(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function o1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Bv={exports:{}},od={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sA;function SP(){if(sA)return od;sA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var c=null;if(o!==void 0&&(c=""+o),s.key!==void 0&&(c=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:n,type:i,key:c,ref:s!==void 0?s:null,props:o}}return od.Fragment=e,od.jsx=t,od.jsxs=t,od}var aA;function AP(){return aA||(aA=1,Bv.exports=SP()),Bv.exports}var v=AP(),zv={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oA;function xP(){if(oA)return Pe;oA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),T=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=T&&V[T]||V["@@iterator"],typeof V=="function"?V:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,q={};function F(V,te,ce){this.props=V,this.context=te,this.refs=q,this.updater=ce||C}F.prototype.isReactComponent={},F.prototype.setState=function(V,te){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,te,"setState")},F.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function j(){}j.prototype=F.prototype;function W(V,te,ce){this.props=V,this.context=te,this.refs=q,this.updater=ce||C}var se=W.prototype=new j;se.constructor=W,M(se,F.prototype),se.isPureReactComponent=!0;var z=Array.isArray;function ae(){}var N={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function x(V,te,ce){var ye=ce.ref;return{$$typeof:n,type:V,key:te,ref:ye!==void 0?ye:null,props:ce}}function k(V,te){return x(V.type,te,V.props)}function P(V){return typeof V=="object"&&V!==null&&V.$$typeof===n}function U(V){var te={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ce){return te[ce]})}var D=/\/+/g;function pt(V,te){return typeof V=="object"&&V!==null&&V.key!=null?U(""+V.key):te.toString(36)}function ct(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(ae,ae):(V.status="pending",V.then(function(te){V.status==="pending"&&(V.status="fulfilled",V.value=te)},function(te){V.status==="pending"&&(V.status="rejected",V.reason=te)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function Z(V,te,ce,ye,Ae){var Ce=typeof V;(Ce==="undefined"||Ce==="boolean")&&(V=null);var Ve=!1;if(V===null)Ve=!0;else switch(Ce){case"bigint":case"string":case"number":Ve=!0;break;case"object":switch(V.$$typeof){case n:case e:Ve=!0;break;case _:return Ve=V._init,Z(Ve(V._payload),te,ce,ye,Ae)}}if(Ve)return Ae=Ae(V),Ve=ye===""?"."+pt(V,0):ye,z(Ae)?(ce="",Ve!=null&&(ce=Ve.replace(D,"$&/")+"/"),Z(Ae,te,ce,"",function(Ni){return Ni})):Ae!=null&&(P(Ae)&&(Ae=k(Ae,ce+(Ae.key==null||V&&V.key===Ae.key?"":(""+Ae.key).replace(D,"$&/")+"/")+Ve)),te.push(Ae)),1;Ve=0;var Et=ye===""?".":ye+":";if(z(V))for(var bt=0;bt<V.length;bt++)ye=V[bt],Ce=Et+pt(ye,bt),Ve+=Z(ye,te,ce,Ce,Ae);else if(bt=S(V),typeof bt=="function")for(V=bt.call(V),bt=0;!(ye=V.next()).done;)ye=ye.value,Ce=Et+pt(ye,bt++),Ve+=Z(ye,te,ce,Ce,Ae);else if(Ce==="object"){if(typeof V.then=="function")return Z(ct(V),te,ce,ye,Ae);throw te=String(V),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Ve}function fe(V,te,ce){if(V==null)return V;var ye=[],Ae=0;return Z(V,ye,"","",function(Ce){return te.call(ce,Ce,Ae++)}),ye}function he(V){if(V._status===-1){var te=V._result;te=te(),te.then(function(ce){(V._status===0||V._status===-1)&&(V._status=1,V._result=ce)},function(ce){(V._status===0||V._status===-1)&&(V._status=2,V._result=ce)}),V._status===-1&&(V._status=0,V._result=te)}if(V._status===1)return V._result.default;throw V._result}var pe=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Ee={map:fe,forEach:function(V,te,ce){fe(V,function(){te.apply(this,arguments)},ce)},count:function(V){var te=0;return fe(V,function(){te++}),te},toArray:function(V){return fe(V,function(te){return te})||[]},only:function(V){if(!P(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Pe.Activity=y,Pe.Children=Ee,Pe.Component=F,Pe.Fragment=t,Pe.Profiler=s,Pe.PureComponent=W,Pe.StrictMode=i,Pe.Suspense=d,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(V){return N.H.useMemoCache(V)}},Pe.cache=function(V){return function(){return V.apply(null,arguments)}},Pe.cacheSignal=function(){return null},Pe.cloneElement=function(V,te,ce){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ye=M({},V.props),Ae=V.key;if(te!=null)for(Ce in te.key!==void 0&&(Ae=""+te.key),te)!R.call(te,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&te.ref===void 0||(ye[Ce]=te[Ce]);var Ce=arguments.length-2;if(Ce===1)ye.children=ce;else if(1<Ce){for(var Ve=Array(Ce),Et=0;Et<Ce;Et++)Ve[Et]=arguments[Et+2];ye.children=Ve}return x(V.type,Ae,ye)},Pe.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:o,_context:V},V},Pe.createElement=function(V,te,ce){var ye,Ae={},Ce=null;if(te!=null)for(ye in te.key!==void 0&&(Ce=""+te.key),te)R.call(te,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(Ae[ye]=te[ye]);var Ve=arguments.length-2;if(Ve===1)Ae.children=ce;else if(1<Ve){for(var Et=Array(Ve),bt=0;bt<Ve;bt++)Et[bt]=arguments[bt+2];Ae.children=Et}if(V&&V.defaultProps)for(ye in Ve=V.defaultProps,Ve)Ae[ye]===void 0&&(Ae[ye]=Ve[ye]);return x(V,Ce,Ae)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(V){return{$$typeof:h,render:V}},Pe.isValidElement=P,Pe.lazy=function(V){return{$$typeof:_,_payload:{_status:-1,_result:V},_init:he}},Pe.memo=function(V,te){return{$$typeof:m,type:V,compare:te===void 0?null:te}},Pe.startTransition=function(V){var te=N.T,ce={};N.T=ce;try{var ye=V(),Ae=N.S;Ae!==null&&Ae(ce,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(ae,pe)}catch(Ce){pe(Ce)}finally{te!==null&&ce.types!==null&&(te.types=ce.types),N.T=te}},Pe.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Pe.use=function(V){return N.H.use(V)},Pe.useActionState=function(V,te,ce){return N.H.useActionState(V,te,ce)},Pe.useCallback=function(V,te){return N.H.useCallback(V,te)},Pe.useContext=function(V){return N.H.useContext(V)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(V,te){return N.H.useDeferredValue(V,te)},Pe.useEffect=function(V,te){return N.H.useEffect(V,te)},Pe.useEffectEvent=function(V){return N.H.useEffectEvent(V)},Pe.useId=function(){return N.H.useId()},Pe.useImperativeHandle=function(V,te,ce){return N.H.useImperativeHandle(V,te,ce)},Pe.useInsertionEffect=function(V,te){return N.H.useInsertionEffect(V,te)},Pe.useLayoutEffect=function(V,te){return N.H.useLayoutEffect(V,te)},Pe.useMemo=function(V,te){return N.H.useMemo(V,te)},Pe.useOptimistic=function(V,te){return N.H.useOptimistic(V,te)},Pe.useReducer=function(V,te,ce){return N.H.useReducer(V,te,ce)},Pe.useRef=function(V){return N.H.useRef(V)},Pe.useState=function(V){return N.H.useState(V)},Pe.useSyncExternalStore=function(V,te,ce){return N.H.useSyncExternalStore(V,te,ce)},Pe.useTransition=function(){return N.H.useTransition()},Pe.version="19.2.0",Pe}var lA;function xw(){return lA||(lA=1,zv.exports=xP()),zv.exports}var H=xw();const Ci=o1(H);var qv={exports:{}},ld={},Gv={exports:{}},Hv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cA;function CP(){return cA||(cA=1,(function(n){function e(Z,fe){var he=Z.length;Z.push(fe);e:for(;0<he;){var pe=he-1>>>1,Ee=Z[pe];if(0<s(Ee,fe))Z[pe]=fe,Z[he]=Ee,he=pe;else break e}}function t(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var fe=Z[0],he=Z.pop();if(he!==fe){Z[0]=he;e:for(var pe=0,Ee=Z.length,V=Ee>>>1;pe<V;){var te=2*(pe+1)-1,ce=Z[te],ye=te+1,Ae=Z[ye];if(0>s(ce,he))ye<Ee&&0>s(Ae,ce)?(Z[pe]=Ae,Z[ye]=he,pe=ye):(Z[pe]=ce,Z[te]=he,pe=te);else if(ye<Ee&&0>s(Ae,he))Z[pe]=Ae,Z[ye]=he,pe=ye;else break e}}return fe}function s(Z,fe){var he=Z.sortIndex-fe.sortIndex;return he!==0?he:Z.id-fe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var d=[],m=[],_=1,y=null,T=3,S=!1,C=!1,M=!1,q=!1,F=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;function se(Z){for(var fe=t(m);fe!==null;){if(fe.callback===null)i(m);else if(fe.startTime<=Z)i(m),fe.sortIndex=fe.expirationTime,e(d,fe);else break;fe=t(m)}}function z(Z){if(M=!1,se(Z),!C)if(t(d)!==null)C=!0,ae||(ae=!0,U());else{var fe=t(m);fe!==null&&ct(z,fe.startTime-Z)}}var ae=!1,N=-1,R=5,x=-1;function k(){return q?!0:!(n.unstable_now()-x<R)}function P(){if(q=!1,ae){var Z=n.unstable_now();x=Z;var fe=!0;try{e:{C=!1,M&&(M=!1,j(N),N=-1),S=!0;var he=T;try{t:{for(se(Z),y=t(d);y!==null&&!(y.expirationTime>Z&&k());){var pe=y.callback;if(typeof pe=="function"){y.callback=null,T=y.priorityLevel;var Ee=pe(y.expirationTime<=Z);if(Z=n.unstable_now(),typeof Ee=="function"){y.callback=Ee,se(Z),fe=!0;break t}y===t(d)&&i(d),se(Z)}else i(d);y=t(d)}if(y!==null)fe=!0;else{var V=t(m);V!==null&&ct(z,V.startTime-Z),fe=!1}}break e}finally{y=null,T=he,S=!1}fe=void 0}}finally{fe?U():ae=!1}}}var U;if(typeof W=="function")U=function(){W(P)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,pt=D.port2;D.port1.onmessage=P,U=function(){pt.postMessage(null)}}else U=function(){F(P,0)};function ct(Z,fe){N=F(function(){Z(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Z){Z.callback=null},n.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Z?Math.floor(1e3/Z):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(Z){switch(T){case 1:case 2:case 3:var fe=3;break;default:fe=T}var he=T;T=fe;try{return Z()}finally{T=he}},n.unstable_requestPaint=function(){q=!0},n.unstable_runWithPriority=function(Z,fe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var he=T;T=Z;try{return fe()}finally{T=he}},n.unstable_scheduleCallback=function(Z,fe,he){var pe=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?pe+he:pe):he=pe,Z){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=he+Ee,Z={id:_++,callback:fe,priorityLevel:Z,startTime:he,expirationTime:Ee,sortIndex:-1},he>pe?(Z.sortIndex=he,e(m,Z),t(d)===null&&Z===t(m)&&(M?(j(N),N=-1):M=!0,ct(z,he-pe))):(Z.sortIndex=Ee,e(d,Z),C||S||(C=!0,ae||(ae=!0,U()))),Z},n.unstable_shouldYield=k,n.unstable_wrapCallback=function(Z){var fe=T;return function(){var he=T;T=fe;try{return Z.apply(this,arguments)}finally{T=he}}}})(Hv)),Hv}var uA;function RP(){return uA||(uA=1,Gv.exports=CP()),Gv.exports}var Kv={exports:{}},Hn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hA;function NP(){if(hA)return Hn;hA=1;var n=xw();function e(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(d,m,_){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:d,containerInfo:m,implementation:_}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,m){if(d==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Hn.createPortal=function(d,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(d,m,null,_)},Hn.flushSync=function(d){var m=c.T,_=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=m,i.p=_,i.d.f()}},Hn.preconnect=function(d,m){typeof d=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(d,m))},Hn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Hn.preinit=function(d,m){if(typeof d=="string"&&m&&typeof m.as=="string"){var _=m.as,y=h(_,m.crossOrigin),T=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(d,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:T,fetchPriority:S}):_==="script"&&i.d.X(d,{crossOrigin:y,integrity:T,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Hn.preinitModule=function(d,m){if(typeof d=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=h(m.as,m.crossOrigin);i.d.M(d,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(d)},Hn.preload=function(d,m){if(typeof d=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,y=h(_,m.crossOrigin);i.d.L(d,_,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Hn.preloadModule=function(d,m){if(typeof d=="string")if(m){var _=h(m.as,m.crossOrigin);i.d.m(d,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(d)},Hn.requestFormReset=function(d){i.d.r(d)},Hn.unstable_batchedUpdates=function(d,m){return d(m)},Hn.useFormState=function(d,m,_){return c.H.useFormState(d,m,_)},Hn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Hn.version="19.2.0",Hn}var dA;function DP(){if(dA)return Kv.exports;dA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Kv.exports=NP(),Kv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fA;function kP(){if(fA)return ld;fA=1;var n=RP(),e=xw(),t=DP();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,l=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(l=a.return),r=a.return;while(r)}return a.tag===3?l:null}function c(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(r.tag===31){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function d(r){if(o(r)!==r)throw Error(i(188))}function m(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(i(188));return a!==r?null:r}for(var l=r,u=a;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(u=p.return,u!==null){l=u;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return d(p),r;if(g===u)return d(p),a;g=g.sibling}throw Error(i(188))}if(l.return!==u.return)l=p,u=g;else{for(var E=!1,I=p.child;I;){if(I===l){E=!0,l=p,u=g;break}if(I===u){E=!0,u=p,l=g;break}I=I.sibling}if(!E){for(I=g.child;I;){if(I===l){E=!0,l=g,u=p;break}if(I===u){E=!0,u=g,l=p;break}I=I.sibling}if(!E)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:a}function _(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=_(r),a!==null)return a;r=r.sibling}return null}var y=Object.assign,T=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),W=Symbol.for("react.context"),se=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function U(r){return r===null||typeof r!="object"?null:(r=P&&r[P]||r["@@iterator"],typeof r=="function"?r:null)}var D=Symbol.for("react.client.reference");function pt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===D?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case M:return"Fragment";case F:return"Profiler";case q:return"StrictMode";case z:return"Suspense";case ae:return"SuspenseList";case x:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case C:return"Portal";case W:return r.displayName||"Context";case j:return(r._context.displayName||"Context")+".Consumer";case se:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case N:return a=r.displayName||null,a!==null?a:pt(r.type)||"Memo";case R:a=r._payload,r=r._init;try{return pt(r(a))}catch{}}return null}var ct=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},pe=[],Ee=-1;function V(r){return{current:r}}function te(r){0>Ee||(r.current=pe[Ee],pe[Ee]=null,Ee--)}function ce(r,a){Ee++,pe[Ee]=r.current,r.current=a}var ye=V(null),Ae=V(null),Ce=V(null),Ve=V(null);function Et(r,a){switch(ce(Ce,a),ce(Ae,r),ce(ye,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?CS(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=CS(a),r=RS(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}te(ye),ce(ye,r)}function bt(){te(ye),te(Ae),te(Ce)}function Ni(r){r.memoizedState!==null&&ce(Ve,r);var a=ye.current,l=RS(a,r.type);a!==l&&(ce(Ae,r),ce(ye,l))}function Di(r){Ae.current===r&&(te(ye),te(Ae)),Ve.current===r&&(te(Ve),id._currentValue=he)}var Tr,ma;function li(r){if(Tr===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Tr=a&&a[1]||"",ma=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tr+r+ma}var _s=!1;function Ir(r,a){if(!r||_s)return"";_s=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(X){var Y=X}Reflect.construct(r,[],re)}else{try{re.call()}catch(X){Y=X}r.call(re.prototype)}}else{try{throw Error()}catch(X){Y=X}(re=r())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(X){if(X&&Y&&typeof X.stack=="string")return[X.stack,Y.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),E=g[0],I=g[1];if(E&&I){var O=E.split(`
`),Q=I.split(`
`);for(p=u=0;u<O.length&&!O[u].includes("DetermineComponentFrameRoot");)u++;for(;p<Q.length&&!Q[p].includes("DetermineComponentFrameRoot");)p++;if(u===O.length||p===Q.length)for(u=O.length-1,p=Q.length-1;1<=u&&0<=p&&O[u]!==Q[p];)p--;for(;1<=u&&0<=p;u--,p--)if(O[u]!==Q[p]){if(u!==1||p!==1)do if(u--,p--,0>p||O[u]!==Q[p]){var ne=`
`+O[u].replace(" at new "," at ");return r.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",r.displayName)),ne}while(1<=u&&0<=p);break}}}finally{_s=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?li(l):""}function pa(r,a){switch(r.tag){case 26:case 27:case 5:return li(r.type);case 16:return li("Lazy");case 13:return r.child!==a&&a!==null?li("Suspense Fallback"):li("Suspense");case 19:return li("SuspenseList");case 0:case 15:return Ir(r.type,!1);case 11:return Ir(r.type.render,!1);case 1:return Ir(r.type,!0);case 31:return li("Activity");default:return""}}function ys(r){try{var a="",l=null;do a+=pa(r,l),l=r,r=r.return;while(r);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var vs=Object.prototype.hasOwnProperty,er=n.unstable_scheduleCallback,Sr=n.unstable_cancelCallback,ci=n.unstable_shouldYield,mn=n.unstable_requestPaint,At=n.unstable_now,hc=n.unstable_getCurrentPriorityLevel,xt=n.unstable_ImmediatePriority,Tt=n.unstable_UserBlockingPriority,gt=n.unstable_NormalPriority,dc=n.unstable_LowPriority,qo=n.unstable_IdlePriority,Go=n.log,ws=n.unstable_setDisableYieldValue,Ue=null,an=null;function qn(r){if(typeof Go=="function"&&ws(r),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Ue,r)}catch{}}var Pn=Math.clz32?Math.clz32:Es,fh=Math.log,ga=Math.LN2;function Es(r){return r>>>=0,r===0?32:31-(fh(r)/ga|0)|0}var tr=256,ki=262144,Ur=4194304;function Oi(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ui(r,a,l){var u=r.pendingLanes;if(u===0)return 0;var p=0,g=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var I=u&134217727;return I!==0?(u=I&~g,u!==0?p=Oi(u):(E&=I,E!==0?p=Oi(E):l||(l=I&~r,l!==0&&(p=Oi(l))))):(I=u&~g,I!==0?p=Oi(I):E!==0?p=Oi(E):l||(l=u&~r,l!==0&&(p=Oi(l)))),p===0?0:a!==0&&a!==p&&(a&g)===0&&(g=p&-p,l=a&-a,g>=l||g===32&&(l&4194048)!==0)?a:p}function Fr(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function _a(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ho(){var r=Ur;return Ur<<=1,(Ur&62914560)===0&&(Ur=4194304),r}function Ar(r){for(var a=[],l=0;31>l;l++)a.push(r);return a}function xr(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function pn(r,a,l,u,p,g){var E=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var I=r.entanglements,O=r.expirationTimes,Q=r.hiddenUpdates;for(l=E&~l;0<l;){var ne=31-Pn(l),re=1<<ne;I[ne]=0,O[ne]=-1;var Y=Q[ne];if(Y!==null)for(Q[ne]=null,ne=0;ne<Y.length;ne++){var X=Y[ne];X!==null&&(X.lane&=-536870913)}l&=~re}u!==0&&Ko(r,u,0),g!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=g&~(E&~a))}function Ko(r,a,l){r.pendingLanes|=a,r.suspendedLanes&=~a;var u=31-Pn(a);r.entangledLanes|=a,r.entanglements[u]=r.entanglements[u]|1073741824|l&261930}function Cr(r,a){var l=r.entangledLanes|=a;for(r=r.entanglements;l;){var u=31-Pn(l),p=1<<u;p&a|r[u]&a&&(r[u]|=a),l&=~p}}function Br(r,a){var l=a&-a;return l=(l&42)!==0?1:Qo(l),(l&(r.suspendedLanes|a))!==0?0:l}function Qo(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ya(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function nr(){var r=fe.p;return r!==0?r:(r=window.event,r===void 0?32:JS(r.type))}function $o(r,a){var l=fe.p;try{return fe.p=r,a()}finally{fe.p=l}}var Oe=Math.random().toString(36).slice(2),ke="__reactFiber$"+Oe,Ft="__reactProps$"+Oe,$n="__reactContainer$"+Oe,Pi="__reactEvents$"+Oe,hi="__reactListeners$"+Oe,bs="__reactHandles$"+Oe,Ts="__reactResources$"+Oe,Is="__reactMarker$"+Oe;function Wo(r){delete r[ke],delete r[Ft],delete r[Pi],delete r[hi],delete r[bs]}function Ss(r){var a=r[ke];if(a)return a;for(var l=r.parentNode;l;){if(a=l[$n]||l[ke]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(r=VS(r);r!==null;){if(l=r[ke])return l;r=VS(r)}return a}r=l,l=r.parentNode}return null}function As(r){if(r=r[ke]||r[$n]){var a=r.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return r}return null}function Yo(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function Rr(r){var a=r[Ts];return a||(a=r[Ts]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function en(r){r[Is]=!0}var fc=new Set,va={};function Wn(r,a){zr(r,a),zr(r+"Capture",a)}function zr(r,a){for(va[r]=a,r=0;r<a.length;r++)fc.add(a[r])}var z_=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mh={},ph={};function am(r){return vs.call(ph,r)?!0:vs.call(mh,r)?!1:z_.test(r)?ph[r]=!0:(mh[r]=!0,!1)}function wa(r,a,l){if(am(a))if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+l)}}function Ea(r,a,l){if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+l)}}function ir(r,a,l,u){if(u===null)r.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(a,l,""+u)}}function Yn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function om(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function q_(r,a,l){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);if(!r.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,g=u.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return p.call(this)},set:function(E){l=""+E,g.call(this,E)}}),Object.defineProperty(r,a,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(E){l=""+E},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function mc(r){if(!r._valueTracker){var a=om(r)?"checked":"value";r._valueTracker=q_(r,a,""+r[a])}}function gh(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return r&&(u=om(r)?r.checked?"true":"false":r.value),r=u,r!==l?(a.setValue(r),!0):!1}function pc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var xs=/[\n"\\]/g;function Ht(r){return r.replace(xs,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ba(r,a,l,u,p,g,E,I){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),a!=null?E==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Yn(a)):r.value!==""+Yn(a)&&(r.value=""+Yn(a)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),a!=null?gc(r,E,Yn(a)):l!=null?gc(r,E,Yn(l)):u!=null&&r.removeAttribute("value"),p==null&&g!=null&&(r.defaultChecked=!!g),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?r.name=""+Yn(I):r.removeAttribute("name")}function Xo(r,a,l,u,p,g,E,I){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(r.type=g),a!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||a!=null)){mc(r);return}l=l!=null?""+Yn(l):"",a=a!=null?""+Yn(a):l,I||a===r.value||(r.value=a),r.defaultValue=a}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=I?r.checked:!!u,r.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),mc(r)}function gc(r,a,l){a==="number"&&pc(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function rt(r,a,l,u){if(r=r.options,a){a={};for(var p=0;p<l.length;p++)a["$"+l[p]]=!0;for(l=0;l<r.length;l++)p=a.hasOwnProperty("$"+r[l].value),r[l].selected!==p&&(r[l].selected=p),p&&u&&(r[l].defaultSelected=!0)}else{for(l=""+Yn(l),a=null,p=0;p<r.length;p++){if(r[p].value===l){r[p].selected=!0,u&&(r[p].defaultSelected=!0);return}a!==null||r[p].disabled||(a=r[p])}a!==null&&(a.selected=!0)}}function Jo(r,a,l){if(a!=null&&(a=""+Yn(a),a!==r.value&&(r.value=a),l==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=l!=null?""+Yn(l):""}function Ta(r,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(i(92));if(ct(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=Yn(a),r.defaultValue=l,u=r.textContent,u===l&&u!==""&&u!==null&&(r.value=u),mc(r)}function rr(r,a){if(a){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=a;return}}r.textContent=a}var G_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _h(r,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":u?r.setProperty(a,l):typeof l!="number"||l===0||G_.has(a)?a==="float"?r.cssFloat=l:r[a]=(""+l).trim():r[a]=l+"px"}function lm(r,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var p in a)u=a[p],a.hasOwnProperty(p)&&l[p]!==u&&_h(r,p,u)}else for(var g in a)a.hasOwnProperty(g)&&_h(r,g,a[g])}function yh(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var H_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),K_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qr(r){return K_.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function wn(){}var _c=null;function yc(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Cs=null,Mi=null;function cm(r){var a=As(r);if(a&&(r=a.stateNode)){var l=r[Ft]||null;e:switch(r=a.stateNode,a.type){case"input":if(ba(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ht(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==r&&u.form===r.form){var p=u[Ft]||null;if(!p)throw Error(i(90));ba(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===r.form&&gh(u)}break e;case"textarea":Jo(r,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&rt(r,!!l.multiple,a,!1)}}}var vh=!1;function um(r,a,l){if(vh)return r(a,l);vh=!0;try{var u=r(a);return u}finally{if(vh=!1,(Cs!==null||Mi!==null)&&(ap(),Cs&&(a=Cs,r=Mi,Mi=Cs=null,cm(a),r)))for(a=0;a<r.length;a++)cm(r[a])}}function di(r,a){var l=r.stateNode;if(l===null)return null;var u=l[Ft]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wh=!1;if(Nr)try{var Gr={};Object.defineProperty(Gr,"passive",{get:function(){wh=!0}}),window.addEventListener("test",Gr,Gr),window.removeEventListener("test",Gr,Gr)}catch{wh=!1}var Vi=null,vc=null,Hr=null;function Ia(){if(Hr)return Hr;var r,a=vc,l=a.length,u,p="value"in Vi?Vi.value:Vi.textContent,g=p.length;for(r=0;r<l&&a[r]===p[r];r++);var E=l-r;for(u=1;u<=E&&a[l-u]===p[g-u];u++);return Hr=p.slice(r,1<u?1-u:void 0)}function Zo(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function Sa(){return!0}function Nt(){return!1}function Gn(r){function a(l,u,p,g,E){this._reactName=l,this._targetInst=p,this.type=u,this.nativeEvent=g,this.target=E,this.currentTarget=null;for(var I in r)r.hasOwnProperty(I)&&(l=r[I],this[I]=l?l(g):g[I]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Sa:Nt,this.isPropagationStopped=Nt,this}return y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Sa)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Sa)},persist:function(){},isPersistent:Sa}),a}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=Gn(Rs),Aa=y({},Rs,{view:0,detail:0}),hm=Gn(Aa),xa,wc,Xn,tl=y({},Aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ra,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Xn&&(Xn&&r.type==="mousemove"?(xa=r.screenX-Xn.screenX,wc=r.screenY-Xn.screenY):wc=xa=0,Xn=r),xa)},movementY:function(r){return"movementY"in r?r.movementY:wc}}),dm=Gn(tl),nl=y({},tl,{dataTransfer:0}),fm=Gn(nl),Eh=y({},Aa,{relatedTarget:0}),Ca=Gn(Eh),mm=y({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ec=Gn(mm),Q_=y({},Rs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),pm=Gn(Q_),il=y({},Rs,{data:0}),bh=Gn(il),gm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Th={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ih={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _m(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=Ih[r])?!!a[r]:!1}function Ra(){return _m}var ym=y({},Aa,{key:function(r){if(r.key){var a=gm[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Zo(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Th[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ra,charCode:function(r){return r.type==="keypress"?Zo(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Zo(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),vm=Gn(ym),Ns=y({},tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sh=Gn(Ns),wm=y({},Aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ra}),Em=Gn(wm),bm=y({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),bc=Gn(bm),Jn=y({},tl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Tm=Gn(Jn),Im=y({},Rs,{newState:0,oldState:0}),Na=Gn(Im),f=[9,13,27,32],w=Nr&&"CompositionEvent"in window,b=null;Nr&&"documentMode"in document&&(b=document.documentMode);var A=Nr&&"TextEvent"in window&&!b,G=Nr&&(!w||b&&8<b&&11>=b),ee=" ",me=!1;function ut(r,a){switch(r){case"keyup":return f.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function on(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Be=!1;function En(r,a){switch(r){case"compositionend":return on(a);case"keypress":return a.which!==32?null:(me=!0,ee);case"textInput":return r=a.data,r===ee&&me?null:r;default:return null}}function bn(r,a){if(Be)return r==="compositionend"||!w&&ut(r,a)?(r=Ia(),Hr=vc=Vi=null,Be=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return G&&a.locale!=="ko"?null:a.data;default:return null}}var Da={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fi(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!Da[r.type]:a==="textarea"}function rl(r,a,l,u){Cs?Mi?Mi.push(u):Mi=[u]:Cs=u,a=fp(a,"onChange"),0<a.length&&(l=new el("onChange","change",null,l,u),r.push({event:l,listeners:a}))}var Ds=null,Ah=null;function Jk(r){bS(r,0)}function Sm(r){var a=Yo(r);if(gh(a))return r}function Bb(r,a){if(r==="change")return a}var zb=!1;if(Nr){var $_;if(Nr){var W_="oninput"in document;if(!W_){var qb=document.createElement("div");qb.setAttribute("oninput","return;"),W_=typeof qb.oninput=="function"}$_=W_}else $_=!1;zb=$_&&(!document.documentMode||9<document.documentMode)}function Gb(){Ds&&(Ds.detachEvent("onpropertychange",Hb),Ah=Ds=null)}function Hb(r){if(r.propertyName==="value"&&Sm(Ah)){var a=[];rl(a,Ah,r,yc(r)),um(Jk,a)}}function Zk(r,a,l){r==="focusin"?(Gb(),Ds=a,Ah=l,Ds.attachEvent("onpropertychange",Hb)):r==="focusout"&&Gb()}function eO(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Sm(Ah)}function tO(r,a){if(r==="click")return Sm(a)}function nO(r,a){if(r==="input"||r==="change")return Sm(a)}function iO(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Li=typeof Object.is=="function"?Object.is:iO;function xh(r,a){if(Li(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var l=Object.keys(r),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var p=l[u];if(!vs.call(a,p)||!Li(r[p],a[p]))return!1}return!0}function Kb(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Qb(r,a){var l=Kb(r);r=0;for(var u;l;){if(l.nodeType===3){if(u=r+l.textContent.length,r<=a&&u>=a)return{node:l,offset:a-r};r=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Kb(l)}}function $b(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?$b(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function Wb(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=pc(r.document);a instanceof r.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)r=a.contentWindow;else break;a=pc(r.document)}return a}function Y_(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var rO=Nr&&"documentMode"in document&&11>=document.documentMode,Tc=null,X_=null,Ch=null,J_=!1;function Yb(r,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;J_||Tc==null||Tc!==pc(u)||(u=Tc,"selectionStart"in u&&Y_(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ch&&xh(Ch,u)||(Ch=u,u=fp(X_,"onSelect"),0<u.length&&(a=new el("onSelect","select",null,a,l),r.push({event:a,listeners:u}),a.target=Tc)))}function sl(r,a){var l={};return l[r.toLowerCase()]=a.toLowerCase(),l["Webkit"+r]="webkit"+a,l["Moz"+r]="moz"+a,l}var Ic={animationend:sl("Animation","AnimationEnd"),animationiteration:sl("Animation","AnimationIteration"),animationstart:sl("Animation","AnimationStart"),transitionrun:sl("Transition","TransitionRun"),transitionstart:sl("Transition","TransitionStart"),transitioncancel:sl("Transition","TransitionCancel"),transitionend:sl("Transition","TransitionEnd")},Z_={},Xb={};Nr&&(Xb=document.createElement("div").style,"AnimationEvent"in window||(delete Ic.animationend.animation,delete Ic.animationiteration.animation,delete Ic.animationstart.animation),"TransitionEvent"in window||delete Ic.transitionend.transition);function al(r){if(Z_[r])return Z_[r];if(!Ic[r])return r;var a=Ic[r],l;for(l in a)if(a.hasOwnProperty(l)&&l in Xb)return Z_[r]=a[l];return r}var Jb=al("animationend"),Zb=al("animationiteration"),eT=al("animationstart"),sO=al("transitionrun"),aO=al("transitionstart"),oO=al("transitioncancel"),tT=al("transitionend"),nT=new Map,ey="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ey.push("scrollEnd");function Dr(r,a){nT.set(r,a),Wn(a,[r])}var Am=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},sr=[],Sc=0,ty=0;function xm(){for(var r=Sc,a=ty=Sc=0;a<r;){var l=sr[a];sr[a++]=null;var u=sr[a];sr[a++]=null;var p=sr[a];sr[a++]=null;var g=sr[a];if(sr[a++]=null,u!==null&&p!==null){var E=u.pending;E===null?p.next=p:(p.next=E.next,E.next=p),u.pending=p}g!==0&&iT(l,p,g)}}function Cm(r,a,l,u){sr[Sc++]=r,sr[Sc++]=a,sr[Sc++]=l,sr[Sc++]=u,ty|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function ny(r,a,l,u){return Cm(r,a,l,u),Rm(r)}function ol(r,a){return Cm(r,null,null,a),Rm(r)}function iT(r,a,l){r.lanes|=l;var u=r.alternate;u!==null&&(u.lanes|=l);for(var p=!1,g=r.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(r=g.stateNode,r===null||r._visibility&1||(p=!0)),r=g,g=g.return;return r.tag===3?(g=r.stateNode,p&&a!==null&&(p=31-Pn(l),r=g.hiddenUpdates,u=r[p],u===null?r[p]=[a]:u.push(a),a.lane=l|536870912),g):null}function Rm(r){if(50<Yh)throw Yh=0,hv=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var Ac={};function lO(r,a,l,u){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ji(r,a,l,u){return new lO(r,a,l,u)}function iy(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ks(r,a){var l=r.alternate;return l===null?(l=ji(r.tag,a,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=a,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,a=r.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function rT(r,a){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,a=l.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function Nm(r,a,l,u,p,g){var E=0;if(u=r,typeof r=="function")iy(r)&&(E=1);else if(typeof r=="string")E=fP(r,l,ye.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case x:return r=ji(31,l,a,p),r.elementType=x,r.lanes=g,r;case M:return ll(l.children,p,g,a);case q:E=8,p|=24;break;case F:return r=ji(12,l,a,p|2),r.elementType=F,r.lanes=g,r;case z:return r=ji(13,l,a,p),r.elementType=z,r.lanes=g,r;case ae:return r=ji(19,l,a,p),r.elementType=ae,r.lanes=g,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case W:E=10;break e;case j:E=9;break e;case se:E=11;break e;case N:E=14;break e;case R:E=16,u=null;break e}E=29,l=Error(i(130,r===null?"null":typeof r,"")),u=null}return a=ji(E,l,a,p),a.elementType=r,a.type=u,a.lanes=g,a}function ll(r,a,l,u){return r=ji(7,r,u,a),r.lanes=l,r}function ry(r,a,l){return r=ji(6,r,null,a),r.lanes=l,r}function sT(r){var a=ji(18,null,null,0);return a.stateNode=r,a}function sy(r,a,l){return a=ji(4,r.children!==null?r.children:[],r.key,a),a.lanes=l,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var aT=new WeakMap;function ar(r,a){if(typeof r=="object"&&r!==null){var l=aT.get(r);return l!==void 0?l:(a={value:r,source:a,stack:ys(a)},aT.set(r,a),a)}return{value:r,source:a,stack:ys(a)}}var xc=[],Cc=0,Dm=null,Rh=0,or=[],lr=0,ka=null,Kr=1,Qr="";function Os(r,a){xc[Cc++]=Rh,xc[Cc++]=Dm,Dm=r,Rh=a}function oT(r,a,l){or[lr++]=Kr,or[lr++]=Qr,or[lr++]=ka,ka=r;var u=Kr;r=Qr;var p=32-Pn(u)-1;u&=~(1<<p),l+=1;var g=32-Pn(a)+p;if(30<g){var E=p-p%5;g=(u&(1<<E)-1).toString(32),u>>=E,p-=E,Kr=1<<32-Pn(a)+p|l<<p|u,Qr=g+r}else Kr=1<<g|l<<p|u,Qr=r}function ay(r){r.return!==null&&(Os(r,1),oT(r,1,0))}function oy(r){for(;r===Dm;)Dm=xc[--Cc],xc[Cc]=null,Rh=xc[--Cc],xc[Cc]=null;for(;r===ka;)ka=or[--lr],or[lr]=null,Qr=or[--lr],or[lr]=null,Kr=or[--lr],or[lr]=null}function lT(r,a){or[lr++]=Kr,or[lr++]=Qr,or[lr++]=ka,Kr=a.id,Qr=a.overflow,ka=r}var Mn=null,Dt=null,Je=!1,Oa=null,cr=!1,ly=Error(i(519));function Pa(r){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nh(ar(a,r)),ly}function cT(r){var a=r.stateNode,l=r.type,u=r.memoizedProps;switch(a[ke]=r,a[Ft]=u,l){case"dialog":Qe("cancel",a),Qe("close",a);break;case"iframe":case"object":case"embed":Qe("load",a);break;case"video":case"audio":for(l=0;l<Jh.length;l++)Qe(Jh[l],a);break;case"source":Qe("error",a);break;case"img":case"image":case"link":Qe("error",a),Qe("load",a);break;case"details":Qe("toggle",a);break;case"input":Qe("invalid",a),Xo(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Qe("invalid",a);break;case"textarea":Qe("invalid",a),Ta(a,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||AS(a.textContent,l)?(u.popover!=null&&(Qe("beforetoggle",a),Qe("toggle",a)),u.onScroll!=null&&Qe("scroll",a),u.onScrollEnd!=null&&Qe("scrollend",a),u.onClick!=null&&(a.onclick=wn),a=!0):a=!1,a||Pa(r,!0)}function uT(r){for(Mn=r.return;Mn;)switch(Mn.tag){case 5:case 31:case 13:cr=!1;return;case 27:case 3:cr=!0;return;default:Mn=Mn.return}}function Rc(r){if(r!==Mn)return!1;if(!Je)return uT(r),Je=!0,!1;var a=r.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||Av(r.type,r.memoizedProps)),l=!l),l&&Dt&&Pa(r),uT(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Dt=MS(r)}else if(a===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Dt=MS(r)}else a===27?(a=Dt,$a(r.type)?(r=Dv,Dv=null,Dt=r):Dt=a):Dt=Mn?hr(r.stateNode.nextSibling):null;return!0}function cl(){Dt=Mn=null,Je=!1}function cy(){var r=Oa;return r!==null&&(_i===null?_i=r:_i.push.apply(_i,r),Oa=null),r}function Nh(r){Oa===null?Oa=[r]:Oa.push(r)}var uy=V(null),ul=null,Ps=null;function Ma(r,a,l){ce(uy,a._currentValue),a._currentValue=l}function Ms(r){r._currentValue=uy.current,te(uy)}function hy(r,a,l){for(;r!==null;){var u=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),r===l)break;r=r.return}}function dy(r,a,l,u){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var g=p.dependencies;if(g!==null){var E=p.child;g=g.firstContext;e:for(;g!==null;){var I=g;g=p;for(var O=0;O<a.length;O++)if(I.context===a[O]){g.lanes|=l,I=g.alternate,I!==null&&(I.lanes|=l),hy(g.return,l,r),u||(E=null);break e}g=I.next}}else if(p.tag===18){if(E=p.return,E===null)throw Error(i(341));E.lanes|=l,g=E.alternate,g!==null&&(g.lanes|=l),hy(E,l,r),E=null}else E=p.child;if(E!==null)E.return=p;else for(E=p;E!==null;){if(E===r){E=null;break}if(p=E.sibling,p!==null){p.return=E.return,E=p;break}E=E.return}p=E}}function Nc(r,a,l,u){r=null;for(var p=a,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var E=p.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var I=p.type;Li(p.pendingProps.value,E.value)||(r!==null?r.push(I):r=[I])}}else if(p===Ve.current){if(E=p.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(id):r=[id])}p=p.return}r!==null&&dy(a,r,l,u),a.flags|=262144}function km(r){for(r=r.firstContext;r!==null;){if(!Li(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function hl(r){ul=r,Ps=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Vn(r){return hT(ul,r)}function Om(r,a){return ul===null&&hl(r),hT(r,a)}function hT(r,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Ps===null){if(r===null)throw Error(i(308));Ps=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else Ps=Ps.next=a;return l}var cO=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(l,u){r.push(u)}};this.abort=function(){a.aborted=!0,r.forEach(function(l){return l()})}},uO=n.unstable_scheduleCallback,hO=n.unstable_NormalPriority,ln={$$typeof:W,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fy(){return{controller:new cO,data:new Map,refCount:0}}function Dh(r){r.refCount--,r.refCount===0&&uO(hO,function(){r.controller.abort()})}var kh=null,my=0,Dc=0,kc=null;function dO(r,a){if(kh===null){var l=kh=[];my=0,Dc=_v(),kc={status:"pending",value:void 0,then:function(u){l.push(u)}}}return my++,a.then(dT,dT),a}function dT(){if(--my===0&&kh!==null){kc!==null&&(kc.status="fulfilled");var r=kh;kh=null,Dc=0,kc=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function fO(r,a){var l=[],u={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return r.then(function(){u.status="fulfilled",u.value=a;for(var p=0;p<l.length;p++)(0,l[p])(a)},function(p){for(u.status="rejected",u.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),u}var fT=Z.S;Z.S=function(r,a){YI=At(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&dO(r,a),fT!==null&&fT(r,a)};var dl=V(null);function py(){var r=dl.current;return r!==null?r:It.pooledCache}function Pm(r,a){a===null?ce(dl,dl.current):ce(dl,a.pool)}function mT(){var r=py();return r===null?null:{parent:ln._currentValue,pool:r}}var Oc=Error(i(460)),gy=Error(i(474)),Mm=Error(i(542)),Vm={then:function(){}};function pT(r){return r=r.status,r==="fulfilled"||r==="rejected"}function gT(r,a,l){switch(l=r[l],l===void 0?r.push(a):l!==a&&(a.then(wn,wn),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,yT(r),r;default:if(typeof a.status=="string")a.then(wn,wn);else{if(r=It,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(u){if(a.status==="pending"){var p=a;p.status="fulfilled",p.value=u}},function(u){if(a.status==="pending"){var p=a;p.status="rejected",p.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,yT(r),r}throw ml=a,Oc}}function fl(r){try{var a=r._init;return a(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ml=l,Oc):l}}var ml=null;function _T(){if(ml===null)throw Error(i(459));var r=ml;return ml=null,r}function yT(r){if(r===Oc||r===Mm)throw Error(i(483))}var Pc=null,Oh=0;function Lm(r){var a=Oh;return Oh+=1,Pc===null&&(Pc=[]),gT(Pc,r,a)}function Ph(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function jm(r,a){throw a.$$typeof===T?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function vT(r){function a(B,L){if(r){var K=B.deletions;K===null?(B.deletions=[L],B.flags|=16):K.push(L)}}function l(B,L){if(!r)return null;for(;L!==null;)a(B,L),L=L.sibling;return null}function u(B){for(var L=new Map;B!==null;)B.key!==null?L.set(B.key,B):L.set(B.index,B),B=B.sibling;return L}function p(B,L){return B=ks(B,L),B.index=0,B.sibling=null,B}function g(B,L,K){return B.index=K,r?(K=B.alternate,K!==null?(K=K.index,K<L?(B.flags|=67108866,L):K):(B.flags|=67108866,L)):(B.flags|=1048576,L)}function E(B){return r&&B.alternate===null&&(B.flags|=67108866),B}function I(B,L,K,ie){return L===null||L.tag!==6?(L=ry(K,B.mode,ie),L.return=B,L):(L=p(L,K),L.return=B,L)}function O(B,L,K,ie){var xe=K.type;return xe===M?ne(B,L,K.props.children,ie,K.key):L!==null&&(L.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===R&&fl(xe)===L.type)?(L=p(L,K.props),Ph(L,K),L.return=B,L):(L=Nm(K.type,K.key,K.props,null,B.mode,ie),Ph(L,K),L.return=B,L)}function Q(B,L,K,ie){return L===null||L.tag!==4||L.stateNode.containerInfo!==K.containerInfo||L.stateNode.implementation!==K.implementation?(L=sy(K,B.mode,ie),L.return=B,L):(L=p(L,K.children||[]),L.return=B,L)}function ne(B,L,K,ie,xe){return L===null||L.tag!==7?(L=ll(K,B.mode,ie,xe),L.return=B,L):(L=p(L,K),L.return=B,L)}function re(B,L,K){if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return L=ry(""+L,B.mode,K),L.return=B,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case S:return K=Nm(L.type,L.key,L.props,null,B.mode,K),Ph(K,L),K.return=B,K;case C:return L=sy(L,B.mode,K),L.return=B,L;case R:return L=fl(L),re(B,L,K)}if(ct(L)||U(L))return L=ll(L,B.mode,K,null),L.return=B,L;if(typeof L.then=="function")return re(B,Lm(L),K);if(L.$$typeof===W)return re(B,Om(B,L),K);jm(B,L)}return null}function Y(B,L,K,ie){var xe=L!==null?L.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return xe!==null?null:I(B,L,""+K,ie);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case S:return K.key===xe?O(B,L,K,ie):null;case C:return K.key===xe?Q(B,L,K,ie):null;case R:return K=fl(K),Y(B,L,K,ie)}if(ct(K)||U(K))return xe!==null?null:ne(B,L,K,ie,null);if(typeof K.then=="function")return Y(B,L,Lm(K),ie);if(K.$$typeof===W)return Y(B,L,Om(B,K),ie);jm(B,K)}return null}function X(B,L,K,ie,xe){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return B=B.get(K)||null,I(L,B,""+ie,xe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:return B=B.get(ie.key===null?K:ie.key)||null,O(L,B,ie,xe);case C:return B=B.get(ie.key===null?K:ie.key)||null,Q(L,B,ie,xe);case R:return ie=fl(ie),X(B,L,K,ie,xe)}if(ct(ie)||U(ie))return B=B.get(K)||null,ne(L,B,ie,xe,null);if(typeof ie.then=="function")return X(B,L,K,Lm(ie),xe);if(ie.$$typeof===W)return X(B,L,K,Om(L,ie),xe);jm(L,ie)}return null}function be(B,L,K,ie){for(var xe=null,st=null,Ie=L,Fe=L=0,We=null;Ie!==null&&Fe<K.length;Fe++){Ie.index>Fe?(We=Ie,Ie=null):We=Ie.sibling;var at=Y(B,Ie,K[Fe],ie);if(at===null){Ie===null&&(Ie=We);break}r&&Ie&&at.alternate===null&&a(B,Ie),L=g(at,L,Fe),st===null?xe=at:st.sibling=at,st=at,Ie=We}if(Fe===K.length)return l(B,Ie),Je&&Os(B,Fe),xe;if(Ie===null){for(;Fe<K.length;Fe++)Ie=re(B,K[Fe],ie),Ie!==null&&(L=g(Ie,L,Fe),st===null?xe=Ie:st.sibling=Ie,st=Ie);return Je&&Os(B,Fe),xe}for(Ie=u(Ie);Fe<K.length;Fe++)We=X(Ie,B,Fe,K[Fe],ie),We!==null&&(r&&We.alternate!==null&&Ie.delete(We.key===null?Fe:We.key),L=g(We,L,Fe),st===null?xe=We:st.sibling=We,st=We);return r&&Ie.forEach(function(Za){return a(B,Za)}),Je&&Os(B,Fe),xe}function Re(B,L,K,ie){if(K==null)throw Error(i(151));for(var xe=null,st=null,Ie=L,Fe=L=0,We=null,at=K.next();Ie!==null&&!at.done;Fe++,at=K.next()){Ie.index>Fe?(We=Ie,Ie=null):We=Ie.sibling;var Za=Y(B,Ie,at.value,ie);if(Za===null){Ie===null&&(Ie=We);break}r&&Ie&&Za.alternate===null&&a(B,Ie),L=g(Za,L,Fe),st===null?xe=Za:st.sibling=Za,st=Za,Ie=We}if(at.done)return l(B,Ie),Je&&Os(B,Fe),xe;if(Ie===null){for(;!at.done;Fe++,at=K.next())at=re(B,at.value,ie),at!==null&&(L=g(at,L,Fe),st===null?xe=at:st.sibling=at,st=at);return Je&&Os(B,Fe),xe}for(Ie=u(Ie);!at.done;Fe++,at=K.next())at=X(Ie,B,Fe,at.value,ie),at!==null&&(r&&at.alternate!==null&&Ie.delete(at.key===null?Fe:at.key),L=g(at,L,Fe),st===null?xe=at:st.sibling=at,st=at);return r&&Ie.forEach(function(IP){return a(B,IP)}),Je&&Os(B,Fe),xe}function vt(B,L,K,ie){if(typeof K=="object"&&K!==null&&K.type===M&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case S:e:{for(var xe=K.key;L!==null;){if(L.key===xe){if(xe=K.type,xe===M){if(L.tag===7){l(B,L.sibling),ie=p(L,K.props.children),ie.return=B,B=ie;break e}}else if(L.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===R&&fl(xe)===L.type){l(B,L.sibling),ie=p(L,K.props),Ph(ie,K),ie.return=B,B=ie;break e}l(B,L);break}else a(B,L);L=L.sibling}K.type===M?(ie=ll(K.props.children,B.mode,ie,K.key),ie.return=B,B=ie):(ie=Nm(K.type,K.key,K.props,null,B.mode,ie),Ph(ie,K),ie.return=B,B=ie)}return E(B);case C:e:{for(xe=K.key;L!==null;){if(L.key===xe)if(L.tag===4&&L.stateNode.containerInfo===K.containerInfo&&L.stateNode.implementation===K.implementation){l(B,L.sibling),ie=p(L,K.children||[]),ie.return=B,B=ie;break e}else{l(B,L);break}else a(B,L);L=L.sibling}ie=sy(K,B.mode,ie),ie.return=B,B=ie}return E(B);case R:return K=fl(K),vt(B,L,K,ie)}if(ct(K))return be(B,L,K,ie);if(U(K)){if(xe=U(K),typeof xe!="function")throw Error(i(150));return K=xe.call(K),Re(B,L,K,ie)}if(typeof K.then=="function")return vt(B,L,Lm(K),ie);if(K.$$typeof===W)return vt(B,L,Om(B,K),ie);jm(B,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,L!==null&&L.tag===6?(l(B,L.sibling),ie=p(L,K),ie.return=B,B=ie):(l(B,L),ie=ry(K,B.mode,ie),ie.return=B,B=ie),E(B)):l(B,L)}return function(B,L,K,ie){try{Oh=0;var xe=vt(B,L,K,ie);return Pc=null,xe}catch(Ie){if(Ie===Oc||Ie===Mm)throw Ie;var st=ji(29,Ie,null,B.mode);return st.lanes=ie,st.return=B,st}finally{}}}var pl=vT(!0),wT=vT(!1),Va=!1;function _y(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yy(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function La(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ja(r,a,l){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(lt&2)!==0){var p=u.pending;return p===null?a.next=a:(a.next=p.next,p.next=a),u.pending=a,a=Rm(r),iT(r,null,l),a}return Cm(r,u,a,l),Rm(r)}function Mh(r,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,Cr(r,l)}}function vy(r,a){var l=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var E={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?p=g=E:g=g.next=E,l=l.next}while(l!==null);g===null?p=g=a:g=g.next=a}else p=g=a;l={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=a:r.next=a,l.lastBaseUpdate=a}var wy=!1;function Vh(){if(wy){var r=kc;if(r!==null)throw r}}function Lh(r,a,l,u){wy=!1;var p=r.updateQueue;Va=!1;var g=p.firstBaseUpdate,E=p.lastBaseUpdate,I=p.shared.pending;if(I!==null){p.shared.pending=null;var O=I,Q=O.next;O.next=null,E===null?g=Q:E.next=Q,E=O;var ne=r.alternate;ne!==null&&(ne=ne.updateQueue,I=ne.lastBaseUpdate,I!==E&&(I===null?ne.firstBaseUpdate=Q:I.next=Q,ne.lastBaseUpdate=O))}if(g!==null){var re=p.baseState;E=0,ne=Q=O=null,I=g;do{var Y=I.lane&-536870913,X=Y!==I.lane;if(X?($e&Y)===Y:(u&Y)===Y){Y!==0&&Y===Dc&&(wy=!0),ne!==null&&(ne=ne.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var be=r,Re=I;Y=a;var vt=l;switch(Re.tag){case 1:if(be=Re.payload,typeof be=="function"){re=be.call(vt,re,Y);break e}re=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Re.payload,Y=typeof be=="function"?be.call(vt,re,Y):be,Y==null)break e;re=y({},re,Y);break e;case 2:Va=!0}}Y=I.callback,Y!==null&&(r.flags|=64,X&&(r.flags|=8192),X=p.callbacks,X===null?p.callbacks=[Y]:X.push(Y))}else X={lane:Y,tag:I.tag,payload:I.payload,callback:I.callback,next:null},ne===null?(Q=ne=X,O=re):ne=ne.next=X,E|=Y;if(I=I.next,I===null){if(I=p.shared.pending,I===null)break;X=I,I=X.next,X.next=null,p.lastBaseUpdate=X,p.shared.pending=null}}while(!0);ne===null&&(O=re),p.baseState=O,p.firstBaseUpdate=Q,p.lastBaseUpdate=ne,g===null&&(p.shared.lanes=0),qa|=E,r.lanes=E,r.memoizedState=re}}function ET(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function bT(r,a){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)ET(l[r],a)}var Mc=V(null),Um=V(0);function TT(r,a){r=Gs,ce(Um,r),ce(Mc,a),Gs=r|a.baseLanes}function Ey(){ce(Um,Gs),ce(Mc,Mc.current)}function by(){Gs=Um.current,te(Mc),te(Um)}var Ui=V(null),ur=null;function Ua(r){var a=r.alternate;ce(tn,tn.current&1),ce(Ui,r),ur===null&&(a===null||Mc.current!==null||a.memoizedState!==null)&&(ur=r)}function Ty(r){ce(tn,tn.current),ce(Ui,r),ur===null&&(ur=r)}function IT(r){r.tag===22?(ce(tn,tn.current),ce(Ui,r),ur===null&&(ur=r)):Fa()}function Fa(){ce(tn,tn.current),ce(Ui,Ui.current)}function Fi(r){te(Ui),ur===r&&(ur=null),te(tn)}var tn=V(0);function Fm(r){for(var a=r;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Rv(l)||Nv(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Vs=0,Le=null,_t=null,cn=null,Bm=!1,Vc=!1,gl=!1,zm=0,jh=0,Lc=null,mO=0;function Kt(){throw Error(i(321))}function Iy(r,a){if(a===null)return!1;for(var l=0;l<a.length&&l<r.length;l++)if(!Li(r[l],a[l]))return!1;return!0}function Sy(r,a,l,u,p,g){return Vs=g,Le=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Z.H=r===null||r.memoizedState===null?oI:Fy,gl=!1,g=l(u,p),gl=!1,Vc&&(g=AT(a,l,u,p)),ST(r),g}function ST(r){Z.H=Bh;var a=_t!==null&&_t.next!==null;if(Vs=0,cn=_t=Le=null,Bm=!1,jh=0,Lc=null,a)throw Error(i(300));r===null||un||(r=r.dependencies,r!==null&&km(r)&&(un=!0))}function AT(r,a,l,u){Le=r;var p=0;do{if(Vc&&(Lc=null),jh=0,Vc=!1,25<=p)throw Error(i(301));if(p+=1,cn=_t=null,r.updateQueue!=null){var g=r.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}Z.H=lI,g=a(l,u)}while(Vc);return g}function pO(){var r=Z.H,a=r.useState()[0];return a=typeof a.then=="function"?Uh(a):a,r=r.useState()[0],(_t!==null?_t.memoizedState:null)!==r&&(Le.flags|=1024),a}function Ay(){var r=zm!==0;return zm=0,r}function xy(r,a,l){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~l}function Cy(r){if(Bm){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Bm=!1}Vs=0,cn=_t=Le=null,Vc=!1,jh=zm=0,Lc=null}function Zn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?Le.memoizedState=cn=r:cn=cn.next=r,cn}function nn(){if(_t===null){var r=Le.alternate;r=r!==null?r.memoizedState:null}else r=_t.next;var a=cn===null?Le.memoizedState:cn.next;if(a!==null)cn=a,_t=r;else{if(r===null)throw Le.alternate===null?Error(i(467)):Error(i(310));_t=r,r={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},cn===null?Le.memoizedState=cn=r:cn=cn.next=r}return cn}function qm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Uh(r){var a=jh;return jh+=1,Lc===null&&(Lc=[]),r=gT(Lc,r,a),a=Le,(cn===null?a.memoizedState:cn.next)===null&&(a=a.alternate,Z.H=a===null||a.memoizedState===null?oI:Fy),r}function Gm(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Uh(r);if(r.$$typeof===W)return Vn(r)}throw Error(i(438,String(r)))}function Ry(r){var a=null,l=Le.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Le.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(p){return p.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=qm(),Le.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(r),u=0;u<r;u++)l[u]=k;return a.index++,l}function Ls(r,a){return typeof a=="function"?a(r):a}function Hm(r){var a=nn();return Ny(a,_t,r)}function Ny(r,a,l){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var p=r.baseQueue,g=u.pending;if(g!==null){if(p!==null){var E=p.next;p.next=g.next,g.next=E}a.baseQueue=p=g,u.pending=null}if(g=r.baseState,p===null)r.memoizedState=g;else{a=p.next;var I=E=null,O=null,Q=a,ne=!1;do{var re=Q.lane&-536870913;if(re!==Q.lane?($e&re)===re:(Vs&re)===re){var Y=Q.revertLane;if(Y===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),re===Dc&&(ne=!0);else if((Vs&Y)===Y){Q=Q.next,Y===Dc&&(ne=!0);continue}else re={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},O===null?(I=O=re,E=g):O=O.next=re,Le.lanes|=Y,qa|=Y;re=Q.action,gl&&l(g,re),g=Q.hasEagerState?Q.eagerState:l(g,re)}else Y={lane:re,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},O===null?(I=O=Y,E=g):O=O.next=Y,Le.lanes|=re,qa|=re;Q=Q.next}while(Q!==null&&Q!==a);if(O===null?E=g:O.next=I,!Li(g,r.memoizedState)&&(un=!0,ne&&(l=kc,l!==null)))throw l;r.memoizedState=g,r.baseState=E,r.baseQueue=O,u.lastRenderedState=g}return p===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function Dy(r){var a=nn(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var u=l.dispatch,p=l.pending,g=a.memoizedState;if(p!==null){l.pending=null;var E=p=p.next;do g=r(g,E.action),E=E.next;while(E!==p);Li(g,a.memoizedState)||(un=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),l.lastRenderedState=g}return[g,u]}function xT(r,a,l){var u=Le,p=nn(),g=Je;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=a();var E=!Li((_t||p).memoizedState,l);if(E&&(p.memoizedState=l,un=!0),p=p.queue,Py(NT.bind(null,u,p,r),[r]),p.getSnapshot!==a||E||cn!==null&&cn.memoizedState.tag&1){if(u.flags|=2048,jc(9,{destroy:void 0},RT.bind(null,u,p,l,a),null),It===null)throw Error(i(349));g||(Vs&127)!==0||CT(u,a,l)}return l}function CT(r,a,l){r.flags|=16384,r={getSnapshot:a,value:l},a=Le.updateQueue,a===null?(a=qm(),Le.updateQueue=a,a.stores=[r]):(l=a.stores,l===null?a.stores=[r]:l.push(r))}function RT(r,a,l,u){a.value=l,a.getSnapshot=u,DT(a)&&kT(r)}function NT(r,a,l){return l(function(){DT(a)&&kT(r)})}function DT(r){var a=r.getSnapshot;r=r.value;try{var l=a();return!Li(r,l)}catch{return!0}}function kT(r){var a=ol(r,2);a!==null&&yi(a,r,2)}function ky(r){var a=Zn();if(typeof r=="function"){var l=r;if(r=l(),gl){qn(!0);try{l()}finally{qn(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:r},a}function OT(r,a,l,u){return r.baseState=l,Ny(r,_t,typeof u=="function"?u:Ls)}function gO(r,a,l,u,p){if($m(r))throw Error(i(485));if(r=a.action,r!==null){var g={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){g.listeners.push(E)}};Z.T!==null?l(!0):g.isTransition=!1,u(g),l=a.pending,l===null?(g.next=a.pending=g,PT(a,g)):(g.next=l.next,a.pending=l.next=g)}}function PT(r,a){var l=a.action,u=a.payload,p=r.state;if(a.isTransition){var g=Z.T,E={};Z.T=E;try{var I=l(p,u),O=Z.S;O!==null&&O(E,I),MT(r,a,I)}catch(Q){Oy(r,a,Q)}finally{g!==null&&E.types!==null&&(g.types=E.types),Z.T=g}}else try{g=l(p,u),MT(r,a,g)}catch(Q){Oy(r,a,Q)}}function MT(r,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){VT(r,a,u)},function(u){return Oy(r,a,u)}):VT(r,a,l)}function VT(r,a,l){a.status="fulfilled",a.value=l,LT(a),r.state=l,a=r.pending,a!==null&&(l=a.next,l===a?r.pending=null:(l=l.next,a.next=l,PT(r,l)))}function Oy(r,a,l){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,LT(a),a=a.next;while(a!==u)}r.action=null}function LT(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function jT(r,a){return a}function UT(r,a){if(Je){var l=It.formState;if(l!==null){e:{var u=Le;if(Je){if(Dt){t:{for(var p=Dt,g=cr;p.nodeType!==8;){if(!g){p=null;break t}if(p=hr(p.nextSibling),p===null){p=null;break t}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){Dt=hr(p.nextSibling),u=p.data==="F!";break e}}Pa(u)}u=!1}u&&(a=l[0])}}return l=Zn(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jT,lastRenderedState:a},l.queue=u,l=rI.bind(null,Le,u),u.dispatch=l,u=ky(!1),g=Uy.bind(null,Le,!1,u.queue),u=Zn(),p={state:a,dispatch:null,action:r,pending:null},u.queue=p,l=gO.bind(null,Le,p,g,l),p.dispatch=l,u.memoizedState=r,[a,l,!1]}function FT(r){var a=nn();return BT(a,_t,r)}function BT(r,a,l){if(a=Ny(r,a,jT)[0],r=Hm(Ls)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=Uh(a)}catch(E){throw E===Oc?Mm:E}else u=a;a=nn();var p=a.queue,g=p.dispatch;return l!==a.memoizedState&&(Le.flags|=2048,jc(9,{destroy:void 0},_O.bind(null,p,l),null)),[u,g,r]}function _O(r,a){r.action=a}function zT(r){var a=nn(),l=_t;if(l!==null)return BT(a,l,r);nn(),a=a.memoizedState,l=nn();var u=l.queue.dispatch;return l.memoizedState=r,[a,u,!1]}function jc(r,a,l,u){return r={tag:r,create:l,deps:u,inst:a,next:null},a=Le.updateQueue,a===null&&(a=qm(),Le.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=r.next=r:(u=l.next,l.next=r,r.next=u,a.lastEffect=r),r}function qT(){return nn().memoizedState}function Km(r,a,l,u){var p=Zn();Le.flags|=r,p.memoizedState=jc(1|a,{destroy:void 0},l,u===void 0?null:u)}function Qm(r,a,l,u){var p=nn();u=u===void 0?null:u;var g=p.memoizedState.inst;_t!==null&&u!==null&&Iy(u,_t.memoizedState.deps)?p.memoizedState=jc(a,g,l,u):(Le.flags|=r,p.memoizedState=jc(1|a,g,l,u))}function GT(r,a){Km(8390656,8,r,a)}function Py(r,a){Qm(2048,8,r,a)}function yO(r){Le.flags|=4;var a=Le.updateQueue;if(a===null)a=qm(),Le.updateQueue=a,a.events=[r];else{var l=a.events;l===null?a.events=[r]:l.push(r)}}function HT(r){var a=nn().memoizedState;return yO({ref:a,nextImpl:r}),function(){if((lt&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function KT(r,a){return Qm(4,2,r,a)}function QT(r,a){return Qm(4,4,r,a)}function $T(r,a){if(typeof a=="function"){r=r();var l=a(r);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function WT(r,a,l){l=l!=null?l.concat([r]):null,Qm(4,4,$T.bind(null,a,r),l)}function My(){}function YT(r,a){var l=nn();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&Iy(a,u[1])?u[0]:(l.memoizedState=[r,a],r)}function XT(r,a){var l=nn();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&Iy(a,u[1]))return u[0];if(u=r(),gl){qn(!0);try{r()}finally{qn(!1)}}return l.memoizedState=[u,a],u}function Vy(r,a,l){return l===void 0||(Vs&1073741824)!==0&&($e&261930)===0?r.memoizedState=a:(r.memoizedState=l,r=JI(),Le.lanes|=r,qa|=r,l)}function JT(r,a,l,u){return Li(l,a)?l:Mc.current!==null?(r=Vy(r,l,u),Li(r,a)||(un=!0),r):(Vs&42)===0||(Vs&1073741824)!==0&&($e&261930)===0?(un=!0,r.memoizedState=l):(r=JI(),Le.lanes|=r,qa|=r,a)}function ZT(r,a,l,u,p){var g=fe.p;fe.p=g!==0&&8>g?g:8;var E=Z.T,I={};Z.T=I,Uy(r,!1,a,l);try{var O=p(),Q=Z.S;if(Q!==null&&Q(I,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var ne=fO(O,u);Fh(r,a,ne,qi(r))}else Fh(r,a,u,qi(r))}catch(re){Fh(r,a,{then:function(){},status:"rejected",reason:re},qi())}finally{fe.p=g,E!==null&&I.types!==null&&(E.types=I.types),Z.T=E}}function vO(){}function Ly(r,a,l,u){if(r.tag!==5)throw Error(i(476));var p=eI(r).queue;ZT(r,p,a,he,l===null?vO:function(){return tI(r),l(u)})}function eI(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:he},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:l},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function tI(r){var a=eI(r);a.next===null&&(a=r.alternate.memoizedState),Fh(r,a.next.queue,{},qi())}function jy(){return Vn(id)}function nI(){return nn().memoizedState}function iI(){return nn().memoizedState}function wO(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var l=qi();r=La(l);var u=ja(a,r,l);u!==null&&(yi(u,a,l),Mh(u,a,l)),a={cache:fy()},r.payload=a;return}a=a.return}}function EO(r,a,l){var u=qi();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},$m(r)?sI(a,l):(l=ny(r,a,l,u),l!==null&&(yi(l,r,u),aI(l,a,u)))}function rI(r,a,l){var u=qi();Fh(r,a,l,u)}function Fh(r,a,l,u){var p={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if($m(r))sI(a,p);else{var g=r.alternate;if(r.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var E=a.lastRenderedState,I=g(E,l);if(p.hasEagerState=!0,p.eagerState=I,Li(I,E))return Cm(r,a,p,0),It===null&&xm(),!1}catch{}finally{}if(l=ny(r,a,p,u),l!==null)return yi(l,r,u),aI(l,a,u),!0}return!1}function Uy(r,a,l,u){if(u={lane:2,revertLane:_v(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},$m(r)){if(a)throw Error(i(479))}else a=ny(r,l,u,2),a!==null&&yi(a,r,2)}function $m(r){var a=r.alternate;return r===Le||a!==null&&a===Le}function sI(r,a){Vc=Bm=!0;var l=r.pending;l===null?a.next=a:(a.next=l.next,l.next=a),r.pending=a}function aI(r,a,l){if((l&4194048)!==0){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,Cr(r,l)}}var Bh={readContext:Vn,use:Gm,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useLayoutEffect:Kt,useInsertionEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useSyncExternalStore:Kt,useId:Kt,useHostTransitionStatus:Kt,useFormState:Kt,useActionState:Kt,useOptimistic:Kt,useMemoCache:Kt,useCacheRefresh:Kt};Bh.useEffectEvent=Kt;var oI={readContext:Vn,use:Gm,useCallback:function(r,a){return Zn().memoizedState=[r,a===void 0?null:a],r},useContext:Vn,useEffect:GT,useImperativeHandle:function(r,a,l){l=l!=null?l.concat([r]):null,Km(4194308,4,$T.bind(null,a,r),l)},useLayoutEffect:function(r,a){return Km(4194308,4,r,a)},useInsertionEffect:function(r,a){Km(4,2,r,a)},useMemo:function(r,a){var l=Zn();a=a===void 0?null:a;var u=r();if(gl){qn(!0);try{r()}finally{qn(!1)}}return l.memoizedState=[u,a],u},useReducer:function(r,a,l){var u=Zn();if(l!==void 0){var p=l(a);if(gl){qn(!0);try{l(a)}finally{qn(!1)}}}else p=a;return u.memoizedState=u.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},u.queue=r,r=r.dispatch=EO.bind(null,Le,r),[u.memoizedState,r]},useRef:function(r){var a=Zn();return r={current:r},a.memoizedState=r},useState:function(r){r=ky(r);var a=r.queue,l=rI.bind(null,Le,a);return a.dispatch=l,[r.memoizedState,l]},useDebugValue:My,useDeferredValue:function(r,a){var l=Zn();return Vy(l,r,a)},useTransition:function(){var r=ky(!1);return r=ZT.bind(null,Le,r.queue,!0,!1),Zn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,l){var u=Le,p=Zn();if(Je){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),It===null)throw Error(i(349));($e&127)!==0||CT(u,a,l)}p.memoizedState=l;var g={value:l,getSnapshot:a};return p.queue=g,GT(NT.bind(null,u,g,r),[r]),u.flags|=2048,jc(9,{destroy:void 0},RT.bind(null,u,g,l,a),null),l},useId:function(){var r=Zn(),a=It.identifierPrefix;if(Je){var l=Qr,u=Kr;l=(u&~(1<<32-Pn(u)-1)).toString(32)+l,a="_"+a+"R_"+l,l=zm++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=mO++,a="_"+a+"r_"+l.toString(32)+"_";return r.memoizedState=a},useHostTransitionStatus:jy,useFormState:UT,useActionState:UT,useOptimistic:function(r){var a=Zn();a.memoizedState=a.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Uy.bind(null,Le,!0,l),l.dispatch=a,[r,a]},useMemoCache:Ry,useCacheRefresh:function(){return Zn().memoizedState=wO.bind(null,Le)},useEffectEvent:function(r){var a=Zn(),l={impl:r};return a.memoizedState=l,function(){if((lt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},Fy={readContext:Vn,use:Gm,useCallback:YT,useContext:Vn,useEffect:Py,useImperativeHandle:WT,useInsertionEffect:KT,useLayoutEffect:QT,useMemo:XT,useReducer:Hm,useRef:qT,useState:function(){return Hm(Ls)},useDebugValue:My,useDeferredValue:function(r,a){var l=nn();return JT(l,_t.memoizedState,r,a)},useTransition:function(){var r=Hm(Ls)[0],a=nn().memoizedState;return[typeof r=="boolean"?r:Uh(r),a]},useSyncExternalStore:xT,useId:nI,useHostTransitionStatus:jy,useFormState:FT,useActionState:FT,useOptimistic:function(r,a){var l=nn();return OT(l,_t,r,a)},useMemoCache:Ry,useCacheRefresh:iI};Fy.useEffectEvent=HT;var lI={readContext:Vn,use:Gm,useCallback:YT,useContext:Vn,useEffect:Py,useImperativeHandle:WT,useInsertionEffect:KT,useLayoutEffect:QT,useMemo:XT,useReducer:Dy,useRef:qT,useState:function(){return Dy(Ls)},useDebugValue:My,useDeferredValue:function(r,a){var l=nn();return _t===null?Vy(l,r,a):JT(l,_t.memoizedState,r,a)},useTransition:function(){var r=Dy(Ls)[0],a=nn().memoizedState;return[typeof r=="boolean"?r:Uh(r),a]},useSyncExternalStore:xT,useId:nI,useHostTransitionStatus:jy,useFormState:zT,useActionState:zT,useOptimistic:function(r,a){var l=nn();return _t!==null?OT(l,_t,r,a):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:Ry,useCacheRefresh:iI};lI.useEffectEvent=HT;function By(r,a,l,u){a=r.memoizedState,l=l(u,a),l=l==null?a:y({},a,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var zy={enqueueSetState:function(r,a,l){r=r._reactInternals;var u=qi(),p=La(u);p.payload=a,l!=null&&(p.callback=l),a=ja(r,p,u),a!==null&&(yi(a,r,u),Mh(a,r,u))},enqueueReplaceState:function(r,a,l){r=r._reactInternals;var u=qi(),p=La(u);p.tag=1,p.payload=a,l!=null&&(p.callback=l),a=ja(r,p,u),a!==null&&(yi(a,r,u),Mh(a,r,u))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var l=qi(),u=La(l);u.tag=2,a!=null&&(u.callback=a),a=ja(r,u,l),a!==null&&(yi(a,r,l),Mh(a,r,l))}};function cI(r,a,l,u,p,g,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,g,E):a.prototype&&a.prototype.isPureReactComponent?!xh(l,u)||!xh(p,g):!0}function uI(r,a,l,u){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==r&&zy.enqueueReplaceState(a,a.state,null)}function _l(r,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(r=r.defaultProps){l===a&&(l=y({},l));for(var p in r)l[p]===void 0&&(l[p]=r[p])}return l}function hI(r){Am(r)}function dI(r){console.error(r)}function fI(r){Am(r)}function Wm(r,a){try{var l=r.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function mI(r,a,l){try{var u=r.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function qy(r,a,l){return l=La(l),l.tag=3,l.payload={element:null},l.callback=function(){Wm(r,a)},l}function pI(r){return r=La(r),r.tag=3,r}function gI(r,a,l,u){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var g=u.value;r.payload=function(){return p(g)},r.callback=function(){mI(a,l,u)}}var E=l.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){mI(a,l,u),typeof p!="function"&&(Ga===null?Ga=new Set([this]):Ga.add(this));var I=u.stack;this.componentDidCatch(u.value,{componentStack:I!==null?I:""})})}function bO(r,a,l,u,p){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&Nc(a,l,p,!0),l=Ui.current,l!==null){switch(l.tag){case 31:case 13:return ur===null?op():l.alternate===null&&Qt===0&&(Qt=3),l.flags&=-257,l.flags|=65536,l.lanes=p,u===Vm?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),mv(r,u,p)),!1;case 22:return l.flags|=65536,u===Vm?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),mv(r,u,p)),!1}throw Error(i(435,l.tag))}return mv(r,u,p),op(),!1}if(Je)return a=Ui.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=p,u!==ly&&(r=Error(i(422),{cause:u}),Nh(ar(r,l)))):(u!==ly&&(a=Error(i(423),{cause:u}),Nh(ar(a,l))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,u=ar(u,l),p=qy(r.stateNode,u,p),vy(r,p),Qt!==4&&(Qt=2)),!1;var g=Error(i(520),{cause:u});if(g=ar(g,l),Wh===null?Wh=[g]:Wh.push(g),Qt!==4&&(Qt=2),a===null)return!0;u=ar(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,r=p&-p,l.lanes|=r,r=qy(l.stateNode,u,r),vy(l,r),!1;case 1:if(a=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ga===null||!Ga.has(g))))return l.flags|=65536,p&=-p,l.lanes|=p,p=pI(p),gI(p,r,l,u),vy(l,p),!1}l=l.return}while(l!==null);return!1}var Gy=Error(i(461)),un=!1;function Ln(r,a,l,u){a.child=r===null?wT(a,null,l,u):pl(a,r.child,l,u)}function _I(r,a,l,u,p){l=l.render;var g=a.ref;if("ref"in u){var E={};for(var I in u)I!=="ref"&&(E[I]=u[I])}else E=u;return hl(a),u=Sy(r,a,l,E,g,p),I=Ay(),r!==null&&!un?(xy(r,a,p),js(r,a,p)):(Je&&I&&ay(a),a.flags|=1,Ln(r,a,u,p),a.child)}function yI(r,a,l,u,p){if(r===null){var g=l.type;return typeof g=="function"&&!iy(g)&&g.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=g,vI(r,a,g,u,p)):(r=Nm(l.type,null,u,a,a.mode,p),r.ref=a.ref,r.return=a,a.child=r)}if(g=r.child,!Jy(r,p)){var E=g.memoizedProps;if(l=l.compare,l=l!==null?l:xh,l(E,u)&&r.ref===a.ref)return js(r,a,p)}return a.flags|=1,r=ks(g,u),r.ref=a.ref,r.return=a,a.child=r}function vI(r,a,l,u,p){if(r!==null){var g=r.memoizedProps;if(xh(g,u)&&r.ref===a.ref)if(un=!1,a.pendingProps=u=g,Jy(r,p))(r.flags&131072)!==0&&(un=!0);else return a.lanes=r.lanes,js(r,a,p)}return Hy(r,a,l,u,p)}function wI(r,a,l,u){var p=u.children,g=r!==null?r.memoizedState:null;if(r===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((a.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,r!==null){for(u=a.child=r.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~g}else u=0,a.child=null;return EI(r,a,g,l,u)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&Pm(a,g!==null?g.cachePool:null),g!==null?TT(a,g):Ey(),IT(a);else return u=a.lanes=536870912,EI(r,a,g!==null?g.baseLanes|l:l,l,u)}else g!==null?(Pm(a,g.cachePool),TT(a,g),Fa(),a.memoizedState=null):(r!==null&&Pm(a,null),Ey(),Fa());return Ln(r,a,p,l),a.child}function zh(r,a){return r!==null&&r.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function EI(r,a,l,u,p){var g=py();return g=g===null?null:{parent:ln._currentValue,pool:g},a.memoizedState={baseLanes:l,cachePool:g},r!==null&&Pm(a,null),Ey(),IT(a),r!==null&&Nc(r,a,u,!0),a.childLanes=p,null}function Ym(r,a){return a=Jm({mode:a.mode,children:a.children},r.mode),a.ref=r.ref,r.child=a,a.return=r,a}function bI(r,a,l){return pl(a,r.child,null,l),r=Ym(a,a.pendingProps),r.flags|=2,Fi(a),a.memoizedState=null,r}function TO(r,a,l){var u=a.pendingProps,p=(a.flags&128)!==0;if(a.flags&=-129,r===null){if(Je){if(u.mode==="hidden")return r=Ym(a,u),a.lanes=536870912,zh(null,r);if(Ty(a),(r=Dt)?(r=PS(r,cr),r=r!==null&&r.data==="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:ka!==null?{id:Kr,overflow:Qr}:null,retryLane:536870912,hydrationErrors:null},l=sT(r),l.return=a,a.child=l,Mn=a,Dt=null)):r=null,r===null)throw Pa(a);return a.lanes=536870912,null}return Ym(a,u)}var g=r.memoizedState;if(g!==null){var E=g.dehydrated;if(Ty(a),p)if(a.flags&256)a.flags&=-257,a=bI(r,a,l);else if(a.memoizedState!==null)a.child=r.child,a.flags|=128,a=null;else throw Error(i(558));else if(un||Nc(r,a,l,!1),p=(l&r.childLanes)!==0,un||p){if(u=It,u!==null&&(E=Br(u,l),E!==0&&E!==g.retryLane))throw g.retryLane=E,ol(r,E),yi(u,r,E),Gy;op(),a=bI(r,a,l)}else r=g.treeContext,Dt=hr(E.nextSibling),Mn=a,Je=!0,Oa=null,cr=!1,r!==null&&lT(a,r),a=Ym(a,u),a.flags|=4096;return a}return r=ks(r.child,{mode:u.mode,children:u.children}),r.ref=a.ref,a.child=r,r.return=a,r}function Xm(r,a){var l=a.ref;if(l===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(a.flags|=4194816)}}function Hy(r,a,l,u,p){return hl(a),l=Sy(r,a,l,u,void 0,p),u=Ay(),r!==null&&!un?(xy(r,a,p),js(r,a,p)):(Je&&u&&ay(a),a.flags|=1,Ln(r,a,l,p),a.child)}function TI(r,a,l,u,p,g){return hl(a),a.updateQueue=null,l=AT(a,u,l,p),ST(r),u=Ay(),r!==null&&!un?(xy(r,a,g),js(r,a,g)):(Je&&u&&ay(a),a.flags|=1,Ln(r,a,l,g),a.child)}function II(r,a,l,u,p){if(hl(a),a.stateNode===null){var g=Ac,E=l.contextType;typeof E=="object"&&E!==null&&(g=Vn(E)),g=new l(u,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=zy,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=u,g.state=a.memoizedState,g.refs={},_y(a),E=l.contextType,g.context=typeof E=="object"&&E!==null?Vn(E):Ac,g.state=a.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(By(a,l,E,u),g.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(E=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),E!==g.state&&zy.enqueueReplaceState(g,g.state,null),Lh(a,u,g,p),Vh(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(r===null){g=a.stateNode;var I=a.memoizedProps,O=_l(l,I);g.props=O;var Q=g.context,ne=l.contextType;E=Ac,typeof ne=="object"&&ne!==null&&(E=Vn(ne));var re=l.getDerivedStateFromProps;ne=typeof re=="function"||typeof g.getSnapshotBeforeUpdate=="function",I=a.pendingProps!==I,ne||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(I||Q!==E)&&uI(a,g,u,E),Va=!1;var Y=a.memoizedState;g.state=Y,Lh(a,u,g,p),Vh(),Q=a.memoizedState,I||Y!==Q||Va?(typeof re=="function"&&(By(a,l,re,u),Q=a.memoizedState),(O=Va||cI(a,l,O,u,Y,Q,E))?(ne||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=Q),g.props=u,g.state=Q,g.context=E,u=O):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{g=a.stateNode,yy(r,a),E=a.memoizedProps,ne=_l(l,E),g.props=ne,re=a.pendingProps,Y=g.context,Q=l.contextType,O=Ac,typeof Q=="object"&&Q!==null&&(O=Vn(Q)),I=l.getDerivedStateFromProps,(Q=typeof I=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E!==re||Y!==O)&&uI(a,g,u,O),Va=!1,Y=a.memoizedState,g.state=Y,Lh(a,u,g,p),Vh();var X=a.memoizedState;E!==re||Y!==X||Va||r!==null&&r.dependencies!==null&&km(r.dependencies)?(typeof I=="function"&&(By(a,l,I,u),X=a.memoizedState),(ne=Va||cI(a,l,ne,u,Y,X,O)||r!==null&&r.dependencies!==null&&km(r.dependencies))?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,X,O),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,X,O)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||E===r.memoizedProps&&Y===r.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&Y===r.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=X),g.props=u,g.state=X,g.context=O,u=ne):(typeof g.componentDidUpdate!="function"||E===r.memoizedProps&&Y===r.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&Y===r.memoizedState||(a.flags|=1024),u=!1)}return g=u,Xm(r,a),u=(a.flags&128)!==0,g||u?(g=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,r!==null&&u?(a.child=pl(a,r.child,null,p),a.child=pl(a,null,l,p)):Ln(r,a,l,p),a.memoizedState=g.state,r=a.child):r=js(r,a,p),r}function SI(r,a,l,u){return cl(),a.flags|=256,Ln(r,a,l,u),a.child}var Ky={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qy(r){return{baseLanes:r,cachePool:mT()}}function $y(r,a,l){return r=r!==null?r.childLanes&~l:0,a&&(r|=zi),r}function AI(r,a,l){var u=a.pendingProps,p=!1,g=(a.flags&128)!==0,E;if((E=g)||(E=r!==null&&r.memoizedState===null?!1:(tn.current&2)!==0),E&&(p=!0,a.flags&=-129),E=(a.flags&32)!==0,a.flags&=-33,r===null){if(Je){if(p?Ua(a):Fa(),(r=Dt)?(r=PS(r,cr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:ka!==null?{id:Kr,overflow:Qr}:null,retryLane:536870912,hydrationErrors:null},l=sT(r),l.return=a,a.child=l,Mn=a,Dt=null)):r=null,r===null)throw Pa(a);return Nv(r)?a.lanes=32:a.lanes=536870912,null}var I=u.children;return u=u.fallback,p?(Fa(),p=a.mode,I=Jm({mode:"hidden",children:I},p),u=ll(u,p,l,null),I.return=a,u.return=a,I.sibling=u,a.child=I,u=a.child,u.memoizedState=Qy(l),u.childLanes=$y(r,E,l),a.memoizedState=Ky,zh(null,u)):(Ua(a),Wy(a,I))}var O=r.memoizedState;if(O!==null&&(I=O.dehydrated,I!==null)){if(g)a.flags&256?(Ua(a),a.flags&=-257,a=Yy(r,a,l)):a.memoizedState!==null?(Fa(),a.child=r.child,a.flags|=128,a=null):(Fa(),I=u.fallback,p=a.mode,u=Jm({mode:"visible",children:u.children},p),I=ll(I,p,l,null),I.flags|=2,u.return=a,I.return=a,u.sibling=I,a.child=u,pl(a,r.child,null,l),u=a.child,u.memoizedState=Qy(l),u.childLanes=$y(r,E,l),a.memoizedState=Ky,a=zh(null,u));else if(Ua(a),Nv(I)){if(E=I.nextSibling&&I.nextSibling.dataset,E)var Q=E.dgst;E=Q,u=Error(i(419)),u.stack="",u.digest=E,Nh({value:u,source:null,stack:null}),a=Yy(r,a,l)}else if(un||Nc(r,a,l,!1),E=(l&r.childLanes)!==0,un||E){if(E=It,E!==null&&(u=Br(E,l),u!==0&&u!==O.retryLane))throw O.retryLane=u,ol(r,u),yi(E,r,u),Gy;Rv(I)||op(),a=Yy(r,a,l)}else Rv(I)?(a.flags|=192,a.child=r.child,a=null):(r=O.treeContext,Dt=hr(I.nextSibling),Mn=a,Je=!0,Oa=null,cr=!1,r!==null&&lT(a,r),a=Wy(a,u.children),a.flags|=4096);return a}return p?(Fa(),I=u.fallback,p=a.mode,O=r.child,Q=O.sibling,u=ks(O,{mode:"hidden",children:u.children}),u.subtreeFlags=O.subtreeFlags&65011712,Q!==null?I=ks(Q,I):(I=ll(I,p,l,null),I.flags|=2),I.return=a,u.return=a,u.sibling=I,a.child=u,zh(null,u),u=a.child,I=r.child.memoizedState,I===null?I=Qy(l):(p=I.cachePool,p!==null?(O=ln._currentValue,p=p.parent!==O?{parent:O,pool:O}:p):p=mT(),I={baseLanes:I.baseLanes|l,cachePool:p}),u.memoizedState=I,u.childLanes=$y(r,E,l),a.memoizedState=Ky,zh(r.child,u)):(Ua(a),l=r.child,r=l.sibling,l=ks(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,r!==null&&(E=a.deletions,E===null?(a.deletions=[r],a.flags|=16):E.push(r)),a.child=l,a.memoizedState=null,l)}function Wy(r,a){return a=Jm({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Jm(r,a){return r=ji(22,r,null,a),r.lanes=0,r}function Yy(r,a,l){return pl(a,r.child,null,l),r=Wy(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function xI(r,a,l){r.lanes|=a;var u=r.alternate;u!==null&&(u.lanes|=a),hy(r.return,a,l)}function Xy(r,a,l,u,p,g){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:p,treeForkCount:g}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=u,E.tail=l,E.tailMode=p,E.treeForkCount=g)}function CI(r,a,l){var u=a.pendingProps,p=u.revealOrder,g=u.tail;u=u.children;var E=tn.current,I=(E&2)!==0;if(I?(E=E&1|2,a.flags|=128):E&=1,ce(tn,E),Ln(r,a,u,l),u=Je?Rh:0,!I&&r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&xI(r,l,a);else if(r.tag===19)xI(r,l,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(l=a.child,p=null;l!==null;)r=l.alternate,r!==null&&Fm(r)===null&&(p=l),l=l.sibling;l=p,l===null?(p=a.child,a.child=null):(p=l.sibling,l.sibling=null),Xy(a,!1,p,l,g,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,p=a.child,a.child=null;p!==null;){if(r=p.alternate,r!==null&&Fm(r)===null){a.child=p;break}r=p.sibling,p.sibling=l,l=p,p=r}Xy(a,!0,l,null,g,u);break;case"together":Xy(a,!1,null,null,void 0,u);break;default:a.memoizedState=null}return a.child}function js(r,a,l){if(r!==null&&(a.dependencies=r.dependencies),qa|=a.lanes,(l&a.childLanes)===0)if(r!==null){if(Nc(r,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,l=ks(r,r.pendingProps),a.child=l,l.return=a;r.sibling!==null;)r=r.sibling,l=l.sibling=ks(r,r.pendingProps),l.return=a;l.sibling=null}return a.child}function Jy(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&km(r)))}function IO(r,a,l){switch(a.tag){case 3:Et(a,a.stateNode.containerInfo),Ma(a,ln,r.memoizedState.cache),cl();break;case 27:case 5:Ni(a);break;case 4:Et(a,a.stateNode.containerInfo);break;case 10:Ma(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Ty(a),null;break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(Ua(a),a.flags|=128,null):(l&a.child.childLanes)!==0?AI(r,a,l):(Ua(a),r=js(r,a,l),r!==null?r.sibling:null);Ua(a);break;case 19:var p=(r.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(Nc(r,a,l,!1),u=(l&a.childLanes)!==0),p){if(u)return CI(r,a,l);a.flags|=128}if(p=a.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ce(tn,tn.current),u)break;return null;case 22:return a.lanes=0,wI(r,a,l,a.pendingProps);case 24:Ma(a,ln,r.memoizedState.cache)}return js(r,a,l)}function RI(r,a,l){if(r!==null)if(r.memoizedProps!==a.pendingProps)un=!0;else{if(!Jy(r,l)&&(a.flags&128)===0)return un=!1,IO(r,a,l);un=(r.flags&131072)!==0}else un=!1,Je&&(a.flags&1048576)!==0&&oT(a,Rh,a.index);switch(a.lanes=0,a.tag){case 16:e:{var u=a.pendingProps;if(r=fl(a.elementType),a.type=r,typeof r=="function")iy(r)?(u=_l(r,u),a.tag=1,a=II(null,a,r,u,l)):(a.tag=0,a=Hy(null,a,r,u,l));else{if(r!=null){var p=r.$$typeof;if(p===se){a.tag=11,a=_I(null,a,r,u,l);break e}else if(p===N){a.tag=14,a=yI(null,a,r,u,l);break e}}throw a=pt(r)||r,Error(i(306,a,""))}}return a;case 0:return Hy(r,a,a.type,a.pendingProps,l);case 1:return u=a.type,p=_l(u,a.pendingProps),II(r,a,u,p,l);case 3:e:{if(Et(a,a.stateNode.containerInfo),r===null)throw Error(i(387));u=a.pendingProps;var g=a.memoizedState;p=g.element,yy(r,a),Lh(a,u,null,l);var E=a.memoizedState;if(u=E.cache,Ma(a,ln,u),u!==g.cache&&dy(a,[ln],l,!0),Vh(),u=E.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:E.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=SI(r,a,u,l);break e}else if(u!==p){p=ar(Error(i(424)),a),Nh(p),a=SI(r,a,u,l);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Dt=hr(r.firstChild),Mn=a,Je=!0,Oa=null,cr=!0,l=wT(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(cl(),u===p){a=js(r,a,l);break e}Ln(r,a,u,l)}a=a.child}return a;case 26:return Xm(r,a),r===null?(l=FS(a.type,null,a.pendingProps,null))?a.memoizedState=l:Je||(l=a.type,r=a.pendingProps,u=mp(Ce.current).createElement(l),u[ke]=a,u[Ft]=r,jn(u,l,r),en(u),a.stateNode=u):a.memoizedState=FS(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return Ni(a),r===null&&Je&&(u=a.stateNode=LS(a.type,a.pendingProps,Ce.current),Mn=a,cr=!0,p=Dt,$a(a.type)?(Dv=p,Dt=hr(u.firstChild)):Dt=p),Ln(r,a,a.pendingProps.children,l),Xm(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&Je&&((p=u=Dt)&&(u=eP(u,a.type,a.pendingProps,cr),u!==null?(a.stateNode=u,Mn=a,Dt=hr(u.firstChild),cr=!1,p=!0):p=!1),p||Pa(a)),Ni(a),p=a.type,g=a.pendingProps,E=r!==null?r.memoizedProps:null,u=g.children,Av(p,g)?u=null:E!==null&&Av(p,E)&&(a.flags|=32),a.memoizedState!==null&&(p=Sy(r,a,pO,null,null,l),id._currentValue=p),Xm(r,a),Ln(r,a,u,l),a.child;case 6:return r===null&&Je&&((r=l=Dt)&&(l=tP(l,a.pendingProps,cr),l!==null?(a.stateNode=l,Mn=a,Dt=null,r=!0):r=!1),r||Pa(a)),null;case 13:return AI(r,a,l);case 4:return Et(a,a.stateNode.containerInfo),u=a.pendingProps,r===null?a.child=pl(a,null,u,l):Ln(r,a,u,l),a.child;case 11:return _I(r,a,a.type,a.pendingProps,l);case 7:return Ln(r,a,a.pendingProps,l),a.child;case 8:return Ln(r,a,a.pendingProps.children,l),a.child;case 12:return Ln(r,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,Ma(a,a.type,u.value),Ln(r,a,u.children,l),a.child;case 9:return p=a.type._context,u=a.pendingProps.children,hl(a),p=Vn(p),u=u(p),a.flags|=1,Ln(r,a,u,l),a.child;case 14:return yI(r,a,a.type,a.pendingProps,l);case 15:return vI(r,a,a.type,a.pendingProps,l);case 19:return CI(r,a,l);case 31:return TO(r,a,l);case 22:return wI(r,a,l,a.pendingProps);case 24:return hl(a),u=Vn(ln),r===null?(p=py(),p===null&&(p=It,g=fy(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=l),p=g),a.memoizedState={parent:u,cache:p},_y(a),Ma(a,ln,p)):((r.lanes&l)!==0&&(yy(r,a),Lh(a,null,null,l),Vh()),p=r.memoizedState,g=a.memoizedState,p.parent!==u?(p={parent:u,cache:u},a.memoizedState=p,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=p),Ma(a,ln,u)):(u=g.cache,Ma(a,ln,u),u!==p.cache&&dy(a,[ln],l,!0))),Ln(r,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Us(r){r.flags|=4}function Zy(r,a,l,u,p){if((a=(r.mode&32)!==0)&&(a=!1),a){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(nS())r.flags|=8192;else throw ml=Vm,gy}else r.flags&=-16777217}function NI(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!HS(a))if(nS())r.flags|=8192;else throw ml=Vm,gy}function Zm(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?Ho():536870912,r.lanes|=a,zc|=a)}function qh(r,a){if(!Je)switch(r.tailMode){case"hidden":a=r.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function kt(r){var a=r.alternate!==null&&r.alternate.child===r.child,l=0,u=0;if(a)for(var p=r.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=u,r.childLanes=l,a}function SO(r,a,l){var u=a.pendingProps;switch(oy(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(a),null;case 1:return kt(a),null;case 3:return l=a.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Ms(ln),bt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(Rc(a)?Us(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,cy())),kt(a),null;case 26:var p=a.type,g=a.memoizedState;return r===null?(Us(a),g!==null?(kt(a),NI(a,g)):(kt(a),Zy(a,p,null,u,l))):g?g!==r.memoizedState?(Us(a),kt(a),NI(a,g)):(kt(a),a.flags&=-16777217):(r=r.memoizedProps,r!==u&&Us(a),kt(a),Zy(a,p,r,u,l)),null;case 27:if(Di(a),l=Ce.current,p=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==u&&Us(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return kt(a),null}r=ye.current,Rc(a)?cT(a):(r=LS(p,u,l),a.stateNode=r,Us(a))}return kt(a),null;case 5:if(Di(a),p=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==u&&Us(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return kt(a),null}if(g=ye.current,Rc(a))cT(a);else{var E=mp(Ce.current);switch(g){case 1:g=E.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:g=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":g=E.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":g=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":g=E.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof u.is=="string"?E.createElement("select",{is:u.is}):E.createElement("select"),u.multiple?g.multiple=!0:u.size&&(g.size=u.size);break;default:g=typeof u.is=="string"?E.createElement(p,{is:u.is}):E.createElement(p)}}g[ke]=a,g[Ft]=u;e:for(E=a.child;E!==null;){if(E.tag===5||E.tag===6)g.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===a)break e;for(;E.sibling===null;){if(E.return===null||E.return===a)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}a.stateNode=g;e:switch(jn(g,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Us(a)}}return kt(a),Zy(a,a.type,r===null?null:r.memoizedProps,a.pendingProps,l),null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==u&&Us(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(i(166));if(r=Ce.current,Rc(a)){if(r=a.stateNode,l=a.memoizedProps,u=null,p=Mn,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}r[ke]=a,r=!!(r.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||AS(r.nodeValue,l)),r||Pa(a,!0)}else r=mp(r).createTextNode(u),r[ke]=a,a.stateNode=r}return kt(a),null;case 31:if(l=a.memoizedState,r===null||r.memoizedState!==null){if(u=Rc(a),l!==null){if(r===null){if(!u)throw Error(i(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[ke]=a}else cl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;kt(a),r=!1}else l=cy(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return a.flags&256?(Fi(a),a):(Fi(a),null);if((a.flags&128)!==0)throw Error(i(558))}return kt(a),null;case 13:if(u=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=Rc(a),u!==null&&u.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=a.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[ke]=a}else cl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;kt(a),p=!1}else p=cy(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return a.flags&256?(Fi(a),a):(Fi(a),null)}return Fi(a),(a.flags&128)!==0?(a.lanes=l,a):(l=u!==null,r=r!==null&&r.memoizedState!==null,l&&(u=a.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==p&&(u.flags|=2048)),l!==r&&l&&(a.child.flags|=8192),Zm(a,a.updateQueue),kt(a),null);case 4:return bt(),r===null&&Ev(a.stateNode.containerInfo),kt(a),null;case 10:return Ms(a.type),kt(a),null;case 19:if(te(tn),u=a.memoizedState,u===null)return kt(a),null;if(p=(a.flags&128)!==0,g=u.rendering,g===null)if(p)qh(u,!1);else{if(Qt!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(g=Fm(r),g!==null){for(a.flags|=128,qh(u,!1),r=g.updateQueue,a.updateQueue=r,Zm(a,r),a.subtreeFlags=0,r=l,l=a.child;l!==null;)rT(l,r),l=l.sibling;return ce(tn,tn.current&1|2),Je&&Os(a,u.treeForkCount),a.child}r=r.sibling}u.tail!==null&&At()>rp&&(a.flags|=128,p=!0,qh(u,!1),a.lanes=4194304)}else{if(!p)if(r=Fm(g),r!==null){if(a.flags|=128,p=!0,r=r.updateQueue,a.updateQueue=r,Zm(a,r),qh(u,!0),u.tail===null&&u.tailMode==="hidden"&&!g.alternate&&!Je)return kt(a),null}else 2*At()-u.renderingStartTime>rp&&l!==536870912&&(a.flags|=128,p=!0,qh(u,!1),a.lanes=4194304);u.isBackwards?(g.sibling=a.child,a.child=g):(r=u.last,r!==null?r.sibling=g:a.child=g,u.last=g)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=At(),r.sibling=null,l=tn.current,ce(tn,p?l&1|2:l&1),Je&&Os(a,u.treeForkCount),r):(kt(a),null);case 22:case 23:return Fi(a),by(),u=a.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(kt(a),a.subtreeFlags&6&&(a.flags|=8192)):kt(a),l=a.updateQueue,l!==null&&Zm(a,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),r!==null&&te(dl),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Ms(ln),kt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function AO(r,a){switch(oy(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Ms(ln),bt(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Di(a),null;case 31:if(a.memoizedState!==null){if(Fi(a),a.alternate===null)throw Error(i(340));cl()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 13:if(Fi(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));cl()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return te(tn),null;case 4:return bt(),null;case 10:return Ms(a.type),null;case 22:case 23:return Fi(a),by(),r!==null&&te(dl),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return Ms(ln),null;case 25:return null;default:return null}}function DI(r,a){switch(oy(a),a.tag){case 3:Ms(ln),bt();break;case 26:case 27:case 5:Di(a);break;case 4:bt();break;case 31:a.memoizedState!==null&&Fi(a);break;case 13:Fi(a);break;case 19:te(tn);break;case 10:Ms(a.type);break;case 22:case 23:Fi(a),by(),r!==null&&te(dl);break;case 24:Ms(ln)}}function Gh(r,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var p=u.next;l=p;do{if((l.tag&r)===r){u=void 0;var g=l.create,E=l.inst;u=g(),E.destroy=u}l=l.next}while(l!==p)}}catch(I){ft(a,a.return,I)}}function Ba(r,a,l){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var g=p.next;u=g;do{if((u.tag&r)===r){var E=u.inst,I=E.destroy;if(I!==void 0){E.destroy=void 0,p=a;var O=l,Q=I;try{Q()}catch(ne){ft(p,O,ne)}}}u=u.next}while(u!==g)}}catch(ne){ft(a,a.return,ne)}}function kI(r){var a=r.updateQueue;if(a!==null){var l=r.stateNode;try{bT(a,l)}catch(u){ft(r,r.return,u)}}}function OI(r,a,l){l.props=_l(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(u){ft(r,a,u)}}function Hh(r,a){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof l=="function"?r.refCleanup=l(u):l.current=u}}catch(p){ft(r,a,p)}}function $r(r,a){var l=r.ref,u=r.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(p){ft(r,a,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){ft(r,a,p)}else l.current=null}function PI(r){var a=r.type,l=r.memoizedProps,u=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(p){ft(r,r.return,p)}}function ev(r,a,l){try{var u=r.stateNode;$O(u,r.type,l,a),u[Ft]=a}catch(p){ft(r,r.return,p)}}function MI(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&$a(r.type)||r.tag===4}function tv(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||MI(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&$a(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function nv(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(r),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=wn));else if(u!==4&&(u===27&&$a(r.type)&&(l=r.stateNode,a=null),r=r.child,r!==null))for(nv(r,a,l),r=r.sibling;r!==null;)nv(r,a,l),r=r.sibling}function ep(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?l.insertBefore(r,a):l.appendChild(r);else if(u!==4&&(u===27&&$a(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(ep(r,a,l),r=r.sibling;r!==null;)ep(r,a,l),r=r.sibling}function VI(r){var a=r.stateNode,l=r.memoizedProps;try{for(var u=r.type,p=a.attributes;p.length;)a.removeAttributeNode(p[0]);jn(a,u,l),a[ke]=r,a[Ft]=l}catch(g){ft(r,r.return,g)}}var Fs=!1,hn=!1,iv=!1,LI=typeof WeakSet=="function"?WeakSet:Set,Tn=null;function xO(r,a){if(r=r.containerInfo,Iv=Ep,r=Wb(r),Y_(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var p=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var E=0,I=-1,O=-1,Q=0,ne=0,re=r,Y=null;t:for(;;){for(var X;re!==l||p!==0&&re.nodeType!==3||(I=E+p),re!==g||u!==0&&re.nodeType!==3||(O=E+u),re.nodeType===3&&(E+=re.nodeValue.length),(X=re.firstChild)!==null;)Y=re,re=X;for(;;){if(re===r)break t;if(Y===l&&++Q===p&&(I=E),Y===g&&++ne===u&&(O=E),(X=re.nextSibling)!==null)break;re=Y,Y=re.parentNode}re=X}l=I===-1||O===-1?null:{start:I,end:O}}else l=null}l=l||{start:0,end:0}}else l=null;for(Sv={focusedElem:r,selectionRange:l},Ep=!1,Tn=a;Tn!==null;)if(a=Tn,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,Tn=r;else for(;Tn!==null;){switch(a=Tn,g=a.alternate,r=a.flags,a.tag){case 0:if((r&4)!==0&&(r=a.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)p=r[l],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&g!==null){r=void 0,l=a,p=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var be=_l(l.type,p);r=u.getSnapshotBeforeUpdate(be,g),u.__reactInternalSnapshotBeforeUpdate=r}catch(Re){ft(l,l.return,Re)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,l=r.nodeType,l===9)Cv(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Cv(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,Tn=r;break}Tn=a.return}}function jI(r,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:zs(r,l),u&4&&Gh(5,l);break;case 1:if(zs(r,l),u&4)if(r=l.stateNode,a===null)try{r.componentDidMount()}catch(E){ft(l,l.return,E)}else{var p=_l(l.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(p,a,r.__reactInternalSnapshotBeforeUpdate)}catch(E){ft(l,l.return,E)}}u&64&&kI(l),u&512&&Hh(l,l.return);break;case 3:if(zs(r,l),u&64&&(r=l.updateQueue,r!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{bT(r,a)}catch(E){ft(l,l.return,E)}}break;case 27:a===null&&u&4&&VI(l);case 26:case 5:zs(r,l),a===null&&u&4&&PI(l),u&512&&Hh(l,l.return);break;case 12:zs(r,l);break;case 31:zs(r,l),u&4&&BI(r,l);break;case 13:zs(r,l),u&4&&zI(r,l),u&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=VO.bind(null,l),nP(r,l))));break;case 22:if(u=l.memoizedState!==null||Fs,!u){a=a!==null&&a.memoizedState!==null||hn,p=Fs;var g=hn;Fs=u,(hn=a)&&!g?qs(r,l,(l.subtreeFlags&8772)!==0):zs(r,l),Fs=p,hn=g}break;case 30:break;default:zs(r,l)}}function UI(r){var a=r.alternate;a!==null&&(r.alternate=null,UI(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&Wo(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Pt=null,mi=!1;function Bs(r,a,l){for(l=l.child;l!==null;)FI(r,a,l),l=l.sibling}function FI(r,a,l){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Ue,l)}catch{}switch(l.tag){case 26:hn||$r(l,a),Bs(r,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:hn||$r(l,a);var u=Pt,p=mi;$a(l.type)&&(Pt=l.stateNode,mi=!1),Bs(r,a,l),ed(l.stateNode),Pt=u,mi=p;break;case 5:hn||$r(l,a);case 6:if(u=Pt,p=mi,Pt=null,Bs(r,a,l),Pt=u,mi=p,Pt!==null)if(mi)try{(Pt.nodeType===9?Pt.body:Pt.nodeName==="HTML"?Pt.ownerDocument.body:Pt).removeChild(l.stateNode)}catch(g){ft(l,a,g)}else try{Pt.removeChild(l.stateNode)}catch(g){ft(l,a,g)}break;case 18:Pt!==null&&(mi?(r=Pt,kS(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Yc(r)):kS(Pt,l.stateNode));break;case 4:u=Pt,p=mi,Pt=l.stateNode.containerInfo,mi=!0,Bs(r,a,l),Pt=u,mi=p;break;case 0:case 11:case 14:case 15:Ba(2,l,a),hn||Ba(4,l,a),Bs(r,a,l);break;case 1:hn||($r(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&OI(l,a,u)),Bs(r,a,l);break;case 21:Bs(r,a,l);break;case 22:hn=(u=hn)||l.memoizedState!==null,Bs(r,a,l),hn=u;break;default:Bs(r,a,l)}}function BI(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Yc(r)}catch(l){ft(a,a.return,l)}}}function zI(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Yc(r)}catch(l){ft(a,a.return,l)}}function CO(r){switch(r.tag){case 31:case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new LI),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new LI),a;default:throw Error(i(435,r.tag))}}function tp(r,a){var l=CO(r);a.forEach(function(u){if(!l.has(u)){l.add(u);var p=LO.bind(null,r,u);u.then(p,p)}})}function pi(r,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var p=l[u],g=r,E=a,I=E;e:for(;I!==null;){switch(I.tag){case 27:if($a(I.type)){Pt=I.stateNode,mi=!1;break e}break;case 5:Pt=I.stateNode,mi=!1;break e;case 3:case 4:Pt=I.stateNode.containerInfo,mi=!0;break e}I=I.return}if(Pt===null)throw Error(i(160));FI(g,E,p),Pt=null,mi=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)qI(a,r),a=a.sibling}var kr=null;function qI(r,a){var l=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:pi(a,r),gi(r),u&4&&(Ba(3,r,r.return),Gh(3,r),Ba(5,r,r.return));break;case 1:pi(a,r),gi(r),u&512&&(hn||l===null||$r(l,l.return)),u&64&&Fs&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var p=kr;if(pi(a,r),gi(r),u&512&&(hn||l===null||$r(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=r.memoizedState,l===null)if(u===null)if(r.stateNode===null){e:{u=r.type,l=r.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":g=p.getElementsByTagName("title")[0],(!g||g[Is]||g[ke]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(u),p.head.insertBefore(g,p.querySelector("head > title"))),jn(g,u,l),g[ke]=r,en(g),u=g;break e;case"link":var E=qS("link","href",p).get(u+(l.href||""));if(E){for(var I=0;I<E.length;I++)if(g=E[I],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){E.splice(I,1);break t}}g=p.createElement(u),jn(g,u,l),p.head.appendChild(g);break;case"meta":if(E=qS("meta","content",p).get(u+(l.content||""))){for(I=0;I<E.length;I++)if(g=E[I],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){E.splice(I,1);break t}}g=p.createElement(u),jn(g,u,l),p.head.appendChild(g);break;default:throw Error(i(468,u))}g[ke]=r,en(g),u=g}r.stateNode=u}else GS(p,r.type,r.stateNode);else r.stateNode=zS(p,u,r.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?GS(p,r.type,r.stateNode):zS(p,u,r.memoizedProps)):u===null&&r.stateNode!==null&&ev(r,r.memoizedProps,l.memoizedProps)}break;case 27:pi(a,r),gi(r),u&512&&(hn||l===null||$r(l,l.return)),l!==null&&u&4&&ev(r,r.memoizedProps,l.memoizedProps);break;case 5:if(pi(a,r),gi(r),u&512&&(hn||l===null||$r(l,l.return)),r.flags&32){p=r.stateNode;try{rr(p,"")}catch(be){ft(r,r.return,be)}}u&4&&r.stateNode!=null&&(p=r.memoizedProps,ev(r,p,l!==null?l.memoizedProps:p)),u&1024&&(iv=!0);break;case 6:if(pi(a,r),gi(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,l=r.stateNode;try{l.nodeValue=u}catch(be){ft(r,r.return,be)}}break;case 3:if(_p=null,p=kr,kr=pp(a.containerInfo),pi(a,r),kr=p,gi(r),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Yc(a.containerInfo)}catch(be){ft(r,r.return,be)}iv&&(iv=!1,GI(r));break;case 4:u=kr,kr=pp(r.stateNode.containerInfo),pi(a,r),gi(r),kr=u;break;case 12:pi(a,r),gi(r);break;case 31:pi(a,r),gi(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,tp(r,u)));break;case 13:pi(a,r),gi(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(ip=At()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,tp(r,u)));break;case 22:p=r.memoizedState!==null;var O=l!==null&&l.memoizedState!==null,Q=Fs,ne=hn;if(Fs=Q||p,hn=ne||O,pi(a,r),hn=ne,Fs=Q,gi(r),u&8192)e:for(a=r.stateNode,a._visibility=p?a._visibility&-2:a._visibility|1,p&&(l===null||O||Fs||hn||yl(r)),l=null,a=r;;){if(a.tag===5||a.tag===26){if(l===null){O=l=a;try{if(g=O.stateNode,p)E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{I=O.stateNode;var re=O.memoizedProps.style,Y=re!=null&&re.hasOwnProperty("display")?re.display:null;I.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(be){ft(O,O.return,be)}}}else if(a.tag===6){if(l===null){O=a;try{O.stateNode.nodeValue=p?"":O.memoizedProps}catch(be){ft(O,O.return,be)}}}else if(a.tag===18){if(l===null){O=a;try{var X=O.stateNode;p?OS(X,!0):OS(O.stateNode,!1)}catch(be){ft(O,O.return,be)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=r.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,tp(r,l))));break;case 19:pi(a,r),gi(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,tp(r,u)));break;case 30:break;case 21:break;default:pi(a,r),gi(r)}}function gi(r){var a=r.flags;if(a&2){try{for(var l,u=r.return;u!==null;){if(MI(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var p=l.stateNode,g=tv(r);ep(r,g,p);break;case 5:var E=l.stateNode;l.flags&32&&(rr(E,""),l.flags&=-33);var I=tv(r);ep(r,I,E);break;case 3:case 4:var O=l.stateNode.containerInfo,Q=tv(r);nv(r,Q,O);break;default:throw Error(i(161))}}catch(ne){ft(r,r.return,ne)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function GI(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;GI(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function zs(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)jI(r,a.alternate,a),a=a.sibling}function yl(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Ba(4,a,a.return),yl(a);break;case 1:$r(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&OI(a,a.return,l),yl(a);break;case 27:ed(a.stateNode);case 26:case 5:$r(a,a.return),yl(a);break;case 22:a.memoizedState===null&&yl(a);break;case 30:yl(a);break;default:yl(a)}r=r.sibling}}function qs(r,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,p=r,g=a,E=g.flags;switch(g.tag){case 0:case 11:case 15:qs(p,g,l),Gh(4,g);break;case 1:if(qs(p,g,l),u=g,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(Q){ft(u,u.return,Q)}if(u=g,p=u.updateQueue,p!==null){var I=u.stateNode;try{var O=p.shared.hiddenCallbacks;if(O!==null)for(p.shared.hiddenCallbacks=null,p=0;p<O.length;p++)ET(O[p],I)}catch(Q){ft(u,u.return,Q)}}l&&E&64&&kI(g),Hh(g,g.return);break;case 27:VI(g);case 26:case 5:qs(p,g,l),l&&u===null&&E&4&&PI(g),Hh(g,g.return);break;case 12:qs(p,g,l);break;case 31:qs(p,g,l),l&&E&4&&BI(p,g);break;case 13:qs(p,g,l),l&&E&4&&zI(p,g);break;case 22:g.memoizedState===null&&qs(p,g,l),Hh(g,g.return);break;case 30:break;default:qs(p,g,l)}a=a.sibling}}function rv(r,a){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&Dh(l))}function sv(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Dh(r))}function Or(r,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)HI(r,a,l,u),a=a.sibling}function HI(r,a,l,u){var p=a.flags;switch(a.tag){case 0:case 11:case 15:Or(r,a,l,u),p&2048&&Gh(9,a);break;case 1:Or(r,a,l,u);break;case 3:Or(r,a,l,u),p&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Dh(r)));break;case 12:if(p&2048){Or(r,a,l,u),r=a.stateNode;try{var g=a.memoizedProps,E=g.id,I=g.onPostCommit;typeof I=="function"&&I(E,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(O){ft(a,a.return,O)}}else Or(r,a,l,u);break;case 31:Or(r,a,l,u);break;case 13:Or(r,a,l,u);break;case 23:break;case 22:g=a.stateNode,E=a.alternate,a.memoizedState!==null?g._visibility&2?Or(r,a,l,u):Kh(r,a):g._visibility&2?Or(r,a,l,u):(g._visibility|=2,Uc(r,a,l,u,(a.subtreeFlags&10256)!==0||!1)),p&2048&&rv(E,a);break;case 24:Or(r,a,l,u),p&2048&&sv(a.alternate,a);break;default:Or(r,a,l,u)}}function Uc(r,a,l,u,p){for(p=p&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var g=r,E=a,I=l,O=u,Q=E.flags;switch(E.tag){case 0:case 11:case 15:Uc(g,E,I,O,p),Gh(8,E);break;case 23:break;case 22:var ne=E.stateNode;E.memoizedState!==null?ne._visibility&2?Uc(g,E,I,O,p):Kh(g,E):(ne._visibility|=2,Uc(g,E,I,O,p)),p&&Q&2048&&rv(E.alternate,E);break;case 24:Uc(g,E,I,O,p),p&&Q&2048&&sv(E.alternate,E);break;default:Uc(g,E,I,O,p)}a=a.sibling}}function Kh(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=r,u=a,p=u.flags;switch(u.tag){case 22:Kh(l,u),p&2048&&rv(u.alternate,u);break;case 24:Kh(l,u),p&2048&&sv(u.alternate,u);break;default:Kh(l,u)}a=a.sibling}}var Qh=8192;function Fc(r,a,l){if(r.subtreeFlags&Qh)for(r=r.child;r!==null;)KI(r,a,l),r=r.sibling}function KI(r,a,l){switch(r.tag){case 26:Fc(r,a,l),r.flags&Qh&&r.memoizedState!==null&&mP(l,kr,r.memoizedState,r.memoizedProps);break;case 5:Fc(r,a,l);break;case 3:case 4:var u=kr;kr=pp(r.stateNode.containerInfo),Fc(r,a,l),kr=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Qh,Qh=16777216,Fc(r,a,l),Qh=u):Fc(r,a,l));break;default:Fc(r,a,l)}}function QI(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function $h(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Tn=u,WI(u,r)}QI(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)$I(r),r=r.sibling}function $I(r){switch(r.tag){case 0:case 11:case 15:$h(r),r.flags&2048&&Ba(9,r,r.return);break;case 3:$h(r);break;case 12:$h(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,np(r)):$h(r);break;default:$h(r)}}function np(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Tn=u,WI(u,r)}QI(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Ba(8,a,a.return),np(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,np(a));break;default:np(a)}r=r.sibling}}function WI(r,a){for(;Tn!==null;){var l=Tn;switch(l.tag){case 0:case 11:case 15:Ba(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Dh(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Tn=u;else e:for(l=r;Tn!==null;){u=Tn;var p=u.sibling,g=u.return;if(UI(u),u===l){Tn=null;break e}if(p!==null){p.return=g,Tn=p;break e}Tn=g}}}var RO={getCacheForType:function(r){var a=Vn(ln),l=a.data.get(r);return l===void 0&&(l=r(),a.data.set(r,l)),l},cacheSignal:function(){return Vn(ln).controller.signal}},NO=typeof WeakMap=="function"?WeakMap:Map,lt=0,It=null,Ke=null,$e=0,dt=0,Bi=null,za=!1,Bc=!1,av=!1,Gs=0,Qt=0,qa=0,vl=0,ov=0,zi=0,zc=0,Wh=null,_i=null,lv=!1,ip=0,YI=0,rp=1/0,sp=null,Ga=null,gn=0,Ha=null,qc=null,Hs=0,cv=0,uv=null,XI=null,Yh=0,hv=null;function qi(){return(lt&2)!==0&&$e!==0?$e&-$e:Z.T!==null?_v():nr()}function JI(){if(zi===0)if(($e&536870912)===0||Je){var r=ki;ki<<=1,(ki&3932160)===0&&(ki=262144),zi=r}else zi=536870912;return r=Ui.current,r!==null&&(r.flags|=32),zi}function yi(r,a,l){(r===It&&(dt===2||dt===9)||r.cancelPendingCommit!==null)&&(Gc(r,0),Ka(r,$e,zi,!1)),xr(r,l),((lt&2)===0||r!==It)&&(r===It&&((lt&2)===0&&(vl|=l),Qt===4&&Ka(r,$e,zi,!1)),Wr(r))}function ZI(r,a,l){if((lt&6)!==0)throw Error(i(327));var u=!l&&(a&127)===0&&(a&r.expiredLanes)===0||Fr(r,a),p=u?OO(r,a):fv(r,a,!0),g=u;do{if(p===0){Bc&&!u&&Ka(r,a,0,!1);break}else{if(l=r.current.alternate,g&&!DO(l)){p=fv(r,a,!1),g=!1;continue}if(p===2){if(g=a,r.errorRecoveryDisabledLanes&g)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){a=E;e:{var I=r;p=Wh;var O=I.current.memoizedState.isDehydrated;if(O&&(Gc(I,E).flags|=256),E=fv(I,E,!1),E!==2){if(av&&!O){I.errorRecoveryDisabledLanes|=g,vl|=g,p=4;break e}g=_i,_i=p,g!==null&&(_i===null?_i=g:_i.push.apply(_i,g))}p=E}if(g=!1,p!==2)continue}}if(p===1){Gc(r,0),Ka(r,a,0,!0);break}e:{switch(u=r,g=p,g){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Ka(u,a,zi,!za);break e;case 2:_i=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(p=ip+300-At(),10<p)){if(Ka(u,a,zi,!za),ui(u,0,!0)!==0)break e;Hs=a,u.timeoutHandle=NS(eS.bind(null,u,l,_i,sp,lv,a,zi,vl,zc,za,g,"Throttled",-0,0),p);break e}eS(u,l,_i,sp,lv,a,zi,vl,zc,za,g,null,-0,0)}}break}while(!0);Wr(r)}function eS(r,a,l,u,p,g,E,I,O,Q,ne,re,Y,X){if(r.timeoutHandle=-1,re=a.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:wn},KI(a,g,re);var be=(g&62914560)===g?ip-At():(g&4194048)===g?YI-At():0;if(be=pP(re,be),be!==null){Hs=g,r.cancelPendingCommit=be(lS.bind(null,r,a,g,l,u,p,E,I,O,ne,re,null,Y,X)),Ka(r,g,E,!Q);return}}lS(r,a,g,l,u,p,E,I,O)}function DO(r){for(var a=r;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var p=l[u],g=p.getSnapshot;p=p.value;try{if(!Li(g(),p))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ka(r,a,l,u){a&=~ov,a&=~vl,r.suspendedLanes|=a,r.pingedLanes&=~a,u&&(r.warmLanes|=a),u=r.expirationTimes;for(var p=a;0<p;){var g=31-Pn(p),E=1<<g;u[g]=-1,p&=~E}l!==0&&Ko(r,l,a)}function ap(){return(lt&6)===0?(Xh(0),!1):!0}function dv(){if(Ke!==null){if(dt===0)var r=Ke.return;else r=Ke,Ps=ul=null,Cy(r),Pc=null,Oh=0,r=Ke;for(;r!==null;)DI(r.alternate,r),r=r.return;Ke=null}}function Gc(r,a){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,XO(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Hs=0,dv(),It=r,Ke=l=ks(r.current,null),$e=a,dt=0,Bi=null,za=!1,Bc=Fr(r,a),av=!1,zc=zi=ov=vl=qa=Qt=0,_i=Wh=null,lv=!1,(a&8)!==0&&(a|=a&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=a;0<u;){var p=31-Pn(u),g=1<<p;a|=r[p],u&=~g}return Gs=a,xm(),l}function tS(r,a){Le=null,Z.H=Bh,a===Oc||a===Mm?(a=_T(),dt=3):a===gy?(a=_T(),dt=4):dt=a===Gy?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Bi=a,Ke===null&&(Qt=1,Wm(r,ar(a,r.current)))}function nS(){var r=Ui.current;return r===null?!0:($e&4194048)===$e?ur===null:($e&62914560)===$e||($e&536870912)!==0?r===ur:!1}function iS(){var r=Z.H;return Z.H=Bh,r===null?Bh:r}function rS(){var r=Z.A;return Z.A=RO,r}function op(){Qt=4,za||($e&4194048)!==$e&&Ui.current!==null||(Bc=!0),(qa&134217727)===0&&(vl&134217727)===0||It===null||Ka(It,$e,zi,!1)}function fv(r,a,l){var u=lt;lt|=2;var p=iS(),g=rS();(It!==r||$e!==a)&&(sp=null,Gc(r,a)),a=!1;var E=Qt;e:do try{if(dt!==0&&Ke!==null){var I=Ke,O=Bi;switch(dt){case 8:dv(),E=6;break e;case 3:case 2:case 9:case 6:Ui.current===null&&(a=!0);var Q=dt;if(dt=0,Bi=null,Hc(r,I,O,Q),l&&Bc){E=0;break e}break;default:Q=dt,dt=0,Bi=null,Hc(r,I,O,Q)}}kO(),E=Qt;break}catch(ne){tS(r,ne)}while(!0);return a&&r.shellSuspendCounter++,Ps=ul=null,lt=u,Z.H=p,Z.A=g,Ke===null&&(It=null,$e=0,xm()),E}function kO(){for(;Ke!==null;)sS(Ke)}function OO(r,a){var l=lt;lt|=2;var u=iS(),p=rS();It!==r||$e!==a?(sp=null,rp=At()+500,Gc(r,a)):Bc=Fr(r,a);e:do try{if(dt!==0&&Ke!==null){a=Ke;var g=Bi;t:switch(dt){case 1:dt=0,Bi=null,Hc(r,a,g,1);break;case 2:case 9:if(pT(g)){dt=0,Bi=null,aS(a);break}a=function(){dt!==2&&dt!==9||It!==r||(dt=7),Wr(r)},g.then(a,a);break e;case 3:dt=7;break e;case 4:dt=5;break e;case 7:pT(g)?(dt=0,Bi=null,aS(a)):(dt=0,Bi=null,Hc(r,a,g,7));break;case 5:var E=null;switch(Ke.tag){case 26:E=Ke.memoizedState;case 5:case 27:var I=Ke;if(E?HS(E):I.stateNode.complete){dt=0,Bi=null;var O=I.sibling;if(O!==null)Ke=O;else{var Q=I.return;Q!==null?(Ke=Q,lp(Q)):Ke=null}break t}}dt=0,Bi=null,Hc(r,a,g,5);break;case 6:dt=0,Bi=null,Hc(r,a,g,6);break;case 8:dv(),Qt=6;break e;default:throw Error(i(462))}}PO();break}catch(ne){tS(r,ne)}while(!0);return Ps=ul=null,Z.H=u,Z.A=p,lt=l,Ke!==null?0:(It=null,$e=0,xm(),Qt)}function PO(){for(;Ke!==null&&!ci();)sS(Ke)}function sS(r){var a=RI(r.alternate,r,Gs);r.memoizedProps=r.pendingProps,a===null?lp(r):Ke=a}function aS(r){var a=r,l=a.alternate;switch(a.tag){case 15:case 0:a=TI(l,a,a.pendingProps,a.type,void 0,$e);break;case 11:a=TI(l,a,a.pendingProps,a.type.render,a.ref,$e);break;case 5:Cy(a);default:DI(l,a),a=Ke=rT(a,Gs),a=RI(l,a,Gs)}r.memoizedProps=r.pendingProps,a===null?lp(r):Ke=a}function Hc(r,a,l,u){Ps=ul=null,Cy(a),Pc=null,Oh=0;var p=a.return;try{if(bO(r,p,a,l,$e)){Qt=1,Wm(r,ar(l,r.current)),Ke=null;return}}catch(g){if(p!==null)throw Ke=p,g;Qt=1,Wm(r,ar(l,r.current)),Ke=null;return}a.flags&32768?(Je||u===1?r=!0:Bc||($e&536870912)!==0?r=!1:(za=r=!0,(u===2||u===9||u===3||u===6)&&(u=Ui.current,u!==null&&u.tag===13&&(u.flags|=16384))),oS(a,r)):lp(a)}function lp(r){var a=r;do{if((a.flags&32768)!==0){oS(a,za);return}r=a.return;var l=SO(a.alternate,a,Gs);if(l!==null){Ke=l;return}if(a=a.sibling,a!==null){Ke=a;return}Ke=a=r}while(a!==null);Qt===0&&(Qt=5)}function oS(r,a){do{var l=AO(r.alternate,r);if(l!==null){l.flags&=32767,Ke=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(r=r.sibling,r!==null)){Ke=r;return}Ke=r=l}while(r!==null);Qt=6,Ke=null}function lS(r,a,l,u,p,g,E,I,O){r.cancelPendingCommit=null;do cp();while(gn!==0);if((lt&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(g=a.lanes|a.childLanes,g|=ty,pn(r,l,g,E,I,O),r===It&&(Ke=It=null,$e=0),qc=a,Ha=r,Hs=l,cv=g,uv=p,XI=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,jO(gt,function(){return fS(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=Z.T,Z.T=null,p=fe.p,fe.p=2,E=lt,lt|=4;try{xO(r,a,l)}finally{lt=E,fe.p=p,Z.T=u}}gn=1,cS(),uS(),hS()}}function cS(){if(gn===1){gn=0;var r=Ha,a=qc,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=Z.T,Z.T=null;var u=fe.p;fe.p=2;var p=lt;lt|=4;try{qI(a,r);var g=Sv,E=Wb(r.containerInfo),I=g.focusedElem,O=g.selectionRange;if(E!==I&&I&&I.ownerDocument&&$b(I.ownerDocument.documentElement,I)){if(O!==null&&Y_(I)){var Q=O.start,ne=O.end;if(ne===void 0&&(ne=Q),"selectionStart"in I)I.selectionStart=Q,I.selectionEnd=Math.min(ne,I.value.length);else{var re=I.ownerDocument||document,Y=re&&re.defaultView||window;if(Y.getSelection){var X=Y.getSelection(),be=I.textContent.length,Re=Math.min(O.start,be),vt=O.end===void 0?Re:Math.min(O.end,be);!X.extend&&Re>vt&&(E=vt,vt=Re,Re=E);var B=Qb(I,Re),L=Qb(I,vt);if(B&&L&&(X.rangeCount!==1||X.anchorNode!==B.node||X.anchorOffset!==B.offset||X.focusNode!==L.node||X.focusOffset!==L.offset)){var K=re.createRange();K.setStart(B.node,B.offset),X.removeAllRanges(),Re>vt?(X.addRange(K),X.extend(L.node,L.offset)):(K.setEnd(L.node,L.offset),X.addRange(K))}}}}for(re=[],X=I;X=X.parentNode;)X.nodeType===1&&re.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<re.length;I++){var ie=re[I];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Ep=!!Iv,Sv=Iv=null}finally{lt=p,fe.p=u,Z.T=l}}r.current=a,gn=2}}function uS(){if(gn===2){gn=0;var r=Ha,a=qc,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=Z.T,Z.T=null;var u=fe.p;fe.p=2;var p=lt;lt|=4;try{jI(r,a.alternate,a)}finally{lt=p,fe.p=u,Z.T=l}}gn=3}}function hS(){if(gn===4||gn===3){gn=0,mn();var r=Ha,a=qc,l=Hs,u=XI;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?gn=5:(gn=0,qc=Ha=null,dS(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(Ga=null),ya(l),a=a.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Ue,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=Z.T,p=fe.p,fe.p=2,Z.T=null;try{for(var g=r.onRecoverableError,E=0;E<u.length;E++){var I=u[E];g(I.value,{componentStack:I.stack})}}finally{Z.T=a,fe.p=p}}(Hs&3)!==0&&cp(),Wr(r),p=r.pendingLanes,(l&261930)!==0&&(p&42)!==0?r===hv?Yh++:(Yh=0,hv=r):Yh=0,Xh(0)}}function dS(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Dh(a)))}function cp(){return cS(),uS(),hS(),fS()}function fS(){if(gn!==5)return!1;var r=Ha,a=cv;cv=0;var l=ya(Hs),u=Z.T,p=fe.p;try{fe.p=32>l?32:l,Z.T=null,l=uv,uv=null;var g=Ha,E=Hs;if(gn=0,qc=Ha=null,Hs=0,(lt&6)!==0)throw Error(i(331));var I=lt;if(lt|=4,$I(g.current),HI(g,g.current,E,l),lt=I,Xh(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Ue,g)}catch{}return!0}finally{fe.p=p,Z.T=u,dS(r,a)}}function mS(r,a,l){a=ar(l,a),a=qy(r.stateNode,a,2),r=ja(r,a,2),r!==null&&(xr(r,2),Wr(r))}function ft(r,a,l){if(r.tag===3)mS(r,r,l);else for(;a!==null;){if(a.tag===3){mS(a,r,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ga===null||!Ga.has(u))){r=ar(l,r),l=pI(2),u=ja(a,l,2),u!==null&&(gI(l,u,a,r),xr(u,2),Wr(u));break}}a=a.return}}function mv(r,a,l){var u=r.pingCache;if(u===null){u=r.pingCache=new NO;var p=new Set;u.set(a,p)}else p=u.get(a),p===void 0&&(p=new Set,u.set(a,p));p.has(l)||(av=!0,p.add(l),r=MO.bind(null,r,a,l),a.then(r,r))}function MO(r,a,l){var u=r.pingCache;u!==null&&u.delete(a),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,It===r&&($e&l)===l&&(Qt===4||Qt===3&&($e&62914560)===$e&&300>At()-ip?(lt&2)===0&&Gc(r,0):ov|=l,zc===$e&&(zc=0)),Wr(r)}function pS(r,a){a===0&&(a=Ho()),r=ol(r,a),r!==null&&(xr(r,a),Wr(r))}function VO(r){var a=r.memoizedState,l=0;a!==null&&(l=a.retryLane),pS(r,l)}function LO(r,a){var l=0;switch(r.tag){case 31:case 13:var u=r.stateNode,p=r.memoizedState;p!==null&&(l=p.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(a),pS(r,l)}function jO(r,a){return er(r,a)}var up=null,Kc=null,pv=!1,hp=!1,gv=!1,Qa=0;function Wr(r){r!==Kc&&r.next===null&&(Kc===null?up=Kc=r:Kc=Kc.next=r),hp=!0,pv||(pv=!0,FO())}function Xh(r,a){if(!gv&&hp){gv=!0;do for(var l=!1,u=up;u!==null;){if(r!==0){var p=u.pendingLanes;if(p===0)var g=0;else{var E=u.suspendedLanes,I=u.pingedLanes;g=(1<<31-Pn(42|r)+1)-1,g&=p&~(E&~I),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,vS(u,g))}else g=$e,g=ui(u,u===It?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Fr(u,g)||(l=!0,vS(u,g));u=u.next}while(l);gv=!1}}function UO(){gS()}function gS(){hp=pv=!1;var r=0;Qa!==0&&YO()&&(r=Qa);for(var a=At(),l=null,u=up;u!==null;){var p=u.next,g=_S(u,a);g===0?(u.next=null,l===null?up=p:l.next=p,p===null&&(Kc=l)):(l=u,(r!==0||(g&3)!==0)&&(hp=!0)),u=p}gn!==0&&gn!==5||Xh(r),Qa!==0&&(Qa=0)}function _S(r,a){for(var l=r.suspendedLanes,u=r.pingedLanes,p=r.expirationTimes,g=r.pendingLanes&-62914561;0<g;){var E=31-Pn(g),I=1<<E,O=p[E];O===-1?((I&l)===0||(I&u)!==0)&&(p[E]=_a(I,a)):O<=a&&(r.expiredLanes|=I),g&=~I}if(a=It,l=$e,l=ui(r,r===a?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,l===0||r===a&&(dt===2||dt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Sr(u),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Fr(r,l)){if(a=l&-l,a===r.callbackPriority)return a;switch(u!==null&&Sr(u),ya(l)){case 2:case 8:l=Tt;break;case 32:l=gt;break;case 268435456:l=qo;break;default:l=gt}return u=yS.bind(null,r),l=er(l,u),r.callbackPriority=a,r.callbackNode=l,a}return u!==null&&u!==null&&Sr(u),r.callbackPriority=2,r.callbackNode=null,2}function yS(r,a){if(gn!==0&&gn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(cp()&&r.callbackNode!==l)return null;var u=$e;return u=ui(r,r===It?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(ZI(r,u,a),_S(r,At()),r.callbackNode!=null&&r.callbackNode===l?yS.bind(null,r):null)}function vS(r,a){if(cp())return null;ZI(r,a,!0)}function FO(){JO(function(){(lt&6)!==0?er(xt,UO):gS()})}function _v(){if(Qa===0){var r=Dc;r===0&&(r=tr,tr<<=1,(tr&261888)===0&&(tr=256)),Qa=r}return Qa}function wS(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:qr(""+r)}function ES(r,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,r.id&&l.setAttribute("form",r.id),a.parentNode.insertBefore(l,a),r=new FormData(r),l.parentNode.removeChild(l),r}function BO(r,a,l,u,p){if(a==="submit"&&l&&l.stateNode===p){var g=wS((p[Ft]||null).action),E=u.submitter;E&&(a=(a=E[Ft]||null)?wS(a.formAction):E.getAttribute("formAction"),a!==null&&(g=a,E=null));var I=new el("action","action",null,u,p);r.push({event:I,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Qa!==0){var O=E?ES(p,E):new FormData(p);Ly(l,{pending:!0,data:O,method:p.method,action:g},null,O)}}else typeof g=="function"&&(I.preventDefault(),O=E?ES(p,E):new FormData(p),Ly(l,{pending:!0,data:O,method:p.method,action:g},g,O))},currentTarget:p}]})}}for(var yv=0;yv<ey.length;yv++){var vv=ey[yv],zO=vv.toLowerCase(),qO=vv[0].toUpperCase()+vv.slice(1);Dr(zO,"on"+qO)}Dr(Jb,"onAnimationEnd"),Dr(Zb,"onAnimationIteration"),Dr(eT,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(sO,"onTransitionRun"),Dr(aO,"onTransitionStart"),Dr(oO,"onTransitionCancel"),Dr(tT,"onTransitionEnd"),zr("onMouseEnter",["mouseout","mouseover"]),zr("onMouseLeave",["mouseout","mouseover"]),zr("onPointerEnter",["pointerout","pointerover"]),zr("onPointerLeave",["pointerout","pointerover"]),Wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jh));function bS(r,a){a=(a&4)!==0;for(var l=0;l<r.length;l++){var u=r[l],p=u.event;u=u.listeners;e:{var g=void 0;if(a)for(var E=u.length-1;0<=E;E--){var I=u[E],O=I.instance,Q=I.currentTarget;if(I=I.listener,O!==g&&p.isPropagationStopped())break e;g=I,p.currentTarget=Q;try{g(p)}catch(ne){Am(ne)}p.currentTarget=null,g=O}else for(E=0;E<u.length;E++){if(I=u[E],O=I.instance,Q=I.currentTarget,I=I.listener,O!==g&&p.isPropagationStopped())break e;g=I,p.currentTarget=Q;try{g(p)}catch(ne){Am(ne)}p.currentTarget=null,g=O}}}}function Qe(r,a){var l=a[Pi];l===void 0&&(l=a[Pi]=new Set);var u=r+"__bubble";l.has(u)||(TS(a,r,2,!1),l.add(u))}function wv(r,a,l){var u=0;a&&(u|=4),TS(l,r,u,a)}var dp="_reactListening"+Math.random().toString(36).slice(2);function Ev(r){if(!r[dp]){r[dp]=!0,fc.forEach(function(l){l!=="selectionchange"&&(GO.has(l)||wv(l,!1,r),wv(l,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[dp]||(a[dp]=!0,wv("selectionchange",!1,a))}}function TS(r,a,l,u){switch(JS(a)){case 2:var p=yP;break;case 8:p=vP;break;default:p=Vv}l=p.bind(null,a,l,r),p=void 0,!wh||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(p=!0),u?p!==void 0?r.addEventListener(a,l,{capture:!0,passive:p}):r.addEventListener(a,l,!0):p!==void 0?r.addEventListener(a,l,{passive:p}):r.addEventListener(a,l,!1)}function bv(r,a,l,u,p){var g=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var I=u.stateNode.containerInfo;if(I===p)break;if(E===4)for(E=u.return;E!==null;){var O=E.tag;if((O===3||O===4)&&E.stateNode.containerInfo===p)return;E=E.return}for(;I!==null;){if(E=Ss(I),E===null)return;if(O=E.tag,O===5||O===6||O===26||O===27){u=g=E;continue e}I=I.parentNode}}u=u.return}um(function(){var Q=g,ne=yc(l),re=[];e:{var Y=nT.get(r);if(Y!==void 0){var X=el,be=r;switch(r){case"keypress":if(Zo(l)===0)break e;case"keydown":case"keyup":X=vm;break;case"focusin":be="focus",X=Ca;break;case"focusout":be="blur",X=Ca;break;case"beforeblur":case"afterblur":X=Ca;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=dm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=fm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=Em;break;case Jb:case Zb:case eT:X=Ec;break;case tT:X=bc;break;case"scroll":case"scrollend":X=hm;break;case"wheel":X=Tm;break;case"copy":case"cut":case"paste":X=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Sh;break;case"toggle":case"beforetoggle":X=Na}var Re=(a&4)!==0,vt=!Re&&(r==="scroll"||r==="scrollend"),B=Re?Y!==null?Y+"Capture":null:Y;Re=[];for(var L=Q,K;L!==null;){var ie=L;if(K=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||K===null||B===null||(ie=di(L,B),ie!=null&&Re.push(Zh(L,ie,K))),vt)break;L=L.return}0<Re.length&&(Y=new X(Y,be,null,l,ne),re.push({event:Y,listeners:Re}))}}if((a&7)===0){e:{if(Y=r==="mouseover"||r==="pointerover",X=r==="mouseout"||r==="pointerout",Y&&l!==_c&&(be=l.relatedTarget||l.fromElement)&&(Ss(be)||be[$n]))break e;if((X||Y)&&(Y=ne.window===ne?ne:(Y=ne.ownerDocument)?Y.defaultView||Y.parentWindow:window,X?(be=l.relatedTarget||l.toElement,X=Q,be=be?Ss(be):null,be!==null&&(vt=o(be),Re=be.tag,be!==vt||Re!==5&&Re!==27&&Re!==6)&&(be=null)):(X=null,be=Q),X!==be)){if(Re=dm,ie="onMouseLeave",B="onMouseEnter",L="mouse",(r==="pointerout"||r==="pointerover")&&(Re=Sh,ie="onPointerLeave",B="onPointerEnter",L="pointer"),vt=X==null?Y:Yo(X),K=be==null?Y:Yo(be),Y=new Re(ie,L+"leave",X,l,ne),Y.target=vt,Y.relatedTarget=K,ie=null,Ss(ne)===Q&&(Re=new Re(B,L+"enter",be,l,ne),Re.target=K,Re.relatedTarget=vt,ie=Re),vt=ie,X&&be)t:{for(Re=HO,B=X,L=be,K=0,ie=B;ie;ie=Re(ie))K++;ie=0;for(var xe=L;xe;xe=Re(xe))ie++;for(;0<K-ie;)B=Re(B),K--;for(;0<ie-K;)L=Re(L),ie--;for(;K--;){if(B===L||L!==null&&B===L.alternate){Re=B;break t}B=Re(B),L=Re(L)}Re=null}else Re=null;X!==null&&IS(re,Y,X,Re,!1),be!==null&&vt!==null&&IS(re,vt,be,Re,!0)}}e:{if(Y=Q?Yo(Q):window,X=Y.nodeName&&Y.nodeName.toLowerCase(),X==="select"||X==="input"&&Y.type==="file")var st=Bb;else if(fi(Y))if(zb)st=nO;else{st=eO;var Ie=Zk}else X=Y.nodeName,!X||X.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?Q&&yh(Q.elementType)&&(st=Bb):st=tO;if(st&&(st=st(r,Q))){rl(re,st,l,ne);break e}Ie&&Ie(r,Y,Q),r==="focusout"&&Q&&Y.type==="number"&&Q.memoizedProps.value!=null&&gc(Y,"number",Y.value)}switch(Ie=Q?Yo(Q):window,r){case"focusin":(fi(Ie)||Ie.contentEditable==="true")&&(Tc=Ie,X_=Q,Ch=null);break;case"focusout":Ch=X_=Tc=null;break;case"mousedown":J_=!0;break;case"contextmenu":case"mouseup":case"dragend":J_=!1,Yb(re,l,ne);break;case"selectionchange":if(rO)break;case"keydown":case"keyup":Yb(re,l,ne)}var Fe;if(w)e:{switch(r){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Be?ut(r,l)&&(We="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(We="onCompositionStart");We&&(G&&l.locale!=="ko"&&(Be||We!=="onCompositionStart"?We==="onCompositionEnd"&&Be&&(Fe=Ia()):(Vi=ne,vc="value"in Vi?Vi.value:Vi.textContent,Be=!0)),Ie=fp(Q,We),0<Ie.length&&(We=new bh(We,r,null,l,ne),re.push({event:We,listeners:Ie}),Fe?We.data=Fe:(Fe=on(l),Fe!==null&&(We.data=Fe)))),(Fe=A?En(r,l):bn(r,l))&&(We=fp(Q,"onBeforeInput"),0<We.length&&(Ie=new bh("onBeforeInput","beforeinput",null,l,ne),re.push({event:Ie,listeners:We}),Ie.data=Fe)),BO(re,r,Q,l,ne)}bS(re,a)})}function Zh(r,a,l){return{instance:r,listener:a,currentTarget:l}}function fp(r,a){for(var l=a+"Capture",u=[];r!==null;){var p=r,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=di(r,l),p!=null&&u.unshift(Zh(r,p,g)),p=di(r,a),p!=null&&u.push(Zh(r,p,g))),r.tag===3)return u;r=r.return}return[]}function HO(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function IS(r,a,l,u,p){for(var g=a._reactName,E=[];l!==null&&l!==u;){var I=l,O=I.alternate,Q=I.stateNode;if(I=I.tag,O!==null&&O===u)break;I!==5&&I!==26&&I!==27||Q===null||(O=Q,p?(Q=di(l,g),Q!=null&&E.unshift(Zh(l,Q,O))):p||(Q=di(l,g),Q!=null&&E.push(Zh(l,Q,O)))),l=l.return}E.length!==0&&r.push({event:a,listeners:E})}var KO=/\r\n?/g,QO=/\u0000|\uFFFD/g;function SS(r){return(typeof r=="string"?r:""+r).replace(KO,`
`).replace(QO,"")}function AS(r,a){return a=SS(a),SS(r)===a}function yt(r,a,l,u,p,g){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||rr(r,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&rr(r,""+u);break;case"className":Ea(r,"class",u);break;case"tabIndex":Ea(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ea(r,l,u);break;case"style":lm(r,u,g);break;case"data":if(a!=="object"){Ea(r,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){r.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=qr(""+u),r.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(a!=="input"&&yt(r,a,"name",p.name,p,null),yt(r,a,"formEncType",p.formEncType,p,null),yt(r,a,"formMethod",p.formMethod,p,null),yt(r,a,"formTarget",p.formTarget,p,null)):(yt(r,a,"encType",p.encType,p,null),yt(r,a,"method",p.method,p,null),yt(r,a,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=qr(""+u),r.setAttribute(l,u);break;case"onClick":u!=null&&(r.onclick=wn);break;case"onScroll":u!=null&&Qe("scroll",r);break;case"onScrollEnd":u!=null&&Qe("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}l=qr(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""+u):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":u===!0?r.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,u):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(l,u):r.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(l):r.setAttribute(l,u);break;case"popover":Qe("beforetoggle",r),Qe("toggle",r),wa(r,"popover",u);break;case"xlinkActuate":ir(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":ir(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":ir(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":ir(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":ir(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":ir(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":ir(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":ir(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":ir(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":wa(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=H_.get(l)||l,wa(r,l,u))}}function Tv(r,a,l,u,p,g){switch(l){case"style":lm(r,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof u=="string"?rr(r,u):(typeof u=="number"||typeof u=="bigint")&&rr(r,""+u);break;case"onScroll":u!=null&&Qe("scroll",r);break;case"onScrollEnd":u!=null&&Qe("scrollend",r);break;case"onClick":u!=null&&(r.onclick=wn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!va.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),a=l.slice(2,p?l.length-7:void 0),g=r[Ft]||null,g=g!=null?g[l]:null,typeof g=="function"&&r.removeEventListener(a,g,p),typeof u=="function")){typeof g!="function"&&g!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(a,u,p);break e}l in r?r[l]=u:u===!0?r.setAttribute(l,""):wa(r,l,u)}}}function jn(r,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",r),Qe("load",r);var u=!1,p=!1,g;for(g in l)if(l.hasOwnProperty(g)){var E=l[g];if(E!=null)switch(g){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:yt(r,a,g,E,l,null)}}p&&yt(r,a,"srcSet",l.srcSet,l,null),u&&yt(r,a,"src",l.src,l,null);return;case"input":Qe("invalid",r);var I=g=E=p=null,O=null,Q=null;for(u in l)if(l.hasOwnProperty(u)){var ne=l[u];if(ne!=null)switch(u){case"name":p=ne;break;case"type":E=ne;break;case"checked":O=ne;break;case"defaultChecked":Q=ne;break;case"value":g=ne;break;case"defaultValue":I=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,a));break;default:yt(r,a,u,ne,l,null)}}Xo(r,g,I,O,Q,E,p,!1);return;case"select":Qe("invalid",r),u=E=g=null;for(p in l)if(l.hasOwnProperty(p)&&(I=l[p],I!=null))switch(p){case"value":g=I;break;case"defaultValue":E=I;break;case"multiple":u=I;default:yt(r,a,p,I,l,null)}a=g,l=E,r.multiple=!!u,a!=null?rt(r,!!u,a,!1):l!=null&&rt(r,!!u,l,!0);return;case"textarea":Qe("invalid",r),g=p=u=null;for(E in l)if(l.hasOwnProperty(E)&&(I=l[E],I!=null))switch(E){case"value":u=I;break;case"defaultValue":p=I;break;case"children":g=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:yt(r,a,E,I,l,null)}Ta(r,u,p,g);return;case"option":for(O in l)if(l.hasOwnProperty(O)&&(u=l[O],u!=null))switch(O){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:yt(r,a,O,u,l,null)}return;case"dialog":Qe("beforetoggle",r),Qe("toggle",r),Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":Qe("load",r);break;case"video":case"audio":for(u=0;u<Jh.length;u++)Qe(Jh[u],r);break;case"image":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"embed":case"source":case"link":Qe("error",r),Qe("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in l)if(l.hasOwnProperty(Q)&&(u=l[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:yt(r,a,Q,u,l,null)}return;default:if(yh(a)){for(ne in l)l.hasOwnProperty(ne)&&(u=l[ne],u!==void 0&&Tv(r,a,ne,u,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(u=l[I],u!=null&&yt(r,a,I,u,l,null))}function $O(r,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,E=null,I=null,O=null,Q=null,ne=null;for(X in l){var re=l[X];if(l.hasOwnProperty(X)&&re!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":O=re;default:u.hasOwnProperty(X)||yt(r,a,X,null,u,re)}}for(var Y in u){var X=u[Y];if(re=l[Y],u.hasOwnProperty(Y)&&(X!=null||re!=null))switch(Y){case"type":g=X;break;case"name":p=X;break;case"checked":Q=X;break;case"defaultChecked":ne=X;break;case"value":E=X;break;case"defaultValue":I=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,a));break;default:X!==re&&yt(r,a,Y,X,u,re)}}ba(r,E,I,O,Q,ne,g,p);return;case"select":X=E=I=Y=null;for(g in l)if(O=l[g],l.hasOwnProperty(g)&&O!=null)switch(g){case"value":break;case"multiple":X=O;default:u.hasOwnProperty(g)||yt(r,a,g,null,u,O)}for(p in u)if(g=u[p],O=l[p],u.hasOwnProperty(p)&&(g!=null||O!=null))switch(p){case"value":Y=g;break;case"defaultValue":I=g;break;case"multiple":E=g;default:g!==O&&yt(r,a,p,g,u,O)}a=I,l=E,u=X,Y!=null?rt(r,!!l,Y,!1):!!u!=!!l&&(a!=null?rt(r,!!l,a,!0):rt(r,!!l,l?[]:"",!1));return;case"textarea":X=Y=null;for(I in l)if(p=l[I],l.hasOwnProperty(I)&&p!=null&&!u.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:yt(r,a,I,null,u,p)}for(E in u)if(p=u[E],g=l[E],u.hasOwnProperty(E)&&(p!=null||g!=null))switch(E){case"value":Y=p;break;case"defaultValue":X=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==g&&yt(r,a,E,p,u,g)}Jo(r,Y,X);return;case"option":for(var be in l)if(Y=l[be],l.hasOwnProperty(be)&&Y!=null&&!u.hasOwnProperty(be))switch(be){case"selected":r.selected=!1;break;default:yt(r,a,be,null,u,Y)}for(O in u)if(Y=u[O],X=l[O],u.hasOwnProperty(O)&&Y!==X&&(Y!=null||X!=null))switch(O){case"selected":r.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:yt(r,a,O,Y,u,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in l)Y=l[Re],l.hasOwnProperty(Re)&&Y!=null&&!u.hasOwnProperty(Re)&&yt(r,a,Re,null,u,Y);for(Q in u)if(Y=u[Q],X=l[Q],u.hasOwnProperty(Q)&&Y!==X&&(Y!=null||X!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(i(137,a));break;default:yt(r,a,Q,Y,u,X)}return;default:if(yh(a)){for(var vt in l)Y=l[vt],l.hasOwnProperty(vt)&&Y!==void 0&&!u.hasOwnProperty(vt)&&Tv(r,a,vt,void 0,u,Y);for(ne in u)Y=u[ne],X=l[ne],!u.hasOwnProperty(ne)||Y===X||Y===void 0&&X===void 0||Tv(r,a,ne,Y,u,X);return}}for(var B in l)Y=l[B],l.hasOwnProperty(B)&&Y!=null&&!u.hasOwnProperty(B)&&yt(r,a,B,null,u,Y);for(re in u)Y=u[re],X=l[re],!u.hasOwnProperty(re)||Y===X||Y==null&&X==null||yt(r,a,re,Y,u,X)}function xS(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function WO(){if(typeof performance.getEntriesByType=="function"){for(var r=0,a=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var p=l[u],g=p.transferSize,E=p.initiatorType,I=p.duration;if(g&&I&&xS(E)){for(E=0,I=p.responseEnd,u+=1;u<l.length;u++){var O=l[u],Q=O.startTime;if(Q>I)break;var ne=O.transferSize,re=O.initiatorType;ne&&xS(re)&&(O=O.responseEnd,E+=ne*(O<I?1:(I-Q)/(O-Q)))}if(--u,a+=8*(g+E)/(p.duration/1e3),r++,10<r)break}}if(0<r)return a/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Iv=null,Sv=null;function mp(r){return r.nodeType===9?r:r.ownerDocument}function CS(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function RS(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function Av(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var xv=null;function YO(){var r=window.event;return r&&r.type==="popstate"?r===xv?!1:(xv=r,!0):(xv=null,!1)}var NS=typeof setTimeout=="function"?setTimeout:void 0,XO=typeof clearTimeout=="function"?clearTimeout:void 0,DS=typeof Promise=="function"?Promise:void 0,JO=typeof queueMicrotask=="function"?queueMicrotask:typeof DS<"u"?function(r){return DS.resolve(null).then(r).catch(ZO)}:NS;function ZO(r){setTimeout(function(){throw r})}function $a(r){return r==="head"}function kS(r,a){var l=a,u=0;do{var p=l.nextSibling;if(r.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"||l==="/&"){if(u===0){r.removeChild(p),Yc(a);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")ed(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,ed(l);for(var g=l.firstChild;g;){var E=g.nextSibling,I=g.nodeName;g[Is]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=E}}else l==="body"&&ed(r.ownerDocument.body);l=p}while(l);Yc(a)}function OS(r,a){var l=r;r=0;do{var u=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=u}while(l)}function Cv(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Cv(l),Wo(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function eP(r,a,l,u){for(;r.nodeType===1;){var p=l;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Is])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(g=r.getAttribute("rel"),g==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(g!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(g=r.getAttribute("src"),(g!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===g)return r}else return r;if(r=hr(r.nextSibling),r===null)break}return null}function tP(r,a,l){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=hr(r.nextSibling),r===null))return null;return r}function PS(r,a){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=hr(r.nextSibling),r===null))return null;return r}function Rv(r){return r.data==="$?"||r.data==="$~"}function Nv(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function nP(r,a){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=a;else if(r.data!=="$?"||l.readyState!=="loading")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function hr(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return r}var Dv=null;function MS(r){r=r.nextSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(a===0)return hr(r.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}r=r.nextSibling}return null}function VS(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return r;a--}else l!=="/$"&&l!=="/&"||a++}r=r.previousSibling}return null}function LS(r,a,l){switch(a=mp(l),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function ed(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);Wo(r)}var dr=new Map,jS=new Set;function pp(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ks=fe.d;fe.d={f:iP,r:rP,D:sP,C:aP,L:oP,m:lP,X:uP,S:cP,M:hP};function iP(){var r=Ks.f(),a=ap();return r||a}function rP(r){var a=As(r);a!==null&&a.tag===5&&a.type==="form"?tI(a):Ks.r(r)}var Qc=typeof document>"u"?null:document;function US(r,a,l){var u=Qc;if(u&&typeof a=="string"&&a){var p=Ht(a);p='link[rel="'+r+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),jS.has(p)||(jS.add(p),r={rel:r,crossOrigin:l,href:a},u.querySelector(p)===null&&(a=u.createElement("link"),jn(a,"link",r),en(a),u.head.appendChild(a)))}}function sP(r){Ks.D(r),US("dns-prefetch",r,null)}function aP(r,a){Ks.C(r,a),US("preconnect",r,a)}function oP(r,a,l){Ks.L(r,a,l);var u=Qc;if(u&&r&&a){var p='link[rel="preload"][as="'+Ht(a)+'"]';a==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+Ht(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+Ht(l.imageSizes)+'"]')):p+='[href="'+Ht(r)+'"]';var g=p;switch(a){case"style":g=$c(r);break;case"script":g=Wc(r)}dr.has(g)||(r=y({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:r,as:a},l),dr.set(g,r),u.querySelector(p)!==null||a==="style"&&u.querySelector(td(g))||a==="script"&&u.querySelector(nd(g))||(a=u.createElement("link"),jn(a,"link",r),en(a),u.head.appendChild(a)))}}function lP(r,a){Ks.m(r,a);var l=Qc;if(l&&r){var u=a&&typeof a.as=="string"?a.as:"script",p='link[rel="modulepreload"][as="'+Ht(u)+'"][href="'+Ht(r)+'"]',g=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Wc(r)}if(!dr.has(g)&&(r=y({rel:"modulepreload",href:r},a),dr.set(g,r),l.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(nd(g)))return}u=l.createElement("link"),jn(u,"link",r),en(u),l.head.appendChild(u)}}}function cP(r,a,l){Ks.S(r,a,l);var u=Qc;if(u&&r){var p=Rr(u).hoistableStyles,g=$c(r);a=a||"default";var E=p.get(g);if(!E){var I={loading:0,preload:null};if(E=u.querySelector(td(g)))I.loading=5;else{r=y({rel:"stylesheet",href:r,"data-precedence":a},l),(l=dr.get(g))&&kv(r,l);var O=E=u.createElement("link");en(O),jn(O,"link",r),O._p=new Promise(function(Q,ne){O.onload=Q,O.onerror=ne}),O.addEventListener("load",function(){I.loading|=1}),O.addEventListener("error",function(){I.loading|=2}),I.loading|=4,gp(E,a,u)}E={type:"stylesheet",instance:E,count:1,state:I},p.set(g,E)}}}function uP(r,a){Ks.X(r,a);var l=Qc;if(l&&r){var u=Rr(l).hoistableScripts,p=Wc(r),g=u.get(p);g||(g=l.querySelector(nd(p)),g||(r=y({src:r,async:!0},a),(a=dr.get(p))&&Ov(r,a),g=l.createElement("script"),en(g),jn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function hP(r,a){Ks.M(r,a);var l=Qc;if(l&&r){var u=Rr(l).hoistableScripts,p=Wc(r),g=u.get(p);g||(g=l.querySelector(nd(p)),g||(r=y({src:r,async:!0,type:"module"},a),(a=dr.get(p))&&Ov(r,a),g=l.createElement("script"),en(g),jn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function FS(r,a,l,u){var p=(p=Ce.current)?pp(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=$c(l.href),l=Rr(p).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=$c(l.href);var g=Rr(p).hoistableStyles,E=g.get(r);if(E||(p=p.ownerDocument||p,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(r,E),(g=p.querySelector(td(r)))&&!g._p&&(E.instance=g,E.state.loading=5),dr.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},dr.set(r,l),g||dP(p,r,l,E.state))),a&&u===null)throw Error(i(528,""));return E}if(a&&u!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Wc(l),l=Rr(p).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function $c(r){return'href="'+Ht(r)+'"'}function td(r){return'link[rel="stylesheet"]['+r+"]"}function BS(r){return y({},r,{"data-precedence":r.precedence,precedence:null})}function dP(r,a,l,u){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=r.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),jn(a,"link",l),en(a),r.head.appendChild(a))}function Wc(r){return'[src="'+Ht(r)+'"]'}function nd(r){return"script[async]"+r}function zS(r,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=r.querySelector('style[data-href~="'+Ht(l.href)+'"]');if(u)return a.instance=u,en(u),u;var p=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),en(u),jn(u,"style",p),gp(u,l.precedence,r),a.instance=u;case"stylesheet":p=$c(l.href);var g=r.querySelector(td(p));if(g)return a.state.loading|=4,a.instance=g,en(g),g;u=BS(l),(p=dr.get(p))&&kv(u,p),g=(r.ownerDocument||r).createElement("link"),en(g);var E=g;return E._p=new Promise(function(I,O){E.onload=I,E.onerror=O}),jn(g,"link",u),a.state.loading|=4,gp(g,l.precedence,r),a.instance=g;case"script":return g=Wc(l.src),(p=r.querySelector(nd(g)))?(a.instance=p,en(p),p):(u=l,(p=dr.get(g))&&(u=y({},l),Ov(u,p)),r=r.ownerDocument||r,p=r.createElement("script"),en(p),jn(p,"link",u),r.head.appendChild(p),a.instance=p);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,gp(u,l.precedence,r));return a.instance}function gp(r,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,g=p,E=0;E<u.length;E++){var I=u[E];if(I.dataset.precedence===a)g=I;else if(g!==p)break}g?g.parentNode.insertBefore(r,g.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(r,a.firstChild))}function kv(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function Ov(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var _p=null;function qS(r,a,l){if(_p===null){var u=new Map,p=_p=new Map;p.set(l,u)}else p=_p,u=p.get(l),u||(u=new Map,p.set(l,u));if(u.has(r))return u;for(u.set(r,null),l=l.getElementsByTagName(r),p=0;p<l.length;p++){var g=l[p];if(!(g[Is]||g[ke]||r==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var E=g.getAttribute(a)||"";E=r+E;var I=u.get(E);I?I.push(g):u.set(E,[g])}}return u}function GS(r,a,l){r=r.ownerDocument||r,r.head.insertBefore(l,a==="title"?r.querySelector("head > title"):null)}function fP(r,a,l){if(l===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function HS(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function mP(r,a,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var p=$c(u.href),g=a.querySelector(td(p));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(r.count++,r=yp.bind(r),a.then(r,r)),l.state.loading|=4,l.instance=g,en(g);return}g=a.ownerDocument||a,u=BS(u),(p=dr.get(p))&&kv(u,p),g=g.createElement("link"),en(g);var E=g;E._p=new Promise(function(I,O){E.onload=I,E.onerror=O}),jn(g,"link",u),l.instance=g}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=yp.bind(r),a.addEventListener("load",l),a.addEventListener("error",l))}}var Pv=0;function pP(r,a){return r.stylesheets&&r.count===0&&wp(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var u=setTimeout(function(){if(r.stylesheets&&wp(r,r.stylesheets),r.unsuspend){var g=r.unsuspend;r.unsuspend=null,g()}},6e4+a);0<r.imgBytes&&Pv===0&&(Pv=62500*WO());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&wp(r,r.stylesheets),r.unsuspend)){var g=r.unsuspend;r.unsuspend=null,g()}},(r.imgBytes>Pv?50:800)+a);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function yp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)wp(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var vp=null;function wp(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,vp=new Map,a.forEach(gP,r),vp=null,yp.call(r))}function gP(r,a){if(!(a.state.loading&4)){var l=vp.get(r);if(l)var u=l.get(null);else{l=new Map,vp.set(r,l);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var E=p[g];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(l.set(E.dataset.precedence,E),u=E)}u&&l.set(null,u)}p=a.instance,E=p.getAttribute("data-precedence"),g=l.get(E)||u,g===u&&l.set(null,p),l.set(E,p),this.count++,u=yp.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),g?g.parentNode.insertBefore(p,g.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),a.state.loading|=4}}var id={$$typeof:W,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function _P(r,a,l,u,p,g,E,I,O){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ar(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ar(0),this.hiddenUpdates=Ar(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function KS(r,a,l,u,p,g,E,I,O,Q,ne,re){return r=new _P(r,a,l,E,O,Q,ne,re,I),a=1,g===!0&&(a|=24),g=ji(3,null,null,a),r.current=g,g.stateNode=r,a=fy(),a.refCount++,r.pooledCache=a,a.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:a},_y(g),r}function QS(r){return r?(r=Ac,r):Ac}function $S(r,a,l,u,p,g){p=QS(p),u.context===null?u.context=p:u.pendingContext=p,u=La(a),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=ja(r,u,a),l!==null&&(yi(l,r,a),Mh(l,r,a))}function WS(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<a?l:a}}function Mv(r,a){WS(r,a),(r=r.alternate)&&WS(r,a)}function YS(r){if(r.tag===13||r.tag===31){var a=ol(r,67108864);a!==null&&yi(a,r,67108864),Mv(r,67108864)}}function XS(r){if(r.tag===13||r.tag===31){var a=qi();a=Qo(a);var l=ol(r,a);l!==null&&yi(l,r,a),Mv(r,a)}}var Ep=!0;function yP(r,a,l,u){var p=Z.T;Z.T=null;var g=fe.p;try{fe.p=2,Vv(r,a,l,u)}finally{fe.p=g,Z.T=p}}function vP(r,a,l,u){var p=Z.T;Z.T=null;var g=fe.p;try{fe.p=8,Vv(r,a,l,u)}finally{fe.p=g,Z.T=p}}function Vv(r,a,l,u){if(Ep){var p=Lv(u);if(p===null)bv(r,a,u,bp,l),ZS(r,u);else if(EP(p,r,a,l,u))u.stopPropagation();else if(ZS(r,u),a&4&&-1<wP.indexOf(r)){for(;p!==null;){var g=As(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var E=Oi(g.pendingLanes);if(E!==0){var I=g;for(I.pendingLanes|=2,I.entangledLanes|=2;E;){var O=1<<31-Pn(E);I.entanglements[1]|=O,E&=~O}Wr(g),(lt&6)===0&&(rp=At()+500,Xh(0))}}break;case 31:case 13:I=ol(g,2),I!==null&&yi(I,g,2),ap(),Mv(g,2)}if(g=Lv(u),g===null&&bv(r,a,u,bp,l),g===p)break;p=g}p!==null&&u.stopPropagation()}else bv(r,a,u,null,l)}}function Lv(r){return r=yc(r),jv(r)}var bp=null;function jv(r){if(bp=null,r=Ss(r),r!==null){var a=o(r);if(a===null)r=null;else{var l=a.tag;if(l===13){if(r=c(a),r!==null)return r;r=null}else if(l===31){if(r=h(a),r!==null)return r;r=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return bp=r,null}function JS(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hc()){case xt:return 2;case Tt:return 8;case gt:case dc:return 32;case qo:return 268435456;default:return 32}default:return 32}}var Uv=!1,Wa=null,Ya=null,Xa=null,rd=new Map,sd=new Map,Ja=[],wP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ZS(r,a){switch(r){case"focusin":case"focusout":Wa=null;break;case"dragenter":case"dragleave":Ya=null;break;case"mouseover":case"mouseout":Xa=null;break;case"pointerover":case"pointerout":rd.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":sd.delete(a.pointerId)}}function ad(r,a,l,u,p,g){return r===null||r.nativeEvent!==g?(r={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[p]},a!==null&&(a=As(a),a!==null&&YS(a)),r):(r.eventSystemFlags|=u,a=r.targetContainers,p!==null&&a.indexOf(p)===-1&&a.push(p),r)}function EP(r,a,l,u,p){switch(a){case"focusin":return Wa=ad(Wa,r,a,l,u,p),!0;case"dragenter":return Ya=ad(Ya,r,a,l,u,p),!0;case"mouseover":return Xa=ad(Xa,r,a,l,u,p),!0;case"pointerover":var g=p.pointerId;return rd.set(g,ad(rd.get(g)||null,r,a,l,u,p)),!0;case"gotpointercapture":return g=p.pointerId,sd.set(g,ad(sd.get(g)||null,r,a,l,u,p)),!0}return!1}function eA(r){var a=Ss(r.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){r.blockedOn=a,$o(r.priority,function(){XS(l)});return}}else if(a===31){if(a=h(l),a!==null){r.blockedOn=a,$o(r.priority,function(){XS(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Tp(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var l=Lv(r.nativeEvent);if(l===null){l=r.nativeEvent;var u=new l.constructor(l.type,l);_c=u,l.target.dispatchEvent(u),_c=null}else return a=As(l),a!==null&&YS(a),r.blockedOn=l,!1;a.shift()}return!0}function tA(r,a,l){Tp(r)&&l.delete(a)}function bP(){Uv=!1,Wa!==null&&Tp(Wa)&&(Wa=null),Ya!==null&&Tp(Ya)&&(Ya=null),Xa!==null&&Tp(Xa)&&(Xa=null),rd.forEach(tA),sd.forEach(tA)}function Ip(r,a){r.blockedOn===a&&(r.blockedOn=null,Uv||(Uv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,bP)))}var Sp=null;function nA(r){Sp!==r&&(Sp=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Sp===r&&(Sp=null);for(var a=0;a<r.length;a+=3){var l=r[a],u=r[a+1],p=r[a+2];if(typeof u!="function"){if(jv(u||l)===null)continue;break}var g=As(l);g!==null&&(r.splice(a,3),a-=3,Ly(g,{pending:!0,data:p,method:l.method,action:u},u,p))}}))}function Yc(r){function a(O){return Ip(O,r)}Wa!==null&&Ip(Wa,r),Ya!==null&&Ip(Ya,r),Xa!==null&&Ip(Xa,r),rd.forEach(a),sd.forEach(a);for(var l=0;l<Ja.length;l++){var u=Ja[l];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Ja.length&&(l=Ja[0],l.blockedOn===null);)eA(l),l.blockedOn===null&&Ja.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var p=l[u],g=l[u+1],E=p[Ft]||null;if(typeof g=="function")E||nA(l);else if(E){var I=null;if(g&&g.hasAttribute("formAction")){if(p=g,E=g[Ft]||null)I=E.formAction;else if(jv(p)!==null)continue}else I=E.action;typeof I=="function"?l[u+1]=I:(l.splice(u,3),u-=3),nA(l)}}}function iA(){function r(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(E){return p=E})},focusReset:"manual",scroll:"manual"})}function a(){p!==null&&(p(),p=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),p!==null&&(p(),p=null)}}}function Fv(r){this._internalRoot=r}Ap.prototype.render=Fv.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,u=qi();$S(l,u,r,a,null,null)},Ap.prototype.unmount=Fv.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;$S(r.current,2,null,r,null,null),ap(),a[$n]=null}};function Ap(r){this._internalRoot=r}Ap.prototype.unstable_scheduleHydration=function(r){if(r){var a=nr();r={blockedOn:null,target:r,priority:a};for(var l=0;l<Ja.length&&a!==0&&a<Ja[l].priority;l++);Ja.splice(l,0,r),l===0&&eA(r)}};var rA=e.version;if(rA!=="19.2.0")throw Error(i(527,rA,"19.2.0"));fe.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=m(a),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var TP={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xp.isDisabled&&xp.supportsFiber)try{Ue=xp.inject(TP),an=xp}catch{}}return ld.createRoot=function(r,a){if(!s(r))throw Error(i(299));var l=!1,u="",p=hI,g=dI,E=fI;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),a=KS(r,1,!1,null,null,l,u,null,p,g,E,iA),r[$n]=a.current,Ev(r),new Fv(a)},ld.hydrateRoot=function(r,a,l){if(!s(r))throw Error(i(299));var u=!1,p="",g=hI,E=dI,I=fI,O=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.formState!==void 0&&(O=l.formState)),a=KS(r,1,!0,a,l??null,u,p,O,g,E,I,iA),a.context=QS(null),l=a.current,u=qi(),u=Qo(u),p=La(u),p.callback=null,ja(l,p,u),l=u,a.current.lanes=l,xr(a,l),Wr(a),r[$n]=a.current,Ev(r),new Ap(a)},ld.version="19.2.0",ld}var mA;function OP(){if(mA)return qv.exports;mA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qv.exports=kP(),qv.exports}var PP=OP();const MP=o1(PP),et=15,ei=5,vu=900,co=180,l1={win:50,draw:20,loss:10},c1={win:30,draw:10,loss:5},Jr=n=>100+(n-1)*50,VP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M17.2,3H6.8l-5.2,9l5.2,9h10.4l5.2-9L17.2,3z"})}),LP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12,2L1,21h22L12,2z"})}),jP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),UP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.03-3.58 2.37-6.53 5.5-7.65L8.5 3.5C4.73 4.83 2 8.57 2 13zm18 0c0-4.43-3.27-8.17-7.5-9.5L11.5 5.35c3.13 1.12 5.47 4.07 5.5 7.65h2zM12 5V3c4.42 0 8 3.58 8 8h-2c0-3.31-2.69-6-6-6zm0 14v2c-4.42 0-8-3.58-8-8h2c0 3.31 2.69 6 6 6z"})}),FP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.5 13c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-4-4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-4 4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-1-6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"})}),BP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C8.69 2 6 4.69 6 8v6c0 1.1.9 2 2 2h2v4h4v-4h2c1.1 0 2-.9 2-2V8c0-3.31-2.69-6-6-6zm-2 10c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm4 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})}),zP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v5.5l3.5 3.5-1.42 1.42L11 13.41V7z"})}),qP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:v.jsx("circle",{cx:"50",cy:"50",r:"40",stroke:"currentColor",strokeWidth:"12"})}),GP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:v.jsx("path",{d:"M10 10 L90 90 M90 10 L10 90",stroke:"currentColor",strokeWidth:"12",strokeLinecap:"round"})}),HP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2 L2 12 L12 22 L22 12 Z"})}),KP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),QP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),$P=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"})}),WP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M7 2v11h3v9l7-12h-4l4-8z"})}),YP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.53c-.25.58-.56 1.12-.9 1.6l-2.8-2.81c.81-.43 1.51-1.03 2-1.79.49-.76.79-1.68.8-2.65.01-.98-.24-1.92-.7-2.75l1.45-1.45C18.53 7.8 19 9.83 19 12c0 2.21-.81 4.24-2.1 5.86v.01z"})}),XP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 14.17l-3.17-3.17 1.41-1.41 1.76 1.76V7h2v6.17l1.76-1.76 1.41 1.41L13 16.17z"})}),JP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"})}),ZP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M3 3v18h18V3H3zm16 16H5V5h14v14z"})}),eM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11.5 4c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-4.09-2.7-7.54-6.42-8.62C13.43 4.12 12.5 4 11.5 4z"})}),tM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-14h2v4h3v2h-3v4h-2v-4H8v-2h3V6z"})}),nM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M19 8h-1.81c-.45-1.73-1.98-3-3.88-3s-3.43 1.27-3.88 3H7.69l-1.63 4.9A2 2 0 0 0 8 15h8a2 2 0 0 0 1.94-2.1L16.31 8h1.88c.55 0 1-.45 1-1s-.45-1-1-1zm-7 8c-1.66 0-3-1.34-3-3h6c0 1.66-1.34 3-3 3z"})}),iM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5z"})}),rM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C21.27 7.61 17 4.5 12 4.5zm0 13c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"})}),sM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M13.5 1.5c-3.1 0-5.4 2.3-5.4 5.4 0 2 .9 3.7 2.3 4.7-1.3 1.1-2.2 2.7-2.2 4.5 0 3.2 2.6 5.8 5.8 5.8s5.8-2.6 5.8-5.8c0-1.9-.9-3.5-2.2-4.5 1.4-1 2.3-2.7 2.3-4.7 0-3.1-2.3-5.4-5.4-5.4z"})}),aM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6z"})}),oM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:v.jsx("path",{d:"M1,9 L5,5 L9,9 L13,5 L17,9 L21,5 L23,7 L19,11 L23,15 L21,17 L17,13 L13,17 L9,13 L5,17 L1,13 L5,9 M9,11 A2,2 0 1,1 9,10.99"})}),lM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(25)].map((n,e)=>v.jsx("div",{className:"absolute text-cyan-200/50",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.8+Math.random()*1.2}rem`,animationName:"snowfall, sway",animationDuration:`${10+Math.random()*10}s, ${4+Math.random()*4}s`,animationDelay:`${Math.random()*15}s, ${Math.random()*4}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*80}px`},children:""},e))}),v.jsx("style",{children:`
            @keyframes snowfall {
                from {
                    transform: translateY(0vh) rotate(0deg);
                    opacity: 1;
                }
                to {
                    transform: translateY(105vh) rotate(720deg);
                    opacity: 0;
                }
            }
             @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),cM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0 opacity-20 animate-scanlines"}),v.jsx("style",{children:`
            @keyframes scanlines {
                0% { background-position: 0 0; }
                100% { background-position: 0 50px; }
            }
            .animate-scanlines {
                background: linear-gradient(to bottom, transparent 0%, transparent 50%, rgba(24, 24, 27, 0.5) 50%, rgba(24, 24, 27, 0.5) 100%);
                background-size: 100% 4px;
                animation: scanlines 0.5s linear infinite;
            }
        `})]})),uM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(15)].map((n,e)=>v.jsx("div",{className:"absolute text-pink-400/50",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,fontSize:`${.5+Math.random()*1}rem`,animationName:"glint, drift",animationDelay:`${Math.random()*8}s`,animationDuration:`${4+Math.random()*4}s, ${4+Math.random()*4}s`,animationTimingFunction:"ease-in-out, linear",animationIterationCount:"infinite, infinite"},children:""},e))}),v.jsx("style",{children:`
            @keyframes glint {
                0%, 100% { transform: scale(0.8); opacity: 0; }
                50% { transform: scale(1.5); opacity: 1; }
                75% { transform: scale(1.2); opacity: 0.8; }
            }
            @keyframes drift {
                from { transform: translateY(0); }
                to { transform: translateY(-80px); opacity: 0; }
            }
        `})]})),hM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(12)].map((n,e)=>v.jsx("div",{className:"absolute text-orange-400/50",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${1+Math.random()*1.5}rem`,animationName:"fall, sway",animationDuration:`${7+Math.random()*8}s, ${4+Math.random()*5}s`,animationDelay:`${Math.random()*10}s, ${Math.random()*5}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*150}px`},children:Math.random()>.5?"":""},e))}),v.jsx("style",{children:`
            @keyframes fall {
                to {
                    transform: translateY(105vh) rotate(720deg);
                    opacity: 0;
                }
            }
            @keyframes sway {
                0%, 100% { margin-left: 0px; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),dM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(15)].map((n,e)=>v.jsx("div",{className:"absolute text-pink-200/60",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.8+Math.random()*1.2}rem`,animationName:"fall, sway",animationDuration:`${8+Math.random()*7}s, ${5+Math.random()*5}s`,animationDelay:`${Math.random()*12}s, ${Math.random()*5}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*120}px`},children:""},e))}),v.jsx("style",{children:`
            @keyframes fall {
                to { transform: translateY(105vh) rotate(720deg); opacity: 0; }
            }
            @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),fM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"absolute -top-24 -right-24 w-96 h-96 pointer-events-none z-0",children:[v.jsx("div",{className:"absolute inset-0 bg-yellow-300 rounded-full blur-3xl animate-pulse-slow opacity-10"}),v.jsx("div",{className:"absolute inset-10 bg-yellow-200 rounded-full blur-2xl animate-pulse-slow opacity-20"})]}),v.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[[...Array(3)].map((n,e)=>v.jsx("div",{className:"absolute h-[150%] w-[150%]",style:{top:"-25%",right:"-25%",background:"linear-gradient(225deg, rgba(253, 224, 71, 0.08), rgba(253, 224, 71, 0))",transformOrigin:"top right",animation:`god-ray-pulse 8s ease-in-out infinite ${e*2.5}s`}},e)),[...Array(30)].map((n,e)=>v.jsx("div",{className:"absolute w-0.5 h-12 bg-gradient-to-b from-cyan-200/0 to-cyan-200/30",style:{top:"-20%",left:`${Math.random()*100}%`,animation:`rain-fall ${.5+Math.random()*.5}s linear infinite`,animationDelay:`${Math.random()*5}s`}},e))]}),v.jsx("style",{children:`
            @keyframes pulse-slow { 50% { opacity: 0.4; transform: scale(1.05); } }
            .animate-pulse-slow { animation: pulse-slow 10s ease-in-out infinite; }
            @keyframes god-ray-pulse {
                0%, 100% { opacity: 0; transform: rotate(15deg); }
                50% { opacity: 0.6; transform: rotate(20deg); }
            }
            @keyframes rain-fall {
                from { transform: translateY(0vh); }
                to { transform: translateY(120vh); }
            }
        `})]})),mM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(40)].map((n,e)=>v.jsx("div",{className:"absolute text-blue-200/60",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.6+Math.random()*1}rem`,animationName:"snowfall, sway",animationDuration:`${8+Math.random()*8}s, ${3+Math.random()*4}s`,animationDelay:`${Math.random()*12}s, ${Math.random()*4}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*120}px`},children:Math.random()>.3?"":""},e))}),v.jsx("style",{children:`
            @keyframes snowfall {
                from {
                    transform: translateY(0vh) rotate(0deg);
                    opacity: 1;
                }
                to {
                    transform: translateY(105vh) rotate(360deg);
                    opacity: 0;
                }
            }
             @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),pM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[[...Array(60)].map((n,e)=>v.jsx("div",{className:"absolute w-0.5 h-0.5 bg-white rounded-full animate-twinkle",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*10}s`,animationDuration:`${2+Math.random()*3}s`,opacity:Math.random()*.5+.2}},`star-${e}`)),[...Array(3)].map((n,e)=>v.jsx("div",{className:"absolute h-0.5 w-24 bg-gradient-to-l from-white/50 to-transparent animate-shooting-star",style:{top:`${Math.random()*60-10}%`,left:`${Math.random()*60+50}%`,animationDelay:`${3+Math.random()*12}s`,animationDuration:`${1.5+Math.random()*1}s`}},`shooting-star-${e}`))]}),v.jsx("style",{children:`
            @keyframes twinkle {
                0%, 100% { opacity: 0.2; transform: scale(0.8); }
                50% { opacity: 1; transform: scale(1.2); filter: drop-shadow(0 0 3px white); }
            }
            .animate-twinkle { animation: twinkle ease-in-out infinite; }

            @keyframes shooting-star {
                from {
                    transform: rotate(135deg) translateX(0);
                    opacity: 1;
                }
                to {
                    transform: rotate(135deg) translateX(150vmin);
                    opacity: 0;
                }
            }
            .animate-shooting-star { animation: shooting-star linear infinite; }
        `})]})),gM=Ci.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/3 bg-gradient-to-t from-orange-900/40 to-transparent pointer-events-none z-0 animate-pulse-slow"}),v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(25)].map((n,e)=>v.jsx("div",{className:"absolute rounded-full",style:{bottom:"-5%",left:`${Math.random()*100}%`,width:`${2+Math.random()*3}px`,height:`${2+Math.random()*3}px`,backgroundColor:`rgba(251, 146, 60, ${.5+Math.random()*.5})`,boxShadow:"0 0 6px 3px #f97316, 0 0 12px 6px #ef4444",animationName:"emberRise, emberWobble",animationDuration:`${4+Math.random()*6}s, ${3+Math.random()*3}s`,animationDelay:`${Math.random()*8}s, ${Math.random()*3}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--wobble-amount":`${(Math.random()-.5)*80}px`}},e))}),v.jsx("style",{children:`
            @keyframes emberRise {
                from {
                    transform: translateY(0) scale(1);
                    opacity: 1;
                }
                to {
                    transform: translateY(-105vh) scale(0.5);
                    opacity: 0;
                }
            }
             @keyframes emberWobble {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--wobble-amount); }
            }
            @keyframes pulse-slow { 
                50% { opacity: 0.6; } 
            }
            .animate-pulse-slow { animation: pulse-slow 6s ease-in-out infinite; }
        `})]})),yr={id:"theme_default",name:"Default",boardBg:"bg-slate-900",cellBg:"bg-transparent",gridColor:"border-slate-500",nameColor:"text-white"},kg=[{id:"theme_ice",name:"Ice",boardBg:"bg-[#0c1a3e]",boardBgImage:"assets/themes/ice.png",cellBg:"bg-transparent",gridColor:"border-cyan-400/50",nameColor:"text-cyan-100",decoratorComponent:lM},{id:"theme_retro",name:"Retro",boardBg:"bg-[#281e36]",boardBgImage:"assets/themes/retro.png",cellBg:"bg-transparent",gridColor:"border-yellow-400/50",nameColor:"text-yellow-100",decoratorComponent:cM},{id:"theme_ruby",name:"Ruby",boardBg:"bg-[#3b0f2d]",boardBgImage:"assets/themes/ruby.png",cellBg:"bg-transparent",gridColor:"border-pink-400/50",nameColor:"text-pink-100",decoratorComponent:uM},{id:"theme_autumn",name:"Autumn",boardBg:"bg-[#4a2525]",boardBgImage:"assets/themes/autumn.png",cellBg:"bg-transparent",gridColor:"border-orange-400/50",nameColor:"text-orange-100",decoratorComponent:hM},{id:"theme_spring",name:"Spring",boardBg:"bg-[#4d7c5a]",boardBgImage:"assets/themes/spring.png",cellBg:"bg-transparent",gridColor:"border-pink-200/60",nameColor:"text-pink-50",decoratorComponent:dM},{id:"theme_summer",name:"Summer",boardBg:"bg-[#005f73]",boardBgImage:"assets/themes/summer.png",cellBg:"bg-transparent",gridColor:"border-yellow-200/50",nameColor:"text-yellow-50",decoratorComponent:fM},{id:"theme_winter",name:"Winter",boardBg:"bg-[#1a2b4a]",boardBgImage:"assets/themes/winter.png",cellBg:"bg-transparent",gridColor:"border-blue-200/50",nameColor:"text-blue-100",decoratorComponent:mM},{id:"theme_space",name:"Space",boardBg:"bg-[#0c0a1f]",boardBgImage:"assets/themes/space.png",cellBg:"bg-transparent",gridColor:"border-purple-400/50",nameColor:"text-purple-200",decoratorComponent:pM},{id:"theme_fire",name:"Fire",boardBg:"bg-[#2d0d0d]",boardBgImage:"assets/themes/fire.png",cellBg:"bg-transparent",gridColor:"border-orange-500/50",nameColor:"text-yellow-200",decoratorComponent:gM}],Nn={id:"piece_default_x",name:"Cross",component:GP},Hd={id:"piece_default_o",name:"Circle",component:qP},uo=[{id:"piece_hexagon",name:"Hexagon",component:VP},{id:"piece_triangle",name:"Triangle",component:LP},{id:"piece_plus",name:"Plus",component:jP},{id:"piece_sun",name:"Sun",component:UP},{id:"piece_paw",name:"Paw Print",component:FP},{id:"piece_ghost",name:"Ghost",component:BP},{id:"piece_peace",name:"Peace Sign",component:zP},{id:"piece_diamond",name:"Diamond",component:HP},{id:"piece_star",name:"Star",component:KP},{id:"piece_heart",name:"Heart",component:QP},{id:"piece_music",name:"Music Note",component:$P},{id:"piece_bolt",name:"Bolt",component:WP},{id:"piece_planet",name:"Planet",component:YP},{id:"piece_rocket",name:"Rocket",component:XP},{id:"piece_shield",name:"Shield",component:JP},{id:"piece_square",name:"Square",component:ZP},{id:"piece_moon",name:"Moon",component:eM},{id:"piece_anchor",name:"Anchor",component:tM},{id:"piece_bug",name:"Bug",component:nM},{id:"piece_crown",name:"Crown",component:iM},{id:"piece_eye",name:"Eye",component:rM},{id:"piece_fire",name:"Fire",component:sM},{id:"piece_flag",name:"Flag",component:aM},{id:"piece_dragon",name:"Dragon",component:oM}],ii={id:"avatar_default",name:"Guest",url:"assets/avatars/avatar_1.png"},Og=[{id:"avatar_2",name:"Rebel",url:"assets/avatars/avatar_2.png"},{id:"avatar_3",name:"Scholar",url:"assets/avatars/avatar_3.png"},{id:"avatar_4",name:"Ninja",url:"assets/avatars/avatar_4.png"},{id:"avatar_5",name:"Knight",url:"assets/avatars/avatar_5.png"}],Pg=[{id:"emoji_wave",name:"Wave",emoji:""},{id:"emoji_cool",name:"Cool",emoji:""},{id:"emoji_laugh",name:"Laugh",emoji:""},{id:"emoji_wow",name:"Wow",emoji:""},{id:"emoji_think",name:"Thinking",emoji:""},{id:"emoji_gg",name:"Good Game",emoji:""},{id:"emoji_thumbs_up",name:"Thumbs Up",emoji:""},{id:"emoji_clap",name:"Clapping",emoji:""},{id:"emoji_fire",name:"Fire",emoji:""},{id:"emoji_mind_blown",name:"Mind Blown",emoji:""},{id:"emoji_cry",name:"Crying",emoji:""},{id:"emoji_angry",name:"Angry",emoji:""},{id:"emoji_sleep",name:"Sleeping",emoji:""},{id:"emoji_facepalm",name:"Facepalm",emoji:""},{id:"emoji_shrug",name:"Shrug",emoji:""},{id:"emoji_heart",name:"Heart",emoji:""},{id:"emoji_rocket",name:"Rocket",emoji:""},{id:"emoji_star_struck",name:"Star-Struck",emoji:""},{id:"emoji_wink",name:"Wink",emoji:""},{id:"emoji_eyes",name:"Eyes",emoji:""},{id:"emoji_pray",name:"Pray",emoji:""},{id:"emoji_celebrate",name:"Celebrate",emoji:""},{id:"emoji_sad",name:"Sad",emoji:""},{id:"emoji_zany",name:"Zany",emoji:""},{id:"emoji_skull",name:"Skull",emoji:""},{id:"emoji_clown",name:"Clown",emoji:""},{id:"emoji_fleur",name:"Fleur-de-lis",emoji:""},{id:"emoji_dragon",name:"Dragon",emoji:""},{id:"emoji_robot",name:"Robot",emoji:""},{id:"emoji_tophat",name:"Top Hat",emoji:""}],bd=({className:n})=>v.jsx("div",{className:n,children:v.jsx("div",{})}),_M=()=>v.jsxs("svg",{viewBox:"0 0 100 100",children:[v.jsx("path",{d:"M50 10 L50 70 M30 50 L50 70 L70 50",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),v.jsx("circle",{cx:"50",cy:"80",r:"10",fill:"currentColor"})]}),yM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",children:[v.jsx("path",{d:"M 50,50 m -35,0 a 35,35 0 1,0 70,0 a 35,35 0 1,0 -70,0",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeDasharray:"150 220",strokeDashoffset:"0"}),v.jsx("path",{d:"M80 50 L65 40 M80 50 L65 60",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round"})]}),vM=()=>v.jsx("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:v.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"currentColor"})}),wM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-400",children:[v.jsx("circle",{cx:"50",cy:"50",r:"15",stroke:"currentColor",strokeWidth:"4",fill:"none"}),v.jsx("circle",{cx:"50",cy:"50",r:"30",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"4 8"})]}),EM=()=>v.jsx("svg",{viewBox:"0 0 100 100",className:"text-cyan-400",children:v.jsxs("circle",{cx:"50",cy:"50",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",children:[v.jsx("animate",{attributeName:"r",from:"10",to:"40",dur:"1s",repeatCount:"indefinite",begin:"0s"}),v.jsx("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",repeatCount:"indefinite",begin:"0s"})]})}),bM=()=>`
  /* Universal Glow for all effects */
  @keyframes piece-glow {
    0%, 100% { filter: drop-shadow(0 0 2px transparent); }
    50% { filter: drop-shadow(0 0 12px currentColor) drop-shadow(0 0 5px currentColor) brightness(1.2); }
  }

  /* Drop: Piece falls from above and lands with a bounce. */
  @keyframes piece-drop-fall {
    0% { transform: translateY(-200%); opacity: 0; }
    80% { transform: translateY(0); opacity: 1; }
    90% { transform: translateY(-10%); }
    100% { transform: translateY(0); }
  }
  .animate-effect_drop { animation: piece-drop-fall 0.4s cubic-bezier(0.5, 0, 0.25, 1.5) forwards; }

  /* Rotate: Spins 360 degrees. */
  @keyframes piece-rotate-spin {
    from { transform: rotate(-360deg) scale(0.5); opacity: 0; }
    to { transform: rotate(0deg) scale(1); opacity: 1; }
  }
  .animate-effect_rotate { animation: piece-rotate-spin 0.35s ease-out forwards; }

  /* Flash: An elegant, bright golden flash that bursts outwards */
  @keyframes piece-flash-burst {
    0% { transform: scale(0); opacity: 0.8; }
    100% { transform: scale(1.8); opacity: 0; }
  }
   @keyframes piece-flash-self {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); filter: brightness(3); }
  }
  .animate-effect_flash { animation: piece-flash-self 0.3s ease-in-out forwards; }
  .animate-effect_flash::after {
    content: '';
    position: absolute;
    inset: -20%;
    border-radius: 99px;
    background: radial-gradient(circle, currentColor 0%, transparent 70%);
    opacity: 0;
    transform: scale(0);
    animation: piece-flash-burst 0.35s ease-out forwards;
  }

  /* Phase: Holographic activation rings, no longer obscures piece */
  @keyframes piece-phase-fade-in {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
  }
  @keyframes piece-phase-rings {
    from { transform: scale(0.5); opacity: 1; }
    to { transform: scale(1.5); opacity: 0; }
  }
  .animate-effect_phase { animation: piece-phase-fade-in 0.4s ease-out forwards; }
  .animate-effect_phase::before, .animate-effect_phase::after {
    content: '';
    position: absolute;
    inset: 0;
    border: 2px solid currentColor;
    border-radius: 99px;
    opacity: 0;
    transform: scale(0.5);
    animation: piece-phase-rings 0.45s ease-out forwards;
  }
  .animate-effect_phase::after { animation-delay: 0.1s; }

  /* Ripple: Expanding shockwave */
  @keyframes piece-ripple {
    from { transform: scale(0); opacity: 0.7; }
    to { transform: scale(3); opacity: 0; }
  }
  .animate-effect_ripple { animation: piece-glow 0.5s ease-out forwards; }
  .animate-effect_ripple::before {
    content: ''; position: absolute; inset: 0; border-radius: 99px;
    border: 3px solid currentColor;
    animation: piece-ripple 0.4s ease-out forwards;
  }
`,TM=()=>v.jsx("style",{children:bM()}),Qi={id:"effect_flash",name:"Flash",component:bd,previewComponent:vM},Mg=[{id:"effect_rotate",name:"Rotate",component:bd,previewComponent:yM},{id:"effect_drop",name:"Drop",component:bd,previewComponent:_M},{id:"effect_phase",name:"Phase",component:bd,previewComponent:wM},{id:"effect_ripple",name:"Ripple",component:bd,previewComponent:EM}],IM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:[v.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"currentColor"}),v.jsx("path",{d:"M20 20 L30 30 M70 30 L80 20 M70 70 L80 80 M20 80 L30 70",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),SM=()=>v.jsx("svg",{viewBox:"0 0 100 100",children:v.jsxs("g",{transform:"translate(15 15) scale(0.7)",children:[v.jsx("rect",{x:"10",y:"20",width:"15",height:"8",fill:"#34D399",transform:"rotate(-30 17.5 24)"}),v.jsx("rect",{x:"50",y:"15",width:"15",height:"8",fill:"#F472B6",transform:"rotate(20 57.5 19)"}),v.jsx("rect",{x:"70",y:"60",width:"15",height:"8",fill:"#60A5FA",transform:"rotate(-10 77.5 64)"}),v.jsx("rect",{x:"25",y:"70",width:"15",height:"8",fill:"#FBBF24",transform:"rotate(40 32.5 74)"})]})}),AM=()=>v.jsx("svg",{viewBox:"0 0 100 100",children:v.jsxs("g",{strokeWidth:"4",strokeLinecap:"round",children:[v.jsx("path",{d:"M50 50 L50 30",stroke:"#F472B6"}),v.jsx("path",{d:"M50 50 L70 50",stroke:"#60A5FA"}),v.jsx("path",{d:"M50 50 L30 50",stroke:"#34D399"}),v.jsx("path",{d:"M50 50 L50 70",stroke:"#FBBF24"})]})}),xM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:[v.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"none",stroke:"currentColor",strokeWidth:"4"}),v.jsx("text",{x:"25",y:"30",fontSize:"30",children:""}),v.jsx("text",{x:"75",y:"75",fontSize:"30",children:""})]}),CM=()=>v.jsx("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:v.jsxs("g",{stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round",children:[v.jsx("path",{d:"M30 70 L30 30 M20 40 L30 30 L40 40"}),v.jsx("path",{d:"M70 70 L70 30 M60 40 L70 30 L80 40"})]})}),RM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-pink-500",children:[v.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),v.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:""})]}),NM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-orange-500",children:[v.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),v.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:""})]}),DM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-500",children:[v.jsx("path",{d:"M20 50 C 40 30, 60 70, 80 50",stroke:"currentColor",strokeWidth:"6",fill:"none"}),v.jsx("circle",{cx:"15",cy:"50",r:"8",fill:"currentColor"})]}),kM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-slate-300",children:[v.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),v.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:""})]}),OM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-400",children:[v.jsx("circle",{cx:"50",cy:"50",r:"25",fill:"black"}),v.jsx("path",{d:"M 50,50 m -15,0 a 15,15 0 1,0 30,0 a 15,15 0 1,0 -30,0",stroke:"currentColor",strokeWidth:"4",fill:"none",transform:"rotate(45 50 50)",strokeDasharray:"10 10"})]}),PM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:Array(30).fill(0).map((n,e)=>v.jsx("div",{className:"absolute w-2 h-2 bg-yellow-300 rounded-full animate-particle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`}},e))}),MM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:[...Array(50)].map((n,e)=>v.jsx("div",{className:"absolute h-4 animate-confetti",style:{width:"8px",left:`${Math.random()*100}%`,animationDelay:`${Math.random()*.2}s`,animationDuration:`${2+Math.random()*2}s`,backgroundColor:["#34D399","#F472B6","#60A5FA","#FBBF24"][e%4]}},e))}),VM=()=>{const n=["#F472B6","#60A5FA","#34D399","#FBBF24","#A78BFA","#FDE047"],e=[{delay:.2,scale:1,left:"45%",top:"40%"},{delay:.7,scale:.8,left:"65%",top:"50%"},{delay:1.2,scale:1.2,left:"35%",top:"30%"},{delay:1.6,scale:.9,left:"55%",top:"60%"},{delay:2,scale:1.1,left:"40%",top:"55%"}];return v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:e.map((t,i)=>v.jsx("div",{className:"absolute animate-firework-container",style:{left:t.left,top:t.top,transform:`scale(${t.scale})`,animationDelay:`${t.delay}s`},children:[...Array(35)].map((s,o)=>{const c=Math.random()*360,h=60+Math.random()*70;return v.jsx("div",{className:"absolute w-2 h-2 rounded-full animate-firework-particle",style:{backgroundColor:n[o%n.length],"--angle":`${c}deg`,"--distance":`${h}px`,"--duration":`${.9+Math.random()*.5}s`}},o)})},i))})},LM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:Array(25).fill(0).map((n,e)=>v.jsx("div",{className:"animate-starlight",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,transform:`scale(${.5+Math.random()*.5})`},children:""},e))}),jM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:[...Array(15)].map((n,e)=>v.jsx("div",{className:"absolute bottom-0 w-2 animate-ascension-beam",style:{left:`${5+Math.random()*90}%`,animationDelay:`${Math.random()*2.5}s`,animationDuration:`${2.5+Math.random()*2}s`}},e))}),cs=n=>n?{x:n.left+n.width/2,y:n.top+n.height/2}:{x:0,y:0},UM=({winnerCoords:n,loserCoords:e})=>{const t=cs(n),i=cs(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:""}),v.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},FM=({winnerCoords:n,loserCoords:e})=>{const t=cs(n),i=cs(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:""}),v.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},BM=({winnerCoords:n,loserCoords:e})=>{const t=cs(n),i=cs(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute w-8 h-8 rounded-full bg-purple-500 animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}}),v.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},zM=({winnerCoords:n,loserCoords:e})=>{const t=cs(n),i=cs(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:""}),v.jsx("div",{className:"animate-boom-ghost-wail",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:[...Array(8)].map((s,o)=>v.jsx("div",{className:"absolute text-2xl top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",style:{transform:`rotate(${o*45}deg) translateY(-50px)`},children:""},o))})]})},qM=({winnerCoords:n,loserCoords:e})=>{const t=cs(n),i=cs(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute w-8 h-8 rounded-full bg-black border-2 border-purple-500 animate-boom-void-travel",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}}),v.jsxs("div",{className:"w-48 h-48 animate-boom-void-impact-container",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:[v.jsx("div",{className:"absolute inset-0 animate-boom-void-black-hole"}),v.jsx("div",{className:"absolute inset-0 animate-boom-void-particles",children:[...Array(12)].map((s,o)=>v.jsx("div",{className:"absolute w-1 h-8 bg-purple-400 animate-boom-void-particle",style:{"--i":o}},o))})]})]})},GM=()=>`
  /* Victory: Default Particle Burst */
  @keyframes particle { 0% { transform: scale(1) translateY(0); opacity: 1; } 100% { transform: scale(0) translateY(-100px); opacity: 0; } }
  .animate-particle { animation: particle 2s ease-out forwards; }
  /* Victory: Confetti */
  @keyframes confetti-fall { from { transform: translateY(-20vh) rotate(0deg); } to { transform: translateY(100vh) rotate(1080deg); } }
  .animate-confetti { animation: confetti-fall linear infinite; }
  /* Victory: Starlight */
  @keyframes starlight-twinkle { 0%, 100% { transform: scale(0.5); opacity: 0.5; } 50% { transform: scale(1.2); opacity: 1; filter: drop-shadow(0 0 5px currentColor); } }
  .animate-starlight { position: absolute; color: #fef08a; font-size: 1.5rem; animation: starlight-twinkle 2s ease-in-out infinite; }
  
  /* Victory: Fireworks */
  @keyframes firework-burst {
    0% { transform: rotate(var(--angle)) translateY(0) scale(1.5); opacity: 1; }
    100% { transform: rotate(var(--angle)) translateY(var(--distance)) scale(0); opacity: 0; }
  }
  .animate-firework-particle {
    animation: firework-burst var(--duration) cubic-bezier(0.2, 0.8, 0.7, 1) forwards;
    filter: drop-shadow(0 0 4px currentColor);
  }
  .animate-firework-container { opacity: 0; animation: firework-fade-in 0.1s linear forwards; animation-delay: inherit; }
  @keyframes firework-fade-in { to { opacity: 1; } }

  /* Victory: Ascension */
  @keyframes light-beam-rise {
    from { transform: translateY(0) scaleY(1); opacity: 0; }
    20% { opacity: 0.7; }
    80% { opacity: 0.7; }
    to { transform: translateY(-100vh) scaleY(3); opacity: 0; }
  }
  .animate-ascension-beam {
    height: 30vh;
    background: linear-gradient(to top, rgba(253, 224, 71, 0), rgba(253, 224, 71, 0.6), rgba(253, 224, 71, 0));
    filter: drop-shadow(0 0 6px #fde047);
    animation: light-beam-rise ease-in forwards;
  }

  /* Boom: Projectile Travel & Vanish (FIXED: Centered and vanishes on impact) */
  @keyframes boom-travel-vanish {
    0% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
    10% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(1); opacity: 1; }
    89% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1); opacity: 1; }
    100% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1.5); opacity: 0; }
  }
  .animate-boom-travel-vanish {
    position: fixed; top: 0; left: 0;
    animation: boom-travel-vanish 1s ease-in-out forwards;
  }
  
  /* Boom: Impact flash at destination */
  @keyframes boom-impact-flash { 
      0% { transform: translate(-50%,-50%) scale(0); opacity: 1; filter: brightness(1.5); } 
      50% { filter: brightness(2.5); }
      100% { transform: translate(-50%,-50%) scale(3); opacity: 0; filter: brightness(1); } 
  }
  .animate-boom-impact {
    position: fixed;
    left: var(--end-x); top: var(--end-y);
    width: 100px; height: 100px; border-radius: 99px;
    background: radial-gradient(circle, white 0%, #FFD700 40%, #FF8C00 70%, transparent 85%);
    transform: translate(-50%, -50%);
    opacity: 0;
    animation: boom-impact-flash 0.4s ease-out forwards;
    animation-delay: 0.85s; /* Delay until travel is almost complete */
  }

  /* Boom: Ghostly Wail Impact */
  @keyframes boom-ghost-wail-anim {
      from { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
      to { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 0; }
  }
  .animate-boom-ghost-wail {
      position: fixed;
      left: var(--end-x); top: var(--end-y);
      width: 150px; height: 150px;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      animation: boom-ghost-wail-anim 0.8s ease-out forwards;
      animation-delay: 0.85s;
  }

  /* Boom: Void Collapse */
  @keyframes boom-void-travel-anim {
      0% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
      10% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(1); opacity: 1; }
      89% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
  }
  .animate-boom-void-travel {
      position: fixed; top: 0; left: 0;
      filter: drop-shadow(0 0 8px #a855f7);
      animation: boom-void-travel-anim 1s ease-in-out forwards;
  }
  .animate-boom-void-impact-container {
      position: fixed;
      top: var(--end-y);
      left: var(--end-x);
      transform: translate(-50%, -50%);
      opacity: 0;
      animation: firework-fade-in 0.1s linear forwards;
      animation-delay: 0.85s;
  }
  @keyframes boom-void-black-hole-anim {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 0.5; }
    30% { transform: translate(-50%, -50%) scale(0.6); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(0.5) rotate(90deg); opacity: 1; }
  }
  .animate-boom-void-black-hole {
    position: absolute; top: 50%; left: 50%;
    width: 100%; height: 100%;
    transform-origin: center;
    transform: translate(-50%, -50%) scale(0);
    background: radial-gradient(circle, #2d0b45 10%, black 60%);
    border-radius: 50%;
    filter: blur(8px);
    animation: boom-void-black-hole-anim 0.8s ease-out forwards;
  }
  @keyframes boom-void-particles-rotate {
      from { transform: scale(1.5) rotate(0deg); }
      to { transform: scale(1.5) rotate(-360deg); }
  }
  .animate-boom-void-particles {
      transform-origin: center;
      animation: boom-void-particles-rotate 0.8s ease-in forwards;
  }
  @keyframes boom-void-particle-suck {
      from { transform: rotate(calc(var(--i) * 30deg)) translateY(0) scaleY(1); opacity: 1; }
      to { transform: rotate(calc(var(--i) * 30deg)) translateY(-70px) scaleY(0.2); opacity: 0; }
  }
  .animate-boom-void-particle {
      top: 50%; left: 50%;
      transform-origin: center bottom;
      animation: boom-void-particle-suck 0.5s ease-in forwards;
  }
`,HM=()=>v.jsx("style",{children:GM()}),$i={id:"victory_default",name:"Glimmer",component:PM,previewComponent:IM},Kd=[{id:"victory_confetti",name:"Confetti",component:MM,previewComponent:SM},{id:"victory_fireworks",name:"Fireworks",component:VM,previewComponent:AM},{id:"victory_starlight",name:"Starlight",component:LM,previewComponent:xM},{id:"victory_ascension",name:"Ascension",component:jM,previewComponent:CM}],Wi={id:"boom_heart",name:"Heart",component:UM,previewComponent:RM},Qd=[{id:"boom_rocket",name:"Rocket Barrage",component:FM,previewComponent:NM},{id:"boom_missile",name:"Magic Missile",component:BM,previewComponent:DM},{id:"boom_ghost",name:"Ghostly Wail",component:zM,previewComponent:kM},{id:"boom_void_collapse",name:"Void Collapse",component:qM,previewComponent:OM}],KM=[{id:"bot_easy",name:"Meow",avatar:"assets/avatars/bot_1.png",level:1,skillLevel:"easy",description:"Mt ch mo nh mi tp chi! Tuyt vi cho nhng mn u khng cng no."},{id:"bot_medium",name:"Nova",avatar:"assets/avatars/bot_2.png",level:5,skillLevel:"medium",description:"Mt c gi xinh p  thnh tho chin lc. Ha hn mt vn u mn nhn."},{id:"bot_hard",name:"Kael",avatar:"assets/avatars/bot_3.png",level:10,skillLevel:"hard",description:"Mt hacker tr, suy ngh rt k trc khi hnh ng, tht bi l iu hin nhin."}],u1=[{id:"music_default",name:"Celestial",url:"assets/sounds/music.mp3"},{id:"music_chill",name:"Chillhop",url:"assets/sounds/music_1.mp3"},{id:"music_action",name:"Action",url:"assets/sounds/music_2.mp3"},{id:"music_synth",name:"Synthwave",url:"assets/sounds/music_3.mp3"}],yo=[{id:yr.id,name:yr.name,type:"theme",price:0,item:yr},...kg.map(n=>({id:n.id,name:n.name,type:"theme",price:500,item:n})),{id:ii.id,name:ii.name,type:"avatar",price:0,item:ii},...Og.map(n=>({id:n.id,name:n.name,type:"avatar",price:300,item:n})),{id:Nn.id,name:Nn.name,type:"piece",price:0,item:Nn},...uo.filter(n=>n.id!=="piece_dragon").map(n=>({id:n.id,name:n.name,type:"piece",price:250,item:n})),{id:"piece_dragon",name:"Dragon",type:"piece",price:750,item:uo.find(n=>n.id==="piece_dragon")},{id:Qi.id,name:Qi.name,type:"effect",price:0,item:Qi},...Mg.map(n=>({id:n.id,name:n.name,type:"effect",price:400,item:n})),{id:$i.id,name:$i.name,type:"victory",price:0,item:$i},...Kd.filter(n=>n.id!=="victory_ascension").map(n=>({id:n.id,name:n.name,type:"victory",price:750,item:n})),{id:"victory_ascension",name:"Ascension",type:"victory",price:900,item:Kd.find(n=>n.id==="victory_ascension")},{id:Wi.id,name:Wi.name,type:"boom",price:0,item:Wi},...Qd.filter(n=>n.id!=="boom_void_collapse").map(n=>({id:n.id,name:n.name,type:"boom",price:1e3,item:n})),{id:"boom_void_collapse",name:"Void Collapse",type:"boom",price:1200,item:Qd.find(n=>n.id==="boom_void_collapse")},...Pg.map(n=>({id:n.id,name:n.name,type:"emoji",price:n.id==="emoji_wave"||n.id==="emoji_think"?0:50,item:n}))];var pA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de=function(n,e){if(!n)throw Ku(e)},Ku=function(n){return new Error("Firebase Database ("+h1.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},QM=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],c=n[t++],h=n[t++],d=((s&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],c=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return e.join("")},Cw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],c=s+1<n.length,h=c?n[s+1]:0,d=s+2<n.length,m=d?n[s+2]:0,_=o>>2,y=(o&3)<<4|h>>4;let T=(h&15)<<2|m>>6,S=m&63;d||(S=64,c||(T=64)),i.push(t[_],t[y],t[T],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(d1(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):QM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],h=s<n.length?t[n.charAt(s)]:0;++s;const m=s<n.length?t[n.charAt(s)]:64;++s;const y=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||h==null||m==null||y==null)throw new $M;const T=o<<2|h>>4;if(i.push(T),m!==64){const S=h<<4&240|m>>2;if(i.push(S),y!==64){const C=m<<6&192|y;i.push(C)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class $M extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const f1=function(n){const e=d1(n);return Cw.encodeByteArray(e,!0)},Xp=function(n){return f1(n).replace(/\./g,"")},Jp=function(n){try{return Cw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(n){return $d(void 0,n)}function $d(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!YM(t)||(n[t]=$d(n[t],e[t]));return n}function YM(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM=()=>m1().__FIREBASE_DEFAULTS__,JM=()=>{if(typeof process>"u"||typeof pA>"u")return;const n=pA.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ZM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Jp(n[1]);return e&&JSON.parse(e)},Vg=()=>{try{return XM()||JM()||ZM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},p1=n=>{var e,t;return(t=(e=Vg())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},g1=n=>{const e=p1(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},_1=()=>{var n;return(n=Vg())===null||n===void 0?void 0:n.config},y1=n=>{var e;return(e=Vg())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Xp(JSON.stringify(t)),Xp(JSON.stringify(c)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Rw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qt())}function Nw(){var n;const e=(n=Vg())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eV(){return typeof window<"u"||w1()}function w1(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function tV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function E1(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Lg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function b1(){const n=qt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function nV(){return h1.NODE_ADMIN===!0}function T1(){return!Nw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Wd(){try{return typeof indexedDB=="object"}catch{return!1}}function iV(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV="FirebaseError";class ri extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=rV,Object.setPrototypeOf(this,ri.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zl.prototype.create)}}class Zl{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],c=o?sV(o,i):"Error",h=`${this.serviceName}: ${c} (${s}).`;return new ri(s,h,i)}}function sV(n,e){return n.replace(aV,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const aV=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(n){return JSON.parse(n)}function _n(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=Yd(Jp(o[0])||""),t=Yd(Jp(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},oV=function(n){const e=I1(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},lV=function(n){const e=I1(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function jl(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Zp(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function eg(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function wu(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],c=e[s];if(gA(o)&&gA(c)){if(!wu(o,c))return!1}else if(o!==c)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function gA(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function lu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Td(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let y=0;y<16;y++)i[y]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let y=0;y<16;y++)i[y]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let y=16;y<80;y++){const T=i[y-3]^i[y-8]^i[y-14]^i[y-16];i[y]=(T<<1|T>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],c=this.chain_[2],h=this.chain_[3],d=this.chain_[4],m,_;for(let y=0;y<80;y++){y<40?y<20?(m=h^o&(c^h),_=1518500249):(m=o^c^h,_=1859775393):y<60?(m=o&c|h&(o|c),_=2400959708):(m=o^c^h,_=3395469782);const T=(s<<5|s>>>27)+m+d+_+i[y]&4294967295;d=h,h=c,c=(o<<30|o>>>2)&4294967295,o=s,s=T}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let c=this.inbuf_;for(;s<t;){if(c===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[c]=e.charCodeAt(s),++c,++s,c===this.blockSize){this.compress_(o),c=0;break}}else for(;s<t;)if(o[c]=e[s],++c,++s,c===this.blockSize){this.compress_(o),c=0;break}}this.inbuf_=c,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function S1(n,e){const t=new uV(n,e);return t.subscribe.bind(t)}class uV{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");hV(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=Qv),s.error===void 0&&(s.error=Qv),s.complete===void 0&&(s.complete=Qv);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function hV(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Qv(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De=function(n,e,t,i){let s;if(i<e?s="at least "+e:i>t&&(s=t===0?"none":"no more than "+t),s){const o=n+" failed: Was called with "+i+(i===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(o)}};function Ai(n,e){return`${n} failed: ${e} argument `}function An(n,e,t,i){if(!(i&&!t)&&typeof t!="function")throw new Error(Ai(n,e)+"must be a valid function.")}function _A(n,e,t,i){if(t&&(typeof t!="object"||t===null))throw new Error(Ai(n,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dV=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,de(i<n.length,"Surrogate pair missing trail surrogate.");const c=n.charCodeAt(i)-56320;s=65536+(o<<10)+c}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},jg=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(n){return n&&n._delegate?n._delegate:n}class xi{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Ei;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mV(e))try{this.getOrInitializeService({instanceIdentifier:bl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=bl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=bl){return this.instances.has(e)}getOptions(e=bl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&c.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:fV(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=bl){return this.component?this.component.multipleInstances?e:bl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fV(n){return n===bl?void 0:n}function mV(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new v0(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw=[];var Ge;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ge||(Ge={}));const A1={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},pV=Ge.INFO,gV={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},_V=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=gV[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Qu{constructor(e){this.name=e,this._logLevel=pV,this._logHandler=_V,this._userLogHandler=null,kw.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?A1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}function yV(n){kw.forEach(e=>{e.setLogLevel(n)})}function vV(n,e){for(const t of kw){let i=null;e&&e.level&&(i=A1[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,o,...c)=>{const h=c.map(d=>{if(d==null)return null;if(typeof d=="string")return d;if(typeof d=="number"||typeof d=="boolean")return d.toString();if(d instanceof Error)return d.message;try{return JSON.stringify(d)}catch{return null}}).filter(d=>d).join(" ");o>=(i??s.logLevel)&&n({level:Ge[o].toLowerCase(),message:h,args:c,type:s.name})}}}const wV=(n,e)=>e.some(t=>n instanceof t);let yA,vA;function EV(){return yA||(yA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bV(){return vA||(vA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x1=new WeakMap,w0=new WeakMap,C1=new WeakMap,$v=new WeakMap,Ow=new WeakMap;function TV(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(ho(n.result)),s()},c=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&x1.set(t,n)}).catch(()=>{}),Ow.set(e,n),e}function IV(n){if(w0.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),s()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});w0.set(n,e)}let E0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return w0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||C1.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ho(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function SV(n){E0=n(E0)}function AV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Wv(this),e,...t);return C1.set(i,e.sort?e.sort():[e]),ho(i)}:bV().includes(n)?function(...e){return n.apply(Wv(this),e),ho(x1.get(this))}:function(...e){return ho(n.apply(Wv(this),e))}}function xV(n){return typeof n=="function"?AV(n):(n instanceof IDBTransaction&&IV(n),wV(n,EV())?new Proxy(n,E0):n)}function ho(n){if(n instanceof IDBRequest)return TV(n);if($v.has(n))return $v.get(n);const e=xV(n);return e!==n&&($v.set(n,e),Ow.set(e,n)),e}const Wv=n=>Ow.get(n);function CV(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const c=indexedDB.open(n,e),h=ho(c);return i&&c.addEventListener("upgradeneeded",d=>{i(ho(c.result),d.oldVersion,d.newVersion,ho(c.transaction),d)}),t&&c.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const RV=["get","getKey","getAll","getAllKeys","count"],NV=["put","add","delete","clear"],Yv=new Map;function wA(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Yv.get(e))return Yv.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=NV.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||RV.includes(t)))return;const o=async function(c,...h){const d=this.transaction(c,s?"readwrite":"readonly");let m=d.store;return i&&(m=m.index(h.shift())),(await Promise.all([m[t](...h),s&&d.done]))[0]};return Yv.set(e,o),o}SV(n=>({...n,get:(e,t,i)=>wA(e,t)||n.get(e,t,i),has:(e,t)=>!!wA(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(kV(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function kV(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tg="@firebase/app",b0="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea=new Qu("@firebase/app"),OV="@firebase/app-compat",PV="@firebase/analytics-compat",MV="@firebase/analytics",VV="@firebase/app-check-compat",LV="@firebase/app-check",jV="@firebase/auth",UV="@firebase/auth-compat",FV="@firebase/database",BV="@firebase/data-connect",zV="@firebase/database-compat",qV="@firebase/functions",GV="@firebase/functions-compat",HV="@firebase/installations",KV="@firebase/installations-compat",QV="@firebase/messaging",$V="@firebase/messaging-compat",WV="@firebase/performance",YV="@firebase/performance-compat",XV="@firebase/remote-config",JV="@firebase/remote-config-compat",ZV="@firebase/storage",eL="@firebase/storage-compat",tL="@firebase/firestore",nL="@firebase/vertexai-preview",iL="@firebase/firestore-compat",rL="firebase",sL="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="[DEFAULT]",aL={[tg]:"fire-core",[OV]:"fire-core-compat",[MV]:"fire-analytics",[PV]:"fire-analytics-compat",[LV]:"fire-app-check",[VV]:"fire-app-check-compat",[jV]:"fire-auth",[UV]:"fire-auth-compat",[FV]:"fire-rtdb",[BV]:"fire-data-connect",[zV]:"fire-rtdb-compat",[qV]:"fire-fn",[GV]:"fire-fn-compat",[HV]:"fire-iid",[KV]:"fire-iid-compat",[QV]:"fire-fcm",[$V]:"fire-fcm-compat",[WV]:"fire-perf",[YV]:"fire-perf-compat",[XV]:"fire-rc",[JV]:"fire-rc-compat",[ZV]:"fire-gcs",[eL]:"fire-gcs-compat",[tL]:"fire-fst",[iL]:"fire-fst-compat",[nL]:"fire-vertex","fire-js":"fire-js",[rL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=new Map,Eu=new Map,bu=new Map;function Xd(n,e){try{n.container.addComponent(e)}catch(t){ea.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function R1(n,e){n.container.addOrOverwriteComponent(e)}function ta(n){const e=n.name;if(bu.has(e))return ea.debug(`There were multiple attempts to register component ${e}.`),!1;bu.set(e,n);for(const t of wo.values())Xd(t,n);for(const t of Eu.values())Xd(t,n);return!0}function $u(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function oL(n,e,t=vo){$u(n,e).clearInstance(t)}function N1(n){return n.options!==void 0}function $t(n){return n.settings!==void 0}function lL(){bu.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vr=new Zl("app","Firebase",cL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D1=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new xi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vr.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL extends D1{constructor(e,t,i,s){const o=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,c={name:i,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,c,s);else{const h=e;super(h.options,c,s)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:o},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Yi(tg,b0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Mw(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw vr.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=sL;function Pw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:vo,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw vr.create("bad-app-name",{appName:String(s)});if(t||(t=_1()),!t)throw vr.create("no-options");const o=wo.get(s);if(o){if(wu(t,o.options)&&wu(i,o.config))return o;throw vr.create("duplicate-app",{appName:s})}const c=new Dw(s);for(const d of bu.values())c.addComponent(d);const h=new D1(t,i,c);return wo.set(s,h),h}function hL(n,e){if(eV()&&!w1())throw vr.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;N1(n)?t=n.options:t=n;const i=Object.assign(Object.assign({},e),t);i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const s=m=>[...m].reduce((_,y)=>Math.imul(31,_)+y.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw vr.create("finalization-registry-not-supported",{});const o=""+s(JSON.stringify(i)),c=Eu.get(o);if(c)return c.incRefCount(e.releaseOnDeref),c;const h=new Dw(o);for(const m of bu.values())h.addComponent(m);const d=new uL(t,e,o,h);return Eu.set(o,d),d}function Ug(n=vo){const e=wo.get(n);if(!e&&n===vo&&_1())return Pw();if(!e)throw vr.create("no-app",{appName:n});return e}function dL(){return Array.from(wo.values())}async function Mw(n){let e=!1;const t=n.name;wo.has(t)?(e=!0,wo.delete(t)):Eu.has(t)&&n.decRefCount()<=0&&(Eu.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)}function Yi(n,e,t){var i;let s=(i=aL[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const h=[`Unable to register library "${s}" with version "${e}":`];o&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&h.push("and"),c&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ea.warn(h.join(" "));return}ta(new xi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function k1(n,e){if(n!==null&&typeof n!="function")throw vr.create("invalid-log-argument");vV(n,e)}function O1(n){yV(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL="firebase-heartbeat-database",mL=1,Jd="firebase-heartbeat-store";let Xv=null;function P1(){return Xv||(Xv=CV(fL,mL,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Jd)}catch(t){console.warn(t)}}}}).catch(n=>{throw vr.create("idb-open",{originalErrorMessage:n.message})})),Xv}async function pL(n){try{const t=(await P1()).transaction(Jd),i=await t.objectStore(Jd).get(M1(n));return await t.done,i}catch(e){if(e instanceof ri)ea.warn(e.message);else{const t=vr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ea.warn(t.message)}}}async function EA(n,e){try{const i=(await P1()).transaction(Jd,"readwrite");await i.objectStore(Jd).put(e,M1(n)),await i.done}catch(t){if(t instanceof ri)ea.warn(t.message);else{const i=vr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ea.warn(i.message)}}}function M1(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL=1024,_L=720*60*60*1e3;class yL{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wL(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=bA();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const h=new Date(c.date).valueOf();return Date.now()-h<=_L}),this._storage.overwrite(this._heartbeatsCache))}catch(i){ea.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=bA(),{heartbeatsToSend:i,unsentEntries:s}=vL(this._heartbeatsCache.heartbeats),o=Xp(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ea.warn(t),""}}}function bA(){return new Date().toISOString().substring(0,10)}function vL(n,e=gL){const t=[];let i=n.slice();for(const s of n){const o=t.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),TA(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),TA(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class wL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wd()?iV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await pL(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return EA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return EA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function TA(n){return Xp(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EL(n){ta(new xi("platform-logger",e=>new DV(e),"PRIVATE")),ta(new xi("heartbeat",e=>new yL(e),"PRIVATE")),Yi(tg,b0,n),Yi(tg,b0,"esm2017"),Yi("fire-js","")}EL("");const bL=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:ri,SDK_VERSION:aa,_DEFAULT_ENTRY_NAME:vo,_addComponent:Xd,_addOrOverwriteComponent:R1,_apps:wo,_clearComponents:lL,_components:bu,_getProvider:$u,_isFirebaseApp:N1,_isFirebaseServerApp:$t,_registerComponent:ta,_removeServiceInstance:oL,_serverApps:Eu,deleteApp:Mw,getApp:Ug,getApps:dL,initializeApp:Pw,initializeServerApp:hL,onLog:k1,registerVersion:Yi,setLogLevel:O1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e,t){this._delegate=e,this.firebase=t,Xd(e,new xi("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Mw(this._delegate)))}_getService(e,t=vo){var i;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((i=s.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:t})}_removeServiceInstance(e,t=vo){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Xd(this._delegate,e)}_addOrOverwriteComponent(e){R1(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},IA=new Zl("app-compat","Firebase",IL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(n){const e={},t={__esModule:!0,initializeApp:o,app:s,registerVersion:Yi,setLogLevel:O1,onLog:k1,apps:null,SDK_VERSION:aa,INTERNAL:{registerComponent:h,removeApp:i,useAsService:d,modularAPIs:bL}};t.default=t,Object.defineProperty(t,"apps",{get:c});function i(m){delete e[m]}function s(m){if(m=m||vo,!Xi(e,m))throw IA.create("no-app",{appName:m});return e[m]}s.App=n;function o(m,_={}){const y=Pw(m,_);if(Xi(e,y.name))return e[y.name];const T=new n(y,t);return e[y.name]=T,T}function c(){return Object.keys(e).map(m=>e[m])}function h(m){const _=m.name,y=_.replace("-compat","");if(ta(m)&&m.type==="PUBLIC"){const T=(S=s())=>{if(typeof S[y]!="function")throw IA.create("invalid-app-argument",{appName:_});return S[y]()};m.serviceProps!==void 0&&$d(T,m.serviceProps),t[y]=T,n.prototype[y]=function(...S){return this._getService.bind(this,_).apply(this,m.multipleInstances?S:[])}}return m.type==="PUBLIC"?t[y]:null}function d(m,_){return _==="serverAuth"?null:_}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(){const n=SL(TL);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:V1,extendNamespace:e,createSubscribe:S1,ErrorFactory:Zl,deepExtend:$d});function e(t){$d(n,t)}return n}const AL=V1();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new Qu("@firebase/app-compat"),xL="@firebase/app-compat",CL="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RL(n){Yi(xL,CL,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=m1();if(n.firebase!==void 0){SA.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&SA.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const tc=AL;RL();var NL="firebase",DL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tc.registerVersion(NL,DL,"app-compat");function Vw(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}const cd={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Xc={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function L1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const OL=kL,PL=L1,j1=new Zl("auth","Firebase",L1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=new Qu("@firebase/auth");function ML(n,...e){ng.logLevel<=Ge.WARN&&ng.warn(`Auth (${aa}): ${n}`,...e)}function jp(n,...e){ng.logLevel<=Ge.ERROR&&ng.error(`Auth (${aa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(n,...e){throw jw(n,...e)}function yn(n,...e){return jw(n,...e)}function Lw(n,e,t){const i=Object.assign(Object.assign({},PL()),{[e]:t});return new Zl("auth","Firebase",i).create(e,{appName:n.name})}function Dn(n){return Lw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Wu(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&kn(n,"argument-error"),Lw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jw(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return j1.create(n,...e)}function ue(n,e,...t){if(!n)throw jw(e,...t)}function is(n){const e="INTERNAL ASSERTION FAILED: "+n;throw jp(e),new Error(e)}function Lr(n,e){n||is(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Uw(){return AA()==="http:"||AA()==="https:"}function AA(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Uw()||E1()||"connection"in navigator)?navigator.onLine:!0}function LL(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Lr(t>e,"Short delay should be less than long delay!"),this.isMobile=Rw()||Lg()}get(){return VL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(n,e){Lr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=new Nf(3e4,6e4);function Jt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Zt(n,e,t,i,s={}){return F1(n,s,async()=>{let o={},c={};i&&(e==="GET"?c=i:o={body:JSON.stringify(i)});const h=ec(Object.assign({key:n.config.apiKey},c)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:d},o);return tV()||(m.referrerPolicy="no-referrer"),U1.fetch()(B1(n,n.config.apiHost,t,h),m)})}async function F1(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},jL),e);try{const s=new BL(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Id(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const h=o.ok?c.errorMessage:c.error.message,[d,m]=h.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Id(n,"credential-already-in-use",c);if(d==="EMAIL_EXISTS")throw Id(n,"email-already-in-use",c);if(d==="USER_DISABLED")throw Id(n,"user-disabled",c);const _=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Lw(n,_,m);kn(n,_)}}catch(s){if(s instanceof ri)throw s;kn(n,"network-request-failed",{message:String(s)})}}async function oa(n,e,t,i,s={}){const o=await Zt(n,e,t,i,s);return"mfaPendingCredential"in o&&kn(n,"multi-factor-auth-required",{_serverResponse:o}),o}function B1(n,e,t,i){const s=`${e}${t}?${i}`;return n.config.emulator?Fw(n.config,s):`${n.config.apiScheme}://${s}`}function FL(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BL{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(yn(this.auth,"network-request-failed")),UL.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Id(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=yn(n,e,i);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(n){return n!==void 0&&n.getResponse!==void 0}function CA(n){return n!==void 0&&n.enterprise!==void 0}class zL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return FL(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qL(n){return(await Zt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function GL(n,e){return Zt(n,"GET","/v2/recaptchaConfig",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HL(n,e){return Zt(n,"POST","/v1/accounts:delete",e)}async function KL(n,e){return Zt(n,"POST","/v1/accounts:update",e)}async function z1(n,e){return Zt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function QL(n,e=!1){const t=ve(n),i=await t.getIdToken(e),s=Fg(i);ue(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,c=o==null?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:Nd(Jv(s.auth_time)),issuedAtTime:Nd(Jv(s.iat)),expirationTime:Nd(Jv(s.exp)),signInProvider:c||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Jv(n){return Number(n)*1e3}function Fg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return jp("JWT malformed, contained fewer than 3 sections"),null;try{const s=Jp(t);return s?JSON.parse(s):(jp("Failed to decode base64 JWT payload"),null)}catch(s){return jp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function RA(n){const e=Fg(n);return ue(e,"internal-error"),ue(typeof e.exp<"u","internal-error"),ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function na(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ri&&$L(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function $L({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nd(this.lastLoginAt),this.creationTime=Nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(n){var e;const t=n.auth,i=await n.getIdToken(),s=await na(n,z1(t,{idToken:i}));ue(s==null?void 0:s.users.length,t,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?q1(o.providerUserInfo):[],h=XL(n.providerData,c),d=n.isAnonymous,m=!(n.email&&o.passwordHash)&&!(h!=null&&h.length),_=d?m:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new T0(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(n,y)}async function YL(n){const e=ve(n);await ef(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XL(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function q1(n){return n.map(e=>{var{providerId:t}=e,i=Vw(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JL(n,e){const t=await F1(n,{},async()=>{const i=ec({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,c=B1(n,s,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",U1.fetch()(c,{method:"POST",headers:h,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function ZL(n,e){return Zt(n,"POST","/v2/accounts:revokeToken",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ue(e.idToken,"internal-error"),ue(typeof e.idToken<"u","internal-error"),ue(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):RA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ue(e.length!==0,"internal-error");const t=RA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:o}=await JL(e,t);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:o}=t,c=new uu;return i&&(ue(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),s&&(ue(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),o&&(ue(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uu,this.toJSON())}_performRefresh(){return is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(n,e){ue(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class $s{constructor(e){var{uid:t,auth:i,stsTokenManager:s}=e,o=Vw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new WL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new T0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await na(this,this.stsTokenManager.getToken(this.auth,e));return ue(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return QL(this,e)}reload(){return YL(this)}_assign(e){this!==e&&(ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new $s(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await ef(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($t(this.auth.app))return Promise.reject(Dn(this.auth));const e=await this.getIdToken();return await na(this,HL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,s,o,c,h,d,m,_;const y=(i=t.displayName)!==null&&i!==void 0?i:void 0,T=(s=t.email)!==null&&s!==void 0?s:void 0,S=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,C=(c=t.photoURL)!==null&&c!==void 0?c:void 0,M=(h=t.tenantId)!==null&&h!==void 0?h:void 0,q=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,F=(m=t.createdAt)!==null&&m!==void 0?m:void 0,j=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:W,emailVerified:se,isAnonymous:z,providerData:ae,stsTokenManager:N}=t;ue(W&&N,e,"internal-error");const R=uu.fromJSON(this.name,N);ue(typeof W=="string",e,"internal-error"),eo(y,e.name),eo(T,e.name),ue(typeof se=="boolean",e,"internal-error"),ue(typeof z=="boolean",e,"internal-error"),eo(S,e.name),eo(C,e.name),eo(M,e.name),eo(q,e.name),eo(F,e.name),eo(j,e.name);const x=new $s({uid:W,auth:e,email:T,emailVerified:se,displayName:y,isAnonymous:z,photoURL:C,phoneNumber:S,tenantId:M,stsTokenManager:R,createdAt:F,lastLoginAt:j});return ae&&Array.isArray(ae)&&(x.providerData=ae.map(k=>Object.assign({},k))),q&&(x._redirectEventId=q),x}static async _fromIdTokenResponse(e,t,i=!1){const s=new uu;s.updateFromServerResponse(t);const o=new $s({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await ef(o),o}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];ue(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?q1(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),h=new uu;h.updateFromIdToken(i);const d=new $s({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:c}),m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new T0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,m),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=new Map;function Ki(n){Lr(n instanceof Function,"Expected a class definition");let e=NA.get(n);return e?(Lr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,NA.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}G1.type="NONE";const Tu=G1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pl(n,e,t){return`firebase:${n}:${e}:${t}`}class hu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=Pl(this.userKey,s.apiKey,o),this.fullPersistenceKey=Pl("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$s._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new hu(Ki(Tu),e,i);const s=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=s[0]||Ki(Tu);const c=Pl(i,e.config.apiKey,e.name);let h=null;for(const m of t)try{const _=await m._get(c);if(_){const y=$s._fromJSON(e,_);m!==o&&(h=y),o=m;break}}catch{}const d=s.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new hu(o,e,i):(o=d[0],h&&await o._set(c,h.toJSON()),await Promise.all(t.map(async m=>{if(m!==o)try{await m._remove(c)}catch{}})),new hu(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(H1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(W1(e))return"Blackberry";if(Y1(e))return"Webos";if(K1(e))return"Safari";if((e.includes("chrome/")||Q1(e))&&!e.includes("edge/"))return"Chrome";if(Df(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function H1(n=qt()){return/firefox\//i.test(n)}function K1(n=qt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q1(n=qt()){return/crios\//i.test(n)}function $1(n=qt()){return/iemobile/i.test(n)}function Df(n=qt()){return/android/i.test(n)}function W1(n=qt()){return/blackberry/i.test(n)}function Y1(n=qt()){return/webos/i.test(n)}function kf(n=qt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function e4(n=qt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function t4(n=qt()){var e;return kf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function n4(){return b1()&&document.documentMode===10}function X1(n=qt()){return kf(n)||Df(n)||Y1(n)||W1(n)||/windows phone/i.test(n)||$1(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J1(n,e=[]){let t;switch(n){case"Browser":t=DA(qt());break;case"Worker":t=`${DA(qt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${aa}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((c,h)=>{try{const d=e(o);c(d)}catch(d){h(d)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r4(n,e={}){return Zt(n,"GET","/v2/passwordPolicy",Jt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4=6;class a4{constructor(e){var t,i,s,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:s4,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,s,o,c,h;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(i=d.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(s=d.containsLowercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(c=d.containsNumericCharacter)!==null&&c!==void 0?c:!0),d.isValid&&(d.isValid=(h=d.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),d}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kA(this),this.idTokenSubscription=new kA(this),this.beforeStateQueue=new i4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=j1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ki(t)),this._initializationPromise=this.queue(async()=>{var i,s;if(!this._deleted&&(this.persistenceManager=await hu.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await z1(this,{idToken:e}),i=await $s._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if($t(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,h=s==null?void 0:s._redirectEventId,d=await this.tryRedirectSignIn(e);(!c||c===h)&&(d!=null&&d.user)&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ef(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=LL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($t(this.app))return Promise.reject(Dn(this));const t=e?ve(e):null;return t&&ue(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $t(this.app)?Promise.reject(Dn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $t(this.app)?Promise.reject(Dn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ki(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await r4(this),t=new a4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Zl("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await ZL(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ki(e)||this._popupRedirectResolver;ue(t,this,"argument-error"),this.redirectPersistenceManager=await hu.create(this,[Ki(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(ue(h,this,"internal-error"),h.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,i,s);return()=>{c=!0,d()}}else{const d=e.addObserver(t);return()=>{c=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=J1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&ML(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Wt(n){return ve(n)}class kA{constructor(e){this.auth=e,this.observer=null,this.addObserver=S1(t=>this.observer=t)}get next(){return ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function l4(n){Of=n}function Bw(n){return Of.loadJS(n)}function c4(){return Of.recaptchaV2Script}function u4(){return Of.recaptchaEnterpriseScript}function h4(){return Of.gapiScript}function Z1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const d4="recaptcha-enterprise",f4="NO_RECAPTCHA";class m4{constructor(e){this.type=d4,this.auth=Wt(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,h)=>{GL(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new zL(d);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,c(m.siteKey)}}).catch(d=>{h(d)})})}function s(o,c,h){const d=window.grecaptcha;CA(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(m=>{c(m)}).catch(()=>{c(f4)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,c)=>{i(this.auth).then(h=>{if(!t&&CA(window.grecaptcha))s(h,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let d=u4();d.length!==0&&(d+=h),Bw(d).then(()=>{s(h,o,c)}).catch(m=>{c(m)})}}).catch(h=>{c(h)})})}}async function OA(n,e,t,i=!1){const s=new m4(n);let o;try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const c=Object.assign({},e);return i?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function tf(n,e,t,i){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await OA(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await OA(n,e,t,t==="getOobCode");return i(n,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(n,e){const t=$u(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(wu(o,e??{}))return s;kn(s,"already-initialized")}return t.initialize({options:e})}function g4(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ki);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function eR(n,e,t){const i=Wt(n);ue(i._canInitEmulator,i,"emulator-config-failed"),ue(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),o=tR(e),{host:c,port:h}=_4(e),d=h===null?"":`:${h}`;i.config.emulator={url:`${o}//${c}${d}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:c,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||y4()}function tR(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _4(n){const e=tR(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:PA(i.substr(o.length+1))}}else{const[o,c]=i.split(":");return{host:o,port:PA(c)}}}function PA(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function y4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return is("not implemented")}_getIdTokenResponse(e){return is("not implemented")}_linkToIdToken(e,t){return is("not implemented")}_getReauthenticationResolver(e){return is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nR(n,e){return Zt(n,"POST","/v1/accounts:resetPassword",Jt(n,e))}async function v4(n,e){return Zt(n,"POST","/v1/accounts:update",e)}async function w4(n,e){return Zt(n,"POST","/v1/accounts:signUp",e)}async function E4(n,e){return Zt(n,"POST","/v1/accounts:update",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b4(n,e){return oa(n,"POST","/v1/accounts:signInWithPassword",Jt(n,e))}async function Bg(n,e){return Zt(n,"POST","/v1/accounts:sendOobCode",Jt(n,e))}async function T4(n,e){return Bg(n,e)}async function I4(n,e){return Bg(n,e)}async function S4(n,e){return Bg(n,e)}async function A4(n,e){return Bg(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x4(n,e){return oa(n,"POST","/v1/accounts:signInWithEmailLink",Jt(n,e))}async function C4(n,e){return oa(n,"POST","/v1/accounts:signInWithEmailLink",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends Yu{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new nf(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new nf(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tf(e,t,"signInWithPassword",b4);case"emailLink":return x4(e,{email:this._email,oobCode:this._password});default:kn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tf(e,i,"signUpPassword",w4);case"emailLink":return C4(e,{idToken:t,email:this._email,oobCode:this._password});default:kn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Js(n,e){return oa(n,"POST","/v1/accounts:signInWithIdp",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4="http://localhost";class us extends Yu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new us(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):kn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s}=t,o=Vw(t,["providerId","signInMethod"]);if(!i||!s)return null;const c=new us(i,s);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Js(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Js(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Js(e,t)}buildRequest(){const e={requestUri:R4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ec(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N4(n,e){return Zt(n,"POST","/v1/accounts:sendVerificationCode",Jt(n,e))}async function D4(n,e){return oa(n,"POST","/v1/accounts:signInWithPhoneNumber",Jt(n,e))}async function k4(n,e){const t=await oa(n,"POST","/v1/accounts:signInWithPhoneNumber",Jt(n,e));if(t.temporaryProof)throw Id(n,"account-exists-with-different-credential",t);return t}const O4={USER_NOT_FOUND:"user-not-found"};async function P4(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return oa(n,"POST","/v1/accounts:signInWithPhoneNumber",Jt(n,t),O4)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml extends Yu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ml({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ml({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return D4(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return k4(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return P4(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:i,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:i,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:o}=e;return!i&&!t&&!s&&!o?null:new Ml({verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function V4(n){const e=lu(Td(n)).link,t=e?lu(Td(e)).deep_link_id:null,i=lu(Td(n)).deep_link_id;return(i?lu(Td(i)).link:null)||i||t||e||n}class zg{constructor(e){var t,i,s,o,c,h;const d=lu(Td(e)),m=(t=d.apiKey)!==null&&t!==void 0?t:null,_=(i=d.oobCode)!==null&&i!==void 0?i:null,y=M4((s=d.mode)!==null&&s!==void 0?s:null);ue(m&&_&&y,"argument-error"),this.apiKey=m,this.operation=y,this.code=_,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=d.languageCode)!==null&&c!==void 0?c:null,this.tenantId=(h=d.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const t=V4(e);try{return new zg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){this.providerId=Lo.PROVIDER_ID}static credential(e,t){return nf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=zg.parseLink(t);return ue(i,"argument-error"),nf._fromEmailAndCode(e,i.code,i.tenantId)}}Lo.PROVIDER_ID="password";Lo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Lo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu extends la{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class du extends Xu{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ue("providerId"in t&&"signInMethod"in t,"argument-error"),us._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ue(e.idToken||e.accessToken,"argument-error"),us._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return du.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return du.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:c,providerId:h}=e;if(!i&&!s&&!t&&!o||!h)return null;try{return new du(h)._credential({idToken:t,accessToken:i,nonce:c,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends Xu{constructor(){super("facebook.com")}static credential(e){return us._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends Xu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return us._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return es.credential(t,i)}catch{return null}}}es.GOOGLE_SIGN_IN_METHOD="google.com";es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Xu{constructor(){super("github.com")}static credential(e){return us._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ts.credential(e.oauthAccessToken)}catch{return null}}}ts.GITHUB_SIGN_IN_METHOD="github.com";ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4="http://localhost";class Iu extends Yu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Js(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Js(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Js(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,pendingToken:o}=t;return!i||!s||!o||i!==s?null:new Iu(i,o)}static _create(e,t){return new Iu(e,t)}buildRequest(){return{requestUri:L4,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4="saml.";class ig extends la{constructor(e){ue(e.startsWith(j4),"argument-error"),super(e)}static credentialFromResult(e){return ig.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return ig.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Iu.fromJSON(e);return ue(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:i}=e;if(!t||!i)return null;try{return Iu._create(i,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends Xu{constructor(){super("twitter.com")}static credential(e,t){return us._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ns.credential(t,i)}catch{return null}}}ns.TWITTER_SIGN_IN_METHOD="twitter.com";ns.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iR(n,e){return oa(n,"POST","/v1/accounts:signUp",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const o=await $s._fromIdTokenResponse(e,i,s),c=MA(i);return new wr({user:o,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=MA(i);return new wr({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function MA(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(n){var e;if($t(n.app))return Promise.reject(Dn(n));const t=Wt(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new wr({user:t.currentUser,providerId:null,operationType:"signIn"});const i=await iR(t,{returnSecureToken:!0}),s=await wr._fromIdTokenResponse(t,"signIn",i,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg extends ri{constructor(e,t,i,s){var o;super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,rg.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new rg(e,t,i,s)}}function sR(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?rg._fromErrorAndOperation(n,o,e,i):o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U4(n,e){const t=ve(n);await qg(!0,t,e);const{providerUserInfo:i}=await KL(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=aR(i||[]);return t.providerData=t.providerData.filter(o=>s.has(o.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function zw(n,e,t=!1){const i=await na(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wr._forOperation(n,"link",i)}async function qg(n,e,t){await ef(e);const i=aR(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ue(i.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oR(n,e,t=!1){const{auth:i}=n;if($t(i.app))return Promise.reject(Dn(i));const s="reauthenticate";try{const o=await na(n,sR(i,s,e,n),t);ue(o.idToken,i,"internal-error");const c=Fg(o.idToken);ue(c,i,"internal-error");const{sub:h}=c;return ue(n.uid===h,i,"user-mismatch"),wr._forOperation(n,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&kn(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lR(n,e,t=!1){if($t(n.app))return Promise.reject(Dn(n));const i="signIn",s=await sR(n,i,e),o=await wr._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(o.user),o}async function Gg(n,e){return lR(Wt(n),e)}async function cR(n,e){const t=ve(n);return await qg(!1,t,e.providerId),zw(t,e)}async function uR(n,e){return oR(ve(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F4(n,e){return oa(n,"POST","/v1/accounts:signInWithCustomToken",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B4(n,e){if($t(n.app))return Promise.reject(Dn(n));const t=Wt(n),i=await F4(t,{token:e,returnSecureToken:!0}),s=await wr._fromIdTokenResponse(t,"signIn",i);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?qw._fromServerResponse(e,t):"totpInfo"in t?Gw._fromServerResponse(e,t):kn(e,"internal-error")}}class qw extends Pf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new qw(t)}}class Gw extends Pf{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Gw(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(n,e,t){var i;ue(((i=t.url)===null||i===void 0?void 0:i.length)>0,n,"invalid-continue-uri"),ue(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ue(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ue(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hw(n){const e=Wt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function z4(n,e,t){const i=Wt(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Hg(i,s,t),await tf(i,s,"getOobCode",I4)}async function q4(n,e,t){await nR(ve(n),{oobCode:e,newPassword:t}).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Hw(n),i})}async function G4(n,e){await E4(ve(n),{oobCode:e})}async function hR(n,e){const t=ve(n),i=await nR(t,{oobCode:e}),s=i.requestType;switch(ue(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ue(i.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ue(i.mfaInfo,t,"internal-error");default:ue(i.email,t,"internal-error")}let o=null;return i.mfaInfo&&(o=Pf._fromServerResponse(Wt(t),i.mfaInfo)),{data:{email:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.newEmail:i.email)||null,previousEmail:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.email:i.newEmail)||null,multiFactorInfo:o},operation:s}}async function H4(n,e){const{data:t}=await hR(ve(n),e);return t.email}async function dR(n,e,t){if($t(n.app))return Promise.reject(Dn(n));const i=Wt(n),c=await tf(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",iR).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&Hw(n),d}),h=await wr._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(h.user),h}function fR(n,e,t){return $t(n.app)?Promise.reject(Dn(n)):Gg(ve(n),Lo.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Hw(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K4(n,e,t){const i=Wt(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(c,h){ue(h.handleCodeInApp,i,"argument-error"),h&&Hg(i,c,h)}o(s,t),await tf(i,s,"getOobCode",S4)}function Q4(n,e){const t=zg.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function $4(n,e,t){if($t(n.app))return Promise.reject(Dn(n));const i=ve(n),s=Lo.credentialWithLink(e,t||Zd());return ue(s._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),Gg(i,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W4(n,e){return Zt(n,"POST","/v1/accounts:createAuthUri",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y4(n,e){const t=Uw()?Zd():"http://localhost",i={identifier:e,continueUri:t},{signinMethods:s}=await W4(ve(n),i);return s||[]}async function X4(n,e){const t=ve(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Hg(t.auth,s,e);const{email:o}=await T4(t.auth,s);o!==n.email&&await n.reload()}async function J4(n,e,t){const i=ve(n),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Hg(i.auth,o,t);const{email:c}=await A4(i.auth,o);c!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z4(n,e){return Zt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kg(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=ve(n),o={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await na(i,Z4(i.auth,o));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const h=i.providerData.find(({providerId:d})=>d==="password");h&&(h.displayName=i.displayName,h.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}function e5(n,e){const t=ve(n);return $t(t.auth.app)?Promise.reject(Dn(t.auth)):mR(t,e,null)}function t5(n,e){return mR(ve(n),null,e)}async function mR(n,e,t){const{auth:i}=n,o={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(o.email=e),t&&(o.password=t);const c=await na(n,v4(i,o));await n._updateTokensIfNecessary(c,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n5(n){var e,t;if(!n)return null;const{providerId:i}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},o=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!i&&(n!=null&&n.idToken)){const c=(t=(e=Fg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(c){const h=c!=="anonymous"&&c!=="custom"?c:null;return new fu(o,h)}}if(!i)return null;switch(i){case"facebook.com":return new i5(o,s);case"github.com":return new r5(o,s);case"google.com":return new s5(o,s);case"twitter.com":return new a5(o,s,n.screenName||null);case"custom":case"anonymous":return new fu(o,null);default:return new fu(o,i,s)}}class fu{constructor(e,t,i={}){this.isNewUser=e,this.providerId=t,this.profile=i}}class pR extends fu{constructor(e,t,i,s){super(e,t,i),this.username=s}}class i5 extends fu{constructor(e,t){super(e,"facebook.com",t)}}class r5 extends pR{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class s5 extends fu{constructor(e,t){super(e,"google.com",t)}}class a5 extends pR{constructor(e,t,i){super(e,"twitter.com",t,i)}}function o5(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:n5(t)}function l5(n,e,t,i){return ve(n).onIdTokenChanged(e,t,i)}function c5(n,e,t){return ve(n).beforeAuthStateChanged(e,t)}function u5(n,e,t,i){return ve(n).onAuthStateChanged(e,t,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,t,i){this.type=e,this.credential=t,this.user=i}static _fromIdtoken(e,t){return new Nl("enroll",e,t)}static _fromMfaPendingCredential(e){return new Nl("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,i;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Nl._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((i=e.multiFactorSession)===null||i===void 0)&&i.idToken)return Nl._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,t,i){this.session=e,this.hints=t,this.signInResolver=i}static _fromError(e,t){const i=Wt(e),s=t.customData._serverResponse,o=(s.mfaInfo||[]).map(h=>Pf._fromServerResponse(i,h));ue(s.mfaPendingCredential,i,"internal-error");const c=Nl._fromMfaPendingCredential(s.mfaPendingCredential);return new Kw(c,o,async h=>{const d=await h._process(i,c);delete s.mfaInfo,delete s.mfaPendingCredential;const m=Object.assign(Object.assign({},s),{idToken:d.idToken,refreshToken:d.refreshToken});switch(t.operationType){case"signIn":const _=await wr._fromIdTokenResponse(i,t.operationType,m);return await i._updateCurrentUser(_.user),_;case"reauthenticate":return ue(t.user,i,"internal-error"),wr._forOperation(t.user,t.operationType,m);default:kn(i,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function h5(n,e){var t;const i=ve(n),s=e;return ue(e.customData.operationType,i,"argument-error"),ue((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,i,"argument-error"),Kw._fromError(i,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(n,e){return Zt(n,"POST","/v2/accounts/mfaEnrollment:start",Jt(n,e))}function f5(n,e){return Zt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Jt(n,e))}function m5(n,e){return Zt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Jt(n,e))}class Qw{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(i=>Pf._fromServerResponse(e.auth,i)))})}static _fromUser(e){return new Qw(e)}async getSession(){return Nl._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const i=e,s=await this.getSession(),o=await na(this.user,i._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,i=await this.user.getIdToken();try{const s=await na(this.user,m5(this.user.auth,{idToken:i,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const Zv=new WeakMap;function p5(n){const e=ve(n);return Zv.has(e)||Zv.set(e,Qw._fromUser(e)),Zv.get(e)}const sg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sg,"1"),this.storage.removeItem(sg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5=1e3,_5=10;class _R extends gR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=X1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,h,d)=>{this.notifyListeners(c,d)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);n4()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,_5):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},g5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_R.type="LOCAL";const Qg=_R;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR extends gR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}yR.type="SESSION";const Eo=yR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new $g(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:o}=t.data,c=this.handlersMap[s];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const h=Array.from(c).map(async m=>m(t.origin,o)),d=await y5(h);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$g.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mf(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,c;return new Promise((h,d)=>{const m=Mf("",20);s.port1.start();const _=setTimeout(()=>{d(new Error("unsupported_event"))},i);c={messageChannel:s,onMessage(y){const T=y;if(T.data.eventId===m)switch(T.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(T.data.response);break;default:clearTimeout(_),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(c),s.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[s.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(){return window}function w5(n){fn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(){return typeof fn().WorkerGlobalScope<"u"&&typeof fn().importScripts=="function"}async function E5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function b5(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function T5(){return $w()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR="firebaseLocalStorageDb",I5=1,ag="firebaseLocalStorage",wR="fbase_key";class Vf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Wg(n,e){return n.transaction([ag],e?"readwrite":"readonly").objectStore(ag)}function S5(){const n=indexedDB.deleteDatabase(vR);return new Vf(n).toPromise()}function I0(){const n=indexedDB.open(vR,I5);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(ag,{keyPath:wR})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(ag)?e(i):(i.close(),await S5(),e(await I0()))})})}async function VA(n,e,t){const i=Wg(n,!0).put({[wR]:e,value:t});return new Vf(i).toPromise()}async function A5(n,e){const t=Wg(n,!1).get(e),i=await new Vf(t).toPromise();return i===void 0?null:i.value}function LA(n,e){const t=Wg(n,!0).delete(e);return new Vf(t).toPromise()}const x5=800,C5=3;class ER{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await I0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>C5)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $w()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$g._getInstance(T5()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await E5(),!this.activeServiceWorker)return;this.sender=new v5(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||b5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await I0();return await VA(e,sg,"1"),await LA(e,sg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>VA(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>A5(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>LA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Wg(s,!1).getAll();return new Vf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),x5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ER.type="LOCAL";const Su=ER;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R5(n,e){return Zt(n,"POST","/v2/accounts/mfaSignIn:start",Jt(n,e))}function N5(n,e){return Zt(n,"POST","/v2/accounts/mfaSignIn:finalize",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5=500,k5=6e4,Cp=1e12;class O5{constructor(e){this.auth=e,this.counter=Cp,this._widgets=new Map}render(e,t){const i=this.counter;return this._widgets.set(i,new P5(e,this.auth.name,t||{})),this.counter++,i}reset(e){var t;const i=e||Cp;(t=this._widgets.get(i))===null||t===void 0||t.delete(),this._widgets.delete(i)}getResponse(e){var t;const i=e||Cp;return((t=this._widgets.get(i))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const i=e||Cp;return(t=this._widgets.get(i))===null||t===void 0||t.execute(),""}}class P5{constructor(e,t,i){this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ue(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=M5(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},k5)},D5))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function M5(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<n;i++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0=Z1("rcb"),V5=new Nf(3e4,6e4);class L5{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=fn().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return ue(j5(t),e,"argument-error"),this.shouldResolveImmediately(t)&&xA(fn().grecaptcha)?Promise.resolve(fn().grecaptcha):new Promise((i,s)=>{const o=fn().setTimeout(()=>{s(yn(e,"network-request-failed"))},V5.get());fn()[e0]=()=>{fn().clearTimeout(o),delete fn()[e0];const h=fn().grecaptcha;if(!h||!xA(h)){s(yn(e,"internal-error"));return}const d=h.render;h.render=(m,_)=>{const y=d(m,_);return this.counter++,y},this.hostLanguage=t,i(h)};const c=`${c4()}?${ec({onload:e0,render:"explicit",hl:t})}`;Bw(c).catch(()=>{clearTimeout(o),s(yn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=fn().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function j5(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class U5{async load(e){return new O5(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR="recaptcha",F5={theme:"light",type:"image"};let B5=class{constructor(e,t,i=Object.assign({},F5)){this.parameters=i,this.type=bR,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Wt(e),this.isInvisible=this.parameters.size==="invisible",ue(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ue(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new U5:new L5,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),i=t.getResponse(e);return i||new Promise(s=>{const o=c=>{c&&(this.tokenChangeListeners.delete(o),s(c))};this.tokenChangeListeners.add(o),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ue(!this.parameters.sitekey,this.auth,"argument-error"),ue(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ue(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(i=>i(t)),typeof e=="function")e(t);else if(typeof e=="string"){const i=fn()[e];typeof i=="function"&&i(t)}}}assertNotDestroyed(){ue(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ue(Uw()&&!$w(),this.auth,"internal-error"),await z5(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await qL(this.auth);ue(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ue(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function z5(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Ml._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function q5(n,e,t){if($t(n.app))return Promise.reject(Dn(n));const i=Wt(n),s=await Yg(i,e,ve(t));return new Ww(s,o=>Gg(i,o))}async function G5(n,e,t){const i=ve(n);await qg(!1,i,"phone");const s=await Yg(i.auth,e,ve(t));return new Ww(s,o=>cR(i,o))}async function H5(n,e,t){const i=ve(n);if($t(i.auth.app))return Promise.reject(Dn(i.auth));const s=await Yg(i.auth,e,ve(t));return new Ww(s,o=>uR(i,o))}async function Yg(n,e,t){var i;const s=await t.verify();try{ue(typeof s=="string",n,"argument-error"),ue(t.type===bR,n,"argument-error");let o;if(typeof e=="string"?o={phoneNumber:e}:o=e,"session"in o){const c=o.session;if("phoneNumber"in o)return ue(c.type==="enroll",n,"internal-error"),(await d5(n,{idToken:c.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{ue(c.type==="signin",n,"internal-error");const h=((i=o.multiFactorHint)===null||i===void 0?void 0:i.uid)||o.multiFactorUid;return ue(h,n,"missing-multi-factor-info"),(await R5(n,{mfaPendingCredential:c.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:c}=await N4(n,{phoneNumber:o.phoneNumber,recaptchaToken:s});return c}}finally{t._reset()}}async function K5(n,e){const t=ve(n);if($t(t.auth.app))return Promise.reject(Dn(t.auth));await zw(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ul=class Up{constructor(e){this.providerId=Up.PROVIDER_ID,this.auth=Wt(e)}verifyPhoneNumber(e,t){return Yg(this.auth,e,ve(t))}static credential(e,t){return Ml._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Up.credentialFromTaggedObject(t)}static credentialFromError(e){return Up.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:i}=e;return t&&i?Ml._fromTokenResponse(t,i):null}};Ul.PROVIDER_ID="phone";Ul.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n,e){return e?Ki(e):(ue(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw extends Yu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Js(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Js(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Js(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Q5(n){return lR(n.auth,new Yw(n),n.bypassAuthState)}function $5(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),oR(t,new Yw(n),n.bypassAuthState)}async function W5(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),zw(t,new Yw(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t,i,s,o=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:o,error:c,type:h}=e;if(c){this.reject(c);return}const d={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Q5;case"linkViaPopup":case"linkViaRedirect":return W5;case"reauthViaPopup":case"reauthViaRedirect":return $5;default:kn(this.auth,"internal-error")}}resolve(e){Lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5=new Nf(2e3,1e4);async function X5(n,e,t){if($t(n.app))return Promise.reject(yn(n,"operation-not-supported-in-this-environment"));const i=Wt(n);Wu(n,e,la);const s=nc(i,t);return new Ws(i,"signInViaPopup",e,s).executeNotNull()}async function J5(n,e,t){const i=ve(n);if($t(i.auth.app))return Promise.reject(yn(i.auth,"operation-not-supported-in-this-environment"));Wu(i.auth,e,la);const s=nc(i.auth,t);return new Ws(i.auth,"reauthViaPopup",e,s,i).executeNotNull()}async function Z5(n,e,t){const i=ve(n);Wu(i.auth,e,la);const s=nc(i.auth,t);return new Ws(i.auth,"linkViaPopup",e,s,i).executeNotNull()}class Ws extends TR{constructor(e,t,i,s,o){super(e,t,s,o),this.provider=i,this.authWindow=null,this.pollId=null,Ws.currentPopupAction&&Ws.currentPopupAction.cancel(),Ws.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ue(e,this.auth,"internal-error"),e}async onExecution(){Lr(this.filter.length===1,"Popup operations only handle one event");const e=Mf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(yn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(yn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ws.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Y5.get())};e()}}Ws.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej="pendingRedirect",Dd=new Map;class tj extends TR{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Dd.get(this.auth._key());if(!e){try{const i=await nj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Dd.set(this.auth._key(),e)}return this.bypassAuthState||Dd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nj(n,e){const t=SR(e),i=IR(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}async function Xw(n,e){return IR(n)._set(SR(e),"true")}function ij(){Dd.clear()}function Jw(n,e){Dd.set(n._key(),e)}function IR(n){return Ki(n._redirectPersistence)}function SR(n){return Pl(ej,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rj(n,e,t){return sj(n,e,t)}async function sj(n,e,t){if($t(n.app))return Promise.reject(Dn(n));const i=Wt(n);Wu(n,e,la),await i._initializationPromise;const s=nc(i,t);return await Xw(s,i),s._openRedirect(i,e,"signInViaRedirect")}function aj(n,e,t){return oj(n,e,t)}async function oj(n,e,t){const i=ve(n);if(Wu(i.auth,e,la),$t(i.auth.app))return Promise.reject(Dn(i.auth));await i.auth._initializationPromise;const s=nc(i.auth,t);await Xw(s,i.auth);const o=await AR(i);return s._openRedirect(i.auth,e,"reauthViaRedirect",o)}function lj(n,e,t){return cj(n,e,t)}async function cj(n,e,t){const i=ve(n);Wu(i.auth,e,la),await i.auth._initializationPromise;const s=nc(i.auth,t);await qg(!1,i,e.providerId),await Xw(s,i.auth);const o=await AR(i);return s._openRedirect(i.auth,e,"linkViaRedirect",o)}async function uj(n,e){return await Wt(n)._initializationPromise,Xg(n,e,!1)}async function Xg(n,e,t=!1){if($t(n.app))return Promise.reject(Dn(n));const i=Wt(n),s=nc(i,e),c=await new tj(i,s,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}async function AR(n){const e=Mf(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=600*1e3;class xR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!dj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!CR(e)){const s=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(yn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hj&&this.cachedEventUids.clear(),this.cachedEventUids.has(jA(e))}saveEventToCache(e){this.cachedEventUids.add(jA(e)),this.lastProcessedEventTime=Date.now()}}function jA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function CR({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function dj(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CR(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RR(n,e={}){return Zt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mj=/^https?/;async function pj(n){if(n.config.emulator)return;const{authorizedDomains:e}=await RR(n);for(const t of e)try{if(gj(t))return}catch{}kn(n,"unauthorized-domain")}function gj(n){const e=Zd(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!mj.test(t))return!1;if(fj.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j=new Nf(3e4,6e4);function UA(){const n=fn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function yj(n){return new Promise((e,t)=>{var i,s,o;function c(){UA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{UA(),t(yn(n,"network-request-failed"))},timeout:_j.get()})}if(!((s=(i=fn().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=fn().gapi)===null||o===void 0)&&o.load)c();else{const h=Z1("iframefcb");return fn()[h]=()=>{gapi.load?c():t(yn(n,"network-request-failed"))},Bw(`${h4()}?onload=${h}`).catch(d=>t(d))}}).catch(e=>{throw Fp=null,e})}let Fp=null;function vj(n){return Fp=Fp||yj(n),Fp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj=new Nf(5e3,15e3),Ej="__/auth/iframe",bj="emulator/auth/iframe",Tj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ij=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Sj(n){const e=n.config;ue(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Fw(e,bj):`https://${n.config.authDomain}/${Ej}`,i={apiKey:e.apiKey,appName:n.name,v:aa},s=Ij.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${ec(i).slice(1)}`}async function Aj(n){const e=await vj(n),t=fn().gapi;return ue(t,n,"internal-error"),e.open({where:document.body,url:Sj(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tj,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const c=yn(n,"network-request-failed"),h=fn().setTimeout(()=>{o(c)},wj.get());function d(){fn().clearTimeout(h),s(i)}i.ping(d).then(d,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Cj=500,Rj=600,Nj="_blank",Dj="http://localhost";class FA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function kj(n,e,t,i=Cj,s=Rj){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const d=Object.assign(Object.assign({},xj),{width:i.toString(),height:s.toString(),top:o,left:c}),m=qt().toLowerCase();t&&(h=Q1(m)?Nj:t),H1(m)&&(e=e||Dj,d.scrollbars="yes");const _=Object.entries(d).reduce((T,[S,C])=>`${T}${S}=${C},`,"");if(t4(m)&&h!=="_self")return Oj(e||"",h),new FA(null);const y=window.open(e||"",h,_);ue(y,n,"popup-blocked");try{y.focus()}catch{}return new FA(y)}function Oj(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pj="__/auth/handler",Mj="emulator/auth/handler",Vj=encodeURIComponent("fac");async function S0(n,e,t,i,s,o){ue(n.config.authDomain,n,"auth-domain-config-required"),ue(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:aa,eventId:s};if(e instanceof la){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",Zp(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,y]of Object.entries(o||{}))c[_]=y}if(e instanceof Xu){const _=e.getScopes().filter(y=>y!=="");_.length>0&&(c.scopes=_.join(","))}n.tenantId&&(c.tid=n.tenantId);const h=c;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const d=await n._getAppCheckToken(),m=d?`#${Vj}=${encodeURIComponent(d)}`:"";return`${Lj(n)}?${ec(h).slice(1)}${m}`}function Lj({config:n}){return n.emulator?Fw(n,Mj):`https://${n.authDomain}/${Pj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0="webStorageSupport";class jj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Eo,this._completeRedirectFn=Xg,this._overrideRedirectResult=Jw}async _openPopup(e,t,i,s){var o;Lr((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await S0(e,t,i,Zd(),s);return kj(e,c,Mf())}async _openRedirect(e,t,i,s){await this._originValidation(e);const o=await S0(e,t,i,Zd(),s);return w5(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Lr(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Aj(e),i=new xR(e);return t.register("authEvent",s=>(ue(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(t0,{type:t0},s=>{var o;const c=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[t0];c!==void 0&&t(!!c),kn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return X1()||K1()||kf()}}const NR=jj;class Uj{constructor(e){this.factorId=e}_process(e,t,i){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,i);case"signin":return this._finalizeSignIn(e,t.credential);default:return is("unexpected MultiFactorSessionType")}}}class Zw extends Uj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Zw(e)}_finalizeEnroll(e,t,i){return f5(e,{idToken:t,displayName:i,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return N5(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class DR{constructor(){}static assertion(e){return Zw._fromCredential(e)}}DR.FACTOR_ID="phone";var BA="@firebase/auth",zA="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function zj(n){ta(new xi("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;ue(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:c,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:J1(n)},m=new o4(i,s,o,d);return g4(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ta(new xi("auth-internal",e=>{const t=Wt(e.getProvider("auth").getImmediate());return(i=>new Fj(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Yi(BA,zA,Bj(n)),Yi(BA,zA,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj=300,Gj=y1("authIdTokenMaxAge")||qj;let qA=null;const Hj=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Gj)return;const s=t==null?void 0:t.token;qA!==s&&(qA=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Kj(n=Ug()){const e=$u(n,"auth");if(e.isInitialized())return e.getImmediate();const t=p4(n,{popupRedirectResolver:NR,persistence:[Su,Qg,Eo]}),i=y1("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const c=Hj(o.toString());c5(t,c,()=>c(t.currentUser)),l5(t,h=>c(h))}}const s=p1("auth");return s&&eR(t,`http://${s}`),t}function Qj(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}l4({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const o=yn("internal-error");o.customData=s,t(o)},i.type="text/javascript",i.charset="UTF-8",Qj().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});zj("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fl(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=2e3;async function Wj(n,e,t){var i;const{BuildInfo:s}=Fl();Lr(e.sessionId,"AuthEvent did not contain a session ID");const o=await e3(e.sessionId),c={};return kf()?c.ibi=s.packageName:Df()?c.apn=s.packageName:kn(n,"operation-not-supported-in-this-environment"),s.displayName&&(c.appDisplayName=s.displayName),c.sessionId=o,S0(n,t,e.type,void 0,(i=e.eventId)!==null&&i!==void 0?i:void 0,c)}async function Yj(n){const{BuildInfo:e}=Fl(),t={};kf()?t.iosBundleId=e.packageName:Df()?t.androidPackageName=e.packageName:kn(n,"operation-not-supported-in-this-environment"),await RR(n,t)}function Xj(n){const{cordova:e}=Fl();return new Promise(t=>{e.plugins.browsertab.isAvailable(i=>{let s=null;i?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,e4()?"_blank":"_system","location=yes"),t(s)})})}async function Jj(n,e,t){const{cordova:i}=Fl();let s=()=>{};try{await new Promise((o,c)=>{let h=null;function d(){var y;o();const T=(y=i.plugins.browsertab)===null||y===void 0?void 0:y.close;typeof T=="function"&&T(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){h||(h=window.setTimeout(()=>{c(yn(n,"redirect-cancelled-by-user"))},$j))}function _(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(d),document.addEventListener("resume",m,!1),Df()&&document.addEventListener("visibilitychange",_,!1),s=()=>{e.removePassiveListener(d),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",_,!1),h&&window.clearTimeout(h)}})}finally{s()}}function Zj(n){var e,t,i,s,o,c,h,d,m,_;const y=Fl();ue(typeof((e=y==null?void 0:y.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ue(typeof((t=y==null?void 0:y.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ue(typeof((o=(s=(i=y==null?void 0:y.cordova)===null||i===void 0?void 0:i.plugins)===null||s===void 0?void 0:s.browsertab)===null||o===void 0?void 0:o.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ue(typeof((d=(h=(c=y==null?void 0:y.cordova)===null||c===void 0?void 0:c.plugins)===null||h===void 0?void 0:h.browsertab)===null||d===void 0?void 0:d.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ue(typeof((_=(m=y==null?void 0:y.cordova)===null||m===void 0?void 0:m.InAppBrowser)===null||_===void 0?void 0:_.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function e3(n){const e=t3(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function t3(n){if(Lr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=20;class i3 extends xR{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function r3(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:o3(),postBody:null,tenantId:n.tenantId,error:yn(n,"no-auth-event")}}function s3(n,e){return A0()._set(x0(n),e)}async function GA(n){const e=await A0()._get(x0(n));return e&&await A0()._remove(x0(n)),e}function a3(n,e){var t,i;const s=c3(e);if(s.includes("/__/auth/callback")){const o=Bp(s),c=o.firebaseError?l3(decodeURIComponent(o.firebaseError)):null,h=(i=(t=c==null?void 0:c.code)===null||t===void 0?void 0:t.split("auth/"))===null||i===void 0?void 0:i[1],d=h?yn(h):null;return d?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:d,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:s,postBody:null}}return null}function o3(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<n3;t++){const i=Math.floor(Math.random()*e.length);n.push(e.charAt(i))}return n.join("")}function A0(){return Ki(Qg)}function x0(n){return Pl("authEvent",n.config.apiKey,n.name)}function l3(n){try{return JSON.parse(n)}catch{return null}}function c3(n){const e=Bp(n),t=e.link?decodeURIComponent(e.link):void 0,i=Bp(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Bp(s).link||s||i||t||n}function Bp(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return lu(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3=500;class h3{constructor(){this._redirectPersistence=Eo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Xg,this._overrideRedirectResult=Jw}async _initialize(e){const t=e._key();let i=this.eventManagers.get(t);return i||(i=new i3(e),this.eventManagers.set(t,i),this.attachCallbackListeners(e,i)),i}_openPopup(e){kn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,i,s){Zj(e);const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),ij(),await this._originValidation(e);const c=r3(e,i,s);await s3(e,c);const h=await Wj(e,c,t),d=await Xj(h);return Jj(e,o,d)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Yj(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:i,handleOpenURL:s,BuildInfo:o}=Fl(),c=setTimeout(async()=>{await GA(e),t.onEvent(HA())},u3),h=async _=>{clearTimeout(c);const y=await GA(e);let T=null;y&&(_!=null&&_.url)&&(T=a3(y,_.url)),t.onEvent(T||HA())};typeof i<"u"&&typeof i.subscribe=="function"&&i.subscribe(null,h);const d=s,m=`${o.packageName.toLowerCase()}://`;Fl().handleOpenURL=async _=>{if(_.toLowerCase().startsWith(m)&&h({url:_}),typeof d=="function")try{d(_)}catch(y){console.error(y)}}}}const d3=h3;function HA(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:yn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f3(n,e){Wt(n)._logFramework(e)}var m3="@firebase/auth-compat",p3="0.5.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3=1e3;function kd(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function _3(){return kd()==="http:"||kd()==="https:"}function kR(n=qt()){return!!((kd()==="file:"||kd()==="ionic:"||kd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function y3(){return Lg()||Nw()}function v3(){return b1()&&(document==null?void 0:document.documentMode)===11}function w3(n=qt()){return/Edge\/\d+/.test(n)}function E3(n=qt()){return v3()||w3(n)}function OR(){try{const n=self.localStorage,e=Mf();if(n)return n.setItem(e,"1"),n.removeItem(e),E3()?Wd():!0}catch{return eE()&&Wd()}return!1}function eE(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function n0(){return(_3()||E1()||kR())&&!y3()&&OR()&&!eE()}function PR(){return kR()&&typeof document<"u"}async function b3(){return PR()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},g3);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function T3(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gi={LOCAL:"local",NONE:"none",SESSION:"session"},ud=ue,MR="persistence";function I3(n,e){if(ud(Object.values(Gi).includes(e),n,"invalid-persistence-type"),Lg()){ud(e!==Gi.SESSION,n,"unsupported-persistence-type");return}if(Nw()){ud(e===Gi.NONE,n,"unsupported-persistence-type");return}if(eE()){ud(e===Gi.NONE||e===Gi.LOCAL&&Wd(),n,"unsupported-persistence-type");return}ud(e===Gi.NONE||OR(),n,"unsupported-persistence-type")}async function C0(n){await n._initializationPromise;const e=VR(),t=Pl(MR,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function S3(n,e){const t=VR();if(!t)return[];const i=Pl(MR,n,e);switch(t.getItem(i)){case Gi.NONE:return[Tu];case Gi.LOCAL:return[Su,Eo];case Gi.SESSION:return[Eo];default:return[]}}function VR(){var n;try{return((n=T3())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3=ue;class so{constructor(){this.browserResolver=Ki(NR),this.cordovaResolver=Ki(d3),this.underlyingResolver=null,this._redirectPersistence=Eo,this._completeRedirectFn=Xg,this._overrideRedirectResult=Jw}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,i,s)}async _openRedirect(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,i,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return PR()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return A3(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await b3();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(n){return n.unwrap()}function x3(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C3(n){return jR(n)}function R3(n,e){var t;const i=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const s=e;s.resolver=new N3(n,h5(n,e))}else if(i){const s=jR(e),o=e;s&&(o.credential=s,o.tenantId=i.tenantId||void 0,o.email=i.email||void 0,o.phoneNumber=i.phoneNumber||void 0)}}function jR(n){const{_tokenResponse:e}=n instanceof ri?n.customData:n;if(!e)return null;if(!(n instanceof ri)&&"temporaryProof"in e&&"phoneNumber"in e)return Ul.credentialFromResult(n);const t=e.providerId;if(!t||t===cd.PASSWORD)return null;let i;switch(t){case cd.GOOGLE:i=es;break;case cd.FACEBOOK:i=Zr;break;case cd.GITHUB:i=ts;break;case cd.TWITTER:i=ns;break;default:const{oauthIdToken:s,oauthAccessToken:o,oauthTokenSecret:c,pendingToken:h,nonce:d}=e;return!o&&!c&&!s&&!h?null:h?t.startsWith("saml.")?Iu._create(t,h):us._fromParams({providerId:t,signInMethod:t,pendingToken:h,idToken:s,accessToken:o}):new du(t).credential({idToken:s,accessToken:o,rawNonce:d})}return n instanceof ri?i.credentialFromError(n):i.credentialFromResult(n)}function vi(n,e){return e.catch(t=>{throw t instanceof ri&&R3(n,t),t}).then(t=>{const i=t.operationType,s=t.user;return{operationType:i,credential:C3(t),additionalUserInfo:o5(t),user:Jg.getOrCreate(s)}})}async function R0(n,e){const t=await e;return{verificationId:t.verificationId,confirm:i=>vi(n,t.confirm(i))}}class N3{constructor(e,t){this.resolver=t,this.auth=x3(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return vi(LR(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jg=class Sd{constructor(e){this._delegate=e,this.multiFactor=p5(e)}static getOrCreate(e){return Sd.USER_MAP.has(e)||Sd.USER_MAP.set(e,new Sd(e)),Sd.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return vi(this.auth,cR(this._delegate,e))}async linkWithPhoneNumber(e,t){return R0(this.auth,G5(this._delegate,e,t))}async linkWithPopup(e){return vi(this.auth,Z5(this._delegate,e,so))}async linkWithRedirect(e){return await C0(Wt(this.auth)),lj(this._delegate,e,so)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return vi(this.auth,uR(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return R0(this.auth,H5(this._delegate,e,t))}reauthenticateWithPopup(e){return vi(this.auth,J5(this._delegate,e,so))}async reauthenticateWithRedirect(e){return await C0(Wt(this.auth)),aj(this._delegate,e,so)}sendEmailVerification(e){return X4(this._delegate,e)}async unlink(e){return await U4(this._delegate,e),this}updateEmail(e){return e5(this._delegate,e)}updatePassword(e){return t5(this._delegate,e)}updatePhoneNumber(e){return K5(this._delegate,e)}updateProfile(e){return Kg(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return J4(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Jg.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd=ue;class N0{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:i}=e.options;hd(i,"invalid-api-key",{appName:e.name}),hd(i,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?so:void 0;this._delegate=t.initialize({options:{persistence:D3(i,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(OL),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Jg.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){eR(this._delegate,e,t)}applyActionCode(e){return G4(this._delegate,e)}checkActionCode(e){return hR(this._delegate,e)}confirmPasswordReset(e,t){return q4(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return vi(this._delegate,dR(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Y4(this._delegate,e)}isSignInWithEmailLink(e){return Q4(this._delegate,e)}async getRedirectResult(){hd(n0(),this._delegate,"operation-not-supported-in-this-environment");const e=await uj(this._delegate,so);return e?vi(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){f3(this._delegate,e)}onAuthStateChanged(e,t,i){const{next:s,error:o,complete:c}=KA(e,t,i);return this._delegate.onAuthStateChanged(s,o,c)}onIdTokenChanged(e,t,i){const{next:s,error:o,complete:c}=KA(e,t,i);return this._delegate.onIdTokenChanged(s,o,c)}sendSignInLinkToEmail(e,t){return K4(this._delegate,e,t)}sendPasswordResetEmail(e,t){return z4(this._delegate,e,t||void 0)}async setPersistence(e){I3(this._delegate,e);let t;switch(e){case Gi.SESSION:t=Eo;break;case Gi.LOCAL:t=await Ki(Su)._isAvailable()?Su:Qg;break;case Gi.NONE:t=Tu;break;default:return kn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return vi(this._delegate,rR(this._delegate))}signInWithCredential(e){return vi(this._delegate,Gg(this._delegate,e))}signInWithCustomToken(e){return vi(this._delegate,B4(this._delegate,e))}signInWithEmailAndPassword(e,t){return vi(this._delegate,fR(this._delegate,e,t))}signInWithEmailLink(e,t){return vi(this._delegate,$4(this._delegate,e,t))}signInWithPhoneNumber(e,t){return R0(this._delegate,q5(this._delegate,e,t))}async signInWithPopup(e){return hd(n0(),this._delegate,"operation-not-supported-in-this-environment"),vi(this._delegate,X5(this._delegate,e,so))}async signInWithRedirect(e){return hd(n0(),this._delegate,"operation-not-supported-in-this-environment"),await C0(this._delegate),rj(this._delegate,e,so)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return H4(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}N0.Persistence=Gi;function KA(n,e,t){let i=n;typeof n!="function"&&({next:i,error:e,complete:t}=n);const s=i;return{next:c=>s(c&&Jg.getOrCreate(c)),error:e,complete:t}}function D3(n,e){const t=S3(n,e);if(typeof self<"u"&&!t.includes(Su)&&t.push(Su),typeof window<"u")for(const i of[Qg,Eo])t.includes(i)||t.push(i);return t.includes(Tu)||t.push(Tu),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(){this.providerId="phone",this._delegate=new Ul(LR(tc.auth()))}static credential(e,t){return Ul.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}tE.PHONE_SIGN_IN_METHOD=Ul.PHONE_SIGN_IN_METHOD;tE.PROVIDER_ID=Ul.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3=ue;class O3{constructor(e,t,i=tc.app()){var s;k3((s=i.options)===null||s===void 0?void 0:s.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new B5(i.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P3="auth-compat";function M3(n){n.INTERNAL.registerComponent(new xi(P3,e=>{const t=e.getProvider("app-compat").getImmediate(),i=e.getProvider("auth");return new N0(t,i)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Xc.EMAIL_SIGNIN,PASSWORD_RESET:Xc.PASSWORD_RESET,RECOVER_EMAIL:Xc.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Xc.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Xc.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Xc.VERIFY_EMAIL}},EmailAuthProvider:Lo,FacebookAuthProvider:Zr,GithubAuthProvider:ts,GoogleAuthProvider:es,OAuthProvider:du,SAMLAuthProvider:ig,PhoneAuthProvider:tE,PhoneMultiFactorGenerator:DR,RecaptchaVerifier:O3,TwitterAuthProvider:ns,Auth:N0,AuthCredential:Yu,Error:ri}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(m3,p3)}M3(tc);var QA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vl,UR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,R){function x(){}x.prototype=R.prototype,N.D=R.prototype,N.prototype=new x,N.prototype.constructor=N,N.C=function(k,P,U){for(var D=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)D[pt-2]=arguments[pt];return R.prototype[P].apply(k,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,R,x){x||(x=0);var k=Array(16);if(typeof R=="string")for(var P=0;16>P;++P)k[P]=R.charCodeAt(x++)|R.charCodeAt(x++)<<8|R.charCodeAt(x++)<<16|R.charCodeAt(x++)<<24;else for(P=0;16>P;++P)k[P]=R[x++]|R[x++]<<8|R[x++]<<16|R[x++]<<24;R=N.g[0],x=N.g[1],P=N.g[2];var U=N.g[3],D=R+(U^x&(P^U))+k[0]+3614090360&4294967295;R=x+(D<<7&4294967295|D>>>25),D=U+(P^R&(x^P))+k[1]+3905402710&4294967295,U=R+(D<<12&4294967295|D>>>20),D=P+(x^U&(R^x))+k[2]+606105819&4294967295,P=U+(D<<17&4294967295|D>>>15),D=x+(R^P&(U^R))+k[3]+3250441966&4294967295,x=P+(D<<22&4294967295|D>>>10),D=R+(U^x&(P^U))+k[4]+4118548399&4294967295,R=x+(D<<7&4294967295|D>>>25),D=U+(P^R&(x^P))+k[5]+1200080426&4294967295,U=R+(D<<12&4294967295|D>>>20),D=P+(x^U&(R^x))+k[6]+2821735955&4294967295,P=U+(D<<17&4294967295|D>>>15),D=x+(R^P&(U^R))+k[7]+4249261313&4294967295,x=P+(D<<22&4294967295|D>>>10),D=R+(U^x&(P^U))+k[8]+1770035416&4294967295,R=x+(D<<7&4294967295|D>>>25),D=U+(P^R&(x^P))+k[9]+2336552879&4294967295,U=R+(D<<12&4294967295|D>>>20),D=P+(x^U&(R^x))+k[10]+4294925233&4294967295,P=U+(D<<17&4294967295|D>>>15),D=x+(R^P&(U^R))+k[11]+2304563134&4294967295,x=P+(D<<22&4294967295|D>>>10),D=R+(U^x&(P^U))+k[12]+1804603682&4294967295,R=x+(D<<7&4294967295|D>>>25),D=U+(P^R&(x^P))+k[13]+4254626195&4294967295,U=R+(D<<12&4294967295|D>>>20),D=P+(x^U&(R^x))+k[14]+2792965006&4294967295,P=U+(D<<17&4294967295|D>>>15),D=x+(R^P&(U^R))+k[15]+1236535329&4294967295,x=P+(D<<22&4294967295|D>>>10),D=R+(P^U&(x^P))+k[1]+4129170786&4294967295,R=x+(D<<5&4294967295|D>>>27),D=U+(x^P&(R^x))+k[6]+3225465664&4294967295,U=R+(D<<9&4294967295|D>>>23),D=P+(R^x&(U^R))+k[11]+643717713&4294967295,P=U+(D<<14&4294967295|D>>>18),D=x+(U^R&(P^U))+k[0]+3921069994&4294967295,x=P+(D<<20&4294967295|D>>>12),D=R+(P^U&(x^P))+k[5]+3593408605&4294967295,R=x+(D<<5&4294967295|D>>>27),D=U+(x^P&(R^x))+k[10]+38016083&4294967295,U=R+(D<<9&4294967295|D>>>23),D=P+(R^x&(U^R))+k[15]+3634488961&4294967295,P=U+(D<<14&4294967295|D>>>18),D=x+(U^R&(P^U))+k[4]+3889429448&4294967295,x=P+(D<<20&4294967295|D>>>12),D=R+(P^U&(x^P))+k[9]+568446438&4294967295,R=x+(D<<5&4294967295|D>>>27),D=U+(x^P&(R^x))+k[14]+3275163606&4294967295,U=R+(D<<9&4294967295|D>>>23),D=P+(R^x&(U^R))+k[3]+4107603335&4294967295,P=U+(D<<14&4294967295|D>>>18),D=x+(U^R&(P^U))+k[8]+1163531501&4294967295,x=P+(D<<20&4294967295|D>>>12),D=R+(P^U&(x^P))+k[13]+2850285829&4294967295,R=x+(D<<5&4294967295|D>>>27),D=U+(x^P&(R^x))+k[2]+4243563512&4294967295,U=R+(D<<9&4294967295|D>>>23),D=P+(R^x&(U^R))+k[7]+1735328473&4294967295,P=U+(D<<14&4294967295|D>>>18),D=x+(U^R&(P^U))+k[12]+2368359562&4294967295,x=P+(D<<20&4294967295|D>>>12),D=R+(x^P^U)+k[5]+4294588738&4294967295,R=x+(D<<4&4294967295|D>>>28),D=U+(R^x^P)+k[8]+2272392833&4294967295,U=R+(D<<11&4294967295|D>>>21),D=P+(U^R^x)+k[11]+1839030562&4294967295,P=U+(D<<16&4294967295|D>>>16),D=x+(P^U^R)+k[14]+4259657740&4294967295,x=P+(D<<23&4294967295|D>>>9),D=R+(x^P^U)+k[1]+2763975236&4294967295,R=x+(D<<4&4294967295|D>>>28),D=U+(R^x^P)+k[4]+1272893353&4294967295,U=R+(D<<11&4294967295|D>>>21),D=P+(U^R^x)+k[7]+4139469664&4294967295,P=U+(D<<16&4294967295|D>>>16),D=x+(P^U^R)+k[10]+3200236656&4294967295,x=P+(D<<23&4294967295|D>>>9),D=R+(x^P^U)+k[13]+681279174&4294967295,R=x+(D<<4&4294967295|D>>>28),D=U+(R^x^P)+k[0]+3936430074&4294967295,U=R+(D<<11&4294967295|D>>>21),D=P+(U^R^x)+k[3]+3572445317&4294967295,P=U+(D<<16&4294967295|D>>>16),D=x+(P^U^R)+k[6]+76029189&4294967295,x=P+(D<<23&4294967295|D>>>9),D=R+(x^P^U)+k[9]+3654602809&4294967295,R=x+(D<<4&4294967295|D>>>28),D=U+(R^x^P)+k[12]+3873151461&4294967295,U=R+(D<<11&4294967295|D>>>21),D=P+(U^R^x)+k[15]+530742520&4294967295,P=U+(D<<16&4294967295|D>>>16),D=x+(P^U^R)+k[2]+3299628645&4294967295,x=P+(D<<23&4294967295|D>>>9),D=R+(P^(x|~U))+k[0]+4096336452&4294967295,R=x+(D<<6&4294967295|D>>>26),D=U+(x^(R|~P))+k[7]+1126891415&4294967295,U=R+(D<<10&4294967295|D>>>22),D=P+(R^(U|~x))+k[14]+2878612391&4294967295,P=U+(D<<15&4294967295|D>>>17),D=x+(U^(P|~R))+k[5]+4237533241&4294967295,x=P+(D<<21&4294967295|D>>>11),D=R+(P^(x|~U))+k[12]+1700485571&4294967295,R=x+(D<<6&4294967295|D>>>26),D=U+(x^(R|~P))+k[3]+2399980690&4294967295,U=R+(D<<10&4294967295|D>>>22),D=P+(R^(U|~x))+k[10]+4293915773&4294967295,P=U+(D<<15&4294967295|D>>>17),D=x+(U^(P|~R))+k[1]+2240044497&4294967295,x=P+(D<<21&4294967295|D>>>11),D=R+(P^(x|~U))+k[8]+1873313359&4294967295,R=x+(D<<6&4294967295|D>>>26),D=U+(x^(R|~P))+k[15]+4264355552&4294967295,U=R+(D<<10&4294967295|D>>>22),D=P+(R^(U|~x))+k[6]+2734768916&4294967295,P=U+(D<<15&4294967295|D>>>17),D=x+(U^(P|~R))+k[13]+1309151649&4294967295,x=P+(D<<21&4294967295|D>>>11),D=R+(P^(x|~U))+k[4]+4149444226&4294967295,R=x+(D<<6&4294967295|D>>>26),D=U+(x^(R|~P))+k[11]+3174756917&4294967295,U=R+(D<<10&4294967295|D>>>22),D=P+(R^(U|~x))+k[2]+718787259&4294967295,P=U+(D<<15&4294967295|D>>>17),D=x+(U^(P|~R))+k[9]+3951481745&4294967295,N.g[0]=N.g[0]+R&4294967295,N.g[1]=N.g[1]+(P+(D<<21&4294967295|D>>>11))&4294967295,N.g[2]=N.g[2]+P&4294967295,N.g[3]=N.g[3]+U&4294967295}i.prototype.u=function(N,R){R===void 0&&(R=N.length);for(var x=R-this.blockSize,k=this.B,P=this.h,U=0;U<R;){if(P==0)for(;U<=x;)s(this,N,U),U+=this.blockSize;if(typeof N=="string"){for(;U<R;)if(k[P++]=N.charCodeAt(U++),P==this.blockSize){s(this,k),P=0;break}}else for(;U<R;)if(k[P++]=N[U++],P==this.blockSize){s(this,k),P=0;break}}this.h=P,this.o+=R},i.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var R=1;R<N.length-8;++R)N[R]=0;var x=8*this.o;for(R=N.length-8;R<N.length;++R)N[R]=x&255,x/=256;for(this.u(N),N=Array(16),R=x=0;4>R;++R)for(var k=0;32>k;k+=8)N[x++]=this.g[R]>>>k&255;return N};function o(N,R){var x=h;return Object.prototype.hasOwnProperty.call(x,N)?x[N]:x[N]=R(N)}function c(N,R){this.h=R;for(var x=[],k=!0,P=N.length-1;0<=P;P--){var U=N[P]|0;k&&U==R||(x[P]=U,k=!1)}this.g=x}var h={};function d(N){return-128<=N&&128>N?o(N,function(R){return new c([R|0],0>R?-1:0)}):new c([N|0],0>N?-1:0)}function m(N){if(isNaN(N)||!isFinite(N))return y;if(0>N)return q(m(-N));for(var R=[],x=1,k=0;N>=x;k++)R[k]=N/x|0,x*=4294967296;return new c(R,0)}function _(N,R){if(N.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(N.charAt(0)=="-")return q(_(N.substring(1),R));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=m(Math.pow(R,8)),k=y,P=0;P<N.length;P+=8){var U=Math.min(8,N.length-P),D=parseInt(N.substring(P,P+U),R);8>U?(U=m(Math.pow(R,U)),k=k.j(U).add(m(D))):(k=k.j(x),k=k.add(m(D)))}return k}var y=d(0),T=d(1),S=d(16777216);n=c.prototype,n.m=function(){if(M(this))return-q(this).m();for(var N=0,R=1,x=0;x<this.g.length;x++){var k=this.i(x);N+=(0<=k?k:4294967296+k)*R,R*=4294967296}return N},n.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(C(this))return"0";if(M(this))return"-"+q(this).toString(N);for(var R=m(Math.pow(N,6)),x=this,k="";;){var P=se(x,R).g;x=F(x,P.j(R));var U=((0<x.g.length?x.g[0]:x.h)>>>0).toString(N);if(x=P,C(x))return U+k;for(;6>U.length;)U="0"+U;k=U+k}},n.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function C(N){if(N.h!=0)return!1;for(var R=0;R<N.g.length;R++)if(N.g[R]!=0)return!1;return!0}function M(N){return N.h==-1}n.l=function(N){return N=F(this,N),M(N)?-1:C(N)?0:1};function q(N){for(var R=N.g.length,x=[],k=0;k<R;k++)x[k]=~N.g[k];return new c(x,~N.h).add(T)}n.abs=function(){return M(this)?q(this):this},n.add=function(N){for(var R=Math.max(this.g.length,N.g.length),x=[],k=0,P=0;P<=R;P++){var U=k+(this.i(P)&65535)+(N.i(P)&65535),D=(U>>>16)+(this.i(P)>>>16)+(N.i(P)>>>16);k=D>>>16,U&=65535,D&=65535,x[P]=D<<16|U}return new c(x,x[x.length-1]&-2147483648?-1:0)};function F(N,R){return N.add(q(R))}n.j=function(N){if(C(this)||C(N))return y;if(M(this))return M(N)?q(this).j(q(N)):q(q(this).j(N));if(M(N))return q(this.j(q(N)));if(0>this.l(S)&&0>N.l(S))return m(this.m()*N.m());for(var R=this.g.length+N.g.length,x=[],k=0;k<2*R;k++)x[k]=0;for(k=0;k<this.g.length;k++)for(var P=0;P<N.g.length;P++){var U=this.i(k)>>>16,D=this.i(k)&65535,pt=N.i(P)>>>16,ct=N.i(P)&65535;x[2*k+2*P]+=D*ct,j(x,2*k+2*P),x[2*k+2*P+1]+=U*ct,j(x,2*k+2*P+1),x[2*k+2*P+1]+=D*pt,j(x,2*k+2*P+1),x[2*k+2*P+2]+=U*pt,j(x,2*k+2*P+2)}for(k=0;k<R;k++)x[k]=x[2*k+1]<<16|x[2*k];for(k=R;k<2*R;k++)x[k]=0;return new c(x,0)};function j(N,R){for(;(N[R]&65535)!=N[R];)N[R+1]+=N[R]>>>16,N[R]&=65535,R++}function W(N,R){this.g=N,this.h=R}function se(N,R){if(C(R))throw Error("division by zero");if(C(N))return new W(y,y);if(M(N))return R=se(q(N),R),new W(q(R.g),q(R.h));if(M(R))return R=se(N,q(R)),new W(q(R.g),R.h);if(30<N.g.length){if(M(N)||M(R))throw Error("slowDivide_ only works with positive integers.");for(var x=T,k=R;0>=k.l(N);)x=z(x),k=z(k);var P=ae(x,1),U=ae(k,1);for(k=ae(k,2),x=ae(x,2);!C(k);){var D=U.add(k);0>=D.l(N)&&(P=P.add(x),U=D),k=ae(k,1),x=ae(x,1)}return R=F(N,P.j(R)),new W(P,R)}for(P=y;0<=N.l(R);){for(x=Math.max(1,Math.floor(N.m()/R.m())),k=Math.ceil(Math.log(x)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),U=m(x),D=U.j(R);M(D)||0<D.l(N);)x-=k,U=m(x),D=U.j(R);C(U)&&(U=T),P=P.add(U),N=F(N,D)}return new W(P,N)}n.A=function(N){return se(this,N).h},n.and=function(N){for(var R=Math.max(this.g.length,N.g.length),x=[],k=0;k<R;k++)x[k]=this.i(k)&N.i(k);return new c(x,this.h&N.h)},n.or=function(N){for(var R=Math.max(this.g.length,N.g.length),x=[],k=0;k<R;k++)x[k]=this.i(k)|N.i(k);return new c(x,this.h|N.h)},n.xor=function(N){for(var R=Math.max(this.g.length,N.g.length),x=[],k=0;k<R;k++)x[k]=this.i(k)^N.i(k);return new c(x,this.h^N.h)};function z(N){for(var R=N.g.length+1,x=[],k=0;k<R;k++)x[k]=N.i(k)<<1|N.i(k-1)>>>31;return new c(x,N.h)}function ae(N,R){var x=R>>5;R%=32;for(var k=N.g.length-x,P=[],U=0;U<k;U++)P[U]=0<R?N.i(U+x)>>>R|N.i(U+x+1)<<32-R:N.i(U+x);return new c(P,N.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,UR=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=_,Vl=c}).apply(typeof QA<"u"?QA:typeof self<"u"?self:typeof window<"u"?window:{});var Rp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FR,Ad,BR,zp,D0,zR,qR,GR;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,w,b){return f==Array.prototype||f==Object.prototype||(f[w]=b.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rp=="object"&&Rp];for(var w=0;w<f.length;++w){var b=f[w];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var i=t(this);function s(f,w){if(w)e:{var b=i;f=f.split(".");for(var A=0;A<f.length-1;A++){var G=f[A];if(!(G in b))break e;b=b[G]}f=f[f.length-1],A=b[f],w=w(A),w!=A&&w!=null&&e(b,f,{configurable:!0,writable:!0,value:w})}}function o(f,w){f instanceof String&&(f+="");var b=0,A=!1,G={next:function(){if(!A&&b<f.length){var ee=b++;return{value:w(ee,f[ee]),done:!1}}return A=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}s("Array.prototype.values",function(f){return f||function(){return o(this,function(w,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},h=this||self;function d(f){var w=typeof f;return w=w!="object"?w:f?Array.isArray(f)?"array":w:"null",w=="array"||w=="object"&&typeof f.length=="number"}function m(f){var w=typeof f;return w=="object"&&f!=null||w=="function"}function _(f,w,b){return f.call.apply(f.bind,arguments)}function y(f,w,b){if(!f)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,A),f.apply(w,G)}}return function(){return f.apply(w,arguments)}}function T(f,w,b){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:y,T.apply(null,arguments)}function S(f,w){var b=Array.prototype.slice.call(arguments,1);return function(){var A=b.slice();return A.push.apply(A,arguments),f.apply(this,A)}}function C(f,w){function b(){}b.prototype=w.prototype,f.aa=w.prototype,f.prototype=new b,f.prototype.constructor=f,f.Qb=function(A,G,ee){for(var me=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)me[ut-2]=arguments[ut];return w.prototype[G].apply(A,me)}}function M(f){const w=f.length;if(0<w){const b=Array(w);for(let A=0;A<w;A++)b[A]=f[A];return b}return[]}function q(f,w){for(let b=1;b<arguments.length;b++){const A=arguments[b];if(d(A)){const G=f.length||0,ee=A.length||0;f.length=G+ee;for(let me=0;me<ee;me++)f[G+me]=A[me]}else f.push(A)}}class F{constructor(w,b){this.i=w,this.j=b,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function j(f){return/^[\s\xa0]*$/.test(f)}function W(){var f=h.navigator;return f&&(f=f.userAgent)?f:""}function se(f){return se[" "](f),f}se[" "]=function(){};var z=W().indexOf("Gecko")!=-1&&!(W().toLowerCase().indexOf("webkit")!=-1&&W().indexOf("Edge")==-1)&&!(W().indexOf("Trident")!=-1||W().indexOf("MSIE")!=-1)&&W().indexOf("Edge")==-1;function ae(f,w,b){for(const A in f)w.call(b,f[A],A,f)}function N(f,w){for(const b in f)w.call(void 0,f[b],b,f)}function R(f){const w={};for(const b in f)w[b]=f[b];return w}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(f,w){let b,A;for(let G=1;G<arguments.length;G++){A=arguments[G];for(b in A)f[b]=A[b];for(let ee=0;ee<x.length;ee++)b=x[ee],Object.prototype.hasOwnProperty.call(A,b)&&(f[b]=A[b])}}function P(f){var w=1;f=f.split(":");const b=[];for(;0<w&&f.length;)b.push(f.shift()),w--;return f.length&&b.push(f.join(":")),b}function U(f){h.setTimeout(()=>{throw f},0)}function D(){var f=pe;let w=null;return f.g&&(w=f.g,f.g=f.g.next,f.g||(f.h=null),w.next=null),w}class pt{constructor(){this.h=this.g=null}add(w,b){const A=ct.get();A.set(w,b),this.h?this.h.next=A:this.g=A,this.h=A}}var ct=new F(()=>new Z,f=>f.reset());class Z{constructor(){this.next=this.g=this.h=null}set(w,b){this.h=w,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,he=!1,pe=new pt,Ee=()=>{const f=h.Promise.resolve(void 0);fe=()=>{f.then(V)}};var V=()=>{for(var f;f=D();){try{f.h.call(f.g)}catch(b){U(b)}var w=ct;w.j(f),100>w.h&&(w.h++,f.next=w.g,w.g=f)}he=!1};function te(){this.s=this.s,this.C=this.C}te.prototype.s=!1,te.prototype.ma=function(){this.s||(this.s=!0,this.N())},te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(f,w){this.type=f,this.g=this.target=w,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var ye=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var f=!1,w=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const b=()=>{};h.addEventListener("test",b,w),h.removeEventListener("test",b,w)}catch{}return f})();function Ae(f,w){if(ce.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var b=this.type=f.type,A=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=w,w=f.relatedTarget){if(z){e:{try{se(w.nodeName);var G=!0;break e}catch{}G=!1}G||(w=null)}}else b=="mouseover"?w=f.fromElement:b=="mouseout"&&(w=f.toElement);this.relatedTarget=w,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:Ce[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Ae.aa.h.call(this)}}C(Ae,ce);var Ce={2:"touch",3:"pen",4:"mouse"};Ae.prototype.h=function(){Ae.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Ve="closure_listenable_"+(1e6*Math.random()|0),Et=0;function bt(f,w,b,A,G){this.listener=f,this.proxy=null,this.src=w,this.type=b,this.capture=!!A,this.ha=G,this.key=++Et,this.da=this.fa=!1}function Ni(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Di(f){this.src=f,this.g={},this.h=0}Di.prototype.add=function(f,w,b,A,G){var ee=f.toString();f=this.g[ee],f||(f=this.g[ee]=[],this.h++);var me=ma(f,w,A,G);return-1<me?(w=f[me],b||(w.fa=!1)):(w=new bt(w,this.src,ee,!!A,G),w.fa=b,f.push(w)),w};function Tr(f,w){var b=w.type;if(b in f.g){var A=f.g[b],G=Array.prototype.indexOf.call(A,w,void 0),ee;(ee=0<=G)&&Array.prototype.splice.call(A,G,1),ee&&(Ni(w),f.g[b].length==0&&(delete f.g[b],f.h--))}}function ma(f,w,b,A){for(var G=0;G<f.length;++G){var ee=f[G];if(!ee.da&&ee.listener==w&&ee.capture==!!b&&ee.ha==A)return G}return-1}var li="closure_lm_"+(1e6*Math.random()|0),_s={};function Ir(f,w,b,A,G){if(Array.isArray(w)){for(var ee=0;ee<w.length;ee++)Ir(f,w[ee],b,A,G);return null}return b=hc(b),f&&f[Ve]?f.K(w,b,m(A)?!!A.capture:!1,G):pa(f,w,b,!1,A,G)}function pa(f,w,b,A,G,ee){if(!w)throw Error("Invalid event type");var me=m(G)?!!G.capture:!!G,ut=mn(f);if(ut||(f[li]=ut=new Di(f)),b=ut.add(w,b,A,me,ee),b.proxy)return b;if(A=ys(),b.proxy=A,A.src=f,A.listener=b,f.addEventListener)ye||(G=me),G===void 0&&(G=!1),f.addEventListener(w.toString(),A,G);else if(f.attachEvent)f.attachEvent(Sr(w.toString()),A);else if(f.addListener&&f.removeListener)f.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return b}function ys(){function f(b){return w.call(f.src,f.listener,b)}const w=ci;return f}function vs(f,w,b,A,G){if(Array.isArray(w))for(var ee=0;ee<w.length;ee++)vs(f,w[ee],b,A,G);else A=m(A)?!!A.capture:!!A,b=hc(b),f&&f[Ve]?(f=f.i,w=String(w).toString(),w in f.g&&(ee=f.g[w],b=ma(ee,b,A,G),-1<b&&(Ni(ee[b]),Array.prototype.splice.call(ee,b,1),ee.length==0&&(delete f.g[w],f.h--)))):f&&(f=mn(f))&&(w=f.g[w.toString()],f=-1,w&&(f=ma(w,b,A,G)),(b=-1<f?w[f]:null)&&er(b))}function er(f){if(typeof f!="number"&&f&&!f.da){var w=f.src;if(w&&w[Ve])Tr(w.i,f);else{var b=f.type,A=f.proxy;w.removeEventListener?w.removeEventListener(b,A,f.capture):w.detachEvent?w.detachEvent(Sr(b),A):w.addListener&&w.removeListener&&w.removeListener(A),(b=mn(w))?(Tr(b,f),b.h==0&&(b.src=null,w[li]=null)):Ni(f)}}}function Sr(f){return f in _s?_s[f]:_s[f]="on"+f}function ci(f,w){if(f.da)f=!0;else{w=new Ae(w,this);var b=f.listener,A=f.ha||f.src;f.fa&&er(f),f=b.call(A,w)}return f}function mn(f){return f=f[li],f instanceof Di?f:null}var At="__closure_events_fn_"+(1e9*Math.random()>>>0);function hc(f){return typeof f=="function"?f:(f[At]||(f[At]=function(w){return f.handleEvent(w)}),f[At])}function xt(){te.call(this),this.i=new Di(this),this.M=this,this.F=null}C(xt,te),xt.prototype[Ve]=!0,xt.prototype.removeEventListener=function(f,w,b,A){vs(this,f,w,b,A)};function Tt(f,w){var b,A=f.F;if(A)for(b=[];A;A=A.F)b.push(A);if(f=f.M,A=w.type||w,typeof w=="string")w=new ce(w,f);else if(w instanceof ce)w.target=w.target||f;else{var G=w;w=new ce(A,f),k(w,G)}if(G=!0,b)for(var ee=b.length-1;0<=ee;ee--){var me=w.g=b[ee];G=gt(me,A,!0,w)&&G}if(me=w.g=f,G=gt(me,A,!0,w)&&G,G=gt(me,A,!1,w)&&G,b)for(ee=0;ee<b.length;ee++)me=w.g=b[ee],G=gt(me,A,!1,w)&&G}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var f=this.i,w;for(w in f.g){for(var b=f.g[w],A=0;A<b.length;A++)Ni(b[A]);delete f.g[w],f.h--}}this.F=null},xt.prototype.K=function(f,w,b,A){return this.i.add(String(f),w,!1,b,A)},xt.prototype.L=function(f,w,b,A){return this.i.add(String(f),w,!0,b,A)};function gt(f,w,b,A){if(w=f.i.g[String(w)],!w)return!0;w=w.concat();for(var G=!0,ee=0;ee<w.length;++ee){var me=w[ee];if(me&&!me.da&&me.capture==b){var ut=me.listener,on=me.ha||me.src;me.fa&&Tr(f.i,me),G=ut.call(on,A)!==!1&&G}}return G&&!A.defaultPrevented}function dc(f,w,b){if(typeof f=="function")b&&(f=T(f,b));else if(f&&typeof f.handleEvent=="function")f=T(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:h.setTimeout(f,w||0)}function qo(f){f.g=dc(()=>{f.g=null,f.i&&(f.i=!1,qo(f))},f.l);const w=f.h;f.h=null,f.m.apply(null,w)}class Go extends te{constructor(w,b){super(),this.m=w,this.l=b,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:qo(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ws(f){te.call(this),this.h=f,this.g={}}C(ws,te);var Ue=[];function an(f){ae(f.g,function(w,b){this.g.hasOwnProperty(b)&&er(w)},f),f.g={}}ws.prototype.N=function(){ws.aa.N.call(this),an(this)},ws.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qn=h.JSON.stringify,Pn=h.JSON.parse,fh=class{stringify(f){return h.JSON.stringify(f,void 0)}parse(f){return h.JSON.parse(f,void 0)}};function ga(){}ga.prototype.h=null;function Es(f){return f.h||(f.h=f.i())}function tr(){}var ki={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ur(){ce.call(this,"d")}C(Ur,ce);function Oi(){ce.call(this,"c")}C(Oi,ce);var ui={},Fr=null;function _a(){return Fr=Fr||new xt}ui.La="serverreachability";function Ho(f){ce.call(this,ui.La,f)}C(Ho,ce);function Ar(f){const w=_a();Tt(w,new Ho(w))}ui.STAT_EVENT="statevent";function xr(f,w){ce.call(this,ui.STAT_EVENT,f),this.stat=w}C(xr,ce);function pn(f){const w=_a();Tt(w,new xr(w,f))}ui.Ma="timingevent";function Ko(f,w){ce.call(this,ui.Ma,f),this.size=w}C(Ko,ce);function Cr(f,w){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){f()},w)}function Br(){this.g=!0}Br.prototype.xa=function(){this.g=!1};function Qo(f,w,b,A,G,ee){f.info(function(){if(f.g)if(ee)for(var me="",ut=ee.split("&"),on=0;on<ut.length;on++){var Be=ut[on].split("=");if(1<Be.length){var En=Be[0];Be=Be[1];var bn=En.split("_");me=2<=bn.length&&bn[1]=="type"?me+(En+"="+Be+"&"):me+(En+"=redacted&")}}else me=null;else me=ee;return"XMLHTTP REQ ("+A+") [attempt "+G+"]: "+w+`
`+b+`
`+me})}function ya(f,w,b,A,G,ee,me){f.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+G+"]: "+w+`
`+b+`
`+ee+" "+me})}function nr(f,w,b,A){f.info(function(){return"XMLHTTP TEXT ("+w+"): "+Oe(f,b)+(A?" "+A:"")})}function $o(f,w){f.info(function(){return"TIMEOUT: "+w})}Br.prototype.info=function(){};function Oe(f,w){if(!f.g)return w;if(!w)return null;try{var b=JSON.parse(w);if(b){for(f=0;f<b.length;f++)if(Array.isArray(b[f])){var A=b[f];if(!(2>A.length)){var G=A[1];if(Array.isArray(G)&&!(1>G.length)){var ee=G[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(var me=1;me<G.length;me++)G[me]=""}}}}return qn(b)}catch{return w}}var ke={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ft={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$n;function Pi(){}C(Pi,ga),Pi.prototype.g=function(){return new XMLHttpRequest},Pi.prototype.i=function(){return{}},$n=new Pi;function hi(f,w,b,A){this.j=f,this.i=w,this.l=b,this.R=A||1,this.U=new ws(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new bs}function bs(){this.i=null,this.g="",this.h=!1}var Ts={},Is={};function Wo(f,w,b){f.L=1,f.v=Jo(Ht(w)),f.m=b,f.P=!0,Ss(f,null)}function Ss(f,w){f.F=Date.now(),Rr(f),f.A=Ht(f.v);var b=f.A,A=f.R;Array.isArray(A)||(A=[String(A)]),Cs(b.i,"t",A),f.C=0,b=f.j.J,f.h=new bs,f.g=Em(f.j,b?w:null,!f.m),0<f.O&&(f.M=new Go(T(f.Y,f,f.g),f.O)),w=f.U,b=f.g,A=f.ca;var G="readystatechange";Array.isArray(G)||(G&&(Ue[0]=G.toString()),G=Ue);for(var ee=0;ee<G.length;ee++){var me=Ir(b,G[ee],A||w.handleEvent,!1,w.h||w);if(!me)break;w.g[me.key]=me}w=f.H?R(f.H):{},f.m?(f.u||(f.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,w)):(f.u="GET",f.g.ea(f.A,f.u,null,w)),Ar(),Qo(f.i,f.u,f.A,f.l,f.R,f.m)}hi.prototype.ca=function(f){f=f.target;const w=this.M;w&&Xn(f)==3?w.j():this.Y(f)},hi.prototype.Y=function(f){try{if(f==this.g)e:{const bn=Xn(this.g);var w=this.g.Ba();const Da=this.g.Z();if(!(3>bn)&&(bn!=3||this.g&&(this.h.h||this.g.oa()||tl(this.g)))){this.J||bn!=4||w==7||(w==8||0>=Da?Ar(3):Ar(2)),fc(this);var b=this.g.Z();this.X=b;t:if(As(this)){var A=tl(this.g);f="";var G=A.length,ee=Xn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Wn(this),va(this);var me="";break t}this.h.i=new h.TextDecoder}for(w=0;w<G;w++)this.h.h=!0,f+=this.h.i.decode(A[w],{stream:!(ee&&w==G-1)});A.length=0,this.h.g+=f,this.C=0,me=this.h.g}else me=this.g.oa();if(this.o=b==200,ya(this.i,this.u,this.A,this.l,this.R,bn,b),this.o){if(this.T&&!this.K){t:{if(this.g){var ut,on=this.g;if((ut=on.g?on.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(ut)){var Be=ut;break t}}Be=null}if(b=Be)nr(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zr(this,b);else{this.o=!1,this.s=3,pn(12),Wn(this),va(this);break e}}if(this.P){b=!0;let fi;for(;!this.J&&this.C<me.length;)if(fi=Yo(this,me),fi==Is){bn==4&&(this.s=4,pn(14),b=!1),nr(this.i,this.l,null,"[Incomplete Response]");break}else if(fi==Ts){this.s=4,pn(15),nr(this.i,this.l,me,"[Invalid Chunk]"),b=!1;break}else nr(this.i,this.l,fi,null),zr(this,fi);if(As(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bn!=4||me.length!=0||this.h.h||(this.s=1,pn(16),b=!1),this.o=this.o&&b,!b)nr(this.i,this.l,me,"[Invalid Chunked Response]"),Wn(this),va(this);else if(0<me.length&&!this.W){this.W=!0;var En=this.j;En.g==this&&En.ba&&!En.M&&(En.j.info("Great, no buffering proxy detected. Bytes received: "+me.length),Ih(En),En.M=!0,pn(11))}}else nr(this.i,this.l,me,null),zr(this,me);bn==4&&Wn(this),this.o&&!this.J&&(bn==4?ym(this.j,this):(this.o=!1,Rr(this)))}else dm(this.g),b==400&&0<me.indexOf("Unknown SID")?(this.s=3,pn(12)):(this.s=0,pn(13)),Wn(this),va(this)}}}catch{}finally{}};function As(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Yo(f,w){var b=f.C,A=w.indexOf(`
`,b);return A==-1?Is:(b=Number(w.substring(b,A)),isNaN(b)?Ts:(A+=1,A+b>w.length?Is:(w=w.slice(A,A+b),f.C=A+b,w)))}hi.prototype.cancel=function(){this.J=!0,Wn(this)};function Rr(f){f.S=Date.now()+f.I,en(f,f.I)}function en(f,w){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Cr(T(f.ba,f),w)}function fc(f){f.B&&(h.clearTimeout(f.B),f.B=null)}hi.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?($o(this.i,this.A),this.L!=2&&(Ar(),pn(17)),Wn(this),this.s=2,va(this)):en(this,this.S-f)};function va(f){f.j.G==0||f.J||ym(f.j,f)}function Wn(f){fc(f);var w=f.M;w&&typeof w.ma=="function"&&w.ma(),f.M=null,an(f.U),f.g&&(w=f.g,f.g=null,w.abort(),w.ma())}function zr(f,w){try{var b=f.j;if(b.G!=0&&(b.g==f||wa(b.h,f))){if(!f.K&&wa(b.h,f)&&b.G==3){try{var A=b.Da.g.parse(w)}catch{A=null}if(Array.isArray(A)&&A.length==3){var G=A;if(G[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<f.F)Ra(b),Ca(b);else break e;Th(b),pn(18)}}else b.za=G[1],0<b.za-b.T&&37500>G[2]&&b.F&&b.v==0&&!b.C&&(b.C=Cr(T(b.Za,b),6e3));if(1>=am(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else Ns(b,11)}else if((f.K||b.g==f)&&Ra(b),!j(w))for(G=b.Da.g.parse(w),w=0;w<G.length;w++){let Be=G[w];if(b.T=Be[0],Be=Be[1],b.G==2)if(Be[0]=="c"){b.K=Be[1],b.ia=Be[2];const En=Be[3];En!=null&&(b.la=En,b.j.info("VER="+b.la));const bn=Be[4];bn!=null&&(b.Aa=bn,b.j.info("SVER="+b.Aa));const Da=Be[5];Da!=null&&typeof Da=="number"&&0<Da&&(A=1.5*Da,b.L=A,b.j.info("backChannelRequestTimeoutMs_="+A)),A=b;const fi=f.g;if(fi){const rl=fi.g?fi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rl){var ee=A.h;ee.g||rl.indexOf("spdy")==-1&&rl.indexOf("quic")==-1&&rl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Ea(ee,ee.h),ee.h=null))}if(A.D){const Ds=fi.g?fi.g.getResponseHeader("X-HTTP-Session-Id"):null;Ds&&(A.ya=Ds,rt(A.I,A.D,Ds))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-f.F,b.j.info("Handshake RTT: "+b.R+"ms")),A=b;var me=f;if(A.qa=wm(A,A.J?A.ia:null,A.W),me.K){ir(A.h,me);var ut=me,on=A.L;on&&(ut.I=on),ut.B&&(fc(ut),Rr(ut)),A.g=me}else gm(A);0<b.i.length&&Ec(b)}else Be[0]!="stop"&&Be[0]!="close"||Ns(b,7);else b.G==3&&(Be[0]=="stop"||Be[0]=="close"?Be[0]=="stop"?Ns(b,7):Eh(b):Be[0]!="noop"&&b.l&&b.l.ta(Be),b.v=0)}}Ar(4)}catch{}}var z_=class{constructor(f,w){this.g=f,this.map=w}};function mh(f){this.l=f||10,h.PerformanceNavigationTiming?(f=h.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ph(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function am(f){return f.h?1:f.g?f.g.size:0}function wa(f,w){return f.h?f.h==w:f.g?f.g.has(w):!1}function Ea(f,w){f.g?f.g.add(w):f.h=w}function ir(f,w){f.h&&f.h==w?f.h=null:f.g&&f.g.has(w)&&f.g.delete(w)}mh.prototype.cancel=function(){if(this.i=Yn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Yn(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let w=f.i;for(const b of f.g.values())w=w.concat(b.D);return w}return M(f.i)}function om(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(d(f)){for(var w=[],b=f.length,A=0;A<b;A++)w.push(f[A]);return w}w=[],b=0;for(A in f)w[b++]=f[A];return w}function q_(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(d(f)||typeof f=="string"){var w=[];f=f.length;for(var b=0;b<f;b++)w.push(b);return w}w=[],b=0;for(const A in f)w[b++]=A;return w}}}function mc(f,w){if(f.forEach&&typeof f.forEach=="function")f.forEach(w,void 0);else if(d(f)||typeof f=="string")Array.prototype.forEach.call(f,w,void 0);else for(var b=q_(f),A=om(f),G=A.length,ee=0;ee<G;ee++)w.call(void 0,A[ee],b&&b[ee],f)}var gh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pc(f,w){if(f){f=f.split("&");for(var b=0;b<f.length;b++){var A=f[b].indexOf("="),G=null;if(0<=A){var ee=f[b].substring(0,A);G=f[b].substring(A+1)}else ee=f[b];w(ee,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function xs(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof xs){this.h=f.h,ba(this,f.j),this.o=f.o,this.g=f.g,Xo(this,f.s),this.l=f.l;var w=f.i,b=new qr;b.i=w.i,w.g&&(b.g=new Map(w.g),b.h=w.h),gc(this,b),this.m=f.m}else f&&(w=String(f).match(gh))?(this.h=!1,ba(this,w[1]||"",!0),this.o=Ta(w[2]||""),this.g=Ta(w[3]||"",!0),Xo(this,w[4]),this.l=Ta(w[5]||"",!0),gc(this,w[6]||"",!0),this.m=Ta(w[7]||"")):(this.h=!1,this.i=new qr(null,this.h))}xs.prototype.toString=function(){var f=[],w=this.j;w&&f.push(rr(w,_h,!0),":");var b=this.g;return(b||w=="file")&&(f.push("//"),(w=this.o)&&f.push(rr(w,_h,!0),"@"),f.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&f.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&f.push("/"),f.push(rr(b,b.charAt(0)=="/"?yh:lm,!0))),(b=this.i.toString())&&f.push("?",b),(b=this.m)&&f.push("#",rr(b,K_)),f.join("")};function Ht(f){return new xs(f)}function ba(f,w,b){f.j=b?Ta(w,!0):w,f.j&&(f.j=f.j.replace(/:$/,""))}function Xo(f,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);f.s=w}else f.s=null}function gc(f,w,b){w instanceof qr?(f.i=w,cm(f.i,f.h)):(b||(w=rr(w,H_)),f.i=new qr(w,f.h))}function rt(f,w,b){f.i.set(w,b)}function Jo(f){return rt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Ta(f,w){return f?w?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function rr(f,w,b){return typeof f=="string"?(f=encodeURI(f).replace(w,G_),b&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function G_(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var _h=/[#\/\?@]/g,lm=/[#\?:]/g,yh=/[#\?]/g,H_=/[#\?@]/g,K_=/#/g;function qr(f,w){this.h=this.g=null,this.i=f||null,this.j=!!w}function wn(f){f.g||(f.g=new Map,f.h=0,f.i&&pc(f.i,function(w,b){f.add(decodeURIComponent(w.replace(/\+/g," ")),b)}))}n=qr.prototype,n.add=function(f,w){wn(this),this.i=null,f=Mi(this,f);var b=this.g.get(f);return b||this.g.set(f,b=[]),b.push(w),this.h+=1,this};function _c(f,w){wn(f),w=Mi(f,w),f.g.has(w)&&(f.i=null,f.h-=f.g.get(w).length,f.g.delete(w))}function yc(f,w){return wn(f),w=Mi(f,w),f.g.has(w)}n.forEach=function(f,w){wn(this),this.g.forEach(function(b,A){b.forEach(function(G){f.call(w,G,A,this)},this)},this)},n.na=function(){wn(this);const f=Array.from(this.g.values()),w=Array.from(this.g.keys()),b=[];for(let A=0;A<w.length;A++){const G=f[A];for(let ee=0;ee<G.length;ee++)b.push(w[A])}return b},n.V=function(f){wn(this);let w=[];if(typeof f=="string")yc(this,f)&&(w=w.concat(this.g.get(Mi(this,f))));else{f=Array.from(this.g.values());for(let b=0;b<f.length;b++)w=w.concat(f[b])}return w},n.set=function(f,w){return wn(this),this.i=null,f=Mi(this,f),yc(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[w]),this.h+=1,this},n.get=function(f,w){return f?(f=this.V(f),0<f.length?String(f[0]):w):w};function Cs(f,w,b){_c(f,w),0<b.length&&(f.i=null,f.g.set(Mi(f,w),M(b)),f.h+=b.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],w=Array.from(this.g.keys());for(var b=0;b<w.length;b++){var A=w[b];const ee=encodeURIComponent(String(A)),me=this.V(A);for(A=0;A<me.length;A++){var G=ee;me[A]!==""&&(G+="="+encodeURIComponent(String(me[A]))),f.push(G)}}return this.i=f.join("&")};function Mi(f,w){return w=String(w),f.j&&(w=w.toLowerCase()),w}function cm(f,w){w&&!f.j&&(wn(f),f.i=null,f.g.forEach(function(b,A){var G=A.toLowerCase();A!=G&&(_c(this,A),Cs(this,G,b))},f)),f.j=w}function vh(f,w){const b=new Br;if(h.Image){const A=new Image;A.onload=S(di,b,"TestLoadImage: loaded",!0,w,A),A.onerror=S(di,b,"TestLoadImage: error",!1,w,A),A.onabort=S(di,b,"TestLoadImage: abort",!1,w,A),A.ontimeout=S(di,b,"TestLoadImage: timeout",!1,w,A),h.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=f}else w(!1)}function um(f,w){const b=new Br,A=new AbortController,G=setTimeout(()=>{A.abort(),di(b,"TestPingServer: timeout",!1,w)},1e4);fetch(f,{signal:A.signal}).then(ee=>{clearTimeout(G),ee.ok?di(b,"TestPingServer: ok",!0,w):di(b,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(G),di(b,"TestPingServer: error",!1,w)})}function di(f,w,b,A,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),A(b)}catch{}}function Nr(){this.g=new fh}function wh(f,w,b){const A=b||"";try{mc(f,function(G,ee){let me=G;m(G)&&(me=qn(G)),w.push(A+ee+"="+encodeURIComponent(me))})}catch(G){throw w.push(A+"type="+encodeURIComponent("_badmap")),G}}function Gr(f){this.l=f.Ub||null,this.j=f.eb||!1}C(Gr,ga),Gr.prototype.g=function(){return new Vi(this.l,this.j)},Gr.prototype.i=(function(f){return function(){return f}})({});function Vi(f,w){xt.call(this),this.D=f,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Vi,xt),n=Vi.prototype,n.open=function(f,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=w,this.readyState=1,Ia(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(w.body=f),(this.D||h).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Hr(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Ia(this)),this.g&&(this.readyState=3,Ia(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vc(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function vc(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var w=f.value?f.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!f.done}))&&(this.response=this.responseText+=w)}f.done?Hr(this):Ia(this),this.readyState==3&&vc(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,Hr(this))},n.Qa=function(f){this.g&&(this.response=f,Hr(this))},n.ga=function(){this.g&&Hr(this)};function Hr(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Ia(f)}n.setRequestHeader=function(f,w){this.u.append(f,w)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],w=this.h.entries();for(var b=w.next();!b.done;)b=b.value,f.push(b[0]+": "+b[1]),b=w.next();return f.join(`\r
`)};function Ia(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Vi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Zo(f){let w="";return ae(f,function(b,A){w+=A,w+=":",w+=b,w+=`\r
`}),w}function Sa(f,w,b){e:{for(A in b){var A=!1;break e}A=!0}A||(b=Zo(b),typeof f=="string"?b!=null&&encodeURIComponent(String(b)):rt(f,w,b))}function Nt(f){xt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Nt,xt);var Gn=/^https?$/i,Rs=["POST","PUT"];n=Nt.prototype,n.Ha=function(f){this.J=f},n.ea=function(f,w,b,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);w=w?w.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$n.g(),this.v=this.o?Es(this.o):Es($n),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(w,String(f),!0),this.B=!1}catch(ee){el(this,ee);return}if(f=b||"",b=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var G in A)b.set(G,A[G]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ee of A.keys())b.set(ee,A.get(ee));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(b.keys()).find(ee=>ee.toLowerCase()=="content-type"),G=h.FormData&&f instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Rs,w,void 0))||A||G||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,me]of b)this.g.setRequestHeader(ee,me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{wc(this),this.u=!0,this.g.send(f),this.u=!1}catch(ee){el(this,ee)}};function el(f,w){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=w,f.m=5,Aa(f),xa(f)}function Aa(f){f.A||(f.A=!0,Tt(f,"complete"),Tt(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Tt(this,"complete"),Tt(this,"abort"),xa(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xa(this,!0)),Nt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?hm(this):this.bb())},n.bb=function(){hm(this)};function hm(f){if(f.h&&typeof c<"u"&&(!f.v[1]||Xn(f)!=4||f.Z()!=2)){if(f.u&&Xn(f)==4)dc(f.Ea,0,f);else if(Tt(f,"readystatechange"),Xn(f)==4){f.h=!1;try{const me=f.Z();e:switch(me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var b;if(!(b=w)){var A;if(A=me===0){var G=String(f.D).match(gh)[1]||null;!G&&h.self&&h.self.location&&(G=h.self.location.protocol.slice(0,-1)),A=!Gn.test(G?G.toLowerCase():"")}b=A}if(b)Tt(f,"complete"),Tt(f,"success");else{f.m=6;try{var ee=2<Xn(f)?f.g.statusText:""}catch{ee=""}f.l=ee+" ["+f.Z()+"]",Aa(f)}}finally{xa(f)}}}}function xa(f,w){if(f.g){wc(f);const b=f.g,A=f.v[0]?()=>{}:null;f.g=null,f.v=null,w||Tt(f,"ready");try{b.onreadystatechange=A}catch{}}}function wc(f){f.I&&(h.clearTimeout(f.I),f.I=null)}n.isActive=function(){return!!this.g};function Xn(f){return f.g?f.g.readyState:0}n.Z=function(){try{return 2<Xn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var w=this.g.responseText;return f&&w.indexOf(f)==0&&(w=w.substring(f.length)),Pn(w)}};function tl(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function dm(f){const w={};f=(f.g&&2<=Xn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<f.length;A++){if(j(f[A]))continue;var b=P(f[A]);const G=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const ee=w[G]||[];w[G]=ee,ee.push(b)}N(w,function(A){return A.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function nl(f,w,b){return b&&b.internalChannelParams&&b.internalChannelParams[f]||w}function fm(f){this.Aa=0,this.i=[],this.j=new Br,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=nl("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=nl("baseRetryDelayMs",5e3,f),this.cb=nl("retryDelaySeedMs",1e4,f),this.Wa=nl("forwardChannelMaxRetries",2,f),this.wa=nl("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new mh(f&&f.concurrentRequestLimit),this.Da=new Nr,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=fm.prototype,n.la=8,n.G=1,n.connect=function(f,w,b,A){pn(0),this.W=f,this.H=w||{},b&&A!==void 0&&(this.H.OSID=b,this.H.OAID=A),this.F=this.X,this.I=wm(this,null,this.W),Ec(this)};function Eh(f){if(mm(f),f.G==3){var w=f.U++,b=Ht(f.I);if(rt(b,"SID",f.K),rt(b,"RID",w),rt(b,"TYPE","terminate"),il(f,b),w=new hi(f,f.j,w),w.L=2,w.v=Jo(Ht(b)),b=!1,h.navigator&&h.navigator.sendBeacon)try{b=h.navigator.sendBeacon(w.v.toString(),"")}catch{}!b&&h.Image&&(new Image().src=w.v,b=!0),b||(w.g=Em(w.j,null),w.g.ea(w.v)),w.F=Date.now(),Rr(w)}Sh(f)}function Ca(f){f.g&&(Ih(f),f.g.cancel(),f.g=null)}function mm(f){Ca(f),f.u&&(h.clearTimeout(f.u),f.u=null),Ra(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&h.clearTimeout(f.s),f.s=null)}function Ec(f){if(!ph(f.h)&&!f.s){f.s=!0;var w=f.Ga;fe||Ee(),he||(fe(),he=!0),pe.add(w,f),f.B=0}}function Q_(f,w){return am(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=w.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Cr(T(f.Ga,f,w),vm(f,f.B)),f.B++,!0)}n.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const G=new hi(this,this.j,f);let ee=this.o;if(this.S&&(ee?(ee=R(ee),k(ee,this.S)):ee=this.S),this.m!==null||this.O||(G.H=ee,ee=null),this.P)e:{for(var w=0,b=0;b<this.i.length;b++){t:{var A=this.i[b];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(w+=A,4096<w){w=b;break e}if(w===4096||b===this.i.length-1){w=b+1;break e}}w=1e3}else w=1e3;w=bh(this,G,w),b=Ht(this.I),rt(b,"RID",f),rt(b,"CVER",22),this.D&&rt(b,"X-HTTP-Session-Id",this.D),il(this,b),ee&&(this.O?w="headers="+encodeURIComponent(String(Zo(ee)))+"&"+w:this.m&&Sa(b,this.m,ee)),Ea(this.h,G),this.Ua&&rt(b,"TYPE","init"),this.P?(rt(b,"$req",w),rt(b,"SID","null"),G.T=!0,Wo(G,b,null)):Wo(G,b,w),this.G=2}}else this.G==3&&(f?pm(this,f):this.i.length==0||ph(this.h)||pm(this))};function pm(f,w){var b;w?b=w.l:b=f.U++;const A=Ht(f.I);rt(A,"SID",f.K),rt(A,"RID",b),rt(A,"AID",f.T),il(f,A),f.m&&f.o&&Sa(A,f.m,f.o),b=new hi(f,f.j,b,f.B+1),f.m===null&&(b.H=f.o),w&&(f.i=w.D.concat(f.i)),w=bh(f,b,1e3),b.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ea(f.h,b),Wo(b,A,w)}function il(f,w){f.H&&ae(f.H,function(b,A){rt(w,A,b)}),f.l&&mc({},function(b,A){rt(w,A,b)})}function bh(f,w,b){b=Math.min(f.i.length,b);var A=f.l?T(f.l.Na,f.l,f):null;e:{var G=f.i;let ee=-1;for(;;){const me=["count="+b];ee==-1?0<b?(ee=G[0].g,me.push("ofs="+ee)):ee=0:me.push("ofs="+ee);let ut=!0;for(let on=0;on<b;on++){let Be=G[on].g;const En=G[on].map;if(Be-=ee,0>Be)ee=Math.max(0,G[on].g-100),ut=!1;else try{wh(En,me,"req"+Be+"_")}catch{A&&A(En)}}if(ut){A=me.join("&");break e}}}return f=f.i.splice(0,b),w.D=f,A}function gm(f){if(!f.g&&!f.u){f.Y=1;var w=f.Fa;fe||Ee(),he||(fe(),he=!0),pe.add(w,f),f.v=0}}function Th(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Cr(T(f.Fa,f),vm(f,f.v)),f.v++,!0)}n.Fa=function(){if(this.u=null,_m(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Cr(T(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pn(10),Ca(this),_m(this))};function Ih(f){f.A!=null&&(h.clearTimeout(f.A),f.A=null)}function _m(f){f.g=new hi(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var w=Ht(f.qa);rt(w,"RID","rpc"),rt(w,"SID",f.K),rt(w,"AID",f.T),rt(w,"CI",f.F?"0":"1"),!f.F&&f.ja&&rt(w,"TO",f.ja),rt(w,"TYPE","xmlhttp"),il(f,w),f.m&&f.o&&Sa(w,f.m,f.o),f.L&&(f.g.I=f.L);var b=f.g;f=f.ia,b.L=1,b.v=Jo(Ht(w)),b.m=null,b.P=!0,Ss(b,f)}n.Za=function(){this.C!=null&&(this.C=null,Ca(this),Th(this),pn(19))};function Ra(f){f.C!=null&&(h.clearTimeout(f.C),f.C=null)}function ym(f,w){var b=null;if(f.g==w){Ra(f),Ih(f),f.g=null;var A=2}else if(wa(f.h,w))b=w.D,ir(f.h,w),A=1;else return;if(f.G!=0){if(w.o)if(A==1){b=w.m?w.m.length:0,w=Date.now()-w.F;var G=f.B;A=_a(),Tt(A,new Ko(A,b)),Ec(f)}else gm(f);else if(G=w.s,G==3||G==0&&0<w.X||!(A==1&&Q_(f,w)||A==2&&Th(f)))switch(b&&0<b.length&&(w=f.h,w.i=w.i.concat(b)),G){case 1:Ns(f,5);break;case 4:Ns(f,10);break;case 3:Ns(f,6);break;default:Ns(f,2)}}}function vm(f,w){let b=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(b*=2),b*w}function Ns(f,w){if(f.j.info("Error code "+w),w==2){var b=T(f.fb,f),A=f.Xa;const G=!A;A=new xs(A||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||ba(A,"https"),Jo(A),G?vh(A.toString(),b):um(A.toString(),b)}else pn(2);f.G=0,f.l&&f.l.sa(w),Sh(f),mm(f)}n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),pn(2)):(this.j.info("Failed to ping google.com"),pn(1))};function Sh(f){if(f.G=0,f.ka=[],f.l){const w=Yn(f.h);(w.length!=0||f.i.length!=0)&&(q(f.ka,w),q(f.ka,f.i),f.h.i.length=0,M(f.i),f.i.length=0),f.l.ra()}}function wm(f,w,b){var A=b instanceof xs?Ht(b):new xs(b);if(A.g!="")w&&(A.g=w+"."+A.g),Xo(A,A.s);else{var G=h.location;A=G.protocol,w=w?w+"."+G.hostname:G.hostname,G=+G.port;var ee=new xs(null);A&&ba(ee,A),w&&(ee.g=w),G&&Xo(ee,G),b&&(ee.l=b),A=ee}return b=f.D,w=f.ya,b&&w&&rt(A,b,w),rt(A,"VER",f.la),il(f,A),A}function Em(f,w,b){if(w&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=f.Ca&&!f.pa?new Nt(new Gr({eb:b})):new Nt(f.pa),w.Ha(f.J),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bm(){}n=bm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function bc(){}bc.prototype.g=function(f,w){return new Jn(f,w)};function Jn(f,w){xt.call(this),this.g=new fm(w),this.l=f,this.h=w&&w.messageUrlParams||null,f=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(f?f["X-WebChannel-Content-Type"]=w.messageContentType:f={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(f?f["X-WebChannel-Client-Profile"]=w.va:f={"X-WebChannel-Client-Profile":w.va}),this.g.S=f,(f=w&&w.Sb)&&!j(f)&&(this.g.m=f),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!j(w)&&(this.g.D=w,f=this.h,f!==null&&w in f&&(f=this.h,w in f&&delete f[w])),this.j=new Na(this)}C(Jn,xt),Jn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jn.prototype.close=function(){Eh(this.g)},Jn.prototype.o=function(f){var w=this.g;if(typeof f=="string"){var b={};b.__data__=f,f=b}else this.u&&(b={},b.__data__=qn(f),f=b);w.i.push(new z_(w.Ya++,f)),w.G==3&&Ec(w)},Jn.prototype.N=function(){this.g.l=null,delete this.j,Eh(this.g),delete this.g,Jn.aa.N.call(this)};function Tm(f){Ur.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var w=f.__sm__;if(w){e:{for(const b in w){f=b;break e}f=void 0}(this.i=f)&&(f=this.i,w=w!==null&&f in w?w[f]:void 0),this.data=w}else this.data=f}C(Tm,Ur);function Im(){Oi.call(this),this.status=1}C(Im,Oi);function Na(f){this.g=f}C(Na,bm),Na.prototype.ua=function(){Tt(this.g,"a")},Na.prototype.ta=function(f){Tt(this.g,new Tm(f))},Na.prototype.sa=function(f){Tt(this.g,new Im)},Na.prototype.ra=function(){Tt(this.g,"b")},bc.prototype.createWebChannel=bc.prototype.g,Jn.prototype.send=Jn.prototype.o,Jn.prototype.open=Jn.prototype.m,Jn.prototype.close=Jn.prototype.close,GR=function(){return new bc},qR=function(){return _a()},zR=ui,D0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ke.NO_ERROR=0,ke.TIMEOUT=8,ke.HTTP_ERROR=6,zp=ke,Ft.COMPLETE="complete",BR=Ft,tr.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",xt.prototype.listen=xt.prototype.K,Ad=tr,Nt.prototype.listenOnce=Nt.prototype.L,Nt.prototype.getLastError=Nt.prototype.Ka,Nt.prototype.getLastErrorCode=Nt.prototype.Ba,Nt.prototype.getStatus=Nt.prototype.Z,Nt.prototype.getResponseJson=Nt.prototype.Oa,Nt.prototype.getResponseText=Nt.prototype.oa,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Ha,FR=Nt}).apply(typeof Rp<"u"?Rp:typeof self<"u"?self:typeof window<"u"?window:{});const $A="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xn.UNAUTHENTICATED=new xn(null),xn.GOOGLE_CREDENTIALS=new xn("google-credentials-uid"),xn.FIRST_PARTY=new xn("first-party-uid"),xn.MOCK_USER=new xn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ju="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=new Qu("@firebase/firestore");function iu(){return bo.logLevel}function V3(n){bo.setLogLevel(n)}function le(n,...e){if(bo.logLevel<=Ge.DEBUG){const t=e.map(nE);bo.debug(`Firestore (${Ju}): ${n}`,...t)}}function rn(n,...e){if(bo.logLevel<=Ge.ERROR){const t=e.map(nE);bo.error(`Firestore (${Ju}): ${n}`,...t)}}function hs(n,...e){if(bo.logLevel<=Ge.WARN){const t=e.map(nE);bo.warn(`Firestore (${Ju}): ${n}`,...t)}}function nE(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(n="Unexpected state"){const e=`FIRESTORE (${Ju}) INTERNAL ASSERTION FAILED: `+n;throw rn(e),new Error(e)}function Te(n,e){n||we()}function L3(n,e){n||we()}function _e(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends ri{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class j3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(xn.UNAUTHENTICATED)))}shutdown(){}}class U3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class F3{constructor(e){this.t=e,this.currentUser=xn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Te(this.o===void 0);let i=this.i;const s=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve();let o=new Bn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Bn,e.enqueueRetryable((()=>s(this.currentUser)))};const c=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},h=d=>{le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((d=>h(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(le("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Bn)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Te(typeof i.accessToken=="string"),new HR(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new xn(e)}}class B3{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=xn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class z3{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new B3(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(xn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class q3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Te(this.o===void 0);const i=o=>{o.error!=null&&le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.R;return this.R=o.token,le("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const s=o=>{le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?s(o):le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Te(typeof t.token=="string"),this.R=t.token,new q3(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const s=H3(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%e.length))}return i}}function Me(n,e){return n<e?-1:n>e?1:0}function Au(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}function QR(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new oe(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new oe(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new oe(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ut.fromMillis(Date.now())}static fromDate(e){return Ut.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Ut(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Se(e)}static min(){return new Se(new Ut(0,0))}static max(){return new Se(new Ut(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,t,i){t===void 0?t=0:t>e.length&&we(),i===void 0?i=e.length-t:i>e.length-t&&we(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return rf.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof rf?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=e.get(s),c=t.get(s);if(o<c)return-1;if(o>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ye extends rf{construct(e,t,i){return new Ye(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new oe(J.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new Ye(t)}static emptyPath(){return new Ye([])}}const K3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vt extends rf{construct(e,t,i){return new Vt(e,t,i)}static isValidIdentifier(e){return K3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Vt(["__name__"])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new oe(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new oe(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new oe(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,s+=2}else h==="`"?(c=!c,s++):h!=="."||c?(i+=h,s++):(o(),s++)}if(o(),c)throw new oe(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vt(t)}static emptyPath(){return new Vt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.path=e}static fromPath(e){return new ge(Ye.fromString(e))}static fromName(e){return new ge(Ye.fromString(e).popFirst(5))}static empty(){return new ge(Ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ge(new Ye(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function k0(n){return n.fields.find((e=>e.kind===2))}function Tl(n){return n.fields.filter((e=>e.kind!==2))}og.UNKNOWN_ID=-1;class qp{constructor(e,t){this.fieldPath=e,this.kind=t}}class sf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new sf(0,Ji.min())}}function $R(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=Se.fromTimestamp(i===1e9?new Ut(t+1,0):new Ut(t,i));return new Ji(s,ge.empty(),e)}function WR(n){return new Ji(n.readTime,n.key,-1)}class Ji{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ji(Se.min(),ge.empty(),-1)}static max(){return new Ji(Se.max(),ge.empty(),-1)}}function iE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ge.comparator(n.documentKey,e.documentKey),t!==0?t:Me(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jo(n){if(n.code!==J.FAILED_PRECONDITION||n.message!==YR)throw n;le("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $(((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof $?t:$.resolve(t)}catch(t){return $.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):$.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):$.reject(t)}static resolve(e){return new $(((t,i)=>{t(e)}))}static reject(e){return new $(((t,i)=>{i(e)}))}static waitFor(e){return new $(((t,i)=>{let s=0,o=0,c=!1;e.forEach((h=>{++s,h.next((()=>{++o,c&&o===s&&t()}),(d=>i(d)))})),c=!0,o===s&&t()}))}static or(e){let t=$.resolve(!1);for(const i of e)t=t.next((s=>s?$.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,o)=>{i.push(t.call(this,s,o))})),this.waitFor(i)}static mapArray(e,t){return new $(((i,s)=>{const o=e.length,c=new Array(o);let h=0;for(let d=0;d<o;d++){const m=d;t(e[m]).next((_=>{c[m]=_,++h,h===o&&i(c)}),(_=>s(_)))}}))}static doWhile(e,t){return new $(((i,s)=>{const o=()=>{e()===!0?t().next((()=>{o()}),s):i()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Bn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Od(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{const s=rE(i.target.error);this.V.reject(new Od(e,s))}}static open(e,t,i,s){try{return new Zg(t,e.transaction(s,i))}catch(o){throw new Od(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(le("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new $3(t)}}class as{constructor(e,t,i){this.name=e,this.version=t,this.p=i,as.S(qt())===12.2&&rn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return le("SimpleDb","Removing database:",e),Sl(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Wd())return!1;if(as.v())return!0;const e=qt(),t=as.S(e),i=0<t&&t<10,s=JR(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}async M(e){return this.db||(le("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const c=o.target.result;t(c)},s.onblocked=()=>{i(new Od(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const c=o.target.error;c.name==="VersionError"?i(new oe(J.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?i(new oe(J.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):i(new Od(e,c))},s.onupgradeneeded=o=>{le("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const c=o.target.result;this.p.O(c,s.transaction,o.oldVersion,this.version).next((()=>{le("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const o=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.M(e);const h=Zg.open(this.db,e,o?"readonly":"readwrite",i),d=s(h).next((m=>(h.g(),m))).catch((m=>(h.abort(m),$.reject(m)))).toPromise();return d.catch((()=>{})),await h.m,d}catch(h){const d=h,m=d.name!=="FirebaseError"&&c<3;if(le("SimpleDb","Transaction failed with error:",d.message,"Retrying:",m),this.close(),!m)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function JR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Q3{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Sl(this.B.delete())}}class Od extends oe{constructor(e,t){super(J.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Uo(n){return n.name==="IndexedDbTransactionError"}class $3{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(le("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(le("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Sl(i)}add(e){return le("SimpleDb","ADD",this.store.name,e,e),Sl(this.store.add(e))}get(e){return Sl(this.store.get(e)).next((t=>(t===void 0&&(t=null),le("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return le("SimpleDb","DELETE",this.store.name,e),Sl(this.store.delete(e))}count(){return le("SimpleDb","COUNT",this.store.name),Sl(this.store.count())}U(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(i.range);return new $(((c,h)=>{o.onerror=d=>{h(d.target.error)},o.onsuccess=d=>{c(d.target.result)}}))}{const o=this.cursor(i),c=[];return this.W(o,((h,d)=>{c.push(d)})).next((()=>c))}}G(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new $(((s,o)=>{i.onerror=c=>{o(c.target.error)},i.onsuccess=c=>{s(c.target.result)}}))}j(e,t){le("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.H=!1;const s=this.cursor(i);return this.W(s,((o,c,h)=>h.delete()))}J(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.W(s,t)}Y(e){const t=this.cursor({});return new $(((i,s)=>{t.onerror=o=>{const c=rE(o.target.error);s(c)},t.onsuccess=o=>{const c=o.target.result;c?e(c.primaryKey,c.value).next((h=>{h?c.continue():i()})):i()}}))}W(e,t){const i=[];return new $(((s,o)=>{e.onerror=c=>{o(c.target.error)},e.onsuccess=c=>{const h=c.target.result;if(!h)return void s();const d=new Q3(h),m=t(h.primaryKey,h.value,d);if(m instanceof $){const _=m.catch((y=>(d.done(),$.reject(y))));i.push(_)}d.isDone?s():d.K===null?h.continue():h.continue(d.K)}})).next((()=>$.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.H?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Sl(n){return new $(((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=rE(i.target.error);t(s)}}))}let WA=!1;function rE(n){const e=as.S(qt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new oe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return WA||(WA=!0,setTimeout((()=>{throw i}),0)),i}}return n}class W3{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){le("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{le("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Uo(t)?le("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await jo(t)}await this.X(6e4)}))}}class Y3{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const i=new Set;let s=t,o=!0;return $.doWhile((()=>o===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!i.has(c))return le("IndexBackfiller",`Processing collection: ${c}`),this.ne(e,c,s).next((h=>{s-=h,i.add(c)}));o=!1})))).next((()=>t-s))}ne(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next((o=>{const c=o.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this.re(s,o))).next((h=>(le("IndexBackfiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>c.size))}))))}re(e,t){let i=e;return t.changes.forEach(((s,o)=>{const c=WR(o);iE(c,i)>0&&(i=c)})),new Ji(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}bi.oe=-1;function Lf(n){return n==null}function af(n){return n===0&&1/n==-1/0}function ZR(n){return typeof n=="number"&&Number.isInteger(n)&&!af(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=YA(e)),e=X3(n.get(t),e);return YA(e)}function X3(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const o=n.charAt(s);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function YA(n){return n+""}function rs(n){const e=n.length;if(Te(e>=2),e===2)return Te(n.charAt(0)===""&&n.charAt(1)===""),Ye.emptyPath();const t=e-2,i=[];let s="";for(let o=0;o<e;){const c=n.indexOf("",o);switch((c<0||c>t)&&we(),n.charAt(c+1)){case"":const h=n.substring(o,c);let d;s.length===0?d=h:(s+=h,d=s,s=""),i.push(d);break;case"":s+=n.substring(o,c),s+="\0";break;case"":s+=n.substring(o,c+1);break;default:we()}o=c+2}return new Ye(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(n,e){return[n,si(e)]}function eN(n,e,t){return[n,si(e),t]}const J3={},Z3=["prefixPath","collectionGroup","readTime","documentId"],eU=["prefixPath","collectionGroup","documentId"],tU=["collectionGroup","readTime","prefixPath","documentId"],nU=["canonicalId","targetId"],iU=["targetId","path"],rU=["path","targetId"],sU=["collectionId","parent"],aU=["indexId","uid"],oU=["uid","sequenceNumber"],lU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],cU=["indexId","uid","orderedDocumentKey"],uU=["userId","collectionPath","documentId"],hU=["userId","collectionPath","largestBatchId"],dU=["userId","collectionGroup","largestBatchId"],tN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],fU=[...tN,"documentOverlays"],nN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],iN=nN,sE=[...iN,"indexConfiguration","indexState","indexEntries"],mU=sE,pU=[...sE,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends XR{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function vn(n,e){const t=_e(n);return as.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ic(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gt=class P0{constructor(e,t){this.comparator=e,this.root=t||fo.EMPTY}insert(e,t){return new P0(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fo.BLACK,null,null))}remove(e){return new P0(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Np(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Np(this.root,e,this.comparator,!1)}getReverseIterator(){return new Np(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Np(this.root,e,this.comparator,!0)}},Np=class{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},fo=class Qs{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??Qs.RED,this.left=s??Qs.EMPTY,this.right=o??Qs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new Qs(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Qs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Qs.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw we();const e=this.left.check();if(e!==this.right.check())throw we();return e+(this.isRed()?0:1)}};fo.EMPTY=null,fo.RED=!0,fo.BLACK=!1;fo.EMPTY=new class{constructor(){this.size=0}get key(){throw we()}get value(){throw we()}get color(){throw we()}get left(){throw we()}get right(){throw we()}copy(e,t,i,s,o){return this}insert(e,t,i){return new fo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.comparator=e,this.data=new Gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ZA(this.data.getIterator())}getIteratorFrom(e){return new ZA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof wt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new wt(this.comparator);return t.data=e,t}}class ZA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Jc(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.fields=e,e.sort(Vt.comparator)}static empty(){return new Ti([])}unionWith(e){let t=new wt(Vt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ti(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Au(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gU(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new sN("Invalid base64 string: "+o):o}})(e);return new Yt(t)}static fromUint8Array(e){const t=(function(s){let o="";for(let c=0;c<s.length;++c)o+=String.fromCharCode(s[c]);return o})(e);return new Yt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yt.EMPTY_BYTE_STRING=new Yt("");const _U=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ia(n){if(Te(!!n),typeof n=="string"){let e=0;const t=_U.exec(n);if(Te(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mt(n.seconds),nanos:Mt(n.nanos)}}function Mt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function To(n){return typeof n=="string"?Yt.fromBase64String(n):Yt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function aE(n){const e=n.mapValue.fields.__previous_value__;return e_(e)?aE(e):e}function of(n){const e=ia(n.mapValue.fields.__local_write_time__.timestampValue);return new Ut(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,t,i,s,o,c,h,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=m}}class Io{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Io("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Io&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Hp={nullValue:"NULL_VALUE"};function Bl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?e_(n)?4:aN(n)?9007199254740991:t_(n)?10:11:we()}function ds(n,e){if(n===e)return!0;const t=Bl(n);if(t!==Bl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return of(n).isEqual(of(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const c=ia(s.timestampValue),h=ia(o.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,o){return To(s.bytesValue).isEqual(To(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,o){return Mt(s.geoPointValue.latitude)===Mt(o.geoPointValue.latitude)&&Mt(s.geoPointValue.longitude)===Mt(o.geoPointValue.longitude)})(n,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return Mt(s.integerValue)===Mt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const c=Mt(s.doubleValue),h=Mt(o.doubleValue);return c===h?af(c)===af(h):isNaN(c)&&isNaN(h)}return!1})(n,e);case 9:return Au(n.arrayValue.values||[],e.arrayValue.values||[],ds);case 10:case 11:return(function(s,o){const c=s.mapValue.fields||{},h=o.mapValue.fields||{};if(JA(c)!==JA(h))return!1;for(const d in c)if(c.hasOwnProperty(d)&&(h[d]===void 0||!ds(c[d],h[d])))return!1;return!0})(n,e);default:return we()}}function lf(n,e){return(n.values||[]).find((t=>ds(t,e)))!==void 0}function So(n,e){if(n===e)return 0;const t=Bl(n),i=Bl(e);if(t!==i)return Me(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(n.booleanValue,e.booleanValue);case 2:return(function(o,c){const h=Mt(o.integerValue||o.doubleValue),d=Mt(c.integerValue||c.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1})(n,e);case 3:return ex(n.timestampValue,e.timestampValue);case 4:return ex(of(n),of(e));case 5:return Me(n.stringValue,e.stringValue);case 6:return(function(o,c){const h=To(o),d=To(c);return h.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){const h=o.split("/"),d=c.split("/");for(let m=0;m<h.length&&m<d.length;m++){const _=Me(h[m],d[m]);if(_!==0)return _}return Me(h.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){const h=Me(Mt(o.latitude),Mt(c.latitude));return h!==0?h:Me(Mt(o.longitude),Mt(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return tx(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var h,d,m,_;const y=o.fields||{},T=c.fields||{},S=(h=y.value)===null||h===void 0?void 0:h.arrayValue,C=(d=T.value)===null||d===void 0?void 0:d.arrayValue,M=Me(((m=S==null?void 0:S.values)===null||m===void 0?void 0:m.length)||0,((_=C==null?void 0:C.values)===null||_===void 0?void 0:_.length)||0);return M!==0?M:tx(S,C)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===ao.mapValue&&c===ao.mapValue)return 0;if(o===ao.mapValue)return 1;if(c===ao.mapValue)return-1;const h=o.fields||{},d=Object.keys(h),m=c.fields||{},_=Object.keys(m);d.sort(),_.sort();for(let y=0;y<d.length&&y<_.length;++y){const T=Me(d[y],_[y]);if(T!==0)return T;const S=So(h[d[y]],m[_[y]]);if(S!==0)return S}return Me(d.length,_.length)})(n.mapValue,e.mapValue);default:throw we()}}function ex(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Me(n,e);const t=ia(n),i=ia(e),s=Me(t.seconds,i.seconds);return s!==0?s:Me(t.nanos,i.nanos)}function tx(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const o=So(t[s],i[s]);if(o)return o}return Me(t.length,i.length)}function xu(n){return M0(n)}function M0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ia(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return To(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ge.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const o of t.values||[])s?s=!1:i+=",",i+=M0(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const c of i)o?o=!1:s+=",",s+=`${c}:${M0(t.fields[c])}`;return s+"}"})(n.mapValue):we()}function zl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function V0(n){return!!n&&"integerValue"in n}function cf(n){return!!n&&"arrayValue"in n}function nx(n){return!!n&&"nullValue"in n}function ix(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Kp(n){return!!n&&"mapValue"in n}function t_(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Pd(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ic(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Pd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Pd(n.arrayValue.values[t]);return e}return Object.assign({},n)}function aN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const oN={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function vU(n){return"nullValue"in n?Hp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?zl(Io.empty(),ge.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?t_(n)?oN:{mapValue:{}}:we()}function wU(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?zl(Io.empty(),ge.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?oN:"mapValue"in n?t_(n)?{mapValue:{}}:ao:we()}function rx(n,e){const t=So(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function sx(n,e){const t=So(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.value=e}static empty(){return new Fn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Kp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pd(t)}setAll(e){let t=Vt.emptyPath(),i={},s=[];e.forEach(((c,h)=>{if(!t.isImmediateParentOf(h)){const d=this.getFieldsMap(t);this.applyChanges(d,i,s),i={},s=[],t=h.popLast()}c?i[h.lastSegment()]=Pd(c):s.push(h.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){const t=this.field(e.popLast());Kp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ds(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Kp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){ic(t,((s,o)=>e[s]=o));for(const s of i)delete e[s]}clone(){return new Fn(Pd(this.value))}}function lN(n){const e=[];return ic(n.fields,((t,i)=>{const s=new Vt([t]);if(Kp(i)){const o=lN(i.mapValue).fields;if(o.length===0)e.push(s);else for(const c of o)e.push(s.child(c))}else e.push(s)})),new Ti(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e,t,i,s,o,c,h){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=c,this.documentState=h}static newInvalidDocument(e){return new Ot(e,0,Se.min(),Se.min(),Se.min(),Fn.empty(),0)}static newFoundDocument(e,t,i,s){return new Ot(e,1,t,Se.min(),i,s,0)}static newNoDocument(e,t){return new Ot(e,2,t,Se.min(),Se.min(),Fn.empty(),0)}static newUnknownDocument(e,t){return new Ot(e,3,t,Se.min(),Se.min(),Fn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ot&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ot(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t){this.position=e,this.inclusive=t}}function ax(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const o=e[s],c=n.position[s];if(o.field.isKeyField()?i=ge.comparator(ge.fromName(c.referenceValue),t.key):i=So(c,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function ox(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ds(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t="asc"){this.field=e,this.dir=t}}function EU(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{}class Xe extends cN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new bU(e,t,i):t==="array-contains"?new SU(e,i):t==="in"?new pN(e,i):t==="not-in"?new AU(e,i):t==="array-contains-any"?new xU(e,i):new Xe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new TU(e,i):new IU(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(So(t,this.value)):t!==null&&Bl(this.value)===Bl(t)&&this.matchesComparison(So(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mt extends cN{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new mt(e,t)}matches(e){return Cu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Cu(n){return n.op==="and"}function L0(n){return n.op==="or"}function oE(n){return uN(n)&&Cu(n)}function uN(n){for(const e of n.filters)if(e instanceof mt)return!1;return!0}function j0(n){if(n instanceof Xe)return n.field.canonicalString()+n.op.toString()+xu(n.value);if(oE(n))return n.filters.map((e=>j0(e))).join(",");{const e=n.filters.map((t=>j0(t))).join(",");return`${n.op}(${e})`}}function hN(n,e){return n instanceof Xe?(function(i,s){return s instanceof Xe&&i.op===s.op&&i.field.isEqual(s.field)&&ds(i.value,s.value)})(n,e):n instanceof mt?(function(i,s){return s instanceof mt&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((o,c,h)=>o&&hN(c,s.filters[h])),!0):!1})(n,e):void we()}function dN(n,e){const t=n.filters.concat(e);return mt.create(t,n.op)}function fN(n){return n instanceof Xe?(function(t){return`${t.field.canonicalString()} ${t.op} ${xu(t.value)}`})(n):n instanceof mt?(function(t){return t.op.toString()+" {"+t.getFilters().map(fN).join(" ,")+"}"})(n):"Filter"}class bU extends Xe{constructor(e,t,i){super(e,t,i),this.key=ge.fromName(i.referenceValue)}matches(e){const t=ge.comparator(e.key,this.key);return this.matchesComparison(t)}}class TU extends Xe{constructor(e,t){super(e,"in",t),this.keys=mN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class IU extends Xe{constructor(e,t){super(e,"not-in",t),this.keys=mN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function mN(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((i=>ge.fromName(i.referenceValue)))}class SU extends Xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cf(t)&&lf(t.arrayValue,this.value)}}class pN extends Xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&lf(this.value.arrayValue,t)}}class AU extends Xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(lf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!lf(this.value.arrayValue,t)}}class xU extends Xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>lf(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CU{constructor(e,t=null,i=[],s=[],o=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=c,this.endAt=h,this.ue=null}}function U0(n,e=null,t=[],i=[],s=null,o=null,c=null){return new CU(n,e,t,i,s,o,c)}function ql(n){const e=_e(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>j0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(o){return o.field.canonicalString()+o.dir})(i))).join(","),Lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>xu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>xu(i))).join(",")),e.ue=t}return e.ue}function jf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!EU(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!hN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ox(n.startAt,e.startAt)&&ox(n.endAt,e.endAt)}function lg(n){return ge.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function cg(n,e){return n.filters.filter((t=>t instanceof Xe&&t.field.isEqual(e)))}function lx(n,e,t){let i=Hp,s=!0;for(const o of cg(n,e)){let c=Hp,h=!0;switch(o.op){case"<":case"<=":c=vU(o.value);break;case"==":case"in":case">=":c=o.value;break;case">":c=o.value,h=!1;break;case"!=":case"not-in":c=Hp}rx({value:i,inclusive:s},{value:c,inclusive:h})<0&&(i=c,s=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];rx({value:i,inclusive:s},{value:c,inclusive:t.inclusive})<0&&(i=c,s=t.inclusive);break}}return{value:i,inclusive:s}}function cx(n,e,t){let i=ao,s=!0;for(const o of cg(n,e)){let c=ao,h=!0;switch(o.op){case">=":case">":c=wU(o.value),h=!1;break;case"==":case"in":case"<=":c=o.value;break;case"<":c=o.value,h=!1;break;case"!=":case"not-in":c=ao}sx({value:i,inclusive:s},{value:c,inclusive:h})>0&&(i=c,s=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];sx({value:i,inclusive:s},{value:c,inclusive:t.inclusive})>0&&(i=c,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t=null,i=[],s=[],o=null,c="F",h=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=c,this.startAt=h,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function gN(n,e,t,i,s,o,c,h){return new ca(n,e,t,i,s,o,c,h)}function Zu(n){return new ca(n)}function ux(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lE(n){return n.collectionGroup!==null}function mu(n){const e=_e(n);if(e.ce===null){e.ce=[];const t=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new wt(Vt.comparator);return c.filters.forEach((d=>{d.getFlattenedFilters().forEach((m=>{m.isInequality()&&(h=h.add(m.field))}))})),h})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new uf(o,i))})),t.has(Vt.keyField().canonicalString())||e.ce.push(new uf(Vt.keyField(),i))}return e.ce}function ai(n){const e=_e(n);return e.le||(e.le=RU(e,mu(n))),e.le}function RU(n,e){if(n.limitType==="F")return U0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new uf(s.field,o)}));const t=n.endAt?new Ao(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ao(n.startAt.position,n.startAt.inclusive):null;return U0(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function F0(n,e){const t=n.filters.concat([e]);return new ca(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ug(n,e,t){return new ca(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Uf(n,e){return jf(ai(n),ai(e))&&n.limitType===e.limitType}function _N(n){return`${ql(ai(n))}|lt:${n.limitType}`}function ru(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>fN(s))).join(", ")}]`),Lf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>xu(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>xu(s))).join(",")),`Target(${i})`})(ai(n))}; limitType=${n.limitType})`}function Ff(n,e){return e.isFoundDocument()&&(function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):ge.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,s){for(const o of mu(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(c,h,d){const m=ax(c,h,d);return c.inclusive?m<=0:m<0})(i.startAt,mu(i),s)||i.endAt&&!(function(c,h,d){const m=ax(c,h,d);return c.inclusive?m>=0:m>0})(i.endAt,mu(i),s))})(n,e)}function yN(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vN(n){return(e,t)=>{let i=!1;for(const s of mu(n)){const o=NU(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function NU(n,e,t){const i=n.field.isKeyField()?ge.comparator(e.key,t.key):(function(o,c,h){const d=c.data.field(o),m=h.data.field(o);return d!==null&&m!==null?So(d,m):we()})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return we()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ic(this.inner,((t,i)=>{for(const[s,o]of i)e(s,o)}))}isEmpty(){return rN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DU=new Gt(ge.comparator);function Ii(){return DU}const wN=new Gt(ge.comparator);function xd(...n){let e=wN;for(const t of n)e=e.insert(t.key,t);return e}function EN(n){let e=wN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ss(){return Md()}function bN(){return Md()}function Md(){return new Fo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const kU=new Gt(ge.comparator),OU=new wt(ge.comparator);function je(...n){let e=OU;for(const t of n)e=e.add(t);return e}const PU=new wt(Me);function cE(){return PU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:af(e)?"-0":e}}function TN(n){return{integerValue:""+n}}function IN(n,e){return ZR(e)?TN(e):uE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(){this._=void 0}}function MU(n,e,t){return n instanceof Ru?(function(s,o){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&e_(o)&&(o=aE(o)),o&&(c.fields.__previous_value__=o),{mapValue:c}})(t,e):n instanceof Gl?AN(n,e):n instanceof Hl?xN(n,e):(function(s,o){const c=SN(s,o),h=hx(c)+hx(s.Pe);return V0(c)&&V0(s.Pe)?TN(h):uE(s.serializer,h)})(n,e)}function VU(n,e,t){return n instanceof Gl?AN(n,e):n instanceof Hl?xN(n,e):t}function SN(n,e){return n instanceof Nu?(function(i){return V0(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}class Ru extends n_{}class Gl extends n_{constructor(e){super(),this.elements=e}}function AN(n,e){const t=CN(e);for(const i of n.elements)t.some((s=>ds(s,i)))||t.push(i);return{arrayValue:{values:t}}}class Hl extends n_{constructor(e){super(),this.elements=e}}function xN(n,e){let t=CN(e);for(const i of n.elements)t=t.filter((s=>!ds(s,i)));return{arrayValue:{values:t}}}class Nu extends n_{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function hx(n){return Mt(n.integerValue||n.doubleValue)}function CN(n){return cf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,t){this.field=e,this.transform=t}}function LU(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof Gl&&s instanceof Gl||i instanceof Hl&&s instanceof Hl?Au(i.elements,s.elements,ds):i instanceof Nu&&s instanceof Nu?ds(i.Pe,s.Pe):i instanceof Ru&&s instanceof Ru})(n.transform,e.transform)}class jU{constructor(e,t){this.version=e,this.transformResults=t}}class Lt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Lt}static exists(e){return new Lt(void 0,e)}static updateTime(e){return new Lt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class i_{}function RN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new th(n.key,Lt.none()):new eh(n.key,n.data,Lt.none());{const t=n.data,i=Fn.empty();let s=new wt(Vt.comparator);for(let o of e.fields)if(!s.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?i.delete(o):i.set(o,c),s=s.add(o)}return new ua(n.key,i,new Ti(s.toArray()),Lt.none())}}function UU(n,e,t){n instanceof eh?(function(s,o,c){const h=s.value.clone(),d=fx(s.fieldTransforms,o,c.transformResults);h.setAll(d),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):n instanceof ua?(function(s,o,c){if(!Qp(s.precondition,o))return void o.convertToUnknownDocument(c.version);const h=fx(s.fieldTransforms,o,c.transformResults),d=o.data;d.setAll(NN(s)),d.setAll(h),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):(function(s,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Vd(n,e,t,i){return n instanceof eh?(function(o,c,h,d){if(!Qp(o.precondition,c))return h;const m=o.value.clone(),_=mx(o.fieldTransforms,d,c);return m.setAll(_),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof ua?(function(o,c,h,d){if(!Qp(o.precondition,c))return h;const m=mx(o.fieldTransforms,d,c),_=c.data;return _.setAll(NN(o)),_.setAll(m),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((y=>y.field)))})(n,e,t,i):(function(o,c,h){return Qp(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(n,e,t)}function FU(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),o=SN(i.transform,s||null);o!=null&&(t===null&&(t=Fn.empty()),t.set(i.field,o))}return t||null}function dx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Au(i,s,((o,c)=>LU(o,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class eh extends i_{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ua extends i_{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function NN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function fx(n,e,t){const i=new Map;Te(n.length===t.length);for(let s=0;s<t.length;s++){const o=n[s],c=o.transform,h=e.data.field(o.field);i.set(o.field,VU(c,h,t[s]))}return i}function mx(n,e,t){const i=new Map;for(const s of n){const o=s.transform,c=t.data.field(s.field);i.set(s.field,MU(o,c,e))}return i}class th extends i_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hE extends i_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&UU(o,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Vd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Vd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=bN();return this.mutations.forEach((s=>{const o=e.get(s.key),c=o.overlayedDocument;let h=this.applyToLocalView(c,o.mutatedFields);h=t.has(s.key)?null:h;const d=RN(c,h);d!==null&&i.set(s.key,d),c.isValidDocument()||c.convertToNoDocument(Se.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),je())}isEqual(e){return this.batchId===e.batchId&&Au(this.mutations,e.mutations,((t,i)=>dx(t,i)))&&Au(this.baseMutations,e.baseMutations,((t,i)=>dx(t,i)))}}class fE{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Te(e.mutations.length===i.length);let s=(function(){return kU})();const o=e.mutations;for(let c=0;c<o.length;c++)s=s.insert(o[c].key,i[c].version);return new fE(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn,Ze;function DN(n){switch(n){default:return we();case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0}}function kN(n){if(n===void 0)return rn("GRPC error has no .code"),J.UNKNOWN;switch(n){case dn.OK:return J.OK;case dn.CANCELLED:return J.CANCELLED;case dn.UNKNOWN:return J.UNKNOWN;case dn.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case dn.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case dn.INTERNAL:return J.INTERNAL;case dn.UNAVAILABLE:return J.UNAVAILABLE;case dn.UNAUTHENTICATED:return J.UNAUTHENTICATED;case dn.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case dn.NOT_FOUND:return J.NOT_FOUND;case dn.ALREADY_EXISTS:return J.ALREADY_EXISTS;case dn.PERMISSION_DENIED:return J.PERMISSION_DENIED;case dn.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case dn.ABORTED:return J.ABORTED;case dn.OUT_OF_RANGE:return J.OUT_OF_RANGE;case dn.UNIMPLEMENTED:return J.UNIMPLEMENTED;case dn.DATA_LOSS:return J.DATA_LOSS;default:return we()}}(Ze=dn||(dn={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ON(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU=new Vl([4294967295,4294967295],0);function px(n){const e=ON().encode(n),t=new UR;return t.update(e),new Uint8Array(t.digest())}function gx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Vl([t,i],0),new Vl([s,o],0)]}class pE{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Cd(`Invalid padding: ${t}`);if(i<0)throw new Cd(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Cd(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Cd(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Vl.fromNumber(this.Ie)}Ee(e,t,i){let s=e.add(t.multiply(Vl.fromNumber(i)));return s.compare(zU)===1&&(s=new Vl([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=px(e),[i,s]=gx(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,s,o);if(!this.de(c))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new pE(o,s,t);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.Ie===0)return;const t=px(e),[i,s]=gx(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,s,o);this.Ae(c)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Cd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,qf.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new zf(Se.min(),s,new Gt(Me),Ii(),je())}}class qf{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new qf(i,t,je(),je(),je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,t,i,s){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=s}}class PN{constructor(e,t){this.targetId=e,this.me=t}}class MN{constructor(e,t,i=Yt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class _x{constructor(){this.fe=0,this.ge=vx(),this.pe=Yt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=je(),t=je(),i=je();return this.ge.forEach(((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:we()}})),new qf(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=vx()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class qU{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ii(),this.qe=yx(),this.Qe=new Gt(Me)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:we()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((i,s)=>{this.ze(s)&&t(s)}))}He(e){const t=e.targetId,i=e.me.count,s=this.Je(t);if(s){const o=s.target;if(lg(o))if(i===0){const c=new ge(o.path);this.Ue(t,c,Ot.newNoDocument(c,Se.min()))}else Te(i===1);else{const c=this.Ye(t);if(c!==i){const h=this.Ze(e),d=h?this.Xe(h,e,c):1;if(d!==0){this.je(t);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,m)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t;let c,h;try{c=To(i).toUint8Array()}catch(d){if(d instanceof sN)return hs("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new pE(c,s,o)}catch(d){return hs(d instanceof Cd?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Ie===0?null:h}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let s=0;return i.forEach((o=>{const c=this.Le.tt(),h=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.Ue(t,o,null),s++)})),s}rt(e){const t=new Map;this.Be.forEach(((o,c)=>{const h=this.Je(c);if(h){if(o.current&&lg(h.target)){const d=new ge(h.target.path);this.ke.get(d)!==null||this.it(c,d)||this.Ue(c,d,Ot.newNoDocument(d,e))}o.be&&(t.set(c,o.ve()),o.Ce())}}));let i=je();this.qe.forEach(((o,c)=>{let h=!0;c.forEachWhile((d=>{const m=this.Je(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(o))})),this.ke.forEach(((o,c)=>c.setReadTime(e)));const s=new zf(e,t,this.Qe,this.ke,i);return this.ke=Ii(),this.qe=yx(),this.Qe=new Gt(Me),s}$e(e,t){if(!this.ze(e))return;const i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new _x,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new wt(Me),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||le("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new _x),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function yx(){return new Gt(ge.comparator)}function vx(){return new Gt(ge.comparator)}const GU={asc:"ASCENDING",desc:"DESCENDING"},HU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KU={and:"AND",or:"OR"};class QU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function B0(n,e){return n.useProto3Json||Lf(e)?e:{value:e}}function Du(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function VN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function $U(n,e){return Du(n,e.toTimestamp())}function sn(n){return Te(!!n),Se.fromTimestamp((function(t){const i=ia(t);return new Ut(i.seconds,i.nanos)})(n))}function gE(n,e){return z0(n,e).canonicalString()}function z0(n,e){const t=(function(s){return new Ye(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function LN(n){const e=Ye.fromString(n);return Te(QN(e)),e}function hf(n,e){return gE(n.databaseId,e.path)}function os(n,e){const t=LN(e);if(t.get(1)!==n.databaseId.projectId)throw new oe(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new oe(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ge(FN(t))}function jN(n,e){return gE(n.databaseId,e)}function UN(n){const e=LN(n);return e.length===4?Ye.emptyPath():FN(e)}function q0(n){return new Ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function FN(n){return Te(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function wx(n,e,t){return{name:hf(n,e),fields:t.value.mapValue.fields}}function BN(n,e,t){const i=os(n,e.name),s=sn(e.updateTime),o=e.createTime?sn(e.createTime):Se.min(),c=new Fn({mapValue:{fields:e.fields}}),h=Ot.newFoundDocument(i,s,o,c);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function WU(n,e){return"found"in e?(function(i,s){Te(!!s.found),s.found.name,s.found.updateTime;const o=os(i,s.found.name),c=sn(s.found.updateTime),h=s.found.createTime?sn(s.found.createTime):Se.min(),d=new Fn({mapValue:{fields:s.found.fields}});return Ot.newFoundDocument(o,c,h,d)})(n,e):"missing"in e?(function(i,s){Te(!!s.missing),Te(!!s.readTime);const o=os(i,s.missing),c=sn(s.readTime);return Ot.newNoDocument(o,c)})(n,e):we()}function YU(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:we()})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=(function(m,_){return m.useProto3Json?(Te(_===void 0||typeof _=="string"),Yt.fromBase64String(_||"")):(Te(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),Yt.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(m){const _=m.code===void 0?J.UNKNOWN:kN(m.code);return new oe(_,m.message||"")})(c);t=new MN(i,s,o,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=os(n,i.document.name),o=sn(i.document.updateTime),c=i.document.createTime?sn(i.document.createTime):Se.min(),h=new Fn({mapValue:{fields:i.document.fields}}),d=Ot.newFoundDocument(s,o,c,h),m=i.targetIds||[],_=i.removedTargetIds||[];t=new $p(m,_,d.key,d)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=os(n,i.document),o=i.readTime?sn(i.readTime):Se.min(),c=Ot.newNoDocument(s,o),h=i.removedTargetIds||[];t=new $p([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=os(n,i.document),o=i.removedTargetIds||[];t=new $p([],o,s,null)}else{if(!("filter"in e))return we();{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,c=new BU(s,o),h=i.targetId;t=new PN(h,c)}}return t}function df(n,e){let t;if(e instanceof eh)t={update:wx(n,e.key,e.value)};else if(e instanceof th)t={delete:hf(n,e.key)};else if(e instanceof ua)t={update:wx(n,e.key,e.data),updateMask:n6(e.fieldMask)};else{if(!(e instanceof hE))return we();t={verify:hf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(o,c){const h=c.transform;if(h instanceof Ru)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Gl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Hl)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Nu)return{fieldPath:c.field.canonicalString(),increment:h.Pe};throw we()})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:$U(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:we()})(n,e.precondition)),t}function G0(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?Lt.updateTime(sn(o.updateTime)):o.exists!==void 0?Lt.exists(o.exists):Lt.none()})(e.currentDocument):Lt.none(),i=e.updateTransforms?e.updateTransforms.map((s=>(function(c,h){let d=null;if("setToServerValue"in h)Te(h.setToServerValue==="REQUEST_TIME"),d=new Ru;else if("appendMissingElements"in h){const _=h.appendMissingElements.values||[];d=new Gl(_)}else if("removeAllFromArray"in h){const _=h.removeAllFromArray.values||[];d=new Hl(_)}else"increment"in h?d=new Nu(c,h.increment):we();const m=Vt.fromServerFormat(h.fieldPath);return new Bf(m,d)})(n,s))):[];if(e.update){e.update.name;const s=os(n,e.update.name),o=new Fn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(d){const m=d.fieldPaths||[];return new Ti(m.map((_=>Vt.fromServerFormat(_))))})(e.updateMask);return new ua(s,o,c,t,i)}return new eh(s,o,t,i)}if(e.delete){const s=os(n,e.delete);return new th(s,t)}if(e.verify){const s=os(n,e.verify);return new hE(s,t)}return we()}function XU(n,e){return n&&n.length>0?(Te(e!==void 0),n.map((t=>(function(s,o){let c=s.updateTime?sn(s.updateTime):sn(o);return c.isEqual(Se.min())&&(c=sn(o)),new jU(c,s.transformResults||[])})(t,e)))):[]}function zN(n,e){return{documents:[jN(n,e.path)]}}function qN(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=jN(n,s);const o=(function(m){if(m.length!==0)return KN(mt.create(m,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(m){if(m.length!==0)return m.map((_=>(function(T){return{field:su(T.field),direction:ZU(T.dir)}})(_)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const h=B0(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{_t:t,parent:s}}function GN(n){let e=UN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Te(i===1);const _=t.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=(function(y){const T=HN(y);return T instanceof mt&&oE(T)?T.getFilters():[T]})(t.where));let c=[];t.orderBy&&(c=(function(y){return y.map((T=>(function(C){return new uf(au(C.field),(function(q){switch(q){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(T)))})(t.orderBy));let h=null;t.limit&&(h=(function(y){let T;return T=typeof y=="object"?y.value:y,Lf(T)?null:T})(t.limit));let d=null;t.startAt&&(d=(function(y){const T=!!y.before,S=y.values||[];return new Ao(S,T)})(t.startAt));let m=null;return t.endAt&&(m=(function(y){const T=!y.before,S=y.values||[];return new Ao(S,T)})(t.endAt)),gN(e,s,c,o,h,"F",d,m)}function JU(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we()}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function HN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=au(t.unaryFilter.field);return Xe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=au(t.unaryFilter.field);return Xe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=au(t.unaryFilter.field);return Xe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=au(t.unaryFilter.field);return Xe.create(c,"!=",{nullValue:"NULL_VALUE"});default:return we()}})(n):n.fieldFilter!==void 0?(function(t){return Xe.create(au(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return we()}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return mt.create(t.compositeFilter.filters.map((i=>HN(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return we()}})(t.compositeFilter.op))})(n):we()}function ZU(n){return GU[n]}function e6(n){return HU[n]}function t6(n){return KU[n]}function su(n){return{fieldPath:n.canonicalString()}}function au(n){return Vt.fromServerFormat(n.fieldPath)}function KN(n){return n instanceof Xe?(function(t){if(t.op==="=="){if(ix(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NAN"}};if(nx(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ix(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NAN"}};if(nx(t.value))return{unaryFilter:{field:su(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:su(t.field),op:e6(t.op),value:t.value}}})(n):n instanceof mt?(function(t){const i=t.getFilters().map((s=>KN(s)));return i.length===1?i[0]:{compositeFilter:{op:t6(t.op),filters:i}}})(n):we()}function n6(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function QN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,t,i,s,o=Se.min(),c=Se.min(),h=Yt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new Ys(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(e){this.ct=e}}function i6(n,e){let t;if(e.document)t=BN(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=ge.fromSegments(e.noDocument.path),s=Ql(e.noDocument.readTime);t=Ot.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return we();{const i=ge.fromSegments(e.unknownDocument.path),s=Ql(e.unknownDocument.version);t=Ot.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime((function(s){const o=new Ut(s[0],s[1]);return Se.fromTimestamp(o)})(e.readTime)),t}function Ex(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:hg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(o,c){return{name:hf(o,c.key),fields:c.data.value.mapValue.fields,updateTime:Du(o,c.version.toTimestamp()),createTime:Du(o,c.createTime.toTimestamp())}})(n.ct,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Kl(e.version)};else{if(!e.isUnknownDocument())return we();i.unknownDocument={path:t.path.toArray(),version:Kl(e.version)}}return i}function hg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Kl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ql(n){const e=new Ut(n.seconds,n.nanoseconds);return Se.fromTimestamp(e)}function Al(n,e){const t=(e.baseMutations||[]).map((o=>G0(n.ct,o)));for(let o=0;o<e.mutations.length-1;++o){const c=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const h=e.mutations[o+1];c.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const i=e.mutations.map((o=>G0(n.ct,o))),s=Ut.fromMillis(e.localWriteTimeMs);return new dE(e.batchId,s,t,i)}function Rd(n){const e=Ql(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ql(n.lastLimboFreeSnapshotVersion):Se.min();let i;return i=(function(o){return o.documents!==void 0})(n.query)?(function(o){return Te(o.documents.length===1),ai(Zu(UN(o.documents[0])))})(n.query):(function(o){return ai(GN(o))})(n.query),new Ys(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Yt.fromBase64String(n.resumeToken))}function WN(n,e){const t=Kl(e.snapshotVersion),i=Kl(e.lastLimboFreeSnapshotVersion);let s;s=lg(e.target)?zN(n.ct,e.target):qN(n.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ql(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function _E(n){const e=GN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ug(e,e.limit,"L"):e}function i0(n,e){return new mE(e.largestBatchId,G0(n.ct,e.overlayMutation))}function bx(n,e){const t=e.path.lastSegment();return[n,si(e.path.popLast()),t]}function Tx(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Kl(i.readTime),documentKey:si(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{getBundleMetadata(e,t){return Ix(e).get(t).next((i=>{if(i)return(function(o){return{id:o.bundleId,createTime:Ql(o.createTime),version:o.version}})(i)}))}saveBundleMetadata(e,t){return Ix(e).put((function(s){return{bundleId:s.id,createTime:Kl(sn(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return Sx(e).get(t).next((i=>{if(i)return(function(o){return{name:o.name,query:_E(o.bundledQuery),readTime:Ql(o.readTime)}})(i)}))}saveNamedQuery(e,t){return Sx(e).put((function(s){return{name:s.name,readTime:Kl(sn(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function Ix(n){return vn(n,"bundles")}function Sx(n){return vn(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const i=t.uid||"";return new r_(e,i)}getOverlay(e,t){return dd(e).get(bx(this.userId,t)).next((i=>i?i0(this.serializer,i):null))}getOverlays(e,t){const i=ss();return $.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&i.set(s,o)})))).next((()=>i))}saveOverlays(e,t,i){const s=[];return i.forEach(((o,c)=>{const h=new mE(t,c);s.push(this.ht(e,h))})),$.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach((c=>s.add(si(c.getCollectionPath()))));const o=[];return s.forEach((c=>{const h=IDBKeyRange.bound([this.userId,c,i],[this.userId,c,i+1],!1,!0);o.push(dd(e).j("collectionPathOverlayIndex",h))})),$.waitFor(o)}getOverlaysForCollection(e,t,i){const s=ss(),o=si(t),c=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return dd(e).U("collectionPathOverlayIndex",c).next((h=>{for(const d of h){const m=i0(this.serializer,d);s.set(m.getKey(),m)}return s}))}getOverlaysForCollectionGroup(e,t,i,s){const o=ss();let c;const h=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return dd(e).J({index:"collectionGroupOverlayIndex",range:h},((d,m,_)=>{const y=i0(this.serializer,m);o.size()<s||y.largestBatchId===c?(o.set(y.getKey(),y),c=y.largestBatchId):_.done()})).next((()=>o))}ht(e,t){return dd(e).put((function(s,o,c){const[h,d,m]=bx(o,c.mutation.key);return{userId:o,collectionPath:d,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:df(s.ct,c.mutation)}})(this.serializer,this.userId,t))}}function dd(n){return vn(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{Pt(e){return vn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?Yt.fromUint8Array(i):Yt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Mt(e.integerValue));else if("doubleValue"in e){const i=Mt(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),af(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=ia(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(To(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?aN(e)?this.dt(t,Number.MAX_SAFE_INTEGER):t_(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):we()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const i=e.fields||{};this.dt(t,55);for(const s of Object.keys(i))this.Vt(s,t),this.Tt(i[s],t)}wt(e,t){var i,s;const o=e.fields||{};this.dt(t,53);const c="value",h=((s=(i=o[c].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Mt(h)),this.Vt(c,t),this.Tt(o[c],t)}bt(e,t){const i=e.values||[];this.dt(t,50);for(const s of i)this.Tt(s,t)}yt(e,t){this.dt(t,37),ge.fromName(e).path.forEach((i=>{this.dt(t,60),this.Dt(i,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}xl.vt=new xl;function a6(n){if(n===0)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function Ax(n){const e=64-(function(i){let s=0;for(let o=0;o<8;++o){const c=a6(255&i[o]);if(s+=c,c!==8)break}return s})(n);return Math.ceil(e/8)}class o6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ft(i.value),i=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ot(i.value),i=t.next();this.Nt()}Lt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ot(i);else if(i<2048)this.Ot(960|i>>>6),this.Ot(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),i=Ax(t);this.Qt(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),i=Ax(t);this.Qt(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=(function(o){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,o,!1),new Uint8Array(c.buffer)})(e),i=(128&t[0])!=0;t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class l6{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class c6{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class fd{constructor(){this.jt=new o6,this.Ht=new l6(this.jt),this.Jt=new c6(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,t,i,s){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new Cl(this.indexId,this.documentKey,this.arrayValue,i)}}function to(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=xx(n.arrayValue,e.arrayValue),t!==0?t:(t=xx(n.directionalValue,e.directionalValue),t!==0?t:ge.comparator(n.documentKey,e.documentKey)))}function xx(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e){this.Xt=new wt(((t,i)=>Vt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const i=t;i.isInequality()?this.Xt=this.Xt.add(i):this.tn.push(i)}}get nn(){return this.Xt.size>1}rn(e){if(Te(e.collectionGroup===this.collectionId),this.nn)return!1;const t=k0(e);if(t!==void 0&&!this.sn(t))return!1;const i=Tl(e);let s=new Set,o=0,c=0;for(;o<i.length&&this.sn(i[o]);++o)s=s.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.Xt.size>0){const h=this.Xt.getIterator().getNext();if(!s.has(h.field.canonicalString())){const d=i[o];if(!this.on(h,d)||!this._n(this.en[c++],d))return!1}++o}for(;o<i.length;++o){const h=i[o];if(c>=this.en.length||!this._n(this.en[c++],h))return!1}return!0}an(){if(this.nn)return null;let e=new wt(Vt.comparator);const t=[];for(const i of this.tn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new qp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new qp(i.field,0))}for(const i of this.en)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new qp(i.field,i.dir==="asc"?0:1)));return new og(og.UNKNOWN_ID,this.collectionId,t,sf.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YN(n){var e,t;if(Te(n instanceof Xe||n instanceof mt),n instanceof Xe){if(n instanceof pN){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((o=>Xe.create(n.field,"==",o))))||[];return mt.create(s,"or")}return n}const i=n.filters.map((s=>YN(s)));return mt.create(i,n.op)}function u6(n){if(n.getFilters().length===0)return[];const e=Q0(YN(n));return Te(XN(e)),H0(e)||K0(e)?[e]:e.getFilters()}function H0(n){return n instanceof Xe}function K0(n){return n instanceof mt&&oE(n)}function XN(n){return H0(n)||K0(n)||(function(t){if(t instanceof mt&&L0(t)){for(const i of t.getFilters())if(!H0(i)&&!K0(i))return!1;return!0}return!1})(n)}function Q0(n){if(Te(n instanceof Xe||n instanceof mt),n instanceof Xe)return n;if(n.filters.length===1)return Q0(n.filters[0]);const e=n.filters.map((i=>Q0(i)));let t=mt.create(e,n.op);return t=dg(t),XN(t)?t:(Te(t instanceof mt),Te(Cu(t)),Te(t.filters.length>1),t.filters.reduce(((i,s)=>yE(i,s))))}function yE(n,e){let t;return Te(n instanceof Xe||n instanceof mt),Te(e instanceof Xe||e instanceof mt),t=n instanceof Xe?e instanceof Xe?(function(s,o){return mt.create([s,o],"and")})(n,e):Rx(n,e):e instanceof Xe?Rx(e,n):(function(s,o){if(Te(s.filters.length>0&&o.filters.length>0),Cu(s)&&Cu(o))return dN(s,o.getFilters());const c=L0(s)?s:o,h=L0(s)?o:s,d=c.filters.map((m=>yE(m,h)));return mt.create(d,"or")})(n,e),dg(t)}function Rx(n,e){if(Cu(e))return dN(e,n.getFilters());{const t=e.filters.map((i=>yE(n,i)));return mt.create(t,"or")}}function dg(n){if(Te(n instanceof Xe||n instanceof mt),n instanceof Xe)return n;const e=n.getFilters();if(e.length===1)return dg(e[0]);if(uN(n))return n;const t=e.map((s=>dg(s))),i=[];return t.forEach((s=>{s instanceof Xe?i.push(s):s instanceof mt&&(s.op===n.op?i.push(...s.filters):i.push(s))})),i.length===1?i[0]:mt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(){this.un=new vE}addToCollectionParentIndex(e,t){return this.un.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(Ji.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(Ji.min())}updateCollectionGroup(e,t,i){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}}class vE{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new wt(Ye.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new wt(Ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp=new Uint8Array(0);class d6{constructor(e,t){this.databaseId=t,this.cn=new vE,this.ln=new Fo((i=>ql(i)),((i,s)=>jf(i,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const o={collectionId:i,parent:si(s)};return Nx(e).put(o)}return $.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[QR(t),""],!1,!0);return Nx(e).U(s).next((o=>{for(const c of o){if(c.collectionId!==t)break;i.push(rs(c.parent))}return i}))}addFieldIndex(e,t){const i=md(e),s=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((d=>[d.fieldPath.canonicalString(),d.kind]))}})(t);delete s.indexId;const o=i.add(s);if(t.indexState){const c=eu(e);return o.next((h=>{c.put(Tx(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const i=md(e),s=eu(e),o=Zc(e);return i.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=md(e),i=Zc(e),s=eu(e);return t.j().next((()=>i.j())).next((()=>s.j()))}createTargetIndexes(e,t){return $.forEach(this.hn(t),(i=>this.getIndexType(e,i).next((s=>{if(s===0||s===1){const o=new Cx(i).an();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const i=Zc(e);let s=!0;const o=new Map;return $.forEach(this.hn(t),(c=>this.Pn(e,c).next((h=>{s&&(s=!!h),o.set(c,h)})))).next((()=>{if(s){let c=je();const h=[];return $.forEach(o,((d,m)=>{le("IndexedDbIndexManager",`Using index ${(function(W){return`id=${W.indexId}|cg=${W.collectionGroup}|f=${W.fields.map((se=>`${se.fieldPath}:${se.kind}`)).join(",")}`})(d)} to execute ${ql(t)}`);const _=(function(W,se){const z=k0(se);if(z===void 0)return null;for(const ae of cg(W,z.fieldPath))switch(ae.op){case"array-contains-any":return ae.value.arrayValue.values||[];case"array-contains":return[ae.value]}return null})(m,d),y=(function(W,se){const z=new Map;for(const ae of Tl(se))for(const N of cg(W,ae.fieldPath))switch(N.op){case"==":case"in":z.set(ae.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return z.set(ae.fieldPath.canonicalString(),N.value),Array.from(z.values())}return null})(m,d),T=(function(W,se){const z=[];let ae=!0;for(const N of Tl(se)){const R=N.kind===0?lx(W,N.fieldPath,W.startAt):cx(W,N.fieldPath,W.startAt);z.push(R.value),ae&&(ae=R.inclusive)}return new Ao(z,ae)})(m,d),S=(function(W,se){const z=[];let ae=!0;for(const N of Tl(se)){const R=N.kind===0?cx(W,N.fieldPath,W.endAt):lx(W,N.fieldPath,W.endAt);z.push(R.value),ae&&(ae=R.inclusive)}return new Ao(z,ae)})(m,d),C=this.In(d,m,T),M=this.In(d,m,S),q=this.Tn(d,m,y),F=this.En(d.indexId,_,C,T.inclusive,M,S.inclusive,q);return $.forEach(F,(j=>i.G(j,t.limit).next((W=>{W.forEach((se=>{const z=ge.fromSegments(se.documentKey);c.has(z)||(c=c.add(z),h.push(z))}))}))))})).next((()=>h))}return $.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=u6(mt.create(e.filters,"and")).map((i=>U0(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,i,s,o,c,h){const d=(t!=null?t.length:1)*Math.max(i.length,o.length),m=d/(t!=null?t.length:1),_=[];for(let y=0;y<d;++y){const T=t?this.dn(t[y/m]):Dp,S=this.An(e,T,i[y%m],s),C=this.Rn(e,T,o[y%m],c),M=h.map((q=>this.An(e,T,q,!0)));_.push(...this.createRange(S,C,M))}return _}An(e,t,i,s){const o=new Cl(e,ge.empty(),t,i);return s?o:o.Zt()}Rn(e,t,i,s){const o=new Cl(e,ge.empty(),t,i);return s?o.Zt():o}Pn(e,t){const i=new Cx(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((o=>{let c=null;for(const h of o)i.rn(h)&&(!c||h.fields.length>c.fields.length)&&(c=h);return c}))}getIndexType(e,t){let i=2;const s=this.hn(t);return $.forEach(s,(o=>this.Pn(e,o).next((c=>{c?i!==0&&c.fields.length<(function(d){let m=new wt(Vt.comparator),_=!1;for(const y of d.filters)for(const T of y.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:m=m.add(T.field));for(const y of d.orderBy)y.field.isKeyField()||(m=m.add(y.field));return m.size+(_?1:0)})(o)&&(i=1):i=0})))).next((()=>(function(c){return c.limit!==null})(t)&&s.length>1&&i===2?1:i))}Vn(e,t){const i=new fd;for(const s of Tl(e)){const o=t.data.field(s.fieldPath);if(o==null)return null;const c=i.Yt(s.kind);xl.vt.It(o,c)}return i.zt()}dn(e){const t=new fd;return xl.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const i=new fd;return xl.vt.It(zl(this.databaseId,t),i.Yt((function(o){const c=Tl(o);return c.length===0?0:c[c.length-1].kind})(e))),i.zt()}Tn(e,t,i){if(i===null)return[];let s=[];s.push(new fd);let o=0;for(const c of Tl(e)){const h=i[o++];for(const d of s)if(this.fn(t,c.fieldPath)&&cf(h))s=this.gn(s,c,h);else{const m=d.Yt(c.kind);xl.vt.It(h,m)}}return this.pn(s)}In(e,t,i){return this.Tn(e,t,i.position)}pn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].zt();return t}gn(e,t,i){const s=[...e],o=[];for(const c of i.arrayValue.values||[])for(const h of s){const d=new fd;d.seed(h.zt()),xl.vt.It(c,d.Yt(t.kind)),o.push(d)}return o}fn(e,t){return!!e.filters.find((i=>i instanceof Xe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=md(e),s=eu(e);return(t?i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.U()).next((o=>{const c=[];return $.forEach(o,(h=>s.get([h.indexId,this.uid]).next((d=>{c.push((function(_,y){const T=y?new sf(y.sequenceNumber,new Ji(Ql(y.readTime),new ge(rs(y.documentKey)),y.largestBatchId)):sf.empty(),S=_.fields.map((([C,M])=>new qp(Vt.fromServerFormat(C),M)));return new og(_.indexId,_.collectionGroup,S,T)})(h,d))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,s)=>{const o=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:Me(i.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const s=md(e),o=eu(e);return this.yn(e).next((c=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((h=>$.forEach(h,(d=>o.put(Tx(d.indexId,this.uid,c,i))))))))}updateIndexEntries(e,t){const i=new Map;return $.forEach(t,((s,o)=>{const c=i.get(s.collectionGroup);return(c?$.resolve(c):this.getFieldIndexes(e,s.collectionGroup)).next((h=>(i.set(s.collectionGroup,h),$.forEach(h,(d=>this.wn(e,s,d).next((m=>{const _=this.Sn(o,d);return m.isEqual(_)?$.resolve():this.bn(e,o,d,m,_)})))))))}))}Dn(e,t,i,s){return Zc(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(i,t.key),documentKey:t.key.path.toArray()})}vn(e,t,i,s){return Zc(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(i,t.key),t.key.path.toArray()])}wn(e,t,i){const s=Zc(e);let o=new wt(to);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.mn(i,t)])},((c,h)=>{o=o.add(new Cl(i.indexId,t,h.arrayValue,h.directionalValue))})).next((()=>o))}Sn(e,t){let i=new wt(to);const s=this.Vn(t,e);if(s==null)return i;const o=k0(t);if(o!=null){const c=e.data.field(o.fieldPath);if(cf(c))for(const h of c.arrayValue.values||[])i=i.add(new Cl(t.indexId,e.key,this.dn(h),s))}else i=i.add(new Cl(t.indexId,e.key,Dp,s));return i}bn(e,t,i,s,o){le("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const c=[];return(function(d,m,_,y,T){const S=d.getIterator(),C=m.getIterator();let M=Jc(S),q=Jc(C);for(;M||q;){let F=!1,j=!1;if(M&&q){const W=_(M,q);W<0?j=!0:W>0&&(F=!0)}else M!=null?j=!0:F=!0;F?(y(q),q=Jc(C)):j?(T(M),M=Jc(S)):(M=Jc(S),q=Jc(C))}})(s,o,to,(h=>{c.push(this.Dn(e,t,i,h))}),(h=>{c.push(this.vn(e,t,i,h))})),$.waitFor(c)}yn(e){let t=1;return eu(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,s,o)=>{o.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((c,h)=>to(c,h))).filter(((c,h,d)=>!h||to(c,d[h-1])!==0));const s=[];s.push(e);for(const c of i){const h=to(c,e),d=to(c,t);if(h===0)s[0]=e.Zt();else if(h>0&&d<0)s.push(c),s.push(c.Zt());else if(d>0)break}s.push(t);const o=[];for(let c=0;c<s.length;c+=2){if(this.Cn(s[c],s[c+1]))return[];const h=[s[c].indexId,this.uid,s[c].arrayValue,s[c].directionalValue,Dp,[]],d=[s[c+1].indexId,this.uid,s[c+1].arrayValue,s[c+1].directionalValue,Dp,[]];o.push(IDBKeyRange.bound(h,d))}return o}Cn(e,t){return to(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Dx)}getMinOffset(e,t){return $.mapArray(this.hn(t),(i=>this.Pn(e,i).next((s=>s||we())))).next(Dx)}}function Nx(n){return vn(n,"collectionParents")}function Zc(n){return vn(n,"indexEntries")}function md(n){return vn(n,"indexConfiguration")}function eu(n){return vn(n,"indexState")}function Dx(n){Te(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;iE(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Ji(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class wi{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new wi(e,wi.DEFAULT_COLLECTION_PERCENTILE,wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(n,e,t){const i=n.store("mutations"),s=n.store("documentMutations"),o=[],c=IDBKeyRange.only(t.batchId);let h=0;const d=i.J({range:c},((_,y,T)=>(h++,T.delete())));o.push(d.next((()=>{Te(h===1)})));const m=[];for(const _ of t.mutations){const y=eN(e,_.key.path,t.batchId);o.push(s.delete(y)),m.push(_.key)}return $.waitFor(o).next((()=>m))}function fg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw we();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wi.DEFAULT_COLLECTION_PERCENTILE=10,wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wi.DEFAULT=new wi(41943040,wi.DEFAULT_COLLECTION_PERCENTILE,wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wi.DISABLED=new wi(-1,0,0);class s_{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.Fn={}}static lt(e,t,i,s){Te(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new s_(o,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return no(e).J({index:"userMutationsIndex",range:i},((s,o,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,i,s){const o=ou(e),c=no(e);return c.add({}).next((h=>{Te(typeof h=="number");const d=new dE(h,t,i,s),m=(function(S,C,M){const q=M.baseMutations.map((j=>df(S.ct,j))),F=M.mutations.map((j=>df(S.ct,j)));return{userId:C,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:q,mutations:F}})(this.serializer,this.userId,d),_=[];let y=new wt(((T,S)=>Me(T.canonicalString(),S.canonicalString())));for(const T of s){const S=eN(this.userId,T.key.path,h);y=y.add(T.key.path.popLast()),_.push(c.put(m)),_.push(o.put(S,J3))}return y.forEach((T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Fn[h]=d.keys()})),$.waitFor(_).next((()=>d))}))}lookupMutationBatch(e,t){return no(e).get(t).next((i=>i?(Te(i.userId===this.userId),Al(this.serializer,i)):null))}Mn(e,t){return this.Fn[t]?$.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const s=i.keys();return this.Fn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return no(e).J({index:"userMutationsIndex",range:s},((c,h,d)=>{h.userId===this.userId&&(Te(h.batchId>=i),o=Al(this.serializer,h)),d.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return no(e).J({index:"userMutationsIndex",range:t,reverse:!0},((s,o,c)=>{i=o.batchId,c.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return no(e).U("userMutationsIndex",t).next((i=>i.map((s=>Al(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Gp(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=[];return ou(e).J({range:s},((c,h,d)=>{const[m,_,y]=c,T=rs(_);if(m===this.userId&&t.path.isEqual(T))return no(e).get(y).next((S=>{if(!S)throw we();Te(S.userId===this.userId),o.push(Al(this.serializer,S))}));d.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new wt(Me);const s=[];return t.forEach((o=>{const c=Gp(this.userId,o.path),h=IDBKeyRange.lowerBound(c),d=ou(e).J({range:h},((m,_,y)=>{const[T,S,C]=m,M=rs(S);T===this.userId&&o.path.isEqual(M)?i=i.add(C):y.done()}));s.push(d)})),$.waitFor(s).next((()=>this.xn(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,o=Gp(this.userId,i),c=IDBKeyRange.lowerBound(o);let h=new wt(Me);return ou(e).J({range:c},((d,m,_)=>{const[y,T,S]=d,C=rs(T);y===this.userId&&i.isPrefixOf(C)?C.length===s&&(h=h.add(S)):_.done()})).next((()=>this.xn(e,h)))}xn(e,t){const i=[],s=[];return t.forEach((o=>{s.push(no(e).get(o).next((c=>{if(c===null)throw we();Te(c.userId===this.userId),i.push(Al(this.serializer,c))})))})),$.waitFor(s).next((()=>i))}removeMutationBatch(e,t){return JN(e._e,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),$.forEach(i,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return $.resolve();const i=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),s=[];return ou(e).J({range:i},((o,c,h)=>{if(o[0]===this.userId){const d=rs(o[1]);s.push(d)}else h.done()})).next((()=>{Te(s.length===0)}))}))}containsKey(e,t){return ZN(e,this.userId,t)}Nn(e){return e2(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function ZN(n,e,t){const i=Gp(e,t.path),s=i[1],o=IDBKeyRange.lowerBound(i);let c=!1;return ou(n).J({range:o,H:!0},((h,d,m)=>{const[_,y,T]=h;_===e&&y===s&&(c=!0),m.done()})).next((()=>c))}function no(n){return vn(n,"mutations")}function ou(n){return vn(n,"documentMutations")}function e2(n){return vn(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new $l(0)}static kn(){return new $l(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const i=new $l(t.highestTargetId);return t.highestTargetId=i.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((t=>Se.fromTimestamp(new Ut(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.qn(e).next((s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((i=>(i.targetCount+=1,this.$n(t,i),this.Qn(e,i))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>tu(e).delete(t.targetId))).next((()=>this.qn(e))).next((i=>(Te(i.targetCount>0),i.targetCount-=1,this.Qn(e,i))))}removeTargets(e,t,i){let s=0;const o=[];return tu(e).J(((c,h)=>{const d=Rd(h);d.sequenceNumber<=t&&i.get(d.targetId)===null&&(s++,o.push(this.removeTargetData(e,d)))})).next((()=>$.waitFor(o))).next((()=>s))}forEachTarget(e,t){return tu(e).J(((i,s)=>{const o=Rd(s);t(o)}))}qn(e){return Ox(e).get("targetGlobalKey").next((t=>(Te(t!==null),t)))}Qn(e,t){return Ox(e).put("targetGlobalKey",t)}Kn(e,t){return tu(e).put(WN(this.serializer,t))}$n(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.qn(e).next((t=>t.targetCount))}getTargetData(e,t){const i=ql(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return tu(e).J({range:s,index:"queryTargetsIndex"},((c,h,d)=>{const m=Rd(h);jf(t,m.target)&&(o=m,d.done())})).next((()=>o))}addMatchingKeys(e,t,i){const s=[],o=io(e);return t.forEach((c=>{const h=si(c.path);s.push(o.put({targetId:i,path:h})),s.push(this.referenceDelegate.addReference(e,i,c))})),$.waitFor(s)}removeMatchingKeys(e,t,i){const s=io(e);return $.forEach(t,(o=>{const c=si(o.path);return $.waitFor([s.delete([i,c]),this.referenceDelegate.removeReference(e,i,o)])}))}removeMatchingKeysForTargetId(e,t){const i=io(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=io(e);let o=je();return s.J({range:i,H:!0},((c,h,d)=>{const m=rs(c[1]),_=new ge(m);o=o.add(_)})).next((()=>o))}containsKey(e,t){const i=si(t.path),s=IDBKeyRange.bound([i],[QR(i)],!1,!0);let o=0;return io(e).J({index:"documentTargetsIndex",H:!0,range:s},(([c,h],d,m)=>{c!==0&&(o++,m.done())})).next((()=>o>0))}ot(e,t){return tu(e).get(t).next((i=>i?Rd(i):null))}}function tu(n){return vn(n,"targets")}function Ox(n){return vn(n,"targetGlobal")}function io(n){return vn(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px([n,e],[t,i]){const s=Me(n,t);return s===0?Me(e,i):s}class m6{constructor(e){this.Un=e,this.buffer=new wt(Px),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Px(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class p6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){le("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Uo(t)?le("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await jo(t)}await this.Hn(3e5)}))}}class g6{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return $.resolve(bi.oe);const i=new m6(t);return this.Jn.forEachTarget(e,(s=>i.zn(s.sequenceNumber))).next((()=>this.Jn.Zn(e,(s=>i.zn(s))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Jn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(le("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(kx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(le("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),kx):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let i,s,o,c,h,d,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,c=Date.now(),this.nthSequenceNumber(e,s)))).next((y=>(i=y,h=Date.now(),this.removeTargets(e,i,t)))).next((y=>(o=y,d=Date.now(),this.removeOrphanedDocuments(e,i)))).next((y=>(m=Date.now(),iu()<=Ge.DEBUG&&le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${s} in `+(h-c)+`ms
	Removed ${o} targets in `+(d-h)+`ms
	Removed ${y} documents in `+(m-d)+`ms
Total Duration: ${m-_}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:y}))))}}function _6(n,e){return new g6(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e,t){this.db=e,this.garbageCollector=_6(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}er(e){let t=0;return this.Zn(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((i,s)=>t(s)))}addReference(e,t,i){return kp(e,i)}removeReference(e,t,i){return kp(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return kp(e,t)}nr(e,t){return(function(s,o){let c=!1;return e2(s).Y((h=>ZN(s,h,o).next((d=>(d&&(c=!0),$.resolve(!d)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.tr(e,((c,h)=>{if(h<=t){const d=this.nr(e,c).next((m=>{if(!m)return o++,i.getEntry(e,c).next((()=>(i.removeEntry(c,Se.min()),io(e).delete((function(y){return[0,si(y.path)]})(c)))))}));s.push(d)}})).next((()=>$.waitFor(s))).next((()=>i.apply(e))).next((()=>o))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return kp(e,t)}tr(e,t){const i=io(e);let s,o=bi.oe;return i.J({index:"documentTargetsIndex"},(([c,h],{path:d,sequenceNumber:m})=>{c===0?(o!==bi.oe&&t(new ge(rs(s)),o),o=m,s=d):o=bi.oe})).next((()=>{o!==bi.oe&&t(new ge(rs(s)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function kp(n,e){return io(n).put((function(i,s){return{targetId:0,path:si(i.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(){this.changes=new Fo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ot.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?$.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return wl(e).put(i)}removeEntry(e,t,i){return wl(e).delete((function(o,c){const h=o.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],hg(c),h[h.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.rr(e,i))))}getEntry(e,t){let i=Ot.newInvalidDocument(t);return wl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(pd(t))},((s,o)=>{i=this.ir(t,o)})).next((()=>i))}sr(e,t){let i={size:0,document:Ot.newInvalidDocument(t)};return wl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(pd(t))},((s,o)=>{i={document:this.ir(t,o),size:fg(o)}})).next((()=>i))}getEntries(e,t){let i=Ii();return this._r(e,t,((s,o)=>{const c=this.ir(s,o);i=i.insert(s,c)})).next((()=>i))}ar(e,t){let i=Ii(),s=new Gt(ge.comparator);return this._r(e,t,((o,c)=>{const h=this.ir(o,c);i=i.insert(o,h),s=s.insert(o,fg(c))})).next((()=>({documents:i,ur:s})))}_r(e,t,i){if(t.isEmpty())return $.resolve();let s=new wt(Lx);t.forEach((d=>s=s.add(d)));const o=IDBKeyRange.bound(pd(s.first()),pd(s.last())),c=s.getIterator();let h=c.getNext();return wl(e).J({index:"documentKeyIndex",range:o},((d,m,_)=>{const y=ge.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&Lx(h,y)<0;)i(h,null),h=c.getNext();h&&h.isEqual(y)&&(i(h,m),h=c.hasNext()?c.getNext():null),h?_.$(pd(h)):_.done()})).next((()=>{for(;h;)i(h,null),h=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,i,s,o){const c=t.path,h=[c.popLast().toArray(),c.lastSegment(),hg(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],d=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wl(e).U(IDBKeyRange.bound(h,d,!0)).next((m=>{o==null||o.incrementDocumentReadCount(m.length);let _=Ii();for(const y of m){const T=this.ir(ge.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);T.isFoundDocument()&&(Ff(t,T)||s.has(T.key))&&(_=_.insert(T.key,T))}return _}))}getAllFromCollectionGroup(e,t,i,s){let o=Ii();const c=Vx(t,i),h=Vx(t,Ji.max());return wl(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(c,h,!0)},((d,m,_)=>{const y=this.ir(ge.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(y.key,y),o.size===s&&_.done()})).next((()=>o))}newChangeBuffer(e){return new w6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Mx(e).get("remoteDocumentGlobalKey").next((t=>(Te(!!t),t)))}rr(e,t){return Mx(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const i=i6(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Se.min())))return i}return Ot.newInvalidDocument(e)}}function n2(n){return new v6(n)}class w6 extends t2{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Fo((i=>i.toString()),((i,s)=>i.isEqual(s)))}applyChanges(e){const t=[];let i=0,s=new wt(((o,c)=>Me(o.canonicalString(),c.canonicalString())));return this.changes.forEach(((o,c)=>{const h=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,h.readTime)),c.isValidDocument()){const d=Ex(this.cr.serializer,c);s=s.add(o.path.popLast());const m=fg(d);i+=m-h.size,t.push(this.cr.addEntry(e,o,d))}else if(i-=h.size,this.trackRemovals){const d=Ex(this.cr.serializer,c.convertToNoDocument(Se.min()));t.push(this.cr.addEntry(e,o,d))}})),s.forEach((o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.cr.updateMetadata(e,i)),$.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((i=>(this.lr.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((({documents:i,ur:s})=>(s.forEach(((o,c)=>{this.lr.set(o,{size:c,readTime:i.get(o).readTime})})),i)))}}function Mx(n){return vn(n,"remoteDocumentGlobal")}function wl(n){return vn(n,"remoteDocumentsV14")}function pd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Vx(n,e){const t=e.documentKey.path.toArray();return[n,hg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Lx(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(s=Me(t[o],i[o]),s)return s;return s=Me(t.length,i.length),s||(s=Me(t[t.length-2],i[i.length-2]),s||Me(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&Vd(i.mutation,s,Ti.empty(),Ut.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,je()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=je()){const s=ss();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((o=>{let c=xd();return o.forEach(((h,d)=>{c=c.insert(h,d.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=ss();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,je())))}populateOverlays(e,t,i){const s=[];return i.forEach((o=>{t.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(e,s).next((o=>{o.forEach(((c,h)=>{t.set(c,h)}))}))}computeViews(e,t,i,s){let o=Ii();const c=Md(),h=(function(){return Md()})();return t.forEach(((d,m)=>{const _=i.get(m.key);s.has(m.key)&&(_===void 0||_.mutation instanceof ua)?o=o.insert(m.key,m):_!==void 0?(c.set(m.key,_.mutation.getFieldMask()),Vd(_.mutation,m,_.mutation.getFieldMask(),Ut.now())):c.set(m.key,Ti.empty())})),this.recalculateAndSaveOverlays(e,o).next((d=>(d.forEach(((m,_)=>c.set(m,_))),t.forEach(((m,_)=>{var y;return h.set(m,new E6(_,(y=c.get(m))!==null&&y!==void 0?y:null))})),h)))}recalculateAndSaveOverlays(e,t){const i=Md();let s=new Gt(((c,h)=>c-h)),o=je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const h of c)h.keys().forEach((d=>{const m=t.get(d);if(m===null)return;let _=i.get(d)||Ti.empty();_=h.applyToLocalView(m,_),i.set(d,_);const y=(s.get(h.batchId)||je()).add(d);s=s.insert(h.batchId,y)}))})).next((()=>{const c=[],h=s.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),m=d.key,_=d.value,y=bN();_.forEach((T=>{if(!o.has(T)){const S=RN(t.get(T),i.get(T));S!==null&&y.set(T,S),o=o.add(T)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,y))}return $.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(c){return ge.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((o=>{const c=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):$.resolve(ss());let h=-1,d=o;return c.next((m=>$.forEach(m,((_,y)=>(h<y.largestBatchId&&(h=y.largestBatchId),o.get(_)?$.resolve():this.remoteDocumentCache.getEntry(e,_).next((T=>{d=d.insert(_,T)}))))).next((()=>this.populateOverlays(e,m,o))).next((()=>this.computeViews(e,d,m,je()))).next((_=>({batchId:h,changes:EN(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ge(t)).next((i=>{let s=xd();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const o=t.collectionGroup;let c=xd();return this.indexManager.getCollectionParents(e,o).next((h=>$.forEach(h,(d=>{const m=(function(y,T){return new ca(T,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,i,s).next((_=>{_.forEach(((y,T)=>{c=c.insert(y,T)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s)))).next((c=>{o.forEach(((d,m)=>{const _=m.getKey();c.get(_)===null&&(c=c.insert(_,Ot.newInvalidDocument(_)))}));let h=xd();return c.forEach(((d,m)=>{const _=o.get(d);_!==void 0&&Vd(_.mutation,m,Ti.empty(),Ut.now()),Ff(t,m)&&(h=h.insert(d,m))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return $.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:sn(s.createTime)}})(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,(function(s){return{name:s.name,query:_E(s.bundledQuery),readTime:sn(s.readTime)}})(t)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(){this.overlays=new Gt(ge.comparator),this.Ir=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ss();return $.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&i.set(s,o)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,o)=>{this.ht(e,t,o)})),$.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.Ir.get(i);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.Ir.delete(i)),$.resolve()}getOverlaysForCollection(e,t,i){const s=ss(),o=t.length+1,c=new ge(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const d=h.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&d.largestBatchId>i&&s.set(d.getKey(),d)}return $.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new Gt(((m,_)=>m-_));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let _=o.get(m.largestBatchId);_===null&&(_=ss(),o=o.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const h=ss(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((m,_)=>h.set(m,_))),!(h.size()>=s)););return $.resolve(h)}ht(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const c=this.Ir.get(s.largestBatchId).delete(i.key);this.Ir.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new mE(t,i));let o=this.Ir.get(t);o===void 0&&(o=je(),this.Ir.set(t,o)),this.Ir.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(){this.sessionToken=Yt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.Tr=new wt(Sn.Er),this.dr=new wt(Sn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const i=new Sn(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Vr(new Sn(e,t))}mr(e,t){e.forEach((i=>this.removeReference(i,t)))}gr(e){const t=new ge(new Ye([])),i=new Sn(t,e),s=new Sn(t,e+1),o=[];return this.dr.forEachInRange([i,s],(c=>{this.Vr(c),o.push(c.key)})),o}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ge(new Ye([])),i=new Sn(t,e),s=new Sn(t,e+1);let o=je();return this.dr.forEachInRange([i,s],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new Sn(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Sn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ge.comparator(e.key,t.key)||Me(e.wr,t.wr)}static Ar(e,t){return Me(e.wr,t.wr)||ge.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new wt(Sn.Er)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new dE(o,t,i,s);this.mutationQueue.push(c);for(const h of s)this.br=this.br.add(new Sn(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return $.resolve(c)}lookupMutationBatch(e,t){return $.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.vr(i),o=s<0?0:s;return $.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Sn(t,0),s=new Sn(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([i,s],(c=>{const h=this.Dr(c.wr);o.push(h)})),$.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new wt(Me);return t.forEach((s=>{const o=new Sn(s,0),c=new Sn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,c],(h=>{i=i.add(h.wr)}))})),$.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let o=i;ge.isDocumentKey(o)||(o=o.child(""));const c=new Sn(new ge(o),0);let h=new wt(Me);return this.br.forEachWhile((d=>{const m=d.key.path;return!!i.isPrefixOf(m)&&(m.length===s&&(h=h.add(d.wr)),!0)}),c),$.resolve(this.Cr(h))}Cr(e){const t=[];return e.forEach((i=>{const s=this.Dr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Te(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return $.forEach(t.mutations,(s=>{const o=new Sn(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.br=i}))}On(e){}containsKey(e,t){const i=new Sn(t,0),s=this.br.firstAfterOrEqual(i);return $.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e){this.Mr=e,this.docs=(function(){return new Gt(ge.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),o=s?s.size:0,c=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return $.resolve(i?i.document.mutableCopy():Ot.newInvalidDocument(t))}getEntries(e,t){let i=Ii();return t.forEach((s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():Ot.newInvalidDocument(s))})),$.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=Ii();const c=t.path,h=new ge(c.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:m,value:{document:_}}=d.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||iE(WR(_),i)<=0||(s.has(_.key)||Ff(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return $.resolve(o)}getAllFromCollectionGroup(e,t,i,s){we()}Or(e,t){return $.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new x6(this)}getSize(e){return $.resolve(this.size)}}class x6 extends t2{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(i)})),$.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.persistence=e,this.Nr=new Fo((t=>ql(t)),jf),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this.Lr=0,this.Br=new wE,this.targetCount=0,this.kr=$l.Bn()}forEachTarget(e,t){return this.Nr.forEach(((i,s)=>t(s))),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),$.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new $l(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.Kn(t),$.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,i){let s=0;const o=[];return this.Nr.forEach(((c,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.Nr.delete(c),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)})),$.waitFor(o).next((()=>s))}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){const i=this.Nr.get(t)||null;return $.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),$.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach((c=>{o.push(s.markPotentiallyOrphaned(e,c))})),$.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),$.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Br.yr(t);return $.resolve(i)}containsKey(e,t){return $.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e,t){this.qr={},this.overlays={},this.Qr=new bi(0),this.Kr=!1,this.Kr=!0,this.$r=new I6,this.referenceDelegate=e(this),this.Ur=new C6(this),this.indexManager=new h6,this.remoteDocumentCache=(function(s){return new A6(s)})((i=>this.referenceDelegate.Wr(i))),this.serializer=new $N(t),this.Gr=new b6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new T6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new S6(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){le("MemoryPersistence","Starting transaction:",e);const s=new R6(this.Qr.next());return this.referenceDelegate.zr(),i(s).next((o=>this.referenceDelegate.jr(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Hr(e,t){return $.or(Object.values(this.qr).map((i=>()=>i.containsKey(e,t))))}}class R6 extends XR{constructor(e){super(),this.currentSequenceNumber=e}}class a_{constructor(e){this.persistence=e,this.Jr=new wE,this.Yr=null}static Zr(e){return new a_(e)}get Xr(){if(this.Yr)return this.Yr;throw we()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),$.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),$.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((s=>this.Xr.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((o=>this.Xr.add(o.toString())))})).next((()=>i.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.Xr,(i=>{const s=ge.fromPath(i);return this.ei(e,s).next((o=>{o||t.removeEntry(s,Se.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return $.or([()=>$.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e){this.serializer=e}O(e,t,i,s){const o=new Zg("createOrUpgrade",t);i<1&&s>=1&&((function(d){d.createObjectStore("owner")})(e),(function(d){d.createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",XA,{unique:!0}),d.createObjectStore("documentMutations")})(e),jx(e),(function(d){d.createObjectStore("remoteDocuments")})(e));let c=$.resolve();return i<3&&s>=3&&(i!==0&&((function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")})(e),jx(e)),c=c.next((()=>(function(d){const m=d.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Se.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",_)})(o)))),i<4&&s>=4&&(i!==0&&(c=c.next((()=>(function(d,m){return m.store("mutations").U().next((_=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",XA,{unique:!0});const y=m.store("mutations"),T=_.map((S=>y.put(S)));return $.waitFor(T)}))})(e,o)))),c=c.next((()=>{(function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)}))),i<5&&s>=5&&(c=c.next((()=>this.ni(o)))),i<6&&s>=6&&(c=c.next((()=>((function(d){d.createObjectStore("remoteDocumentGlobal")})(e),this.ri(o))))),i<7&&s>=7&&(c=c.next((()=>this.ii(o)))),i<8&&s>=8&&(c=c.next((()=>this.si(e,o)))),i<9&&s>=9&&(c=c.next((()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&s>=10&&(c=c.next((()=>this.oi(o)))),i<11&&s>=11&&(c=c.next((()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),(function(d){d.createObjectStore("namedQueries",{keyPath:"name"})})(e)}))),i<12&&s>=12&&(c=c.next((()=>{(function(d){const m=d.createObjectStore("documentOverlays",{keyPath:uU});m.createIndex("collectionPathOverlayIndex",hU,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",dU,{unique:!1})})(e)}))),i<13&&s>=13&&(c=c.next((()=>(function(d){const m=d.createObjectStore("remoteDocumentsV14",{keyPath:Z3});m.createIndex("documentKeyIndex",eU),m.createIndex("collectionGroupIndex",tU)})(e))).next((()=>this._i(e,o))).next((()=>e.deleteObjectStore("remoteDocuments")))),i<14&&s>=14&&(c=c.next((()=>this.ai(e,o)))),i<15&&s>=15&&(c=c.next((()=>(function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:aU}).createIndex("sequenceNumberIndex",oU,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:lU}).createIndex("documentKeyIndex",cU,{unique:!1})})(e)))),i<16&&s>=16&&(c=c.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),i<17&&s>=17&&(c=c.next((()=>{(function(d){d.createObjectStore("globals",{keyPath:"name"})})(e)}))),c}ri(e){let t=0;return e.store("remoteDocuments").J(((i,s)=>{t+=fg(s)})).next((()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)}))}ni(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.U().next((s=>$.forEach(s,(o=>{const c=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",c).next((h=>$.forEach(h,(d=>{Te(d.userId===o.userId);const m=Al(this.serializer,d);return JN(e,o.userId,m).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((s=>{const o=[];return i.J(((c,h)=>{const d=new Ye(c),m=(function(y){return[0,si(y)]})(d);o.push(t.get(m).next((_=>_?$.resolve():(y=>t.put({targetId:0,path:si(y),sequenceNumber:s.highestListenSequenceNumber}))(d))))})).next((()=>$.waitFor(o)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:sU});const i=t.store("collectionParents"),s=new vE,o=c=>{if(s.add(c)){const h=c.lastSegment(),d=c.popLast();return i.put({collectionId:h,parent:si(d)})}};return t.store("remoteDocuments").J({H:!0},((c,h)=>{const d=new Ye(c);return o(d.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([c,h,d],m)=>{const _=rs(h);return o(_.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((i,s)=>{const o=Rd(s),c=WN(this.serializer,o);return t.put(c)}))}_i(e,t){const i=t.store("remoteDocuments"),s=[];return i.J(((o,c)=>{const h=t.store("remoteDocumentsV14"),d=(function(y){return y.document?new ge(Ye.fromString(y.document.name).popFirst(5)):y.noDocument?ge.fromSegments(y.noDocument.path):y.unknownDocument?ge.fromSegments(y.unknownDocument.path):we()})(c).path.toArray(),m={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};s.push(h.put(m))})).next((()=>$.waitFor(s)))}ai(e,t){const i=t.store("mutations"),s=n2(this.serializer),o=new r2(a_.Zr,this.serializer.ct);return i.U().next((c=>{const h=new Map;return c.forEach((d=>{var m;let _=(m=h.get(d.userId))!==null&&m!==void 0?m:je();Al(this.serializer,d).keys().forEach((y=>_=_.add(y))),h.set(d.userId,_)})),$.forEach(h,((d,m)=>{const _=new xn(m),y=r_.lt(this.serializer,_),T=o.getIndexManager(_),S=s_.lt(_,this.serializer,T,o.referenceDelegate);return new i2(s,S,y,T).recalculateAndSaveOverlaysForDocumentKeys(new O0(t,bi.oe),d).next()}))}))}}function jx(n){n.createObjectStore("targetDocuments",{keyPath:iU}).createIndex("documentTargetsIndex",rU,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",nU,{unique:!0}),n.createObjectStore("targetGlobal")}const r0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class EE{constructor(e,t,i,s,o,c,h,d,m,_,y=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.ui=o,this.window=c,this.document=h,this.ci=m,this.li=_,this.hi=y,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=T=>Promise.resolve(),!EE.D())throw new oe(J.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new y6(this,s),this.Ai=t+"main",this.serializer=new $N(d),this.Ri=new as(this.Ai,this.hi,new N6(this.serializer)),this.$r=new s6,this.Ur=new f6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=n2(this.serializer),this.Gr=new r6,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,_===!1&&rn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new oe(J.FAILED_PRECONDITION,r0);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new bi(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Op(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(Uo(e))return le("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return le("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return gd(e).get("owner").next((t=>$.resolve(this.vi(t))))}Ci(e){return Op(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=vn(t,"clientMetadata");return i.U().next((s=>{const o=this.xi(s,18e5),c=s.filter((h=>o.indexOf(h)===-1));return $.forEach(c,(h=>i.delete(h.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?$.resolve(!0):gd(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new oe(J.FAILED_PRECONDITION,r0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Op(e).U().next((i=>this.xi(i,5e3).find((s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,c=!this.inForeground&&s.inForeground,h=this.networkEnabled===s.networkEnabled;if(o||c&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&le("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new O0(e,bi.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((i=>this.Mi(i.updateTimeMs,t)&&!this.Ni(i.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>Op(e).U().next((t=>this.xi(t,18e5).map((i=>i.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return s_.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new d6(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return r_.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,i){le("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",o=(function(d){return d===17?pU:d===16?mU:d===15?sE:d===14?iN:d===13?nN:d===12?fU:d===11?tN:void we()})(this.hi);let c;return this.Ri.runTransaction(e,s,o,(h=>(c=new O0(h,this.Qr?this.Qr.next():bi.oe),t==="readwrite-primary"?this.wi(c).next((d=>!!d||this.Si(c))).next((d=>{if(!d)throw rn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new oe(J.FAILED_PRECONDITION,YR);return i(c)})).next((d=>this.Di(c).next((()=>d)))):this.Ki(c).next((()=>i(c)))))).then((h=>(c.raiseOnCommittedEvent(),h)))}Ki(e){return gd(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new oe(J.FAILED_PRECONDITION,r0)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gd(e).put("owner",t)}static D(){return as.D()}bi(e){const t=gd(e);return t.get("owner").next((i=>this.vi(i)?(le("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):$.resolve()))}Mi(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(rn(`Detected an update time that is in the future: ${e} > ${i}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;T1()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const i=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return le("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return rn("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){rn("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function gd(n){return vn(n,"owner")}function Op(n){return vn(n,"clientMetadata")}function bE(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=s}static Wi(e,t){let i=je(),s=je();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new TE(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return T1()?8:JR(qt())>0?6:4})()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,s){const o={result:null};return this.Yi(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.Zi(e,t,s,i).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new D6;return this.Xi(e,t,c).next((h=>{if(o.result=h,this.zi)return this.es(e,t,c,h.size)}))})).next((()=>o.result))}es(e,t,i,s){return i.documentReadCount<this.ji?(iu()<=Ge.DEBUG&&le("QueryEngine","SDK will not create cache indexes for query:",ru(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),$.resolve()):(iu()<=Ge.DEBUG&&le("QueryEngine","Query:",ru(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.Hi*s?(iu()<=Ge.DEBUG&&le("QueryEngine","The SDK decides to create cache indexes for query:",ru(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ai(t))):$.resolve())}Yi(e,t){if(ux(t))return $.resolve(null);let i=ai(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=ug(t,null,"F"),i=ai(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((o=>{const c=je(...o);return this.Ji.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((d=>{const m=this.ts(t,h);return this.ns(t,m,c,d.readTime)?this.Yi(e,ug(t,null,"F")):this.rs(e,m,t,d)}))))})))))}Zi(e,t,i,s){return ux(t)||s.isEqual(Se.min())?$.resolve(null):this.Ji.getDocuments(e,i).next((o=>{const c=this.ts(t,o);return this.ns(t,c,i,s)?$.resolve(null):(iu()<=Ge.DEBUG&&le("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ru(t)),this.rs(e,c,t,$R(s,-1)).next((h=>h)))}))}ts(e,t){let i=new wt(vN(e));return t.forEach(((s,o)=>{Ff(e,o)&&(i=i.add(o))})),i}ns(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Xi(e,t,i){return iu()<=Ge.DEBUG&&le("QueryEngine","Using full collection scan to execute query:",ru(t)),this.Ji.getDocumentsMatchingQuery(e,t,Ji.min(),i)}rs(e,t,i,s){return this.Ji.getDocumentsMatchingQuery(e,i,s).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,t,i,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Gt(Me),this._s=new Fo((o=>ql(o)),jf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new i2(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function a2(n,e,t,i){return new k6(n,e,t,i)}async function o2(n,e){const t=_e(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((o=>(s=o,t.ls(e),t.mutationQueue.getAllMutationBatches(i)))).next((o=>{const c=[],h=[];let d=je();for(const m of s){c.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}for(const m of o){h.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}return t.localDocuments.getDocuments(i,d).next((m=>({hs:m,removedBatchIds:c,addedBatchIds:h})))}))}))}function O6(n,e){const t=_e(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return(function(h,d,m,_){const y=m.batch,T=y.keys();let S=$.resolve();return T.forEach((C=>{S=S.next((()=>_.getEntry(d,C))).next((M=>{const q=m.docVersions.get(C);Te(q!==null),M.version.compareTo(q)<0&&(y.applyToRemoteDocument(M,m),M.isValidDocument()&&(M.setReadTime(m.commitVersion),_.addEntry(M)))}))})),S.next((()=>h.mutationQueue.removeMutationBatch(d,y)))})(t,i,e,o).next((()=>o.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let d=je();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(d=d.add(h.batch.mutations[m].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function l2(n){const e=_e(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ur.getLastRemoteSnapshotVersion(t)))}function P6(n,e){const t=_e(n),i=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const h=[];e.targetChanges.forEach(((_,y)=>{const T=s.get(y);if(!T)return;h.push(t.Ur.removeMatchingKeys(o,_.removedDocuments,y).next((()=>t.Ur.addMatchingKeys(o,_.addedDocuments,y))));let S=T.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?S=S.withResumeToken(Yt.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,i)),s=s.insert(y,S),(function(M,q,F){return M.resumeToken.approximateByteSize()===0||q.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(T,S,_)&&h.push(t.Ur.updateTargetData(o,S))}));let d=Ii(),m=je();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,_))})),h.push(c2(o,c,e.documentUpdates).next((_=>{d=_.Ps,m=_.Is}))),!i.isEqual(Se.min())){const _=t.Ur.getLastRemoteSnapshotVersion(o).next((y=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,i)));h.push(_)}return $.waitFor(h).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,d,m))).next((()=>d))})).then((o=>(t.os=s,o)))}function c2(n,e,t){let i=je(),s=je();return t.forEach((o=>i=i.add(o))),e.getEntries(n,i).next((o=>{let c=Ii();return t.forEach(((h,d)=>{const m=o.get(h);d.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(h)),d.isNoDocument()&&d.version.isEqual(Se.min())?(e.removeEntry(h,d.readTime),c=c.insert(h,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),c=c.insert(h,d)):le("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",d.version)})),{Ps:c,Is:s}}))}function M6(n,e){const t=_e(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function ku(n,e){const t=_e(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Ur.getTargetData(i,e).next((o=>o?(s=o,$.resolve(s)):t.Ur.allocateTargetId(i).next((c=>(s=new Ys(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.os.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i}))}async function Ou(n,e,t){const i=_e(n),s=i.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,(c=>i.persistence.referenceDelegate.removeTarget(c,s)))}catch(c){if(!Uo(c))throw c;le("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}i.os=i.os.remove(e),i._s.delete(s.target)}function mg(n,e,t){const i=_e(n);let s=Se.min(),o=je();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(d,m,_){const y=_e(d),T=y._s.get(_);return T!==void 0?$.resolve(y.os.get(T)):y.Ur.getTargetData(m,_)})(i,c,ai(e)).next((h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(c,h.targetId).next((d=>{o=d}))})).next((()=>i.ss.getDocumentsMatchingQuery(c,e,t?s:Se.min(),t?o:je()))).next((h=>(d2(i,yN(e),h),{documents:h,Ts:o})))))}function u2(n,e){const t=_e(n),i=_e(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(o=>i.ot(o,e).next((c=>c?c.target:null))))}function h2(n,e){const t=_e(n),i=t.us.get(e)||Se.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.cs.getAllFromCollectionGroup(s,e,$R(i,-1),Number.MAX_SAFE_INTEGER))).then((s=>(d2(t,e,s),s)))}function d2(n,e,t){let i=n.us.get(e)||Se.min();t.forEach(((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)})),n.us.set(e,i)}async function V6(n,e,t,i){const s=_e(n);let o=je(),c=Ii();for(const m of t){const _=e.Es(m.metadata.name);m.document&&(o=o.add(_));const y=e.ds(m);y.setReadTime(e.As(m.metadata.readTime)),c=c.insert(_,y)}const h=s.cs.newChangeBuffer({trackRemovals:!0}),d=await ku(s,(function(_){return ai(Zu(Ye.fromString(`__bundle__/docs/${_}`)))})(i));return s.persistence.runTransaction("Apply bundle documents","readwrite",(m=>c2(m,h,c).next((_=>(h.apply(m),_))).next((_=>s.Ur.removeMatchingKeysForTargetId(m,d.targetId).next((()=>s.Ur.addMatchingKeys(m,o,d.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(m,_.Ps,_.Is))).next((()=>_.Ps))))))}async function L6(n,e,t=je()){const i=await ku(n,ai(_E(e.bundledQuery))),s=_e(n);return s.persistence.runTransaction("Save named query","readwrite",(o=>{const c=sn(e.readTime);if(i.snapshotVersion.compareTo(c)>=0)return s.Gr.saveNamedQuery(o,e);const h=i.withResumeToken(Yt.EMPTY_BYTE_STRING,c);return s.os=s.os.insert(h.targetId,h),s.Ur.updateTargetData(o,h).next((()=>s.Ur.removeMatchingKeysForTargetId(o,i.targetId))).next((()=>s.Ur.addMatchingKeys(o,t,i.targetId))).next((()=>s.Gr.saveNamedQuery(o,e)))}))}function Ux(n,e){return`firestore_clients_${n}_${e}`}function Fx(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function s0(n,e){return`firestore_targets_${n}_${e}`}class pg{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Rs(e,t,i){const s=JSON.parse(i);let o,c=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return c&&s.error&&(c=typeof s.error.message=="string"&&typeof s.error.code=="string",c&&(o=new oe(s.error.code,s.error.message))),c?new pg(e,t,s.state,o):(rn("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ld{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Rs(e,t){const i=JSON.parse(t);let s,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new oe(i.error.code,i.error.message))),o?new Ld(e,i.state,s):(rn("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,o=cE();for(let c=0;s&&c<i.activeTargetIds.length;++c)s=ZR(i.activeTargetIds[c]),o=o.add(i.activeTargetIds[c]);return s?new gg(e,o):(rn("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class IE{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new IE(t.clientId,t.onlineState):(rn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class $0{constructor(){this.activeTargetIds=cE()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class a0{constructor(e,t,i,s,o){this.window=e,this.ui=t,this.persistenceKey=i,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Gt(Me),this.started=!1,this.bs=[];const c=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=Ux(this.persistenceKey,this.ps),this.vs=(function(d){return`firestore_sequence_number_${d}`})(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new $0),this.Cs=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.xs=(function(d){return`firestore_online_state_${d}`})(this.persistenceKey),this.Os=(function(d){return`firestore_bundle_loaded_v2_${d}`})(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const i of e){if(i===this.ps)continue;const s=this.getItem(Ux(this.persistenceKey,i));if(s){const o=gg.Rs(i,s);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const i=this.Ls(t);i&&this.Bs(i)}for(const i of this.bs)this.ws(i);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,i){this.qs(e,t,i),this.Qs(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(s0(this.persistenceKey,e));if(s){const o=Ld.Rs(e,s);o&&(i=o.state)}}return t&&this.Ks.fs(e),this.Ns(),i}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(s0(this.persistenceKey,e))}updateQueryState(e,t,i){this.$s(e,t,i)}handleUserChange(e,t,i){t.forEach((s=>{this.Qs(s)})),this.currentUser=e,i.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return le("SharedClientState","READ",e,t),t}setItem(e,t){le("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){le("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(le("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void rn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const i=this.Gs(t.key);return this.zs(i,null)}{const i=this.js(t.key,t.newValue);if(i)return this.zs(i.clientId,i)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const i=this.Hs(t.key,t.newValue);if(i)return this.Js(i)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const i=this.Ys(t.key,t.newValue);if(i)return this.Zs(i)}}else if(t.key===this.xs){if(t.newValue!==null){const i=this.Ls(t.newValue);if(i)return this.Bs(i)}}else if(t.key===this.vs){const i=(function(o){let c=bi.oe;if(o!=null)try{const h=JSON.parse(o);Te(typeof h=="number"),c=h}catch(h){rn("SharedClientState","Failed to read sequence number from WebStorage",h)}return c})(t.newValue);i!==bi.oe&&this.sequenceNumberHandler(i)}else if(t.key===this.Os){const i=this.Xs(t.newValue);await Promise.all(i.map((s=>this.syncEngine.eo(s))))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,i){const s=new pg(this.currentUser,e,t,i),o=Fx(this.persistenceKey,this.currentUser,e);this.setItem(o,s.Vs())}Qs(e){const t=Fx(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,i){const s=s0(this.persistenceKey,e),o=new Ld(e,t,i);this.setItem(s,o.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const i=this.Gs(e);return gg.Rs(i,t)}Hs(e,t){const i=this.Fs.exec(e),s=Number(i[1]),o=i[2]!==void 0?i[2]:null;return pg.Rs(new xn(o),s,t)}Ys(e,t){const i=this.Ms.exec(e),s=Number(i[1]);return Ld.Rs(s,t)}Ls(e){return IE.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);le("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const i=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),o=this.ks(i),c=[],h=[];return o.forEach((d=>{s.has(d)||c.push(d)})),s.forEach((d=>{o.has(d)||h.push(d)})),this.syncEngine.io(c,h).then((()=>{this.Ss=i}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=cE();return e.forEach(((i,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class f2{constructor(){this.so=new $0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new $0,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){le("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){le("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pp=null;function o0(){return Pp===null?Pp=(function(){return 268435456+Math.round(2147483648*Math.random())})():Pp++,"0x"+Pp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="WebChannelConnection";class B6 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${s}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${o}`}get Fo(){return!1}Mo(t,i,s,o,c){const h=o0(),d=this.xo(t,i.toUriEncodedString());le("RestConnection",`Sending RPC '${t}' ${h}:`,d,s);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,o,c),this.No(t,d,m,s).then((_=>(le("RestConnection",`Received RPC '${t}' ${h}: `,_),_)),(_=>{throw hs("RestConnection",`RPC '${t}' ${h} failed with error: `,_,"url: ",d,"request:",s),_}))}Lo(t,i,s,o,c,h){return this.Mo(t,i,s,o,c)}Oo(t,i,s){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ju})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach(((o,c)=>t[c]=o)),s&&s.headers.forEach(((o,c)=>t[c]=o))}xo(t,i){const s=U6[t];return`${this.Do}/v1/${i}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,s){const o=o0();return new Promise(((c,h)=>{const d=new FR;d.setWithCredentials(!0),d.listenOnce(BR.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case zp.NO_ERROR:const _=d.getResponseJson();le(Kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(_)),c(_);break;case zp.TIMEOUT:le(Kn,`RPC '${e}' ${o} timed out`),h(new oe(J.DEADLINE_EXCEEDED,"Request time out"));break;case zp.HTTP_ERROR:const y=d.getStatus();if(le(Kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T==null?void 0:T.error;if(S&&S.status&&S.message){const C=(function(q){const F=q.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(F)>=0?F:J.UNKNOWN})(S.status);h(new oe(C,S.message))}else h(new oe(J.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new oe(J.UNAVAILABLE,"Connection failed."));break;default:we()}}finally{le(Kn,`RPC '${e}' ${o} completed.`)}}));const m=JSON.stringify(s);le(Kn,`RPC '${e}' ${o} sending request:`,s),d.send(t,"POST",m,i,15)}))}Bo(e,t,i){const s=o0(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=GR(),h=qR(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const _=o.join("");le(Kn,`Creating RPC '${e}' stream ${s}: ${_}`,d);const y=c.createWebChannel(_,d);let T=!1,S=!1;const C=new F6({Io:q=>{S?le(Kn,`Not sending because RPC '${e}' stream ${s} is closed:`,q):(T||(le(Kn,`Opening RPC '${e}' stream ${s} transport.`),y.open(),T=!0),le(Kn,`RPC '${e}' stream ${s} sending:`,q),y.send(q))},To:()=>y.close()}),M=(q,F,j)=>{q.listen(F,(W=>{try{j(W)}catch(se){setTimeout((()=>{throw se}),0)}}))};return M(y,Ad.EventType.OPEN,(()=>{S||(le(Kn,`RPC '${e}' stream ${s} transport opened.`),C.yo())})),M(y,Ad.EventType.CLOSE,(()=>{S||(S=!0,le(Kn,`RPC '${e}' stream ${s} transport closed`),C.So())})),M(y,Ad.EventType.ERROR,(q=>{S||(S=!0,hs(Kn,`RPC '${e}' stream ${s} transport errored:`,q),C.So(new oe(J.UNAVAILABLE,"The operation could not be completed")))})),M(y,Ad.EventType.MESSAGE,(q=>{var F;if(!S){const j=q.data[0];Te(!!j);const W=j,se=W.error||((F=W[0])===null||F===void 0?void 0:F.error);if(se){le(Kn,`RPC '${e}' stream ${s} received error:`,se);const z=se.status;let ae=(function(x){const k=dn[x];if(k!==void 0)return kN(k)})(z),N=se.message;ae===void 0&&(ae=J.INTERNAL,N="Unknown error status: "+z+" with message "+se.message),S=!0,C.So(new oe(ae,N)),y.close()}else le(Kn,`RPC '${e}' stream ${s} received:`,j),C.bo(j)}})),M(h,zR.STAT_EVENT,(q=>{q.stat===D0.PROXY?le(Kn,`RPC '${e}' stream ${s} detected buffering proxy`):q.stat===D0.NOPROXY&&le(Kn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{C.wo()}),0),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m2(){return typeof window<"u"?window:null}function Wp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(n){return new QU(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t,i=1e3,s=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=s,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-i);s>0&&le("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,t,i,s,o,c,h,d){this.ui=e,this.Ho=i,this.Jo=s,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new SE(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===J.RESOURCE_EXHAUSTED?(rn(t.toString()),rn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.Yo===t&&this.P_(i,s)}),(i=>{e((()=>{const s=new oe(J.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(s)}))}))}P_(e,t){const i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{i((()=>this.listener.Eo()))})),this.stream.Ro((()=>{i((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((s=>{i((()=>this.I_(s)))})),this.stream.onMessage((s=>{i((()=>++this.e_==1?this.E_(s):this.onNext(s)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return le("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(le("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class z6 extends p2{constructor(e,t,i,s,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,c),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=YU(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Se.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Se.min():c.readTime?sn(c.readTime):Se.min()})(e);return this.listener.d_(t,i)}A_(e){const t={};t.database=q0(this.serializer),t.addTarget=(function(o,c){let h;const d=c.target;if(h=lg(d)?{documents:zN(o,d)}:{query:qN(o,d)._t},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=VN(o,c.resumeToken);const m=B0(o,c.expectedCount);m!==null&&(h.expectedCount=m)}else if(c.snapshotVersion.compareTo(Se.min())>0){h.readTime=Du(o,c.snapshotVersion.toTimestamp());const m=B0(o,c.expectedCount);m!==null&&(h.expectedCount=m)}return h})(this.serializer,e);const i=JU(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){const t={};t.database=q0(this.serializer),t.removeTarget=e,this.a_(t)}}class q6 extends p2{constructor(e,t,i,s,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,c),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=XU(e.writeResults,e.commitTime),i=sn(e.commitTime);return this.listener.g_(i,t)}p_(){const e={};e.database=q0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>df(this.serializer,i)))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6 extends class{}{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new oe(J.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Mo(e,z0(t,i),s,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new oe(J.UNKNOWN,o.toString())}))}Lo(e,t,i,s,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Lo(e,z0(t,i),s,c,h,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new oe(J.UNKNOWN,c.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class H6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(rn(t),this.D_=!1):le("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o((c=>{i.enqueueAndForget((async()=>{Bo(this)&&(le("RemoteStore","Restarting streams for network reachability change."),await(async function(d){const m=_e(d);m.L_.add(4),await nh(m),m.q_.set("Unknown"),m.L_.delete(4),await Hf(m)})(this))}))})),this.q_=new H6(i,s)}}async function Hf(n){if(Bo(n))for(const e of n.B_)await e(!0)}async function nh(n){for(const e of n.B_)await e(!1)}function o_(n,e){const t=_e(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),CE(t)?xE(t):rh(t).r_()&&AE(t,e))}function Pu(n,e){const t=_e(n),i=rh(t);t.N_.delete(e),i.r_()&&g2(t,e),t.N_.size===0&&(i.r_()?i.o_():Bo(t)&&t.q_.set("Unknown"))}function AE(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rh(n).A_(e)}function g2(n,e){n.Q_.xe(e),rh(n).R_(e)}function xE(n){n.Q_=new qU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),rh(n).start(),n.q_.v_()}function CE(n){return Bo(n)&&!rh(n).n_()&&n.N_.size>0}function Bo(n){return _e(n).L_.size===0}function _2(n){n.Q_=void 0}async function Q6(n){n.q_.set("Online")}async function $6(n){n.N_.forEach(((e,t)=>{AE(n,e)}))}async function W6(n,e){_2(n),CE(n)?(n.q_.M_(e),xE(n)):n.q_.set("Unknown")}async function Y6(n,e,t){if(n.q_.set("Online"),e instanceof MN&&e.state===2&&e.cause)try{await(async function(s,o){const c=o.cause;for(const h of o.targetIds)s.N_.has(h)&&(await s.remoteSyncer.rejectListen(h,c),s.N_.delete(h),s.Q_.removeTarget(h))})(n,e)}catch(i){le("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await _g(n,i)}else if(e instanceof $p?n.Q_.Ke(e):e instanceof PN?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Se.min()))try{const i=await l2(n.localStore);t.compareTo(i)>=0&&await(function(o,c){const h=o.Q_.rt(c);return h.targetChanges.forEach(((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const _=o.N_.get(m);_&&o.N_.set(m,_.withResumeToken(d.resumeToken,c))}})),h.targetMismatches.forEach(((d,m)=>{const _=o.N_.get(d);if(!_)return;o.N_.set(d,_.withResumeToken(Yt.EMPTY_BYTE_STRING,_.snapshotVersion)),g2(o,d);const y=new Ys(_.target,d,m,_.sequenceNumber);AE(o,y)})),o.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(i){le("RemoteStore","Failed to raise snapshot:",i),await _g(n,i)}}async function _g(n,e,t){if(!Uo(e))throw e;n.L_.add(1),await nh(n),n.q_.set("Offline"),t||(t=()=>l2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{le("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Hf(n)}))}function y2(n,e){return e().catch((t=>_g(n,t,e)))}async function ih(n){const e=_e(n),t=xo(e);let i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;X6(e);)try{const s=await M6(e.localStore,i);if(s===null){e.O_.length===0&&t.o_();break}i=s.batchId,J6(e,s)}catch(s){await _g(e,s)}v2(e)&&w2(e)}function X6(n){return Bo(n)&&n.O_.length<10}function J6(n,e){n.O_.push(e);const t=xo(n);t.r_()&&t.V_&&t.m_(e.mutations)}function v2(n){return Bo(n)&&!xo(n).n_()&&n.O_.length>0}function w2(n){xo(n).start()}async function Z6(n){xo(n).p_()}async function eF(n){const e=xo(n);for(const t of n.O_)e.m_(t.mutations)}async function tF(n,e,t){const i=n.O_.shift(),s=fE.from(i,e,t);await y2(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await ih(n)}async function nF(n,e){e&&xo(n).V_&&await(async function(i,s){if((function(c){return DN(c)&&c!==J.ABORTED})(s.code)){const o=i.O_.shift();xo(i).s_(),await y2(i,(()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s))),await ih(i)}})(n,e),v2(n)&&w2(n)}async function zx(n,e){const t=_e(n);t.asyncQueue.verifyOperationInProgress(),le("RemoteStore","RemoteStore received new credentials");const i=Bo(t);t.L_.add(3),await nh(t),i&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Hf(t)}async function W0(n,e){const t=_e(n);e?(t.L_.delete(2),await Hf(t)):e||(t.L_.add(2),await nh(t),t.q_.set("Unknown"))}function rh(n){return n.K_||(n.K_=(function(t,i,s){const o=_e(t);return o.w_(),new z6(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Eo:Q6.bind(null,n),Ro:$6.bind(null,n),mo:W6.bind(null,n),d_:Y6.bind(null,n)}),n.B_.push((async e=>{e?(n.K_.s_(),CE(n)?xE(n):n.q_.set("Unknown")):(await n.K_.stop(),_2(n))}))),n.K_}function xo(n){return n.U_||(n.U_=(function(t,i,s){const o=_e(t);return o.w_(),new q6(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Z6.bind(null,n),mo:nF.bind(null,n),f_:eF.bind(null,n),g_:tF.bind(null,n)}),n.B_.push((async e=>{e?(n.U_.s_(),await ih(n)):(await n.U_.stop(),n.O_.length>0&&(le("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new Bn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const c=Date.now()+i,h=new RE(e,t,c,s,o);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sh(n,e){if(rn("AsyncQueue",`${e}: ${n}`),Uo(n))return new oe(J.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this.comparator=e?(t,i)=>e(t,i)||ge.comparator(t.key,i.key):(t,i)=>ge.comparator(t.key,i.key),this.keyedMap=xd(),this.sortedSet=new Gt(this.comparator)}static emptySet(e){return new pu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new pu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(){this.W_=new Gt(ge.comparator)}track(e){const t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):we():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Mu{constructor(e,t,i,s,o,c,h,d,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,s,o){const c=[];return t.forEach((h=>{c.push({type:0,doc:h})})),new Mu(e,t,pu.emptySet(t),c,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class rF{constructor(){this.queries=Gx(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){const s=_e(t),o=s.queries;s.queries=Gx(),o.forEach(((c,h)=>{for(const d of h.j_)d.onError(i)}))})(this,new oe(J.ABORTED,"Firestore shutting down"))}}function Gx(){return new Fo((n=>_N(n)),Uf)}async function NE(n,e){const t=_e(n);let i=3;const s=e.query;let o=t.queries.get(s);o?!o.H_()&&e.J_()&&(i=2):(o=new iF,i=e.J_()?0:1);try{switch(i){case 0:o.z_=await t.onListen(s,!0);break;case 1:o.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(c){const h=sh(c,`Initialization of query '${ru(e.query)}' failed`);return void e.onError(h)}t.queries.set(s,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&kE(t)}async function DE(n,e){const t=_e(n),i=e.query;let s=3;const o=t.queries.get(i);if(o){const c=o.j_.indexOf(e);c>=0&&(o.j_.splice(c,1),o.j_.length===0?s=e.J_()?0:1:!o.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function sF(n,e){const t=_e(n);let i=!1;for(const s of e){const o=s.query,c=t.queries.get(o);if(c){for(const h of c.j_)h.X_(s)&&(i=!0);c.z_=s}}i&&kE(t)}function aF(n,e,t){const i=_e(n),s=i.queries.get(e);if(s)for(const o of s.j_)o.onError(t);i.queries.delete(e)}function kE(n){n.Y_.forEach((e=>{e.next()}))}var Y0,Hx;(Hx=Y0||(Y0={})).ea="default",Hx.Cache="cache";class OE{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new Mu(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Mu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Y0.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e){this.serializer=e}Es(e){return os(this.serializer,e)}ds(e){return e.metadata.exists?BN(this.serializer,e.document,!1):Ot.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return sn(e)}}class lF{constructor(e,t,i){this.ca=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=E2(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const i=Ye.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,i=new Kx(this.serializer);for(const s of e)if(s.metadata.queries){const o=i.Es(s.metadata.name);for(const c of s.metadata.queries){const h=(t.get(c)||je()).add(o);t.set(c,h)}}return t}async complete(){const e=await V6(this.localStore,new Kx(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const i of this.queries)await L6(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function E2(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e){this.key=e}}class T2{constructor(e){this.key=e}}class I2{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=je(),this.mutatedKeys=je(),this.Aa=vN(e),this.Ra=new pu(this.Aa)}get Va(){return this.Ta}ma(e,t){const i=t?t.fa:new qx,s=t?t.Ra:this.Ra;let o=t?t.mutatedKeys:this.mutatedKeys,c=s,h=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((_,y)=>{const T=s.get(_),S=Ff(this.query,y)?y:null,C=!!T&&this.mutatedKeys.has(T.key),M=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let q=!1;T&&S?T.data.isEqual(S.data)?C!==M&&(i.track({type:3,doc:S}),q=!0):this.ga(T,S)||(i.track({type:2,doc:S}),q=!0,(d&&this.Aa(S,d)>0||m&&this.Aa(S,m)<0)&&(h=!0)):!T&&S?(i.track({type:0,doc:S}),q=!0):T&&!S&&(i.track({type:1,doc:T}),q=!0,(d||m)&&(h=!0)),q&&(S?(c=c.add(S),o=M?o.add(_):o.delete(_)):(c=c.delete(_),o=o.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),o=o.delete(_.key),i.track({type:1,doc:_})}return{Ra:c,fa:i,ns:h,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const c=e.fa.G_();c.sort(((_,y)=>(function(S,C){const M=q=>{switch(q){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we()}};return M(S)-M(C)})(_.type,y.type)||this.Aa(_.doc,y.doc))),this.pa(i),s=s!=null&&s;const h=t&&!s?this.ya():[],d=this.da.size===0&&this.current&&!s?1:0,m=d!==this.Ea;return this.Ea=d,c.length!==0||m?{snapshot:new Mu(this.query,e.Ra,o,c,e.mutatedKeys,d===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new qx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((t=>this.Ta=this.Ta.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ta=this.Ta.delete(t))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=je(),this.Ra.forEach((i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))}));const t=[];return e.forEach((i=>{this.da.has(i)||t.push(new T2(i))})),this.da.forEach((i=>{e.has(i)||t.push(new b2(i))})),t}ba(e){this.Ta=e.Ts,this.da=je();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Mu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class cF{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class uF{constructor(e){this.key=e,this.va=!1}}class hF{constructor(e,t,i,s,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Ca={},this.Fa=new Fo((h=>_N(h)),Uf),this.Ma=new Map,this.xa=new Set,this.Oa=new Gt(ge.comparator),this.Na=new Map,this.La=new wE,this.Ba={},this.ka=new Map,this.qa=$l.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function dF(n,e,t=!0){const i=l_(n);let s;const o=i.Fa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.Da()):s=await S2(i,e,t,!0),s}async function fF(n,e){const t=l_(n);await S2(t,e,!0,!1)}async function S2(n,e,t,i){const s=await ku(n.localStore,ai(e)),o=s.targetId,c=n.sharedClientState.addLocalQueryTarget(o,t);let h;return i&&(h=await PE(n,e,o,c==="current",s.resumeToken)),n.isPrimaryClient&&t&&o_(n.remoteStore,s),h}async function PE(n,e,t,i,s){n.Ka=(y,T,S)=>(async function(M,q,F,j){let W=q.view.ma(F);W.ns&&(W=await mg(M.localStore,q.query,!1).then((({documents:N})=>q.view.ma(N,W))));const se=j&&j.targetChanges.get(q.targetId),z=j&&j.targetMismatches.get(q.targetId)!=null,ae=q.view.applyChanges(W,M.isPrimaryClient,se,z);return X0(M,q.targetId,ae.wa),ae.snapshot})(n,y,T,S);const o=await mg(n.localStore,e,!0),c=new I2(e,o.Ts),h=c.ma(o.documents),d=qf.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),m=c.applyChanges(h,n.isPrimaryClient,d);X0(n,t,m.wa);const _=new cF(e,t,c);return n.Fa.set(e,_),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),m.snapshot}async function mF(n,e,t){const i=_e(n),s=i.Fa.get(e),o=i.Ma.get(s.targetId);if(o.length>1)return i.Ma.set(s.targetId,o.filter((c=>!Uf(c,e)))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Ou(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&Pu(i.remoteStore,s.targetId),Vu(i,s.targetId)})).catch(jo)):(Vu(i,s.targetId),await Ou(i.localStore,s.targetId,!0))}async function pF(n,e){const t=_e(n),i=t.Fa.get(e),s=t.Ma.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Pu(t.remoteStore,i.targetId))}async function gF(n,e,t){const i=jE(n);try{const s=await(function(c,h){const d=_e(c),m=Ut.now(),_=h.reduce(((S,C)=>S.add(C.key)),je());let y,T;return d.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let C=Ii(),M=je();return d.cs.getEntries(S,_).next((q=>{C=q,C.forEach(((F,j)=>{j.isValidDocument()||(M=M.add(F))}))})).next((()=>d.localDocuments.getOverlayedDocuments(S,C))).next((q=>{y=q;const F=[];for(const j of h){const W=FU(j,y.get(j.key).overlayedDocument);W!=null&&F.push(new ua(j.key,W,lN(W.value.mapValue),Lt.exists(!0)))}return d.mutationQueue.addMutationBatch(S,m,F,h)})).next((q=>{T=q;const F=q.applyToLocalDocumentSet(y,M);return d.documentOverlayCache.saveOverlays(S,q.batchId,F)}))})).then((()=>({batchId:T.batchId,changes:EN(y)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(c,h,d){let m=c.Ba[c.currentUser.toKey()];m||(m=new Gt(Me)),m=m.insert(h,d),c.Ba[c.currentUser.toKey()]=m})(i,s.batchId,t),await ha(i,s.changes),await ih(i.remoteStore)}catch(s){const o=sh(s,"Failed to persist write");t.reject(o)}}async function A2(n,e){const t=_e(n);try{const i=await P6(t.localStore,e);e.targetChanges.forEach(((s,o)=>{const c=t.Na.get(o);c&&(Te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?c.va=!0:s.modifiedDocuments.size>0?Te(c.va):s.removedDocuments.size>0&&(Te(c.va),c.va=!1))})),await ha(t,i,e)}catch(i){await jo(i)}}function Qx(n,e,t){const i=_e(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Fa.forEach(((o,c)=>{const h=c.view.Z_(e);h.snapshot&&s.push(h.snapshot)})),(function(c,h){const d=_e(c);d.onlineState=h;let m=!1;d.queries.forEach(((_,y)=>{for(const T of y.j_)T.Z_(h)&&(m=!0)})),m&&kE(d)})(i.eventManager,e),s.length&&i.Ca.d_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function _F(n,e,t){const i=_e(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Na.get(e),o=s&&s.key;if(o){let c=new Gt(ge.comparator);c=c.insert(o,Ot.newNoDocument(o,Se.min()));const h=je().add(o),d=new zf(Se.min(),new Map,new Gt(Me),c,h);await A2(i,d),i.Oa=i.Oa.remove(o),i.Na.delete(e),LE(i)}else await Ou(i.localStore,e,!1).then((()=>Vu(i,e,t))).catch(jo)}async function yF(n,e){const t=_e(n),i=e.batch.batchId;try{const s=await O6(t.localStore,e);VE(t,i,null),ME(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ha(t,s)}catch(s){await jo(s)}}async function vF(n,e,t){const i=_e(n);try{const s=await(function(c,h){const d=_e(c);return d.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return d.mutationQueue.lookupMutationBatch(m,h).next((y=>(Te(y!==null),_=y.keys(),d.mutationQueue.removeMutationBatch(m,y)))).next((()=>d.mutationQueue.performConsistencyCheck(m))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(m,_,h))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>d.localDocuments.getDocuments(m,_)))}))})(i.localStore,e);VE(i,e,t),ME(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ha(i,s)}catch(s){await jo(s)}}async function wF(n,e){const t=_e(n);Bo(t.remoteStore)||le("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await(function(c){const h=_e(c);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(d=>h.mutationQueue.getHighestUnacknowledgedBatchId(d)))})(t.localStore);if(i===-1)return void e.resolve();const s=t.ka.get(i)||[];s.push(e),t.ka.set(i,s)}catch(i){const s=sh(i,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function ME(n,e){(n.ka.get(e)||[]).forEach((t=>{t.resolve()})),n.ka.delete(e)}function VE(n,e,t){const i=_e(n);let s=i.Ba[i.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.Ba[i.currentUser.toKey()]=s}}function Vu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach((i=>{n.La.containsKey(i)||x2(n,i)}))}function x2(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Pu(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),LE(n))}function X0(n,e,t){for(const i of t)i instanceof b2?(n.La.addReference(i.key,e),EF(n,i)):i instanceof T2?(le("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||x2(n,i.key)):we()}function EF(n,e){const t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(le("SyncEngine","New document in limbo: "+t),n.xa.add(i),LE(n))}function LE(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new ge(Ye.fromString(e)),i=n.qa.next();n.Na.set(i,new uF(t)),n.Oa=n.Oa.insert(t,i),o_(n.remoteStore,new Ys(ai(Zu(t.path)),i,"TargetPurposeLimboResolution",bi.oe))}}async function ha(n,e,t){const i=_e(n),s=[],o=[],c=[];i.Fa.isEmpty()||(i.Fa.forEach(((h,d)=>{c.push(i.Ka(d,e,t).then((m=>{var _;if((m||t)&&i.isPrimaryClient){const y=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(d.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(m){s.push(m);const y=TE.Wi(d.targetId,m);o.push(y)}})))})),await Promise.all(c),i.Ca.d_(s),await(async function(d,m){const _=_e(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>$.forEach(m,(T=>$.forEach(T.$i,(S=>_.persistence.referenceDelegate.addReference(y,T.targetId,S))).next((()=>$.forEach(T.Ui,(S=>_.persistence.referenceDelegate.removeReference(y,T.targetId,S)))))))))}catch(y){if(!Uo(y))throw y;le("LocalStore","Failed to update sequence numbers: "+y)}for(const y of m){const T=y.targetId;if(!y.fromCache){const S=_.os.get(T),C=S.snapshotVersion,M=S.withLastLimboFreeSnapshotVersion(C);_.os=_.os.insert(T,M)}}})(i.localStore,o))}async function bF(n,e){const t=_e(n);if(!t.currentUser.isEqual(e)){le("SyncEngine","User change. New user:",e.toKey());const i=await o2(t.localStore,e);t.currentUser=e,(function(o,c){o.ka.forEach((h=>{h.forEach((d=>{d.reject(new oe(J.CANCELLED,c))}))})),o.ka.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ha(t,i.hs)}}function TF(n,e){const t=_e(n),i=t.Na.get(e);if(i&&i.va)return je().add(i.key);{let s=je();const o=t.Ma.get(e);if(!o)return s;for(const c of o){const h=t.Fa.get(c);s=s.unionWith(h.view.Va)}return s}}async function IF(n,e){const t=_e(n),i=await mg(t.localStore,e.query,!0),s=e.view.ba(i);return t.isPrimaryClient&&X0(t,e.targetId,s.wa),s}async function SF(n,e){const t=_e(n);return h2(t.localStore,e).then((i=>ha(t,i)))}async function AF(n,e,t,i){const s=_e(n),o=await(function(h,d){const m=_e(h),_=_e(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(y=>_.Mn(y,d).next((T=>T?m.localDocuments.getDocuments(y,T):$.resolve(null)))))})(s.localStore,e);o!==null?(t==="pending"?await ih(s.remoteStore):t==="acknowledged"||t==="rejected"?(VE(s,e,i||null),ME(s,e),(function(h,d){_e(_e(h).mutationQueue).On(d)})(s.localStore,e)):we(),await ha(s,o)):le("SyncEngine","Cannot apply mutation batch with id: "+e)}async function xF(n,e){const t=_e(n);if(l_(t),jE(t),e===!0&&t.Qa!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await $x(t,i.toArray());t.Qa=!0,await W0(t.remoteStore,!0);for(const o of s)o_(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){const i=[];let s=Promise.resolve();t.Ma.forEach(((o,c)=>{t.sharedClientState.isLocalQueryTarget(c)?i.push(c):s=s.then((()=>(Vu(t,c),Ou(t.localStore,c,!0)))),Pu(t.remoteStore,c)})),await s,await $x(t,i),(function(c){const h=_e(c);h.Na.forEach(((d,m)=>{Pu(h.remoteStore,m)})),h.La.pr(),h.Na=new Map,h.Oa=new Gt(ge.comparator)})(t),t.Qa=!1,await W0(t.remoteStore,!1)}}async function $x(n,e,t){const i=_e(n),s=[],o=[];for(const c of e){let h;const d=i.Ma.get(c);if(d&&d.length!==0){h=await ku(i.localStore,ai(d[0]));for(const m of d){const _=i.Fa.get(m),y=await IF(i,_);y.snapshot&&o.push(y.snapshot)}}else{const m=await u2(i.localStore,c);h=await ku(i.localStore,m),await PE(i,C2(m),c,!1,h.resumeToken)}s.push(h)}return i.Ca.d_(o),s}function C2(n){return gN(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function CF(n){return(function(t){return _e(_e(t).persistence).Qi()})(_e(n).localStore)}async function RF(n,e,t,i){const s=_e(n);if(s.Qa)return void le("SyncEngine","Ignoring unexpected query state notification.");const o=s.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const c=await h2(s.localStore,yN(o[0])),h=zf.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Yt.EMPTY_BYTE_STRING);await ha(s,c,h);break}case"rejected":await Ou(s.localStore,e,!0),Vu(s,e,i);break;default:we()}}async function NF(n,e,t){const i=l_(n);if(i.Qa){for(const s of e){if(i.Ma.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){le("SyncEngine","Adding an already active target "+s);continue}const o=await u2(i.localStore,s),c=await ku(i.localStore,o);await PE(i,C2(o),c.targetId,!1,c.resumeToken),o_(i.remoteStore,c)}for(const s of t)i.Ma.has(s)&&await Ou(i.localStore,s,!1).then((()=>{Pu(i.remoteStore,s),Vu(i,s)})).catch(jo)}}function l_(n){const e=_e(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=A2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_F.bind(null,e),e.Ca.d_=sF.bind(null,e.eventManager),e.Ca.$a=aF.bind(null,e.eventManager),e}function jE(n){const e=_e(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vF.bind(null,e),e}function DF(n,e,t){const i=_e(n);(async function(o,c,h){try{const d=await c.getMetadata();if(await(function(S,C){const M=_e(S),q=sn(C.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",(F=>M.Gr.getBundleMetadata(F,C.id))).then((F=>!!F&&F.createTime.compareTo(q)>=0))})(o.localStore,d))return await c.close(),h._completeWith((function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}})(d)),Promise.resolve(new Set);h._updateProgress(E2(d));const m=new lF(d,o.localStore,c.serializer);let _=await c.Ua();for(;_;){const T=await m.la(_);T&&h._updateProgress(T),_=await c.Ua()}const y=await m.complete();return await ha(o,y.Ia,void 0),await(function(S,C){const M=_e(S);return M.persistence.runTransaction("Save bundle","readwrite",(q=>M.Gr.saveBundleMetadata(q,C)))})(o.localStore,d),h._completeWith(y.progress),Promise.resolve(y.Pa)}catch(d){return hs("SyncEngine",`Loading bundle failed with ${d}`),h._failWith(d),Promise.resolve(new Set)}})(i,e,t).then((s=>{i.sharedClientState.notifyBundleLoaded(s)}))}class ff{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return a2(this.persistence,new s2,e.initialUser,this.serializer)}Ga(e){return new r2(a_.Zr,this.serializer)}Wa(e){return new f2}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ff.provider={build:()=>new ff};class R2 extends ff{constructor(e,t,i){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await jE(this.Ja.syncEngine),await ih(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return a2(this.persistence,new s2,e.initialUser,this.serializer)}ja(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new p6(i,e.asyncQueue,t)}Ha(e,t){const i=new Y3(t,this.persistence);return new W3(e.asyncQueue,i)}Ga(e){const t=bE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?wi.withCacheSize(this.cacheSizeBytes):wi.DEFAULT;return new EE(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,m2(),Wp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new f2}}class kF extends R2{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof a0&&(this.sharedClientState.syncEngine={no:AF.bind(null,t),ro:RF.bind(null,t),io:NF.bind(null,t),Qi:CF.bind(null,t),eo:SF.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async i=>{await xF(this.Ja.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=m2();if(!a0.D(t))throw new oe(J.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=bE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new a0(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class mf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Qx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bF.bind(null,this.syncEngine),await W0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new rF})()}createDatastore(e){const t=Gf(e.databaseInfo.databaseId),i=(function(o){return new B6(o)})(e.databaseInfo);return(function(o,c,h,d){return new G6(o,c,h,d)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,o,c,h){return new K6(i,s,o,c,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>Qx(this.syncEngine,t,0)),(function(){return Bx.D()?new Bx:new j6})())}createSyncEngine(e,t){return(function(s,o,c,h,d,m,_){const y=new hF(s,o,c,h,d,m);return _&&(y.Qa=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const o=_e(s);le("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await nh(o),o.k_.shutdown(),o.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}mf.provider={build:()=>new mf};function Wx(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):rn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Bn,this.buffer=new Uint8Array,this.eu=(function(){return new TextDecoder("utf-8")})(),this.tu().then((i=>{i&&i.ua()?this.metadata.resolve(i.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.aa)}`))}),(i=>this.metadata.reject(i)))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),i=Number(t);isNaN(i)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(i);return new oF(JSON.parse(s),e.length+i)}su(){return this.buffer.findIndex((e=>e===123))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new oe(J.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,o){const c=_e(s),h={documents:o.map((y=>hf(c.serializer,y)))},d=await c.Lo("BatchGetDocuments",c.serializer.databaseId,Ye.emptyPath(),h,o.length),m=new Map;d.forEach((y=>{const T=WU(c.serializer,y);m.set(T.key.toString(),T)}));const _=[];return o.forEach((y=>{const T=m.get(y.toString());Te(!!T),_.push(T)})),_})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new th(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const s=ge.fromPath(i);this.mutations.push(new hE(s,this.precondition(s)))})),await(async function(i,s){const o=_e(i),c={writes:s.map((h=>df(o.serializer,h)))};await o.Mo("Commit",o.serializer.databaseId,Ye.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we();t=Se.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new oe(J.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Se.min())?Lt.exists(!1):Lt.updateTime(t):Lt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Se.min()))throw new oe(J.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Lt.updateTime(t)}return Lt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(e,t,i,s,o){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=s,this.deferred=o,this._u=i.maxAttempts,this.t_=new SE(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new PF(this.datastore),t=this.cu(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((s=>{this.lu(s)}))))})).catch((i=>{this.lu(i)}))}))}cu(e){try{const t=this.updateFunction(e);return!Lf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!DN(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=xn.UNAUTHENTICATED,this.clientId=KR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,(async c=>{le("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(le("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=sh(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function l0(n,e){n.asyncQueue.verifyOperationInProgress(),le("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await o2(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Yx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await UE(n);le("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>zx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>zx(e.remoteStore,s))),n._onlineComponents=e}async function UE(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){le("FirestoreClient","Using user provided OfflineComponentProvider");try{await l0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===J.FAILED_PRECONDITION||s.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;hs("Error using user provided cache. Falling back to memory cache: "+t),await l0(n,new ff)}}else le("FirestoreClient","Using default OfflineComponentProvider"),await l0(n,new ff);return n._offlineComponents}async function u_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(le("FirestoreClient","Using user provided OnlineComponentProvider"),await Yx(n,n._uninitializedComponentsProvider._online)):(le("FirestoreClient","Using default OnlineComponentProvider"),await Yx(n,new mf))),n._onlineComponents}function N2(n){return UE(n).then((e=>e.persistence))}function FE(n){return UE(n).then((e=>e.localStore))}function D2(n){return u_(n).then((e=>e.remoteStore))}function BE(n){return u_(n).then((e=>e.syncEngine))}function LF(n){return u_(n).then((e=>e.datastore))}async function Lu(n){const e=await u_(n),t=e.eventManager;return t.onListen=dF.bind(null,e.syncEngine),t.onUnlisten=mF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=fF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=pF.bind(null,e.syncEngine),t}function jF(n){return n.asyncQueue.enqueue((async()=>{const e=await N2(n),t=await D2(n);return e.setNetworkEnabled(!0),(function(s){const o=_e(s);return o.L_.delete(0),Hf(o)})(t)}))}function UF(n){return n.asyncQueue.enqueue((async()=>{const e=await N2(n),t=await D2(n);return e.setNetworkEnabled(!1),(async function(s){const o=_e(s);o.L_.add(0),await nh(o),o.q_.set("Offline")})(t)}))}function FF(n,e){const t=new Bn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,o,c){try{const h=await(function(m,_){const y=_e(m);return y.persistence.runTransaction("read document","readonly",(T=>y.localDocuments.getDocument(T,_)))})(s,o);h.isFoundDocument()?c.resolve(h):h.isNoDocument()?c.resolve(null):c.reject(new oe(J.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const d=sh(h,`Failed to get document '${o} from cache`);c.reject(d)}})(await FE(n),e,t))),t.promise}function k2(n,e,t={}){const i=new Bn;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,m){const _=new c_({next:T=>{_.Za(),c.enqueueAndForget((()=>DE(o,y)));const S=T.docs.has(h);!S&&T.fromCache?m.reject(new oe(J.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&T.fromCache&&d&&d.source==="server"?m.reject(new oe(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(T)},error:T=>m.reject(T)}),y=new OE(Zu(h.path),_,{includeMetadataChanges:!0,_a:!0});return NE(o,y)})(await Lu(n),n.asyncQueue,e,t,i))),i.promise}function BF(n,e){const t=new Bn;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,o,c){try{const h=await mg(s,o,!0),d=new I2(o,h.Ts),m=d.ma(h.documents),_=d.applyChanges(m,!1);c.resolve(_.snapshot)}catch(h){const d=sh(h,`Failed to execute query '${o} against cache`);c.reject(d)}})(await FE(n),e,t))),t.promise}function O2(n,e,t={}){const i=new Bn;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,m){const _=new c_({next:T=>{_.Za(),c.enqueueAndForget((()=>DE(o,y))),T.fromCache&&d.source==="server"?m.reject(new oe(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(T)},error:T=>m.reject(T)}),y=new OE(h,_,{includeMetadataChanges:!0,_a:!0});return NE(o,y)})(await Lu(n),n.asyncQueue,e,t,i))),i.promise}function zF(n,e){const t=new c_(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,o){_e(s).Y_.add(o),o.next()})(await Lu(n),t))),()=>{t.Za(),n.asyncQueue.enqueueAndForget((async()=>(function(s,o){_e(s).Y_.delete(o)})(await Lu(n),t)))}}function qF(n,e,t,i){const s=(function(c,h){let d;return d=typeof c=="string"?ON().encode(c):c,(function(_,y){return new OF(_,y)})((function(_,y){if(_ instanceof Uint8Array)return Wx(_,y);if(_ instanceof ArrayBuffer)return Wx(new Uint8Array(_),y);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(d),h)})(t,Gf(e));n.asyncQueue.enqueueAndForget((async()=>{DF(await BE(n),s,i)}))}function GF(n,e){return n.asyncQueue.enqueue((async()=>(function(i,s){const o=_e(i);return o.persistence.runTransaction("Get named query","readonly",(c=>o.Gr.getNamedQuery(c,s)))})(await FE(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(n,e,t){if(!t)throw new oe(J.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function M2(n,e,t,i){if(e===!0&&i===!0)throw new oe(J.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Jx(n){if(!ge.isDocumentKey(n))throw new oe(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Zx(n){if(ge.isDocumentKey(n))throw new oe(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function h_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":we()}function it(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new oe(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=h_(n);throw new oe(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function V2(n,e){if(e<=0)throw new oe(J.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new oe(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new oe(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}M2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=P2((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new oe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new oe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new oe(J.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kf{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eC({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eC(e),e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new j3;switch(i.type){case"firstParty":return new z3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new oe(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Xx.get(t);i&&(le("ComponentProvider","Removing Datastore"),Xx.delete(t),i.terminate())})(this),Promise.resolve()}}function L2(n,e,t,i={}){var s;const o=(n=it(n,Kf))._getSettings(),c=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==c&&hs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),i.mockUserToken){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=xn.MOCK_USER;else{h=v1(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new oe(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new xn(m)}n._authCredentials=new U3(new HR(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oi=class j2{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new j2(this.firestore,e,this._query)}},zt=class U2{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new U2(this.firestore,e,this._key)}},mo=class F2 extends oi{constructor(e,t,i){super(e,t,Zu(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zt(this.firestore,null,new ge(e))}withConverter(e){return new F2(this.firestore,e,this._path)}};function d_(n,e,...t){if(n=ve(n),zE("collection","path",e),n instanceof Kf){const i=Ye.fromString(e,...t);return Zx(i),new mo(n,null,i)}{if(!(n instanceof zt||n instanceof mo))throw new oe(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ye.fromString(e,...t));return Zx(i),new mo(n.firestore,null,i)}}function HF(n,e){if(n=it(n,Kf),zE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new oe(J.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new oi(n,null,(function(i){return new ca(Ye.emptyPath(),i)})(e))}function nt(n,e,...t){if(n=ve(n),arguments.length===1&&(e=KR.newId()),zE("doc","path",e),n instanceof Kf){const i=Ye.fromString(e,...t);return Jx(i),new zt(n,null,new ge(i))}{if(!(n instanceof zt||n instanceof mo))throw new oe(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ye.fromString(e,...t));return Jx(i),new zt(n.firestore,n instanceof mo?n.converter:null,new ge(i))}}function B2(n,e){return n=ve(n),e=ve(e),(n instanceof zt||n instanceof mo)&&(e instanceof zt||e instanceof mo)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function z2(n,e){return n=ve(n),e=ve(e),n instanceof oi&&e instanceof oi&&n.firestore===e.firestore&&Uf(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new SE(this,"async_queue_retry"),this.Vu=()=>{const i=Wp();i&&le("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;const t=Wp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Wp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Bn;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Uo(e))throw e;le("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((i=>{this.Eu=i,this.du=!1;const s=(function(c){let h=c.message||"";return c.stack&&(h=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),h})(i);throw rn("INTERNAL UNHANDLED ERROR: ",s),i})).then((i=>(this.du=!1,i))))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=RE.createAndSchedule(this,e,t,i,(o=>this.yu(o)));return this.Tu.push(s),s}fu(){this.Eu&&we()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function J0(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1})(n,["next","error","complete"])}class KF{constructor(){this._progressObserver={},this._taskCompletionResolver=new Bn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QF=-1;let Xt=class extends Kf{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new tC,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tC(e),this._firestoreClient=void 0,await e}}};function $F(n,e){const t=typeof n=="object"?n:Ug(),i=typeof n=="string"?n:"(default)",s=$u(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=g1("firestore");o&&L2(s,...o)}return s}function zn(n){if(n._terminated)throw new oe(J.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||q2(n),n._firestoreClient}function q2(n){var e,t,i;const s=n._freezeSettings(),o=(function(h,d,m,_){return new yU(h,d,m,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,P2(_.experimentalLongPollingOptions),_.useFetchStreams)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new VF(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(h){const d=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(d),_online:d}})(n._componentsProvider))}function WF(n,e){hs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return G2(n,mf.provider,{build:i=>new R2(i,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function YF(n){hs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();G2(n,mf.provider,{build:t=>new kF(t,e.cacheSizeBytes)})}function G2(n,e,t){if((n=it(n,Xt))._firestoreClient||n._terminated)throw new oe(J.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new oe(J.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},q2(n)}function XF(n){if(n._initialized&&!n._terminated)throw new oe(J.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Bn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(i){if(!as.D())return Promise.resolve();const s=i+"main";await as.delete(s)})(bE(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function JF(n){return(function(t){const i=new Bn;return t.asyncQueue.enqueueAndForget((async()=>wF(await BE(t),i))),i.promise})(zn(n=it(n,Xt)))}function ZF(n){return jF(zn(n=it(n,Xt)))}function eB(n){return UF(zn(n=it(n,Xt)))}function tB(n,e){const t=zn(n=it(n,Xt)),i=new KF;return qF(t,n._databaseId,e,i),i}function nB(n,e){return GF(zn(n=it(n,Xt)),e).then((t=>t?new oi(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fs(Yt.fromBase64String(e))}catch(t){throw new oe(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new fs(Yt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Co=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new oe(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rc=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new oe(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new oe(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0})(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iB=/^__.*__$/;class rB{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new ua(e,this.data,this.fieldMask,t,this.fieldTransforms):new eh(e,this.data,t,this.fieldTransforms)}}class H2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new ua(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function K2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we()}}class m_{constructor(e,t,i,s,o,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new m_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.Ou(e),s}Nu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yg(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(K2(this.Cu)&&iB.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class sB{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Gf(e)}Qu(e,t,i,s=!1){return new m_({Cu:e,methodName:t,qu:i,path:Vt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sc(n){const e=n._freezeSettings(),t=Gf(n._databaseId);return new sB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function p_(n,e,t,i,s,o={}){const c=n.Qu(o.merge||o.mergeFields?2:0,e,t,s);YE("Data must be an object, but it was:",c,i);const h=W2(i,c);let d,m;if(o.merge)d=new Ti(c.fieldMask),m=c.fieldTransforms;else if(o.mergeFields){const _=[];for(const y of o.mergeFields){const T=Z0(e,y,t);if(!c.contains(T))throw new oe(J.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);X2(_,T)||_.push(T)}d=new Ti(_),m=c.fieldTransforms.filter((y=>d.covers(y.field)))}else d=null,m=c.fieldTransforms;return new rB(new Fn(h),d,m)}class Qf extends rc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Qf}}function Q2(n,e,t){return new m_({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class GE extends rc{_toFieldTransform(e){return new Bf(e.path,new Ru)}isEqual(e){return e instanceof GE}}class HE extends rc{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Q2(this,e,!0),i=this.Ku.map((o=>ac(o,t))),s=new Gl(i);return new Bf(e.path,s)}isEqual(e){return e instanceof HE&&wu(this.Ku,e.Ku)}}class KE extends rc{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Q2(this,e,!0),i=this.Ku.map((o=>ac(o,t))),s=new Hl(i);return new Bf(e.path,s)}isEqual(e){return e instanceof KE&&wu(this.Ku,e.Ku)}}class QE extends rc{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Nu(e.serializer,IN(e.serializer,this.$u));return new Bf(e.path,t)}isEqual(e){return e instanceof QE&&this.$u===e.$u}}function $E(n,e,t,i){const s=n.Qu(1,e,t);YE("Data must be an object, but it was:",s,i);const o=[],c=Fn.empty();ic(i,((d,m)=>{const _=XE(e,d,t);m=ve(m);const y=s.Nu(_);if(m instanceof Qf)o.push(_);else{const T=ac(m,y);T!=null&&(o.push(_),c.set(_,T))}}));const h=new Ti(o);return new H2(c,h,s.fieldTransforms)}function WE(n,e,t,i,s,o){const c=n.Qu(1,e,t),h=[Z0(e,i,t)],d=[s];if(o.length%2!=0)throw new oe(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)h.push(Z0(e,o[T])),d.push(o[T+1]);const m=[],_=Fn.empty();for(let T=h.length-1;T>=0;--T)if(!X2(m,h[T])){const S=h[T];let C=d[T];C=ve(C);const M=c.Nu(S);if(C instanceof Qf)m.push(S);else{const q=ac(C,M);q!=null&&(m.push(S),_.set(S,q))}}const y=new Ti(m);return new H2(_,y,c.fieldTransforms)}function $2(n,e,t,i=!1){return ac(t,n.Qu(i?4:3,e))}function ac(n,e){if(Y2(n=ve(n)))return YE("Unsupported field value:",e,n),W2(n,e);if(n instanceof rc)return(function(i,s){if(!K2(s.Cu))throw s.Bu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(i,s){const o=[];let c=0;for(const h of i){let d=ac(h,s.Lu(c));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),c++}return{arrayValue:{values:o}}})(n,e)}return(function(i,s){if((i=ve(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return IN(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Ut.fromDate(i);return{timestampValue:Du(s.serializer,o)}}if(i instanceof Ut){const o=new Ut(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Du(s.serializer,o)}}if(i instanceof f_)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof fs)return{bytesValue:VN(s.serializer,i._byteString)};if(i instanceof zt){const o=s.databaseId,c=i.firestore._databaseId;if(!c.isEqual(o))throw s.Bu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:gE(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof qE)return(function(c,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map((d=>{if(typeof d!="number")throw h.Bu("VectorValues must only contain numeric values.");return uE(h.serializer,d)}))}}}}}})(i,s);throw s.Bu(`Unsupported field value: ${h_(i)}`)})(n,e)}function W2(n,e){const t={};return rN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ic(n,((i,s)=>{const o=ac(s,e.Mu(i));o!=null&&(t[i]=o)})),{mapValue:{fields:t}}}function Y2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ut||n instanceof f_||n instanceof fs||n instanceof zt||n instanceof rc||n instanceof qE)}function YE(n,e,t){if(!Y2(t)||!(function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)})(t)){const i=h_(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function Z0(n,e,t){if((e=ve(e))instanceof Co)return e._internalPath;if(typeof e=="string")return XE(n,e);throw yg("Field path arguments must be of type string or ",n,!1,void 0,t)}const aB=new RegExp("[~\\*/\\[\\]]");function XE(n,e,t){if(e.search(aB)>=0)throw yg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Co(...e.split("."))._internalPath}catch{throw yg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function yg(n,e,t,i,s){const o=i&&!i.isEmpty(),c=s!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(o||c)&&(d+=" (found",o&&(d+=` in field ${i}`),c&&(d+=` in document ${s}`),d+=")"),new oe(J.INVALID_ARGUMENT,h+n+d)}function X2(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(g_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class oB extends pf{data(){return super.data()}}function g_(n,e){return typeof e=="string"?XE(n,e):e instanceof Co?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new oe(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class JE{}let $f=class extends JE{};function Xr(n,e,...t){let i=[];e instanceof JE&&i.push(e),i=i.concat(t),(function(o){const c=o.filter((d=>d instanceof ZE)).length,h=o.filter((d=>d instanceof __)).length;if(c>1||c>0&&h>0)throw new oe(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class __ extends $f{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new __(e,t,i)}_apply(e){const t=this._parse(e);return aD(e._query,t),new oi(e.firestore,e.converter,F0(e._query,t))}_parse(e){const t=sc(e.firestore);return(function(o,c,h,d,m,_,y){let T;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new oe(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){iC(y,_);const S=[];for(const C of y)S.push(nC(d,o,C));T={arrayValue:{values:S}}}else T=nC(d,o,y)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||iC(y,_),T=$2(h,c,y,_==="in"||_==="not-in");return Xe.create(m,_,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Z2(n,e,t){const i=e,s=g_("where",n);return __._create(s,i,t)}class ZE extends JE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ZE(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:mt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,o){let c=s;const h=o.getFlattenedFilters();for(const d of h)aD(c,d),c=F0(c,d)})(e._query,t),new oi(e.firestore,e.converter,F0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class eb extends $f{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new eb(e,t)}_apply(e){const t=(function(s,o,c){if(s.startAt!==null)throw new oe(J.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new oe(J.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new uf(o,c)})(e._query,this._field,this._direction);return new oi(e.firestore,e.converter,(function(s,o){const c=s.explicitOrderBy.concat([o]);return new ca(s.path,s.collectionGroup,c,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function lB(n,e="asc"){const t=e,i=g_("orderBy",n);return eb._create(i,t)}class y_ extends $f{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new y_(e,t,i)}_apply(e){return new oi(e.firestore,e.converter,ug(e._query,this._limit,this._limitType))}}function eD(n){return V2("limit",n),y_._create("limit",n,"F")}function cB(n){return V2("limitToLast",n),y_._create("limitToLast",n,"L")}let tD=class nD extends $f{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new nD(e,t,i)}_apply(e){const t=sD(e,this.type,this._docOrFields,this._inclusive);return new oi(e.firestore,e.converter,(function(s,o){return new ca(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,o,s.endAt)})(e._query,t))}};function uB(...n){return tD._create("startAt",n,!0)}function hB(...n){return tD._create("startAfter",n,!1)}let iD=class rD extends $f{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new rD(e,t,i)}_apply(e){const t=sD(e,this.type,this._docOrFields,this._inclusive);return new oi(e.firestore,e.converter,(function(s,o){return new ca(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,o)})(e._query,t))}};function dB(...n){return iD._create("endBefore",n,!1)}function fB(...n){return iD._create("endAt",n,!0)}function sD(n,e,t,i){if(t[0]=ve(t[0]),t[0]instanceof pf)return(function(o,c,h,d,m){if(!d)throw new oe(J.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const _=[];for(const y of mu(o))if(y.field.isKeyField())_.push(zl(c,d.key));else{const T=d.data.field(y.field);if(e_(T))throw new oe(J.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const S=y.field.canonicalString();throw new oe(J.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}_.push(T)}return new Ao(_,m)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{const s=sc(n.firestore);return(function(c,h,d,m,_,y){const T=c.explicitOrderBy;if(_.length>T.length)throw new oe(J.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let C=0;C<_.length;C++){const M=_[C];if(T[C].field.isKeyField()){if(typeof M!="string")throw new oe(J.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof M}`);if(!lE(c)&&M.indexOf("/")!==-1)throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${M}' contains a slash.`);const q=c.path.child(Ye.fromString(M));if(!ge.isDocumentKey(q))throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${q}' is not because it contains an odd number of segments.`);const F=new ge(q);S.push(zl(h,F))}else{const q=$2(d,m,M);S.push(q)}}return new Ao(S,y)})(n._query,n.firestore._databaseId,s,e,t,i)}}function nC(n,e,t){if(typeof(t=ve(t))=="string"){if(t==="")throw new oe(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lE(e)&&t.indexOf("/")!==-1)throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Ye.fromString(t));if(!ge.isDocumentKey(i))throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return zl(n,new ge(i))}if(t instanceof zt)return zl(n,t._key);throw new oe(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${h_(t)}.`)}function iC(n,e){if(!Array.isArray(n)||n.length===0)throw new oe(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aD(n,e){const t=(function(s,o){for(const c of s)for(const h of c.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new oe(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class tb{convertValue(e,t="none"){switch(Bl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(To(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw we()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ic(e,((s,o)=>{i[s]=this.convertValue(o,t)})),i}convertVectorValue(e){var t,i,s;const o=(s=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map((c=>Mt(c.doubleValue)));return new qE(o)}convertGeoPoint(e){return new f_(Mt(e.latitude),Mt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=aE(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(of(e));default:return null}}convertTimestamp(e){const t=ia(e);return new Ut(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ye.fromString(e);Te(QN(i));const s=new Io(i.get(1),i.get(3)),o=new ge(i.popFirst(5));return s.isEqual(t)||rn(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class mB extends tb{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new zt(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let ra=class extends pf{constructor(e,t,i,s,o,c){super(e,t,i,s,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new jd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(g_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},jd=class extends ra{data(e={}){return super.data(e)}},Ro=class{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Dl(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new jd(this._firestore,this._userDataWriter,i.key,i,new Dl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new oe(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map((h=>{const d=new jd(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Dl(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:c++}}))}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const d=new jd(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Dl(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,_=-1;return h.type!==0&&(m=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),_=c.indexOf(h.doc.key)),{type:pB(h.type),doc:d,oldIndex:m,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function pB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we()}}function oD(n,e){return n instanceof ra&&e instanceof ra?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ro&&e instanceof Ro&&n._firestore===e._firestore&&z2(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function da(n){n=it(n,zt);const e=it(n.firestore,Xt);return k2(zn(e),n._key).then((t=>nb(e,n,t)))}class oc extends tb{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new zt(this.firestore,null,t)}}function gB(n){n=it(n,zt);const e=it(n.firestore,Xt),t=zn(e),i=new oc(e);return FF(t,n._key).then((s=>new ra(e,i,n._key,s,new Dl(s!==null&&s.hasLocalMutations,!0),n.converter)))}function _B(n){n=it(n,zt);const e=it(n.firestore,Xt);return k2(zn(e),n._key,{source:"server"}).then((t=>nb(e,n,t)))}function lD(n){n=it(n,oi);const e=it(n.firestore,Xt),t=zn(e),i=new oc(e);return J2(n._query),O2(t,n._query).then((s=>new Ro(e,i,n,s)))}function yB(n){n=it(n,oi);const e=it(n.firestore,Xt),t=zn(e),i=new oc(e);return BF(t,n._query).then((s=>new Ro(e,i,n,s)))}function vB(n){n=it(n,oi);const e=it(n.firestore,Xt),t=zn(e),i=new oc(e);return O2(t,n._query,{source:"server"}).then((s=>new Ro(e,i,n,s)))}function No(n,e,t){n=it(n,zt);const i=it(n.firestore,Xt),s=v_(n.converter,e,t);return oh(i,[p_(sc(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Lt.none())])}function Er(n,e,t,...i){n=it(n,zt);const s=it(n.firestore,Xt),o=sc(s);let c;return c=typeof(e=ve(e))=="string"||e instanceof Co?WE(o,"updateDoc",n._key,e,t,i):$E(o,"updateDoc",n._key,e),oh(s,[c.toMutation(n._key,Lt.exists(!0))])}function w_(n){return oh(it(n.firestore,Xt),[new th(n._key,Lt.none())])}function wB(n,e){const t=it(n.firestore,Xt),i=nt(n),s=v_(n.converter,e);return oh(t,[p_(sc(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,Lt.exists(!1))]).then((()=>i))}function ah(n,...e){var t,i,s;n=ve(n);let o={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||J0(e[c])||(o=e[c],c++);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(J0(e[c])){const y=e[c];e[c]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[c+1]=(i=y.error)===null||i===void 0?void 0:i.bind(y),e[c+2]=(s=y.complete)===null||s===void 0?void 0:s.bind(y)}let d,m,_;if(n instanceof zt)m=it(n.firestore,Xt),_=Zu(n._key.path),d={next:y=>{e[c]&&e[c](nb(m,n,y))},error:e[c+1],complete:e[c+2]};else{const y=it(n,oi);m=it(y.firestore,Xt),_=y._query;const T=new oc(m);d={next:S=>{e[c]&&e[c](new Ro(m,T,y,S))},error:e[c+1],complete:e[c+2]},J2(n._query)}return(function(T,S,C,M){const q=new c_(M),F=new OE(S,q,C);return T.asyncQueue.enqueueAndForget((async()=>NE(await Lu(T),F))),()=>{q.Za(),T.asyncQueue.enqueueAndForget((async()=>DE(await Lu(T),F)))}})(zn(m),_,h,d)}function EB(n,e){return zF(zn(n=it(n,Xt)),J0(e)?e:{next:e})}function oh(n,e){return(function(i,s){const o=new Bn;return i.asyncQueue.enqueueAndForget((async()=>gF(await BE(i),s,o))),o.promise})(zn(n),e)}function nb(n,e,t){const i=t.docs.get(e._key),s=new oc(n);return new ra(n,s,e._key,i,new Dl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bB={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cD=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=sc(e)}set(e,t,i){this._verifyNotCommitted();const s=ro(e,this._firestore),o=v_(s.converter,t,i),c=p_(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,i);return this._mutations.push(c.toMutation(s._key,Lt.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const o=ro(e,this._firestore);let c;return c=typeof(t=ve(t))=="string"||t instanceof Co?WE(this._dataReader,"WriteBatch.update",o._key,t,i,s):$E(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(c.toMutation(o._key,Lt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ro(e,this._firestore);return this._mutations=this._mutations.concat(new th(t._key,Lt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new oe(J.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ro(n,e){if((n=ve(n)).firestore!==e)throw new oe(J.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TB=class extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=sc(t)}get(t){const i=ro(t,this._firestore),s=new mB(this._firestore);return this._transaction.lookup([i._key]).then((o=>{if(!o||o.length!==1)return we();const c=o[0];if(c.isFoundDocument())return new pf(this._firestore,s,c.key,c,i.converter);if(c.isNoDocument())return new pf(this._firestore,s,i._key,null,i.converter);throw we()}))}set(t,i,s){const o=ro(t,this._firestore),c=v_(o.converter,i,s),h=p_(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,s);return this._transaction.set(o._key,h),this}update(t,i,s,...o){const c=ro(t,this._firestore);let h;return h=typeof(i=ve(i))=="string"||i instanceof Co?WE(this._dataReader,"Transaction.update",c._key,i,s,o):$E(this._dataReader,"Transaction.update",c._key,i),this._transaction.update(c._key,h),this}delete(t){const i=ro(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ro(e,this._firestore),i=new oc(this._firestore);return super.get(e).then((s=>new ra(this._firestore,i,t._key,s._document,new Dl(!1,!1),t.converter)))}};function IB(n,e,t){n=it(n,Xt);const i=Object.assign(Object.assign({},bB),t);return(function(o){if(o.maxAttempts<1)throw new oe(J.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i),(function(o,c,h){const d=new Bn;return o.asyncQueue.enqueueAndForget((async()=>{const m=await LF(o);new MF(o.asyncQueue,m,h,c,d).au()})),d.promise})(zn(n),(s=>e(new TB(n,s))),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SB(){return new Qf("deleteField")}function uD(){return new GE("serverTimestamp")}function AB(...n){return new HE("arrayUnion",n)}function xB(...n){return new KE("arrayRemove",n)}function CB(n){return new QE("increment",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(n){return zn(n=it(n,Xt)),new cD(n,(e=>oh(n,e)))}(function(e,t=!0){(function(s){Ju=s})(aa),ta(new xi("firestore",((i,{instanceIdentifier:s,options:o})=>{const c=i.getProvider("app").getImmediate(),h=new Xt(new F3(i.getProvider("auth-internal")),new G3(i.getProvider("app-check-internal")),(function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new oe(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Io(m.options.projectId,_)})(c,s),c);return o=Object.assign({useFetchStreams:t},o),h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),Yi($A,"4.7.3",e),Yi($A,"4.7.3","esm2017")})();const RB="@firebase/firestore-compat",NB="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new oe("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(){if(typeof Uint8Array>"u")throw new oe("unimplemented","Uint8Arrays are not available in this environment.")}function sC(){if(!gU())throw new oe("unimplemented","Blobs are unavailable in Firestore in this environment.")}class gf{constructor(e){this._delegate=e}static fromBase64String(e){return sC(),new gf(fs.fromBase64String(e))}static fromUint8Array(e){return rC(),new gf(fs.fromUint8Array(e))}toBase64(){return sC(),this._delegate.toBase64()}toUint8Array(){return rC(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(n){return DB(n,["next","error","complete"])}function DB(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kB{enableIndexedDbPersistence(e,t){return WF(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return YF(e._delegate)}clearIndexedDbPersistence(e){return XF(e._delegate)}}class dD{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Io||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&hs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){L2(this._delegate,e,t,i)}enableNetwork(){return ZF(this._delegate)}disableNetwork(){return eB(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,M2("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return JF(this._delegate)}onSnapshotsInSync(e){return EB(this._delegate,e)}get app(){if(!this._appCompat)throw new oe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ju(this,d_(this._delegate,e))}catch(t){throw ti(t,"collection()","Firestore.collection()")}}doc(e){try{return new pr(this,nt(this._delegate,e))}catch(t){throw ti(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new vf(this,HF(this._delegate,e))}catch(t){throw ti(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return IB(this._delegate,t=>e(new fD(this,t)))}batch(){return zn(this._delegate),new mD(new cD(this._delegate,e=>oh(this._delegate,e)))}loadBundle(e){return tB(this._delegate,e)}namedQuery(e){return nB(this._delegate,e).then(t=>t?new vf(this,t):null)}}class E_ extends tb{constructor(e){super(),this.firestore=e}convertBytes(e){return new gf(new fs(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return pr.forKey(t,this.firestore,null)}}function OB(n){V3(n)}class fD{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new E_(e)}get(e){const t=kl(e);return this._delegate.get(t).then(i=>new _f(this._firestore,new ra(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const s=kl(e);return i?(ib("Transaction.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const o=kl(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...s),this}delete(e){const t=kl(e);return this._delegate.delete(t),this}}class mD{constructor(e){this._delegate=e}set(e,t,i){const s=kl(e);return i?(ib("WriteBatch.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const o=kl(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...s),this}delete(e){const t=kl(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Wl{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new jd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new yf(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Wl.INSTANCES;let s=i.get(e);s||(s=new WeakMap,i.set(e,s));let o=s.get(t);return o||(o=new Wl(e,new E_(e),t),s.set(t,o)),o}}Wl.INSTANCES=new WeakMap;class pr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new E_(e)}static forPath(e,t,i){if(e.length%2!==0)throw new oe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new pr(t,new zt(t._delegate,i,new ge(e)))}static forKey(e,t,i){return new pr(t,new zt(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new ju(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ju(this.firestore,d_(this._delegate,e))}catch(t){throw ti(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ve(e),e instanceof zt?B2(this._delegate,e):!1}set(e,t){t=ib("DocumentReference.set",t);try{return t?No(this._delegate,e,t):No(this._delegate,e)}catch(i){throw ti(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?Er(this._delegate,e):Er(this._delegate,e,t,...i)}catch(s){throw ti(s,"updateDoc()","DocumentReference.update()")}}delete(){return w_(this._delegate)}onSnapshot(...e){const t=pD(e),i=gD(e,s=>new _f(this.firestore,new ra(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return ah(this._delegate,t,i)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=gB(this._delegate):(e==null?void 0:e.source)==="server"?t=_B(this._delegate):t=da(this._delegate),t.then(i=>new _f(this.firestore,new ra(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new pr(this.firestore,e?this._delegate.withConverter(Wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ti(n,e,t){return n.message=n.message.replace(e,t),n}function pD(n){for(const e of n)if(typeof e=="object"&&!ew(e))return e;return{}}function gD(n,e){var t,i;let s;return ew(n[0])?s=n[0]:ew(n[1])?s=n[1]:typeof n[0]=="function"?s={next:n[0],error:n[1],complete:n[2]}:s={next:n[1],error:n[2],complete:n[3]},{next:o=>{s.next&&s.next(e(o))},error:(t=s.error)===null||t===void 0?void 0:t.bind(s),complete:(i=s.complete)===null||i===void 0?void 0:i.bind(s)}}class _f{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new pr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return oD(this._delegate,e._delegate)}}class yf extends _f{data(e){const t=this._delegate.data(e);return this._delegate._converter||L3(t!==void 0),t}}let vf=class Yr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new E_(e)}where(e,t,i){try{return new Yr(this.firestore,Xr(this._delegate,Z2(e,t,i)))}catch(s){throw ti(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Yr(this.firestore,Xr(this._delegate,lB(e,t)))}catch(i){throw ti(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Yr(this.firestore,Xr(this._delegate,eD(e)))}catch(t){throw ti(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Yr(this.firestore,Xr(this._delegate,cB(e)))}catch(t){throw ti(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Yr(this.firestore,Xr(this._delegate,uB(...e)))}catch(t){throw ti(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Yr(this.firestore,Xr(this._delegate,hB(...e)))}catch(t){throw ti(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Yr(this.firestore,Xr(this._delegate,dB(...e)))}catch(t){throw ti(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Yr(this.firestore,Xr(this._delegate,fB(...e)))}catch(t){throw ti(t,"endAt()","Query.endAt()")}}isEqual(e){return z2(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=yB(this._delegate):(e==null?void 0:e.source)==="server"?t=vB(this._delegate):t=lD(this._delegate),t.then(i=>new tw(this.firestore,new Ro(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=pD(e),i=gD(e,s=>new tw(this.firestore,new Ro(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return ah(this._delegate,t,i)}withConverter(e){return new Yr(this.firestore,e?this._delegate.withConverter(Wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};class PB{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new yf(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class tw{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new vf(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new yf(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new PB(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new yf(this._firestore,i))})}isEqual(e){return oD(this._delegate,e._delegate)}}class ju extends vf{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new pr(this.firestore,e):null}doc(e){try{return e===void 0?new pr(this.firestore,nt(this._delegate)):new pr(this.firestore,nt(this._delegate,e))}catch(t){throw ti(t,"doc()","CollectionReference.doc()")}}add(e){return wB(this._delegate,e).then(t=>new pr(this.firestore,t))}isEqual(e){return B2(this._delegate,e._delegate)}withConverter(e){return new ju(this.firestore,e?this._delegate.withConverter(Wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function kl(n){return it(n,zt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(...e){this._delegate=new Co(...e)}static documentId(){return new rb(Vt.keyField().canonicalString())}isEqual(e){return e=ve(e),e instanceof Co?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e){this._delegate=e}static serverTimestamp(){const e=uD();return e._methodName="FieldValue.serverTimestamp",new Rl(e)}static delete(){const e=SB();return e._methodName="FieldValue.delete",new Rl(e)}static arrayUnion(...e){const t=AB(...e);return t._methodName="FieldValue.arrayUnion",new Rl(t)}static arrayRemove(...e){const t=xB(...e);return t._methodName="FieldValue.arrayRemove",new Rl(t)}static increment(e){const t=CB(e);return t._methodName="FieldValue.increment",new Rl(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MB={Firestore:dD,GeoPoint:f_,Timestamp:Ut,Blob:gf,Transaction:fD,WriteBatch:mD,DocumentReference:pr,DocumentSnapshot:_f,Query:vf,QueryDocumentSnapshot:yf,QuerySnapshot:tw,CollectionReference:ju,FieldPath:rb,FieldValue:Rl,setLogLevel:OB,CACHE_SIZE_UNLIMITED:QF};function VB(n,e){n.INTERNAL.registerComponent(new xi("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(i,s)},"PUBLIC").setServiceProps(Object.assign({},MB)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LB(n){VB(n,(e,t)=>new dD(e,t,new kB)),n.registerVersion(RB,NB)}LB(tc);var aC={};const oC="@firebase/database",lC="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _D="";function yD(n){_D=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jB{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_n(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Yd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UB{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Xi(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new jB(e)}}catch{}return new UB},Ol=vD("localStorage"),nw=vD("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu=new Qu("@firebase/database"),wD=(function(){let n=1;return function(){return n++}})(),ED=function(n){const e=dV(n),t=new cV;t.update(e);const i=t.digest();return Cw.encodeByteArray(i)},Wf=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Wf.apply(null,i):typeof i=="object"?e+=_n(i):e+=i,e+=" "}return e};let Ll=null,cC=!0;const bD=function(n,e){de(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(gu.logLevel=Ge.VERBOSE,Ll=gu.log.bind(gu),e&&nw.set("logging_enabled",!0)):typeof n=="function"?Ll=n:(Ll=null,nw.remove("logging_enabled"))},Rn=function(...n){if(cC===!0&&(cC=!1,Ll===null&&nw.get("logging_enabled")===!0&&bD(!0)),Ll){const e=Wf.apply(null,n);Ll(e)}},Yf=function(n){return function(...e){Rn(n,...e)}},iw=function(...n){const e="FIREBASE INTERNAL ERROR: "+Wf(...n);gu.error(e)},ms=function(...n){const e=`FIREBASE FATAL ERROR: ${Wf(...n)}`;throw gu.error(e),new Error(e)},Qn=function(...n){const e="FIREBASE WARNING: "+Wf(...n);gu.warn(e)},FB=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Qn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},b_=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},BB=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Do="[MIN_NAME]",sa="[MAX_NAME]",lc=function(n,e){if(n===e)return 0;if(n===Do||e===sa)return-1;if(e===Do||n===sa)return 1;{const t=uC(n),i=uC(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},zB=function(n,e){return n===e?0:n<e?-1:1},_d=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+_n(e))},sb=function(n){if(typeof n!="object"||n===null)return _n(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=_n(e[i]),t+=":",t+=sb(n[e[i]]);return t+="}",t},TD=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function On(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const ID=function(n){de(!b_(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,c,h,d;n===0?(o=0,c=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=h+i,c=Math.round(n*Math.pow(2,t-h)-Math.pow(2,t))):(o=0,c=Math.round(n/Math.pow(2,1-i-t))));const m=[];for(d=t;d;d-=1)m.push(c%2?1:0),c=Math.floor(c/2);for(d=e;d;d-=1)m.push(o%2?1:0),o=Math.floor(o/2);m.push(s?1:0),m.reverse();const _=m.join("");let y="";for(d=0;d<64;d+=8){let T=parseInt(_.substr(d,8),2).toString(16);T.length===1&&(T="0"+T),y=y+T}return y.toLowerCase()},qB=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},GB=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function HB(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const KB=new RegExp("^-?(0*)\\d{1,10}$"),QB=-2147483648,$B=2147483647,uC=function(n){if(KB.test(n)){const e=Number(n);if(e>=QB&&e<=$B)return e}return null},lh=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Qn("Exception was thrown by user callback.",t),e},Math.floor(0))}},WB=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ud=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YB{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Qn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XB{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Rn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Qn(e)}}class _u{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}_u.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab="5",SD="v",AD="s",xD="r",CD="f",RD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ND="ls",DD="p",rw="ac",kD="websocket",OD="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,t,i,s,o=!1,c="",h=!1,d=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ol.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ol.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function JB(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function MD(n,e,t){de(typeof e=="string","typeof type must == string"),de(typeof t=="object","typeof params must == object");let i;if(e===kD)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===OD)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);JB(n)&&(t.ns=n.namespace);const s=[];return On(t,(o,c)=>{s.push(o+"="+c)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{constructor(){this.counters_={}}incrementCounter(e,t=1){Xi(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return WM(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0={},u0={};function ob(n){const e=n.toString();return c0[e]||(c0[e]=new ZB),c0[e]}function ez(n,e){const t=n.toString();return u0[t]||(u0[t]=e()),u0[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&lh(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC="start",nz="close",iz="pLPCommand",rz="pRTLPCB",VD="id",LD="pw",jD="ser",sz="cb",az="seg",oz="ts",lz="d",cz="dframe",UD=1870,FD=30,uz=UD-FD,hz=25e3,dz=3e4;class oo{constructor(e,t,i,s,o,c,h){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Yf(e),this.stats_=ob(t),this.urlFn=d=>(this.appCheckToken&&(d[rw]=this.appCheckToken),MD(t,OD,d))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new tz(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(dz)),BB(()=>{if(this.isClosed_)return;this.scriptTagHolder=new lb((...o)=>{const[c,h,d,m,_]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===hC)this.id=h,this.password=d;else if(c===nz)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...o)=>{const[c,h]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const i={};i[hC]="t",i[jD]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[sz]=this.scriptTagHolder.uniqueCallbackIdentifier),i[SD]=ab,this.transportSessionId&&(i[AD]=this.transportSessionId),this.lastSessionId&&(i[ND]=this.lastSessionId),this.applicationId&&(i[DD]=this.applicationId),this.appCheckToken&&(i[rw]=this.appCheckToken),typeof location<"u"&&location.hostname&&RD.test(location.hostname)&&(i[xD]=CD);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){oo.forceAllow_=!0}static forceDisallow(){oo.forceDisallow_=!0}static isAvailable(){return oo.forceAllow_?!0:!oo.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!qB()&&!GB()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=_n(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=f1(t),s=TD(i,uz);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[cz]="t",i[VD]=e,i[LD]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=_n(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class lb{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=wD(),window[iz+this.uniqueCallbackIdentifier]=e,window[rz+this.uniqueCallbackIdentifier]=t,this.myIFrame=lb.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){Rn("frame writing exception"),h.stack&&Rn(h.stack),Rn(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Rn("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[VD]=this.myID,e[LD]=this.myPW,e[jD]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+FD+i.length<=UD;){const c=this.pendingSegs.shift();i=i+"&"+az+s+"="+c.seg+"&"+oz+s+"="+c.ts+"&"+lz+s+"="+c.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(hz)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Rn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz=16384,mz=45e3;let vg=null;typeof MozWebSocket<"u"?vg=MozWebSocket:typeof WebSocket<"u"&&(vg=WebSocket);class mr{constructor(e,t,i,s,o,c,h){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Yf(this.connId),this.stats_=ob(t),this.connURL=mr.connectionURL_(t,c,h,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const c={};return c[SD]=ab,typeof location<"u"&&location.hostname&&RD.test(location.hostname)&&(c[xD]=CD),t&&(c[AD]=t),i&&(c[ND]=i),s&&(c[rw]=s),o&&(c[DD]=o),MD(e,kD,c)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ol.set("previous_websocket_failure",!0);try{let i;nV(),this.mySock=new vg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){mr.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&vg!==null&&!mr.forceDisallow_}static previouslyFailed(){return Ol.isInMemoryStorage||Ol.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ol.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=Yd(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(de(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=_n(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=TD(t,fz);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(mz))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}mr.responsesRequiredToBeHealthy=2;mr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[oo,mr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=mr&&mr.isAvailable();let i=t&&!mr.previouslyFailed();if(e.webSocketOnly&&(t||Qn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[mr];else{const s=this.transports_=[];for(const o of Uu.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);Uu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Uu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pz=6e4,gz=5e3,_z=10*1024,yz=100*1024,h0="t",dC="d",vz="s",fC="r",wz="e",mC="o",pC="a",gC="n",_C="p",Ez="h";class bz{constructor(e,t,i,s,o,c,h,d,m,_){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=d,this.onKill_=m,this.lastSessionId=_,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Yf("c:"+this.id+":"),this.transportManager_=new Uu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Ud(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>yz?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>_z?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(h0 in e){const t=e[h0];t===pC?this.upgradeIfSecondaryHealthy_():t===fC?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===mC&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=_d("t",e),i=_d("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:_C,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:pC,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:gC,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=_d("t",e),i=_d("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=_d(h0,e);if(dC in e){const i=e[dC];if(t===Ez){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===gC){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===vz?this.onConnectionShutdown_(i):t===fC?this.onReset_(i):t===wz?iw("Server Error: "+i):t===mC?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):iw("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),ab!==i&&Qn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Ud(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(pz))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ud(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(gz))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:_C,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ol.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.allowedEvents_=e,this.listeners_={},de(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){de(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg extends zD{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Rw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new wg}getInitialEvent(e){return de(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=32,vC=768;class ht{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function ot(){return new ht("")}function ze(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ko(n){return n.pieces_.length-n.pieceNum_}function St(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ht(n.pieces_,e)}function cb(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Tz(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function wf(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function qD(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ht(e,0)}function jt(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof ht)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new ht(t,0)}function qe(n){return n.pieceNum_>=n.pieces_.length}function ni(n,e){const t=ze(n),i=ze(e);if(t===null)return e;if(t===i)return ni(St(n),St(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Iz(n,e){const t=wf(n,0),i=wf(e,0);for(let s=0;s<t.length&&s<i.length;s++){const o=lc(t[s],i[s]);if(o!==0)return o}return t.length===i.length?0:t.length<i.length?-1:1}function ub(n,e){if(ko(n)!==ko(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function gr(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(ko(n)>ko(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class Sz{constructor(e,t){this.errorPrefix_=t,this.parts_=wf(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=jg(this.parts_[i]);GD(this)}}function Az(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=jg(e),GD(n)}function xz(n){const e=n.parts_.pop();n.byteLength_-=jg(e),n.parts_.length>0&&(n.byteLength_-=1)}function GD(n){if(n.byteLength_>vC)throw new Error(n.errorPrefix_+"has a key path longer than "+vC+" bytes ("+n.byteLength_+").");if(n.parts_.length>yC)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+yC+") or object contains a cycle "+Il(n))}function Il(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb extends zD{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new hb}getInitialEvent(e){return de(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd=1e3,Cz=300*1e3,wC=30*1e3,Rz=1.3,Nz=3e4,Dz="server_kill",EC=3;class Zs extends BD{constructor(e,t,i,s,o,c,h,d){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=h,this.authOverride_=d,this.id=Zs.nextPersistentConnectionId_++,this.log_=Yf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=yd,this.maxReconnectDelay_=Cz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");hb.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&wg.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(_n(o)),de(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new Ei,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const h=c.d;c.s==="ok"?t.resolve(h):t.reject(h)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),de(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),de(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");const h={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(c).set(o,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},c="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(c,o,h=>{const d=h.d,m=h.s;Zs.warnOnListenWarnings_(d,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",h),m!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(m,d))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Xi(e,"w")){const i=jl(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Qn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||lV(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=wC)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=oV(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,c=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),de(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},c="n";s&&(o.q=i,o.t=s),this.sendRequest(c,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,c=>{s&&setTimeout(()=>{s(c.s,c.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const c={p:t,d:i};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:e,request:c,onComplete:s}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+_n(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):iw("Unrecognized action received from server: "+_n(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){de(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yd,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=yd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Nz&&(this.reconnectDelay_=yd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Rz)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Zs.nextConnectionId_++,o=this.lastSessionId;let c=!1,h=null;const d=function(){h?h.close():(c=!0,i())},m=function(y){de(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(y)};this.realtime_={close:d,sendRequest:m};const _=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[y,T]=await Promise.all([this.authTokenProvider_.getToken(_),this.appCheckTokenProvider_.getToken(_)]);c?Rn("getToken() completed but was canceled"):(Rn("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=T&&T.token,h=new bz(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,S=>{Qn(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(Dz)},o))}catch(y){this.log_("Failed to get token: "+y),c||(this.repoInfo_.nodeAdmin&&Qn(y),d())}}}interrupt(e){Rn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Rn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Zp(this.interruptReasons_)&&(this.reconnectDelay_=yd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>sb(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new ht(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){Rn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=EC&&(this.reconnectDelay_=wC,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Rn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=EC&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+_D.replace(/\./g,"-")]=1,Rw()?e["framework.cordova"]=1:Lg()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=wg.getInstance().currentlyOnline();return Zp(this.interruptReasons_)&&e}}Zs.nextPersistentConnectionId_=0;Zs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new He(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new He(Do,e),s=new He(Do,t);return this.compare(i,s)!==0}minPost(){return He.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mp;class HD extends T_{static get __EMPTY_NODE(){return Mp}static set __EMPTY_NODE(e){Mp=e}compare(e,t){return lc(e.name,t.name)}isDefinedOn(e){throw Ku("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return He.MIN}maxPost(){return new He(sa,Mp)}makePost(e,t){return de(typeof e=="string","KeyIndex indexValue must always be a string."),new He(e,Mp)}toString(){return".key"}}const ls=new HD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?i(e.key,t):1,s&&(c*=-1),c<0)this.isReverse_?e=e.left:e=e.right;else if(c===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Cn{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??Cn.RED,this.left=s??Si.EMPTY_NODE,this.right=o??Si.EMPTY_NODE}copy(e,t,i,s,o){return new Cn(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Si.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return Si.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Cn.RED=!0;Cn.BLACK=!1;class kz{copy(e,t,i,s,o){return this}insert(e,t,i){return new Cn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Si{constructor(e,t=Si.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Si(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Cn.BLACK,null,null))}remove(e){return new Si(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Cn.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Vp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Vp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Vp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Vp(this.root_,null,this.comparator_,!0,e)}}Si.EMPTY_NODE=new kz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(n,e){return lc(n.name,e.name)}function db(n,e){return lc(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sw;function Pz(n){sw=n}const KD=function(n){return typeof n=="number"?"number:"+ID(n):"string:"+n},QD=function(n){if(n.isLeafNode()){const e=n.val();de(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Xi(e,".sv"),"Priority must be a string or number.")}else de(n===sw||n.isEmpty(),"priority of unexpected type.");de(n===sw||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bC;class In{constructor(e,t=In.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,de(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),QD(this.priorityNode_)}static set __childrenNodeConstructor(e){bC=e}static get __childrenNodeConstructor(){return bC}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new In(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:In.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return qe(e)?this:ze(e)===".priority"?this.priorityNode_:In.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:In.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=ze(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(de(i!==".priority"||ko(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,In.__childrenNodeConstructor.EMPTY_NODE.updateChild(St(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+KD(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=ID(this.value_):e+=this.value_,this.lazyHash_=ED(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===In.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof In.__childrenNodeConstructor?-1:(de(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=In.VALUE_TYPE_ORDER.indexOf(t),o=In.VALUE_TYPE_ORDER.indexOf(i);return de(s>=0,"Unknown leaf type: "+t),de(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}In.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $D,WD;function Mz(n){$D=n}function Vz(n){WD=n}class Lz extends T_{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?lc(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return He.MIN}maxPost(){return new He(sa,new In("[PRIORITY-POST]",WD))}makePost(e,t){const i=$D(e);return new He(t,new In("[PRIORITY-POST]",i))}toString(){return".priority"}}const Rt=new Lz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz=Math.log(2);class Uz{constructor(e){const t=o=>parseInt(Math.log(o)/jz,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Eg=function(n,e,t,i){n.sort(e);const s=function(d,m){const _=m-d;let y,T;if(_===0)return null;if(_===1)return y=n[d],T=t?t(y):y,new Cn(T,y.node,Cn.BLACK,null,null);{const S=parseInt(_/2,10)+d,C=s(d,S),M=s(S+1,m);return y=n[S],T=t?t(y):y,new Cn(T,y.node,Cn.BLACK,C,M)}},o=function(d){let m=null,_=null,y=n.length;const T=function(C,M){const q=y-C,F=y;y-=C;const j=s(q+1,F),W=n[q],se=t?t(W):W;S(new Cn(se,W.node,M,null,j))},S=function(C){m?(m.left=C,m=C):(_=C,m=C)};for(let C=0;C<d.count;++C){const M=d.nextBitIsOne(),q=Math.pow(2,d.count-(C+1));M?T(q,Cn.BLACK):(T(q,Cn.BLACK),T(q,Cn.RED))}return _},c=new Uz(n.length),h=o(c);return new Si(i||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d0;const nu={};class Xs{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return de(nu&&Rt,"ChildrenNode.ts has not been loaded"),d0=d0||new Xs({".priority":nu},{".priority":Rt}),d0}get(e){const t=jl(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Si?t:null}hasIndex(e){return Xi(this.indexSet_,e.toString())}addIndex(e,t){de(e!==ls,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(He.Wrap);let c=o.getNext();for(;c;)s=s||e.isDefinedOn(c.node),i.push(c),c=o.getNext();let h;s?h=Eg(i,e.getCompare()):h=nu;const d=e.toString(),m=Object.assign({},this.indexSet_);m[d]=e;const _=Object.assign({},this.indexes_);return _[d]=h,new Xs(_,m)}addToIndexes(e,t){const i=eg(this.indexes_,(s,o)=>{const c=jl(this.indexSet_,o);if(de(c,"Missing index implementation for "+o),s===nu)if(c.isDefinedOn(e.node)){const h=[],d=t.getIterator(He.Wrap);let m=d.getNext();for(;m;)m.name!==e.name&&h.push(m),m=d.getNext();return h.push(e),Eg(h,c.getCompare())}else return nu;else{const h=t.get(e.name);let d=s;return h&&(d=d.remove(new He(e.name,h))),d.insert(e,e.node)}});return new Xs(i,this.indexSet_)}removeFromIndexes(e,t){const i=eg(this.indexes_,s=>{if(s===nu)return s;{const o=t.get(e.name);return o?s.remove(new He(e.name,o)):s}});return new Xs(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vd;class Ne{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&QD(this.priorityNode_),this.children_.isEmpty()&&de(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return vd||(vd=new Ne(new Si(db),null,Xs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||vd}updatePriority(e){return this.children_.isEmpty()?this:new Ne(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?vd:t}}getChild(e){const t=ze(e);return t===null?this:this.getImmediateChild(t).getChild(St(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(de(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new He(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const c=s.isEmpty()?vd:this.priorityNode_;return new Ne(s,c,o)}}updateChild(e,t){const i=ze(e);if(i===null)return t;{de(ze(e)!==".priority"||ko(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(St(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(Rt,(c,h)=>{t[c]=h.val(e),i++,o&&Ne.INTEGER_REGEXP_.test(c)?s=Math.max(s,Number(c)):o=!1}),!e&&o&&s<2*i){const c=[];for(const h in t)c[h]=t[h];return c}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+KD(this.getPriority().val())+":"),this.forEachChild(Rt,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":ED(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new He(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new He(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new He(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,He.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,He.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xf?-1:0}withIndex(e){if(e===ls||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ne(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===ls||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(Rt),s=t.getIterator(Rt);let o=i.getNext(),c=s.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=i.getNext(),c=s.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(e){return e===ls?null:this.indexMap_.get(e.toString())}}Ne.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Fz extends Ne{constructor(){super(new Si(db),Ne.EMPTY_NODE,Xs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ne.EMPTY_NODE}isEmpty(){return!1}}const Xf=new Fz;Object.defineProperties(He,{MIN:{value:new He(Do,Ne.EMPTY_NODE)},MAX:{value:new He(sa,Xf)}});HD.__EMPTY_NODE=Ne.EMPTY_NODE;In.__childrenNodeConstructor=Ne;Pz(Xf);Vz(Xf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz=!0;function Bt(n,e=null){if(n===null)return Ne.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),de(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new In(t,Bt(e))}if(!(n instanceof Array)&&Bz){const t=[];let i=!1;if(On(n,(c,h)=>{if(c.substring(0,1)!=="."){const d=Bt(h);d.isEmpty()||(i=i||!d.getPriority().isEmpty(),t.push(new He(c,d)))}}),t.length===0)return Ne.EMPTY_NODE;const o=Eg(t,Oz,c=>c.name,db);if(i){const c=Eg(t,Rt.getCompare());return new Ne(o,Bt(e),new Xs({".priority":c},{".priority":Rt}))}else return new Ne(o,Bt(e),Xs.Default)}else{let t=Ne.EMPTY_NODE;return On(n,(i,s)=>{if(Xi(n,i)&&i.substring(0,1)!=="."){const o=Bt(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(Bt(e))}}Mz(Bt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb extends T_{constructor(e){super(),this.indexPath_=e,de(!qe(e)&&ze(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?lc(e.name,t.name):o}makePost(e,t){const i=Bt(e),s=Ne.EMPTY_NODE.updateChild(this.indexPath_,i);return new He(t,s)}maxPost(){const e=Ne.EMPTY_NODE.updateChild(this.indexPath_,Xf);return new He(sa,e)}toString(){return wf(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz extends T_{compare(e,t){const i=e.node.compareTo(t.node);return i===0?lc(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return He.MIN}maxPost(){return He.MAX}makePost(e,t){const i=Bt(e);return new He(t,i)}toString(){return".value"}}const mb=new zz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(n){return{type:"value",snapshotNode:n}}function Fu(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Ef(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function bf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function qz(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e){this.index_=e}updateChild(e,t,i,s,o,c){de(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(s).equals(i.getChild(s))&&h.isEmpty()===i.isEmpty()||(c!=null&&(i.isEmpty()?e.hasChild(t)?c.trackChildChange(Ef(t,h)):de(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(Fu(t,i)):c.trackChildChange(bf(t,i,h))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(Rt,(s,o)=>{t.hasChild(s)||i.trackChildChange(Ef(s,o))}),t.isLeafNode()||t.forEachChild(Rt,(s,o)=>{if(e.hasChild(s)){const c=e.getImmediateChild(s);c.equals(o)||i.trackChildChange(bf(s,o,c))}else i.trackChildChange(Fu(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ne.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this.indexedFilter_=new pb(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Tf.getStartPost_(e),this.endPost_=Tf.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,c){return this.matches(new He(t,i))||(i=Ne.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,c)}updateFullNode(e,t,i){t.isLeafNode()&&(t=Ne.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(Ne.EMPTY_NODE);const o=this;return t.forEachChild(Rt,(c,h)=>{o.matches(new He(c,h))||(s=s.updateImmediateChild(c,Ne.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Tf(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,c){return this.rangedFilter_.matches(new He(t,i))||(i=Ne.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,c):this.fullLimitUpdateChild_(e,t,i,o,c)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=Ne.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=Ne.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;o.hasNext()&&c<this.limit_;){const h=o.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))s=s.updateImmediateChild(h.name,h.node),c++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(Ne.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let c=0;for(;o.hasNext();){const h=o.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:s=s.updateImmediateChild(h.name,Ne.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let c;if(this.reverse_){const y=this.index_.getCompare();c=(T,S)=>y(S,T)}else c=this.index_.getCompare();const h=e;de(h.numChildren()===this.limit_,"");const d=new He(t,i),m=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),_=this.rangedFilter_.matches(d);if(h.hasChild(t)){const y=h.getImmediateChild(t);let T=s.getChildAfterChild(this.index_,m,this.reverse_);for(;T!=null&&(T.name===t||h.hasChild(T.name));)T=s.getChildAfterChild(this.index_,T,this.reverse_);const S=T==null?1:c(T,d);if(_&&!i.isEmpty()&&S>=0)return o!=null&&o.trackChildChange(bf(t,i,y)),h.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(Ef(t,y));const M=h.updateImmediateChild(t,Ne.EMPTY_NODE);return T!=null&&this.rangedFilter_.matches(T)?(o!=null&&o.trackChildChange(Fu(T.name,T.node)),M.updateImmediateChild(T.name,T.node)):M}}else return i.isEmpty()?e:_&&c(m,d)>=0?(o!=null&&(o.trackChildChange(Ef(m.name,m.node)),o.trackChildChange(Fu(t,i))),h.updateImmediateChild(t,i).updateImmediateChild(m.name,Ne.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Rt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return de(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return de(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Do}hasEnd(){return this.endSet_}getIndexEndValue(){return de(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return de(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:sa}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return de(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Rt}copy(){const e=new I_;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Hz(n){return n.loadsAllData()?new pb(n.getIndex()):n.hasLimit()?new Gz(n):new Tf(n)}function Kz(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function Qz(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function aw(n,e,t){const i=n.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,t!=null?(i.startNameSet_=!0,i.indexStartName_=t):(i.startNameSet_=!1,i.indexStartName_=""),i}function $z(n,e,t){let i;return n.index_===ls||t?i=aw(n,e,t):i=aw(n,e,sa),i.startAfterSet_=!0,i}function ow(n,e,t){const i=n.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,t!==void 0?(i.endNameSet_=!0,i.indexEndName_=t):(i.endNameSet_=!1,i.indexEndName_=""),i}function Wz(n,e,t){let i;return n.index_===ls||t?i=ow(n,e,t):i=ow(n,e,Do),i.endBeforeSet_=!0,i}function S_(n,e){const t=n.copy();return t.index_=e,t}function TC(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Rt?t="$priority":n.index_===mb?t="$value":n.index_===ls?t="$key":(de(n.index_ instanceof fb,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=_n(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=_n(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+_n(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=_n(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+_n(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function IC(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Rt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg extends BD{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=Yf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(de(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const c=bg.getListenId_(e,i),h={};this.listens_[c]=h;const d=TC(e._queryParams);this.restRequest_(o+".json",d,(m,_)=>{let y=_;if(m===404&&(y=null,m=null),m===null&&this.onDataUpdate_(o,y,!1,i),jl(this.listens_,c)===h){let T;m?m===401?T="permission_denied":T="rest_error:"+m:T="ok",s(T,null)}})}unlisten(e,t){const i=bg.getListenId_(e,t);delete this.listens_[i]}get(e){const t=TC(e._queryParams),i=e._path.toString(),s=new Ei;return this.restRequest_(i+".json",t,(o,c)=>{let h=c;o===404&&(h=null,o=null),o===null?(this.onDataUpdate_(i,h,!1,null),s.resolve(h)):s.reject(new Error(h))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ec(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(i&&h.readyState===4){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let d=null;if(h.status>=200&&h.status<300){try{d=Yd(h.responseText)}catch{Qn("Failed to parse JSON response for "+c+": "+h.responseText)}i(null,d)}else h.status!==401&&h.status!==404&&Qn("Got unsuccessful REST response for "+c+" Status: "+h.status),i(h.status);i=null}},h.open("GET",c,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yz{constructor(){this.rootNode_=Ne.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(){return{value:null,children:new Map}}function ch(n,e,t){if(qe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=ze(e);n.children.has(i)||n.children.set(i,Tg());const s=n.children.get(i);e=St(e),ch(s,e,t)}}function lw(n,e){if(qe(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Rt,(i,s)=>{ch(n,new ht(i),s)}),lw(n,e)}}else if(n.children.size>0){const t=ze(e);return e=St(e),n.children.has(t)&&lw(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function cw(n,e,t){n.value!==null?t(e,n.value):Xz(n,(i,s)=>{const o=new ht(e.toString()+"/"+i);cw(s,o,t)})}function Xz(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jz{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&On(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC=10*1e3,Zz=30*1e3,e9=300*1e3;class t9{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Jz(e);const i=SC+(Zz-SC)*Math.random();Ud(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;On(e,(s,o)=>{o>0&&Xi(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),Ud(this.reportStats_.bind(this),Math.floor(Math.random()*2*e9))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mr;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Mr||(Mr={}));function gb(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function _b(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function yb(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Mr.ACK_USER_WRITE,this.source=gb()}operationForChild(e){if(qe(this.path)){if(this.affectedTree.value!=null)return de(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ht(e));return new Ig(ot(),t,this.revert)}}else return de(ze(this.path)===e,"operationForChild called for unrelated child."),new Ig(St(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t){this.source=e,this.path=t,this.type=Mr.LISTEN_COMPLETE}operationForChild(e){return qe(this.path)?new If(this.source,ot()):new If(this.source,St(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Mr.OVERWRITE}operationForChild(e){return qe(this.path)?new Yl(this.source,ot(),this.snap.getImmediateChild(e)):new Yl(this.source,St(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Mr.MERGE}operationForChild(e){if(qe(this.path)){const t=this.children.subtree(new ht(e));return t.isEmpty()?null:t.value?new Yl(this.source,ot(),t.value):new Bu(this.source,ot(),t)}else return de(ze(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Bu(this.source,St(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(qe(e))return this.isFullyInitialized()&&!this.filtered_;const t=ze(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function i9(n,e,t,i){const s=[],o=[];return e.forEach(c=>{c.type==="child_changed"&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&o.push(qz(c.childName,c.snapshotNode))}),wd(n,s,"child_removed",e,i,t),wd(n,s,"child_added",e,i,t),wd(n,s,"child_moved",o,i,t),wd(n,s,"child_changed",e,i,t),wd(n,s,"value",e,i,t),s}function wd(n,e,t,i,s,o){const c=i.filter(h=>h.type===t);c.sort((h,d)=>s9(n,h,d)),c.forEach(h=>{const d=r9(n,h,o);s.forEach(m=>{m.respondsTo(h.type)&&e.push(m.createEvent(d,n.query_))})})}function r9(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function s9(n,e,t){if(e.childName==null||t.childName==null)throw Ku("Should only compare child_ events.");const i=new He(e.childName,e.snapshotNode),s=new He(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(n,e){return{eventCache:n,serverCache:e}}function Fd(n,e,t,i){return A_(new Oo(e,t,i),n.serverCache)}function XD(n,e,t,i){return A_(n.eventCache,new Oo(e,t,i))}function Sg(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Xl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let f0;const a9=()=>(f0||(f0=new Si(zB)),f0);class Ct{constructor(e,t=a9()){this.value=e,this.children=t}static fromObject(e){let t=new Ct(null);return On(e,(i,s)=>{t=t.set(new ht(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:ot(),value:this.value};if(qe(e))return null;{const i=ze(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(St(e),t);return o!=null?{path:jt(new ht(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(qe(e))return this;{const t=ze(e),i=this.children.get(t);return i!==null?i.subtree(St(e)):new Ct(null)}}set(e,t){if(qe(e))return new Ct(t,this.children);{const i=ze(e),o=(this.children.get(i)||new Ct(null)).set(St(e),t),c=this.children.insert(i,o);return new Ct(this.value,c)}}remove(e){if(qe(e))return this.children.isEmpty()?new Ct(null):new Ct(null,this.children);{const t=ze(e),i=this.children.get(t);if(i){const s=i.remove(St(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Ct(null):new Ct(this.value,o)}else return this}}get(e){if(qe(e))return this.value;{const t=ze(e),i=this.children.get(t);return i?i.get(St(e)):null}}setTree(e,t){if(qe(e))return t;{const i=ze(e),o=(this.children.get(i)||new Ct(null)).setTree(St(e),t);let c;return o.isEmpty()?c=this.children.remove(i):c=this.children.insert(i,o),new Ct(this.value,c)}}fold(e){return this.fold_(ot(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(jt(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,ot(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(qe(e))return null;{const o=ze(e),c=this.children.get(o);return c?c.findOnPath_(St(e),jt(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ot(),t)}foreachOnPath_(e,t,i){if(qe(e))return this;{this.value&&i(t,this.value);const s=ze(e),o=this.children.get(s);return o?o.foreachOnPath_(St(e),jt(t,s),i):new Ct(null)}}foreach(e){this.foreach_(ot(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(jt(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this.writeTree_=e}static empty(){return new Vr(new Ct(null))}}function Bd(n,e,t){if(qe(e))return new Vr(new Ct(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const c=ni(s,e);return o=o.updateChild(c,t),new Vr(n.writeTree_.set(s,o))}else{const s=new Ct(t),o=n.writeTree_.setTree(e,s);return new Vr(o)}}}function uw(n,e,t){let i=n;return On(t,(s,o)=>{i=Bd(i,jt(e,s),o)}),i}function AC(n,e){if(qe(e))return Vr.empty();{const t=n.writeTree_.setTree(e,new Ct(null));return new Vr(t)}}function hw(n,e){return cc(n,e)!=null}function cc(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ni(t.path,e)):null}function xC(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Rt,(i,s)=>{e.push(new He(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new He(i,s.value))}),e}function po(n,e){if(qe(e))return n;{const t=cc(n,e);return t!=null?new Vr(new Ct(t)):new Vr(n.writeTree_.subtree(e))}}function dw(n){return n.writeTree_.isEmpty()}function zu(n,e){return JD(ot(),n.writeTree_,e)}function JD(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(de(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=JD(jt(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(jt(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(n,e){return nk(e,n)}function o9(n,e,t,i,s){de(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=Bd(n.visibleWrites,e,t)),n.lastWriteId=i}function l9(n,e,t,i){de(i>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:i,visible:!0}),n.visibleWrites=uw(n.visibleWrites,e,t),n.lastWriteId=i}function c9(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function u9(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);de(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,c=n.allWrites.length-1;for(;s&&c>=0;){const h=n.allWrites[c];h.visible&&(c>=t&&h9(h,i.path)?s=!1:gr(i.path,h.path)&&(o=!0)),c--}if(s){if(o)return d9(n),!0;if(i.snap)n.visibleWrites=AC(n.visibleWrites,i.path);else{const h=i.children;On(h,d=>{n.visibleWrites=AC(n.visibleWrites,jt(i.path,d))})}return!0}else return!1}function h9(n,e){if(n.snap)return gr(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&gr(jt(n.path,t),e))return!0;return!1}function d9(n){n.visibleWrites=ZD(n.allWrites,f9,ot()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function f9(n){return n.visible}function ZD(n,e,t){let i=Vr.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const c=o.path;let h;if(o.snap)gr(t,c)?(h=ni(t,c),i=Bd(i,h,o.snap)):gr(c,t)&&(h=ni(c,t),i=Bd(i,ot(),o.snap.getChild(h)));else if(o.children){if(gr(t,c))h=ni(t,c),i=uw(i,h,o.children);else if(gr(c,t))if(h=ni(c,t),qe(h))i=uw(i,ot(),o.children);else{const d=jl(o.children,ze(h));if(d){const m=d.getChild(St(h));i=Bd(i,ot(),m)}}}else throw Ku("WriteRecord should have .snap or .children")}}return i}function ek(n,e,t,i,s){if(!i&&!s){const o=cc(n.visibleWrites,e);if(o!=null)return o;{const c=po(n.visibleWrites,e);if(dw(c))return t;if(t==null&&!hw(c,ot()))return null;{const h=t||Ne.EMPTY_NODE;return zu(c,h)}}}else{const o=po(n.visibleWrites,e);if(!s&&dw(o))return t;if(!s&&t==null&&!hw(o,ot()))return null;{const c=function(m){return(m.visible||s)&&(!i||!~i.indexOf(m.writeId))&&(gr(m.path,e)||gr(e,m.path))},h=ZD(n.allWrites,c,e),d=t||Ne.EMPTY_NODE;return zu(h,d)}}}function m9(n,e,t){let i=Ne.EMPTY_NODE;const s=cc(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Rt,(o,c)=>{i=i.updateImmediateChild(o,c)}),i;if(t){const o=po(n.visibleWrites,e);return t.forEachChild(Rt,(c,h)=>{const d=zu(po(o,new ht(c)),h);i=i.updateImmediateChild(c,d)}),xC(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}else{const o=po(n.visibleWrites,e);return xC(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}}function p9(n,e,t,i,s){de(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=jt(e,t);if(hw(n.visibleWrites,o))return null;{const c=po(n.visibleWrites,o);return dw(c)?s.getChild(t):zu(c,s.getChild(t))}}function g9(n,e,t,i){const s=jt(e,t),o=cc(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const c=po(n.visibleWrites,s);return zu(c,i.getNode().getImmediateChild(t))}else return null}function _9(n,e){return cc(n.visibleWrites,e)}function y9(n,e,t,i,s,o,c){let h;const d=po(n.visibleWrites,e),m=cc(d,ot());if(m!=null)h=m;else if(t!=null)h=zu(d,t);else return[];if(h=h.withIndex(c),!h.isEmpty()&&!h.isLeafNode()){const _=[],y=c.getCompare(),T=o?h.getReverseIteratorFrom(i,c):h.getIteratorFrom(i,c);let S=T.getNext();for(;S&&_.length<s;)y(S,i)!==0&&_.push(S),S=T.getNext();return _}else return[]}function v9(){return{visibleWrites:Vr.empty(),allWrites:[],lastWriteId:-1}}function Ag(n,e,t,i){return ek(n.writeTree,n.treePath,e,t,i)}function vb(n,e){return m9(n.writeTree,n.treePath,e)}function CC(n,e,t,i){return p9(n.writeTree,n.treePath,e,t,i)}function xg(n,e){return _9(n.writeTree,jt(n.treePath,e))}function w9(n,e,t,i,s,o){return y9(n.writeTree,n.treePath,e,t,i,s,o)}function wb(n,e,t){return g9(n.writeTree,n.treePath,e,t)}function tk(n,e){return nk(jt(n.treePath,e),n.writeTree)}function nk(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;de(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),de(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,bf(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,Ef(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,Fu(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,bf(i,e.snapshotNode,s.oldSnap));else throw Ku("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const ik=new b9;class Eb{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new Oo(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return wb(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Xl(this.viewCache_),o=w9(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T9(n){return{filter:n}}function I9(n,e){de(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),de(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function S9(n,e,t,i,s){const o=new E9;let c,h;if(t.type===Mr.OVERWRITE){const m=t;m.source.fromUser?c=fw(n,e,m.path,m.snap,i,s,o):(de(m.source.fromServer,"Unknown source."),h=m.source.tagged||e.serverCache.isFiltered()&&!qe(m.path),c=Cg(n,e,m.path,m.snap,i,s,h,o))}else if(t.type===Mr.MERGE){const m=t;m.source.fromUser?c=x9(n,e,m.path,m.children,i,s,o):(de(m.source.fromServer,"Unknown source."),h=m.source.tagged||e.serverCache.isFiltered(),c=mw(n,e,m.path,m.children,i,s,h,o))}else if(t.type===Mr.ACK_USER_WRITE){const m=t;m.revert?c=N9(n,e,m.path,i,s,o):c=C9(n,e,m.path,m.affectedTree,i,s,o)}else if(t.type===Mr.LISTEN_COMPLETE)c=R9(n,e,t.path,i,o);else throw Ku("Unknown operation type: "+t.type);const d=o.getChanges();return A9(e,c,d),{viewCache:c,changes:d}}function A9(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Sg(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(YD(Sg(e)))}}function rk(n,e,t,i,s,o){const c=e.eventCache;if(xg(i,t)!=null)return e;{let h,d;if(qe(t))if(de(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const m=Xl(e),_=m instanceof Ne?m:Ne.EMPTY_NODE,y=vb(i,_);h=n.filter.updateFullNode(e.eventCache.getNode(),y,o)}else{const m=Ag(i,Xl(e));h=n.filter.updateFullNode(e.eventCache.getNode(),m,o)}else{const m=ze(t);if(m===".priority"){de(ko(t)===1,"Can't have a priority with additional path components");const _=c.getNode();d=e.serverCache.getNode();const y=CC(i,t,_,d);y!=null?h=n.filter.updatePriority(_,y):h=c.getNode()}else{const _=St(t);let y;if(c.isCompleteForChild(m)){d=e.serverCache.getNode();const T=CC(i,t,c.getNode(),d);T!=null?y=c.getNode().getImmediateChild(m).updateChild(_,T):y=c.getNode().getImmediateChild(m)}else y=wb(i,m,e.serverCache);y!=null?h=n.filter.updateChild(c.getNode(),m,y,_,s,o):h=c.getNode()}}return Fd(e,h,c.isFullyInitialized()||qe(t),n.filter.filtersNodes())}}function Cg(n,e,t,i,s,o,c,h){const d=e.serverCache;let m;const _=c?n.filter:n.filter.getIndexedFilter();if(qe(t))m=_.updateFullNode(d.getNode(),i,null);else if(_.filtersNodes()&&!d.isFiltered()){const S=d.getNode().updateChild(t,i);m=_.updateFullNode(d.getNode(),S,null)}else{const S=ze(t);if(!d.isCompleteForPath(t)&&ko(t)>1)return e;const C=St(t),q=d.getNode().getImmediateChild(S).updateChild(C,i);S===".priority"?m=_.updatePriority(d.getNode(),q):m=_.updateChild(d.getNode(),S,q,C,ik,null)}const y=XD(e,m,d.isFullyInitialized()||qe(t),_.filtersNodes()),T=new Eb(s,y,o);return rk(n,y,t,s,T,h)}function fw(n,e,t,i,s,o,c){const h=e.eventCache;let d,m;const _=new Eb(s,e,o);if(qe(t))m=n.filter.updateFullNode(e.eventCache.getNode(),i,c),d=Fd(e,m,!0,n.filter.filtersNodes());else{const y=ze(t);if(y===".priority")m=n.filter.updatePriority(e.eventCache.getNode(),i),d=Fd(e,m,h.isFullyInitialized(),h.isFiltered());else{const T=St(t),S=h.getNode().getImmediateChild(y);let C;if(qe(T))C=i;else{const M=_.getCompleteChild(y);M!=null?cb(T)===".priority"&&M.getChild(qD(T)).isEmpty()?C=M:C=M.updateChild(T,i):C=Ne.EMPTY_NODE}if(S.equals(C))d=e;else{const M=n.filter.updateChild(h.getNode(),y,C,T,_,c);d=Fd(e,M,h.isFullyInitialized(),n.filter.filtersNodes())}}}return d}function RC(n,e){return n.eventCache.isCompleteForChild(e)}function x9(n,e,t,i,s,o,c){let h=e;return i.foreach((d,m)=>{const _=jt(t,d);RC(e,ze(_))&&(h=fw(n,h,_,m,s,o,c))}),i.foreach((d,m)=>{const _=jt(t,d);RC(e,ze(_))||(h=fw(n,h,_,m,s,o,c))}),h}function NC(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function mw(n,e,t,i,s,o,c,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let d=e,m;qe(t)?m=i:m=new Ct(null).setTree(t,i);const _=e.serverCache.getNode();return m.children.inorderTraversal((y,T)=>{if(_.hasChild(y)){const S=e.serverCache.getNode().getImmediateChild(y),C=NC(n,S,T);d=Cg(n,d,new ht(y),C,s,o,c,h)}}),m.children.inorderTraversal((y,T)=>{const S=!e.serverCache.isCompleteForChild(y)&&T.value===null;if(!_.hasChild(y)&&!S){const C=e.serverCache.getNode().getImmediateChild(y),M=NC(n,C,T);d=Cg(n,d,new ht(y),M,s,o,c,h)}}),d}function C9(n,e,t,i,s,o,c){if(xg(s,t)!=null)return e;const h=e.serverCache.isFiltered(),d=e.serverCache;if(i.value!=null){if(qe(t)&&d.isFullyInitialized()||d.isCompleteForPath(t))return Cg(n,e,t,d.getNode().getChild(t),s,o,h,c);if(qe(t)){let m=new Ct(null);return d.getNode().forEachChild(ls,(_,y)=>{m=m.set(new ht(_),y)}),mw(n,e,t,m,s,o,h,c)}else return e}else{let m=new Ct(null);return i.foreach((_,y)=>{const T=jt(t,_);d.isCompleteForPath(T)&&(m=m.set(_,d.getNode().getChild(T)))}),mw(n,e,t,m,s,o,h,c)}}function R9(n,e,t,i,s){const o=e.serverCache,c=XD(e,o.getNode(),o.isFullyInitialized()||qe(t),o.isFiltered());return rk(n,c,t,i,ik,s)}function N9(n,e,t,i,s,o){let c;if(xg(i,t)!=null)return e;{const h=new Eb(i,e,s),d=e.eventCache.getNode();let m;if(qe(t)||ze(t)===".priority"){let _;if(e.serverCache.isFullyInitialized())_=Ag(i,Xl(e));else{const y=e.serverCache.getNode();de(y instanceof Ne,"serverChildren would be complete if leaf node"),_=vb(i,y)}_=_,m=n.filter.updateFullNode(d,_,o)}else{const _=ze(t);let y=wb(i,_,e.serverCache);y==null&&e.serverCache.isCompleteForChild(_)&&(y=d.getImmediateChild(_)),y!=null?m=n.filter.updateChild(d,_,y,St(t),h,o):e.eventCache.getNode().hasChild(_)?m=n.filter.updateChild(d,_,Ne.EMPTY_NODE,St(t),h,o):m=d,m.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=Ag(i,Xl(e)),c.isLeafNode()&&(m=n.filter.updateFullNode(m,c,o)))}return c=e.serverCache.isFullyInitialized()||xg(i,ot())!=null,Fd(e,m,c,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new pb(i.getIndex()),o=Hz(i);this.processor_=T9(o);const c=t.serverCache,h=t.eventCache,d=s.updateFullNode(Ne.EMPTY_NODE,c.getNode(),null),m=o.updateFullNode(Ne.EMPTY_NODE,h.getNode(),null),_=new Oo(d,c.isFullyInitialized(),s.filtersNodes()),y=new Oo(m,h.isFullyInitialized(),o.filtersNodes());this.viewCache_=A_(y,_),this.eventGenerator_=new n9(this.query_)}get query(){return this.query_}}function k9(n){return n.viewCache_.serverCache.getNode()}function O9(n){return Sg(n.viewCache_)}function P9(n,e){const t=Xl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!qe(e)&&!t.getImmediateChild(ze(e)).isEmpty())?t.getChild(e):null}function DC(n){return n.eventRegistrations_.length===0}function M9(n,e){n.eventRegistrations_.push(e)}function kC(n,e,t){const i=[];if(t){de(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const c=o.createCancelEvent(t,s);c&&i.push(c)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const c=n.eventRegistrations_[o];if(!c.matches(e))s.push(c);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function OC(n,e,t,i){e.type===Mr.MERGE&&e.source.queryId!==null&&(de(Xl(n.viewCache_),"We should always have a full cache before handling merges"),de(Sg(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=S9(n.processor_,s,e,t,i);return I9(n.processor_,o.viewCache),de(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,sk(n,o.changes,o.viewCache.eventCache.getNode(),null)}function V9(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Rt,(o,c)=>{i.push(Fu(o,c))}),t.isFullyInitialized()&&i.push(YD(t.getNode())),sk(n,i,t.getNode(),e)}function sk(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return i9(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rg;class ak{constructor(){this.views=new Map}}function L9(n){de(!Rg,"__referenceConstructor has already been defined"),Rg=n}function j9(){return de(Rg,"Reference.ts has not been loaded"),Rg}function U9(n){return n.views.size===0}function bb(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return de(o!=null,"SyncTree gave us an op for an invalid query."),OC(o,e,t,i)}else{let o=[];for(const c of n.views.values())o=o.concat(OC(c,e,t,i));return o}}function ok(n,e,t,i,s){const o=e._queryIdentifier,c=n.views.get(o);if(!c){let h=Ag(t,s?i:null),d=!1;h?d=!0:i instanceof Ne?(h=vb(t,i),d=!1):(h=Ne.EMPTY_NODE,d=!1);const m=A_(new Oo(h,d,!1),new Oo(i,s,!1));return new D9(e,m)}return c}function F9(n,e,t,i,s,o){const c=ok(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),M9(c,t),V9(c,t)}function B9(n,e,t,i){const s=e._queryIdentifier,o=[];let c=[];const h=Po(n);if(s==="default")for(const[d,m]of n.views.entries())c=c.concat(kC(m,t,i)),DC(m)&&(n.views.delete(d),m.query._queryParams.loadsAllData()||o.push(m.query));else{const d=n.views.get(s);d&&(c=c.concat(kC(d,t,i)),DC(d)&&(n.views.delete(s),d.query._queryParams.loadsAllData()||o.push(d.query)))}return h&&!Po(n)&&o.push(new(j9())(e._repo,e._path)),{removed:o,events:c}}function lk(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function go(n,e){let t=null;for(const i of n.views.values())t=t||P9(i,e);return t}function ck(n,e){if(e._queryParams.loadsAllData())return C_(n);{const i=e._queryIdentifier;return n.views.get(i)}}function uk(n,e){return ck(n,e)!=null}function Po(n){return C_(n)!=null}function C_(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ng;function z9(n){de(!Ng,"__referenceConstructor has already been defined"),Ng=n}function q9(){return de(Ng,"Reference.ts has not been loaded"),Ng}let G9=1;class PC{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ct(null),this.pendingWriteTree_=v9(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Tb(n,e,t,i,s){return o9(n.pendingWriteTree_,e,t,i,s),s?uh(n,new Yl(gb(),e,t)):[]}function H9(n,e,t,i){l9(n.pendingWriteTree_,e,t,i);const s=Ct.fromObject(t);return uh(n,new Bu(gb(),e,s))}function lo(n,e,t=!1){const i=c9(n.pendingWriteTree_,e);if(u9(n.pendingWriteTree_,e)){let o=new Ct(null);return i.snap!=null?o=o.set(ot(),!0):On(i.children,c=>{o=o.set(new ht(c),!0)}),uh(n,new Ig(i.path,o,t))}else return[]}function Jf(n,e,t){return uh(n,new Yl(_b(),e,t))}function K9(n,e,t){const i=Ct.fromObject(t);return uh(n,new Bu(_b(),e,i))}function Q9(n,e){return uh(n,new If(_b(),e))}function $9(n,e,t){const i=Ib(n,t);if(i){const s=Sb(i),o=s.path,c=s.queryId,h=ni(o,e),d=new If(yb(c),h);return Ab(n,o,d)}else return[]}function Dg(n,e,t,i,s=!1){const o=e._path,c=n.syncPointTree_.get(o);let h=[];if(c&&(e._queryIdentifier==="default"||uk(c,e))){const d=B9(c,e,t,i);U9(c)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const m=d.removed;if(h=d.events,!s){const _=m.findIndex(T=>T._queryParams.loadsAllData())!==-1,y=n.syncPointTree_.findOnPath(o,(T,S)=>Po(S));if(_&&!y){const T=n.syncPointTree_.subtree(o);if(!T.isEmpty()){const S=X9(T);for(let C=0;C<S.length;++C){const M=S[C],q=M.query,F=mk(n,M);n.listenProvider_.startListening(zd(q),Sf(n,q),F.hashFn,F.onComplete)}}}!y&&m.length>0&&!i&&(_?n.listenProvider_.stopListening(zd(e),null):m.forEach(T=>{const S=n.queryToTagMap.get(N_(T));n.listenProvider_.stopListening(zd(T),S)}))}J9(n,m)}return h}function hk(n,e,t,i){const s=Ib(n,i);if(s!=null){const o=Sb(s),c=o.path,h=o.queryId,d=ni(c,e),m=new Yl(yb(h),d,t);return Ab(n,c,m)}else return[]}function W9(n,e,t,i){const s=Ib(n,i);if(s){const o=Sb(s),c=o.path,h=o.queryId,d=ni(c,e),m=Ct.fromObject(t),_=new Bu(yb(h),d,m);return Ab(n,c,_)}else return[]}function pw(n,e,t,i=!1){const s=e._path;let o=null,c=!1;n.syncPointTree_.foreachOnPath(s,(T,S)=>{const C=ni(T,s);o=o||go(S,C),c=c||Po(S)});let h=n.syncPointTree_.get(s);h?(c=c||Po(h),o=o||go(h,ot())):(h=new ak,n.syncPointTree_=n.syncPointTree_.set(s,h));let d;o!=null?d=!0:(d=!1,o=Ne.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((S,C)=>{const M=go(C,ot());M&&(o=o.updateImmediateChild(S,M))}));const m=uk(h,e);if(!m&&!e._queryParams.loadsAllData()){const T=N_(e);de(!n.queryToTagMap.has(T),"View does not exist, but we have a tag");const S=Z9();n.queryToTagMap.set(T,S),n.tagToQueryMap.set(S,T)}const _=x_(n.pendingWriteTree_,s);let y=F9(h,e,t,_,o,d);if(!m&&!c&&!i){const T=ck(h,e);y=y.concat(eq(n,e,T))}return y}function R_(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(c,h)=>{const d=ni(c,e),m=go(h,d);if(m)return m});return ek(s,e,o,t,!0)}function Y9(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(m,_)=>{const y=ni(m,t);i=i||go(_,y)});let s=n.syncPointTree_.get(t);s?i=i||go(s,ot()):(s=new ak,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,c=o?new Oo(i,!0,!1):null,h=x_(n.pendingWriteTree_,e._path),d=ok(s,e,h,o?c.getNode():Ne.EMPTY_NODE,o);return O9(d)}function uh(n,e){return dk(e,n.syncPointTree_,null,x_(n.pendingWriteTree_,ot()))}function dk(n,e,t,i){if(qe(n.path))return fk(n,e,t,i);{const s=e.get(ot());t==null&&s!=null&&(t=go(s,ot()));let o=[];const c=ze(n.path),h=n.operationForChild(c),d=e.children.get(c);if(d&&h){const m=t?t.getImmediateChild(c):null,_=tk(i,c);o=o.concat(dk(h,d,m,_))}return s&&(o=o.concat(bb(s,n,i,t))),o}}function fk(n,e,t,i){const s=e.get(ot());t==null&&s!=null&&(t=go(s,ot()));let o=[];return e.children.inorderTraversal((c,h)=>{const d=t?t.getImmediateChild(c):null,m=tk(i,c),_=n.operationForChild(c);_&&(o=o.concat(fk(_,h,d,m)))}),s&&(o=o.concat(bb(s,n,i,t))),o}function mk(n,e){const t=e.query,i=Sf(n,t);return{hashFn:()=>(k9(e)||Ne.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?$9(n,t._path,i):Q9(n,t._path);{const o=HB(s,t);return Dg(n,t,null,o)}}}}function Sf(n,e){const t=N_(e);return n.queryToTagMap.get(t)}function N_(n){return n._path.toString()+"$"+n._queryIdentifier}function Ib(n,e){return n.tagToQueryMap.get(e)}function Sb(n){const e=n.indexOf("$");return de(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ht(n.substr(0,e))}}function Ab(n,e,t){const i=n.syncPointTree_.get(e);de(i,"Missing sync point for query tag that we're tracking");const s=x_(n.pendingWriteTree_,e);return bb(i,t,s,null)}function X9(n){return n.fold((e,t,i)=>{if(t&&Po(t))return[C_(t)];{let s=[];return t&&(s=lk(t)),On(i,(o,c)=>{s=s.concat(c)}),s}})}function zd(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(q9())(n._repo,n._path):n}function J9(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=N_(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function Z9(){return G9++}function eq(n,e,t){const i=e._path,s=Sf(n,e),o=mk(n,t),c=n.listenProvider_.startListening(zd(e),s,o.hashFn,o.onComplete),h=n.syncPointTree_.subtree(i);if(s)de(!Po(h.value),"If we're adding a query, it shouldn't be shadowed");else{const d=h.fold((m,_,y)=>{if(!qe(m)&&_&&Po(_))return[C_(_).query];{let T=[];return _&&(T=T.concat(lk(_).map(S=>S.query))),On(y,(S,C)=>{T=T.concat(C)}),T}});for(let m=0;m<d.length;++m){const _=d[m];n.listenProvider_.stopListening(zd(_),Sf(n,_))}}return c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new xb(t)}node(){return this.node_}}class Cb{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=jt(this.path_,e);return new Cb(this.syncTree_,t)}node(){return R_(this.syncTree_,this.path_)}}const tq=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},MC=function(n,e,t){if(!n||typeof n!="object")return n;if(de(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return nq(n[".sv"],e,t);if(typeof n[".sv"]=="object")return iq(n[".sv"],e);de(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},nq=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:de(!1,"Unexpected server value: "+n)}},iq=function(n,e,t){n.hasOwnProperty("increment")||de(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&de(!1,"Unexpected increment value: "+i);const s=e.node();if(de(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const c=s.getValue();return typeof c!="number"?i:c+i},pk=function(n,e,t,i){return Nb(e,new Cb(t,n),i)},Rb=function(n,e,t){return Nb(n,new xb(e),t)};function Nb(n,e,t){const i=n.getPriority().val(),s=MC(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const c=n,h=MC(c.getValue(),e,t);return h!==c.getValue()||s!==c.getPriority().val()?new In(h,Bt(s)):n}else{const c=n;return o=c,s!==c.getPriority().val()&&(o=o.updatePriority(new In(s))),c.forEachChild(Rt,(h,d)=>{const m=Nb(d,e.getImmediateChild(h),t);m!==d&&(o=o.updateImmediateChild(h,m))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function D_(n,e){let t=e instanceof ht?e:new ht(e),i=n,s=ze(t);for(;s!==null;){const o=jl(i.node.children,s)||{children:{},childCount:0};i=new Db(s,i,o),t=St(t),s=ze(t)}return i}function uc(n){return n.node.value}function kb(n,e){n.node.value=e,gw(n)}function gk(n){return n.node.childCount>0}function rq(n){return uc(n)===void 0&&!gk(n)}function k_(n,e){On(n.node.children,(t,i)=>{e(new Db(t,n,i))})}function _k(n,e,t,i){t&&e(n),k_(n,s=>{_k(s,e,!0)})}function sq(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Zf(n){return new ht(n.parent===null?n.name:Zf(n.parent)+"/"+n.name)}function gw(n){n.parent!==null&&aq(n.parent,n.name,n)}function aq(n,e,t){const i=rq(t),s=Xi(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,gw(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,gw(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oq=/[\[\].#$\/\u0000-\u001F\u007F]/,lq=/[\[\].#$\u0000-\u001F\u007F]/,m0=10*1024*1024,O_=function(n){return typeof n=="string"&&n.length!==0&&!oq.test(n)},yk=function(n){return typeof n=="string"&&n.length!==0&&!lq.test(n)},cq=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),yk(n)},Af=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!b_(n)||n&&typeof n=="object"&&Xi(n,".sv")},ps=function(n,e,t,i){i&&e===void 0||em(Ai(n,"value"),e,t)},em=function(n,e,t){const i=t instanceof ht?new Sz(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Il(i));if(typeof e=="function")throw new Error(n+"contains a function "+Il(i)+" with contents = "+e.toString());if(b_(e))throw new Error(n+"contains "+e.toString()+" "+Il(i));if(typeof e=="string"&&e.length>m0/3&&jg(e)>m0)throw new Error(n+"contains a string greater than "+m0+" utf8 bytes "+Il(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(On(e,(c,h)=>{if(c===".value")s=!0;else if(c!==".priority"&&c!==".sv"&&(o=!0,!O_(c)))throw new Error(n+" contains an invalid key ("+c+") "+Il(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Az(i,c),em(n,h,i),xz(i)}),s&&o)throw new Error(n+' contains ".value" child '+Il(i)+" in addition to actual children.")}},uq=function(n,e){let t,i;for(t=0;t<e.length;t++){i=e[t];const o=wf(i);for(let c=0;c<o.length;c++)if(!(o[c]===".priority"&&c===o.length-1)){if(!O_(o[c]))throw new Error(n+"contains an invalid key ("+o[c]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(Iz);let s=null;for(t=0;t<e.length;t++){if(i=e[t],s!==null&&gr(s,i))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},vk=function(n,e,t,i){const s=Ai(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];On(e,(c,h)=>{const d=new ht(c);if(em(s,h,jt(t,d)),cb(d)===".priority"&&!Af(h))throw new Error(s+"contains an invalid value for '"+d.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(d)}),uq(s,o)},Ob=function(n,e,t){if(b_(e))throw new Error(Ai(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Af(e))throw new Error(Ai(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},tm=function(n,e,t,i){if(t!==void 0&&!O_(t))throw new Error(Ai(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},xf=function(n,e,t,i){if(!yk(t))throw new Error(Ai(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},hq=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),xf(n,e,t)},_r=function(n,e){if(ze(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},wk=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!O_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!cq(t))throw new Error(Ai(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dq{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function P_(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!ub(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function Ek(n,e,t){P_(n,t),bk(n,i=>ub(i,e))}function Zi(n,e,t){P_(n,t),bk(n,i=>gr(i,e)||gr(e,i))}function bk(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(fq(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function fq(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();Ll&&Rn("event: "+t.toString()),lh(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tk="repo_interrupt",mq=25;class pq{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new dq,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Tg(),this.transactionQueueTree_=new Db,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function gq(n,e,t){if(n.stats_=ob(n.repoInfo_),n.forceRestClient_||WB())n.server_=new bg(n.repoInfo_,(i,s,o,c)=>{VC(n,i,s,o,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>LC(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_n(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Zs(n.repoInfo_,e,(i,s,o,c)=>{VC(n,i,s,o,c)},i=>{LC(n,i)},i=>{_q(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=ez(n.repoInfo_,()=>new t9(n.stats_,n.server_)),n.infoData_=new Yz,n.infoSyncTree_=new PC({startListening:(i,s,o,c)=>{let h=[];const d=n.infoData_.getNode(i._path);return d.isEmpty()||(h=Jf(n.infoSyncTree_,i._path,d),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),Pb(n,"connected",!1),n.serverSyncTree_=new PC({startListening:(i,s,o,c)=>(n.server_.listen(i,o,s,(h,d)=>{const m=c(h,d);Zi(n.eventQueue_,i._path,m)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function Ik(n){const t=n.infoData_.getNode(new ht(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function nm(n){return tq({timestamp:Ik(n)})}function VC(n,e,t,i,s){n.dataUpdateCount++;const o=new ht(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(s)if(i){const d=eg(t,m=>Bt(m));c=W9(n.serverSyncTree_,o,d,s)}else{const d=Bt(t);c=hk(n.serverSyncTree_,o,d,s)}else if(i){const d=eg(t,m=>Bt(m));c=K9(n.serverSyncTree_,o,d)}else{const d=Bt(t);c=Jf(n.serverSyncTree_,o,d)}let h=o;c.length>0&&(h=qu(n,o)),Zi(n.eventQueue_,h,c)}function LC(n,e){Pb(n,"connected",e),e===!1&&wq(n)}function _q(n,e){On(e,(t,i)=>{Pb(n,t,i)})}function Pb(n,e,t){const i=new ht("/.info/"+e),s=Bt(t);n.infoData_.updateSnapshot(i,s);const o=Jf(n.infoSyncTree_,i,s);Zi(n.eventQueue_,i,o)}function M_(n){return n.nextWriteId_++}function yq(n,e,t){const i=Y9(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=Bt(s).withIndex(e._queryParams.getIndex());pw(n.serverSyncTree_,e,t,!0);let c;if(e._queryParams.loadsAllData())c=Jf(n.serverSyncTree_,e._path,o);else{const h=Sf(n.serverSyncTree_,e);c=hk(n.serverSyncTree_,e._path,o,h)}return Zi(n.eventQueue_,e._path,c),Dg(n.serverSyncTree_,e,t,null,!0),o},s=>(hh(n,"get for query "+_n(e)+" failed: "+s),Promise.reject(new Error(s))))}function Mb(n,e,t,i,s){hh(n,"set",{path:e.toString(),value:t,priority:i});const o=nm(n),c=Bt(t,i),h=R_(n.serverSyncTree_,e),d=Rb(c,h,o),m=M_(n),_=Tb(n.serverSyncTree_,e,d,m,!0);P_(n.eventQueue_,_),n.server_.put(e.toString(),c.val(!0),(T,S)=>{const C=T==="ok";C||Qn("set at "+e+" failed: "+T);const M=lo(n.serverSyncTree_,m,!C);Zi(n.eventQueue_,e,M),Mo(n,s,T,S)});const y=Lb(n,e);qu(n,y),Zi(n.eventQueue_,y,[])}function vq(n,e,t,i){hh(n,"update",{path:e.toString(),value:t});let s=!0;const o=nm(n),c={};if(On(t,(h,d)=>{s=!1,c[h]=pk(jt(e,h),Bt(d),n.serverSyncTree_,o)}),s)Rn("update() called with empty data.  Don't do anything."),Mo(n,i,"ok",void 0);else{const h=M_(n),d=H9(n.serverSyncTree_,e,c,h);P_(n.eventQueue_,d),n.server_.merge(e.toString(),t,(m,_)=>{const y=m==="ok";y||Qn("update at "+e+" failed: "+m);const T=lo(n.serverSyncTree_,h,!y),S=T.length>0?qu(n,e):e;Zi(n.eventQueue_,S,T),Mo(n,i,m,_)}),On(t,m=>{const _=Lb(n,jt(e,m));qu(n,_)}),Zi(n.eventQueue_,e,[])}}function wq(n){hh(n,"onDisconnectEvents");const e=nm(n),t=Tg();cw(n.onDisconnect_,ot(),(s,o)=>{const c=pk(s,o,n.serverSyncTree_,e);ch(t,s,c)});let i=[];cw(t,ot(),(s,o)=>{i=i.concat(Jf(n.serverSyncTree_,s,o));const c=Lb(n,s);qu(n,c)}),n.onDisconnect_=Tg(),Zi(n.eventQueue_,ot(),i)}function Eq(n,e,t){n.server_.onDisconnectCancel(e.toString(),(i,s)=>{i==="ok"&&lw(n.onDisconnect_,e),Mo(n,t,i,s)})}function jC(n,e,t,i){const s=Bt(t);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,c)=>{o==="ok"&&ch(n.onDisconnect_,e,s),Mo(n,i,o,c)})}function bq(n,e,t,i,s){const o=Bt(t,i);n.server_.onDisconnectPut(e.toString(),o.val(!0),(c,h)=>{c==="ok"&&ch(n.onDisconnect_,e,o),Mo(n,s,c,h)})}function Tq(n,e,t,i){if(Zp(t)){Rn("onDisconnect().update() called with empty data.  Don't do anything."),Mo(n,i,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(s,o)=>{s==="ok"&&On(t,(c,h)=>{const d=Bt(h);ch(n.onDisconnect_,jt(e,c),d)}),Mo(n,i,s,o)})}function Iq(n,e,t){let i;ze(e._path)===".info"?i=pw(n.infoSyncTree_,e,t):i=pw(n.serverSyncTree_,e,t),Ek(n.eventQueue_,e._path,i)}function _w(n,e,t){let i;ze(e._path)===".info"?i=Dg(n.infoSyncTree_,e,t):i=Dg(n.serverSyncTree_,e,t),Ek(n.eventQueue_,e._path,i)}function Sk(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Tk)}function Sq(n){n.persistentConnection_&&n.persistentConnection_.resume(Tk)}function hh(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Rn(t,...e)}function Mo(n,e,t,i){e&&lh(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const c=new Error(o);c.code=s,e(c)}})}function Aq(n,e,t,i,s,o){hh(n,"transaction on "+e);const c={path:e,update:t,onComplete:i,status:null,order:wD(),applyLocally:o,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Vb(n,e,void 0);c.currentInputSnapshot=h;const d=c.update(h.val());if(d===void 0)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{em("transaction failed: Data returned ",d,c.path),c.status=0;const m=D_(n.transactionQueueTree_,e),_=uc(m)||[];_.push(c),kb(m,_);let y;typeof d=="object"&&d!==null&&Xi(d,".priority")?(y=jl(d,".priority"),de(Af(y),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):y=(R_(n.serverSyncTree_,e)||Ne.EMPTY_NODE).getPriority().val();const T=nm(n),S=Bt(d,y),C=Rb(S,h,T);c.currentOutputSnapshotRaw=S,c.currentOutputSnapshotResolved=C,c.currentWriteId=M_(n);const M=Tb(n.serverSyncTree_,e,C,c.currentWriteId,c.applyLocally);Zi(n.eventQueue_,e,M),V_(n,n.transactionQueueTree_)}}function Vb(n,e,t){return R_(n.serverSyncTree_,e,t)||Ne.EMPTY_NODE}function V_(n,e=n.transactionQueueTree_){if(e||L_(n,e),uc(e)){const t=xk(n,e);de(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&xq(n,Zf(e),t)}else gk(e)&&k_(e,t=>{V_(n,t)})}function xq(n,e,t){const i=t.map(m=>m.currentWriteId),s=Vb(n,e,i);let o=s;const c=s.hash();for(let m=0;m<t.length;m++){const _=t[m];de(_.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),_.status=1,_.retryCount++;const y=ni(e,_.path);o=o.updateChild(y,_.currentOutputSnapshotRaw)}const h=o.val(!0),d=e;n.server_.put(d.toString(),h,m=>{hh(n,"transaction put response",{path:d.toString(),status:m});let _=[];if(m==="ok"){const y=[];for(let T=0;T<t.length;T++)t[T].status=2,_=_.concat(lo(n.serverSyncTree_,t[T].currentWriteId)),t[T].onComplete&&y.push(()=>t[T].onComplete(null,!0,t[T].currentOutputSnapshotResolved)),t[T].unwatcher();L_(n,D_(n.transactionQueueTree_,e)),V_(n,n.transactionQueueTree_),Zi(n.eventQueue_,e,_);for(let T=0;T<y.length;T++)lh(y[T])}else{if(m==="datastale")for(let y=0;y<t.length;y++)t[y].status===3?t[y].status=4:t[y].status=0;else{Qn("transaction at "+d.toString()+" failed: "+m);for(let y=0;y<t.length;y++)t[y].status=4,t[y].abortReason=m}qu(n,e)}},c)}function qu(n,e){const t=Ak(n,e),i=Zf(t),s=xk(n,t);return Cq(n,s,i),i}function Cq(n,e,t){if(e.length===0)return;const i=[];let s=[];const c=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const d=e[h],m=ni(t,d.path);let _=!1,y;if(de(m!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),d.status===4)_=!0,y=d.abortReason,s=s.concat(lo(n.serverSyncTree_,d.currentWriteId,!0));else if(d.status===0)if(d.retryCount>=mq)_=!0,y="maxretry",s=s.concat(lo(n.serverSyncTree_,d.currentWriteId,!0));else{const T=Vb(n,d.path,c);d.currentInputSnapshot=T;const S=e[h].update(T.val());if(S!==void 0){em("transaction failed: Data returned ",S,d.path);let C=Bt(S);typeof S=="object"&&S!=null&&Xi(S,".priority")||(C=C.updatePriority(T.getPriority()));const q=d.currentWriteId,F=nm(n),j=Rb(C,T,F);d.currentOutputSnapshotRaw=C,d.currentOutputSnapshotResolved=j,d.currentWriteId=M_(n),c.splice(c.indexOf(q),1),s=s.concat(Tb(n.serverSyncTree_,d.path,j,d.currentWriteId,d.applyLocally)),s=s.concat(lo(n.serverSyncTree_,q,!0))}else _=!0,y="nodata",s=s.concat(lo(n.serverSyncTree_,d.currentWriteId,!0))}Zi(n.eventQueue_,t,s),s=[],_&&(e[h].status=2,(function(T){setTimeout(T,Math.floor(0))})(e[h].unwatcher),e[h].onComplete&&(y==="nodata"?i.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):i.push(()=>e[h].onComplete(new Error(y),!1,null))))}L_(n,n.transactionQueueTree_);for(let h=0;h<i.length;h++)lh(i[h]);V_(n,n.transactionQueueTree_)}function Ak(n,e){let t,i=n.transactionQueueTree_;for(t=ze(e);t!==null&&uc(i)===void 0;)i=D_(i,t),e=St(e),t=ze(e);return i}function xk(n,e){const t=[];return Ck(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Ck(n,e,t){const i=uc(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);k_(e,s=>{Ck(n,s,t)})}function L_(n,e){const t=uc(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,kb(e,t.length>0?t:void 0)}k_(e,i=>{L_(n,i)})}function Lb(n,e){const t=Zf(Ak(n,e)),i=D_(n.transactionQueueTree_,e);return sq(i,s=>{p0(n,s)}),p0(n,i),_k(i,s=>{p0(n,s)}),t}function p0(n,e){const t=uc(e);if(t){const i=[];let s=[],o=-1;for(let c=0;c<t.length;c++)t[c].status===3||(t[c].status===1?(de(o===c-1,"All SENT items should be at beginning of queue."),o=c,t[c].status=3,t[c].abortReason="set"):(de(t[c].status===0,"Unexpected transaction status in abort"),t[c].unwatcher(),s=s.concat(lo(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&i.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));o===-1?kb(e,void 0):t.length=o+1,Zi(n.eventQueue_,Zf(e),s);for(let c=0;c<i.length;c++)lh(i[c])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rq(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function Nq(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Qn(`Invalid query segment '${t}' in query '${n}'`)}return e}const yw=function(n,e){const t=Dq(n),i=t.namespace;t.domain==="firebase.com"&&ms(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&ms("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||FB();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new PD(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new ht(t.pathString)}},Dq=function(n){let e="",t="",i="",s="",o="",c=!0,h="https",d=443;if(typeof n=="string"){let m=n.indexOf("//");m>=0&&(h=n.substring(0,m-1),n=n.substring(m+2));let _=n.indexOf("/");_===-1&&(_=n.length);let y=n.indexOf("?");y===-1&&(y=n.length),e=n.substring(0,Math.min(_,y)),_<y&&(s=Rq(n.substring(_,y)));const T=Nq(n.substring(Math.min(n.length,y)));m=e.indexOf(":"),m>=0?(c=h==="https"||h==="wss",d=parseInt(e.substring(m+1),10)):m=e.length;const S=e.slice(0,m);if(S.toLowerCase()==="localhost")t="localhost";else if(S.split(".").length<=2)t=S;else{const C=e.indexOf(".");i=e.substring(0,C).toLowerCase(),t=e.substring(C+1),o=i}"ns"in T&&(o=T.ns)}return{host:e,port:d,domain:t,subdomain:i,secure:c,scheme:h,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",kq=(function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=UC.charAt(t%64),t=Math.floor(t/64);de(t===0,"Cannot push at time == 0");let c=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)c+=UC.charAt(e[s]);return de(c.length===20,"nextPushId: Length should be 20."),c}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_n(this.snapshot.exportVal())}}class Nk{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return de(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dk=class{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Ei;return Eq(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){_r("OnDisconnect.remove",this._path);const e=new Ei;return jC(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){_r("OnDisconnect.set",this._path),ps("OnDisconnect.set",e,this._path,!1);const t=new Ei;return jC(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){_r("OnDisconnect.setWithPriority",this._path),ps("OnDisconnect.setWithPriority",e,this._path,!1),Ob("OnDisconnect.setWithPriority",t);const i=new Ei;return bq(this._repo,this._path,e,t,i.wrapCallback(()=>{})),i.promise}update(e){_r("OnDisconnect.update",this._path),vk("OnDisconnect.update",e,this._path);const t=new Ei;return Tq(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return qe(this._path)?null:cb(this._path)}get ref(){return new br(this._repo,this._path)}get _queryIdentifier(){const e=IC(this._queryParams),t=sb(e);return t==="{}"?"default":t}get _queryObject(){return IC(this._queryParams)}isEqual(e){if(e=ve(e),!(e instanceof Ri))return!1;const t=this._repo===e._repo,i=ub(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Tz(this._path)}}function j_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function zo(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===ls){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Do)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==sa)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===Rt){if(e!=null&&!Af(e)||t!=null&&!Af(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(de(n.getIndex()instanceof fb||n.getIndex()===mb,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function U_(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class br extends Ri{constructor(e,t){super(e,t,new I_,!1)}get parent(){const e=qD(this._path);return e===null?null:new br(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let F_=class vw{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ht(e),i=Jl(this.ref,e);return new vw(this._node.getChild(t),i,Rt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new vw(s,Jl(this.ref,i),Rt)))}hasChild(e){const t=new ht(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function yu(n,e){return n=ve(n),n._checkNotDeleted("ref"),e!==void 0?Jl(n._root,e):n._root}function FC(n,e){n=ve(n),n._checkNotDeleted("refFromURL");const t=yw(e,n._repo.repoInfo_.nodeAdmin);wk("refFromURL",t);const i=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&i.host!==n._repo.repoInfo_.host&&ms("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+n._repo.repoInfo_.host+")"),yu(n,t.path.toString())}function Jl(n,e){return n=ve(n),ze(n._path)===null?hq("child","path",e):xf("child","path",e),new br(n._repo,jt(n._path,e))}function BC(n){return n=ve(n),new Dk(n._repo,n._path)}function Oq(n,e){n=ve(n),_r("push",n._path),ps("push",e,n._path,!0);const t=Ik(n._repo),i=kq(t),s=Jl(n,i),o=Jl(n,i);let c;return e!=null?c=Gu(o,e).then(()=>o):c=Promise.resolve(o),s.then=c.then.bind(c),s.catch=c.then.bind(c,void 0),s}function Pq(n){return _r("remove",n._path),Gu(n,null)}function Gu(n,e){n=ve(n),_r("set",n._path),ps("set",e,n._path,!1);const t=new Ei;return Mb(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Mq(n,e){n=ve(n),_r("setPriority",n._path),Ob("setPriority",e);const t=new Ei;return Mb(n._repo,jt(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function Vq(n,e,t){if(_r("setWithPriority",n._path),ps("setWithPriority",e,n._path,!1),Ob("setWithPriority",t),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";const i=new Ei;return Mb(n._repo,n._path,e,t,i.wrapCallback(()=>{})),i.promise}function Lq(n,e){vk("update",e,n._path);const t=new Ei;return vq(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function jq(n){n=ve(n);const e=new jb(()=>{}),t=new im(e);return yq(n._repo,n,t).then(i=>new F_(i,new br(n._repo,n._path),n._queryParams.getIndex()))}class im{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new Rk("value",this,new F_(e.snapshotNode,new br(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Nk(this,e,t):null}matches(e){return e instanceof im?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class B_{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Nk(this,e,t):null}createEvent(e,t){de(e.childName!=null,"Child events should have a childName.");const i=Jl(new br(t._repo,t._path),e.childName),s=t._queryParams.getIndex();return new Rk(e.type,this,new F_(e.snapshotNode,i,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof B_?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function rm(n,e,t,i,s){let o;if(typeof i=="object"&&(o=void 0,s=i),typeof i=="function"&&(o=i),s&&s.onlyOnce){const d=t,m=(_,y)=>{_w(n._repo,n,h),d(_,y)};m.userCallback=t.userCallback,m.context=t.context,t=m}const c=new jb(t,o||void 0),h=e==="value"?new im(c):new B_(e,c);return Iq(n._repo,n,h),()=>_w(n._repo,n,h)}function Cf(n,e,t,i){return rm(n,"value",e,t,i)}function zC(n,e,t,i){return rm(n,"child_added",e,t,i)}function qC(n,e,t,i){return rm(n,"child_changed",e,t,i)}function GC(n,e,t,i){return rm(n,"child_moved",e,t,i)}function HC(n,e,t,i){return rm(n,"child_removed",e,t,i)}function KC(n,e,t){let i=null;const s=t?new jb(t):null;e==="value"?i=new im(s):e&&(i=new B_(e,s)),_w(n._repo,n,i)}class jr{}class kk extends jr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){ps("endAt",this._value,e._path,!0);const t=ow(e._queryParams,this._value,this._key);if(U_(t),zo(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ri(e._repo,e._path,t,e._orderByCalled)}}function Uq(n,e){return tm("endAt","key",e),new kk(n,e)}class Fq extends jr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){ps("endBefore",this._value,e._path,!1);const t=Wz(e._queryParams,this._value,this._key);if(U_(t),zo(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ri(e._repo,e._path,t,e._orderByCalled)}}function Bq(n,e){return tm("endBefore","key",e),new Fq(n,e)}class Ok extends jr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){ps("startAt",this._value,e._path,!0);const t=aw(e._queryParams,this._value,this._key);if(U_(t),zo(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ri(e._repo,e._path,t,e._orderByCalled)}}function zq(n=null,e){return tm("startAt","key",e),new Ok(n,e)}class qq extends jr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){ps("startAfter",this._value,e._path,!1);const t=$z(e._queryParams,this._value,this._key);if(U_(t),zo(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ri(e._repo,e._path,t,e._orderByCalled)}}function Gq(n,e){return tm("startAfter","key",e),new qq(n,e)}class Hq extends jr{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ri(e._repo,e._path,Kz(e._queryParams,this._limit),e._orderByCalled)}}function Kq(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Hq(n)}class Qq extends jr{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ri(e._repo,e._path,Qz(e._queryParams,this._limit),e._orderByCalled)}}function $q(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Qq(n)}class Wq extends jr{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){j_(e,"orderByChild");const t=new ht(this._path);if(qe(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const i=new fb(t),s=S_(e._queryParams,i);return zo(s),new Ri(e._repo,e._path,s,!0)}}function Yq(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return xf("orderByChild","path",n),new Wq(n)}class Xq extends jr{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){j_(e,"orderByKey");const t=S_(e._queryParams,ls);return zo(t),new Ri(e._repo,e._path,t,!0)}}function Jq(){return new Xq}class Zq extends jr{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){j_(e,"orderByPriority");const t=S_(e._queryParams,Rt);return zo(t),new Ri(e._repo,e._path,t,!0)}}function e8(){return new Zq}class t8 extends jr{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){j_(e,"orderByValue");const t=S_(e._queryParams,mb);return zo(t),new Ri(e._repo,e._path,t,!0)}}function n8(){return new t8}class i8 extends jr{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(ps("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new kk(this._value,this._key)._apply(new Ok(this._value,this._key)._apply(e))}}function r8(n,e){return tm("equalTo","key",e),new i8(n,e)}function Pr(n,...e){let t=ve(n);for(const i of e)t=i._apply(t);return t}L9(br);z9(br);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8="FIREBASE_DATABASE_EMULATOR_HOST",ww={};let a8=!1;function o8(n,e,t,i){n.repoInfo_=new PD(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function Pk(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||ms("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c=yw(o,s),h=c.repoInfo,d,m;typeof process<"u"&&aC&&(m=aC[s8]),m?(d=!0,o=`http://${m}?ns=${h.namespace}`,c=yw(o,s),h=c.repoInfo):d=!c.repoInfo.secure;const _=s&&d?new _u(_u.OWNER):new XB(n.name,n.options,e);wk("Invalid Firebase Database URL",c),qe(c.path)||ms("Database URL must point to the root of a Firebase Database (not including a child path).");const y=c8(h,n,_,new YB(n.name,t));return new u8(y,n)}function l8(n,e){const t=ww[e];(!t||t[n.key]!==n)&&ms(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Sk(n),delete t[n.key]}function c8(n,e,t,i){let s=ww[e.name];s||(s={},ww[e.name]=s);let o=s[n.toURLString()];return o&&ms("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new pq(n,a8,t,i),s[n.toURLString()]=o,o}let u8=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(gq(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new br(this._repo,ot())),this._rootInternal}_delete(){return this._rootInternal!==null&&(l8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ms("Cannot call "+e+" on a deleted database.")}};function Mk(){Uu.IS_TRANSPORT_INITIALIZED&&Qn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function h8(){Mk(),oo.forceDisallow()}function d8(){Mk(),mr.forceDisallow(),oo.forceAllow()}function f8(n=Ug(),e){const t=$u(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=g1("database");i&&Vk(t,...i)}return t}function Vk(n,e,t,i={}){n=ve(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&ms("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&ms('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new _u(_u.OWNER);else if(i.mockUserToken){const c=typeof i.mockUserToken=="string"?i.mockUserToken:v1(i.mockUserToken,n.app.options.projectId);o=new _u(c)}o8(s,e,t,o)}function m8(n){n=ve(n),n._checkNotDeleted("goOffline"),Sk(n._repo)}function p8(n){n=ve(n),n._checkNotDeleted("goOnline"),Sq(n._repo)}function g8(n,e){bD(n,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _8(n){yD(aa),ta(new xi("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return Pk(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Yi(oC,lC,n),Yi(oC,lC,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8={".sv":"timestamp"};function cu(){return y8}function v8(n){return{".sv":{increment:n}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w8=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function E8(n,e,t){var i;if(n=ve(n),_r("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";const s=(i=t==null?void 0:t.applyLocally)!==null&&i!==void 0?i:!0,o=new Ei,c=(d,m,_)=>{let y=null;d?o.reject(d):(y=new F_(_,new br(n._repo,n._path),Rt),o.resolve(new w8(m,y)))},h=Cf(n,()=>{});return Aq(n._repo,n._path,e,c,h,s),o.promise}Zs.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Zs.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};_8();const b8="@firebase/database-compat",T8="1.0.8";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8=new Qu("@firebase/database-compat"),Lk=function(n){const e="FIREBASE WARNING: "+n;I8.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S8=function(n,e,t,i){if(t!==void 0&&typeof t!="boolean")throw new Error(Ai(n,e)+"must be a boolean.")},A8=function(n,e,t){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Ai(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x8{constructor(e){this._delegate=e}cancel(e){De("OnDisconnect.cancel",0,1,arguments.length),An("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),i=>e(i)),t}remove(e){De("OnDisconnect.remove",0,1,arguments.length),An("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),i=>e(i)),t}set(e,t){De("OnDisconnect.set",1,2,arguments.length),An("OnDisconnect.set","onComplete",t,!0);const i=this._delegate.set(e);return t&&i.then(()=>t(null),s=>t(s)),i}setWithPriority(e,t,i){De("OnDisconnect.setWithPriority",2,3,arguments.length),An("OnDisconnect.setWithPriority","onComplete",i,!0);const s=this._delegate.setWithPriority(e,t);return i&&s.then(()=>i(null),o=>i(o)),s}update(e,t){if(De("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,Lk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}An("OnDisconnect.update","onComplete",t,!0);const i=this._delegate.update(e);return t&&i.then(()=>t(null),s=>t(s)),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C8{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return De("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t){this._database=e,this._delegate=t}val(){return De("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return De("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return De("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return De("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return De("DataSnapshot.child",0,1,arguments.length),e=String(e),xf("DataSnapshot.child","path",e),new _o(this._database,this._delegate.child(e))}hasChild(e){return De("DataSnapshot.hasChild",1,1,arguments.length),xf("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return De("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return De("DataSnapshot.forEach",1,1,arguments.length),An("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new _o(this._database,t)))}hasChildren(){return De("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return De("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return De("DataSnapshot.ref",0,0,arguments.length),new Hi(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Un{constructor(e,t){this.database=e,this._delegate=t}on(e,t,i,s){var o;De("Query.on",2,4,arguments.length),An("Query.on","callback",t,!1);const c=Un.getCancelAndContextArgs_("Query.on",i,s),h=(m,_)=>{t.call(c.context,new _o(this.database,m),_)};h.userCallback=t,h.context=c.context;const d=(o=c.cancel)===null||o===void 0?void 0:o.bind(c.context);switch(e){case"value":return Cf(this._delegate,h,d),t;case"child_added":return zC(this._delegate,h,d),t;case"child_removed":return HC(this._delegate,h,d),t;case"child_changed":return qC(this._delegate,h,d),t;case"child_moved":return GC(this._delegate,h,d),t;default:throw new Error(Ai("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,i){if(De("Query.off",0,3,arguments.length),A8("Query.off",e),An("Query.off","callback",t,!0),_A("Query.off","context",i),t){const s=()=>{};s.userCallback=t,s.context=i,KC(this._delegate,e,s)}else KC(this._delegate,e)}get(){return jq(this._delegate).then(e=>new _o(this.database,e))}once(e,t,i,s){De("Query.once",1,4,arguments.length),An("Query.once","callback",t,!0);const o=Un.getCancelAndContextArgs_("Query.once",i,s),c=new Ei,h=(m,_)=>{const y=new _o(this.database,m);t&&t.call(o.context,y,_),c.resolve(y)};h.userCallback=t,h.context=o.context;const d=m=>{o.cancel&&o.cancel.call(o.context,m),c.reject(m)};switch(e){case"value":Cf(this._delegate,h,d,{onlyOnce:!0});break;case"child_added":zC(this._delegate,h,d,{onlyOnce:!0});break;case"child_removed":HC(this._delegate,h,d,{onlyOnce:!0});break;case"child_changed":qC(this._delegate,h,d,{onlyOnce:!0});break;case"child_moved":GC(this._delegate,h,d,{onlyOnce:!0});break;default:throw new Error(Ai("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return De("Query.limitToFirst",1,1,arguments.length),new Un(this.database,Pr(this._delegate,Kq(e)))}limitToLast(e){return De("Query.limitToLast",1,1,arguments.length),new Un(this.database,Pr(this._delegate,$q(e)))}orderByChild(e){return De("Query.orderByChild",1,1,arguments.length),new Un(this.database,Pr(this._delegate,Yq(e)))}orderByKey(){return De("Query.orderByKey",0,0,arguments.length),new Un(this.database,Pr(this._delegate,Jq()))}orderByPriority(){return De("Query.orderByPriority",0,0,arguments.length),new Un(this.database,Pr(this._delegate,e8()))}orderByValue(){return De("Query.orderByValue",0,0,arguments.length),new Un(this.database,Pr(this._delegate,n8()))}startAt(e=null,t){return De("Query.startAt",0,2,arguments.length),new Un(this.database,Pr(this._delegate,zq(e,t)))}startAfter(e=null,t){return De("Query.startAfter",0,2,arguments.length),new Un(this.database,Pr(this._delegate,Gq(e,t)))}endAt(e=null,t){return De("Query.endAt",0,2,arguments.length),new Un(this.database,Pr(this._delegate,Uq(e,t)))}endBefore(e=null,t){return De("Query.endBefore",0,2,arguments.length),new Un(this.database,Pr(this._delegate,Bq(e,t)))}equalTo(e,t){return De("Query.equalTo",1,2,arguments.length),new Un(this.database,Pr(this._delegate,r8(e,t)))}toString(){return De("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return De("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(De("Query.isEqual",1,1,arguments.length),!(e instanceof Un)){const t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,i){const s={cancel:void 0,context:void 0};if(t&&i)s.cancel=t,An(e,"cancel",s.cancel,!0),s.context=i,_A(e,"context",s.context);else if(t)if(typeof t=="object"&&t!==null)s.context=t;else if(typeof t=="function")s.cancel=t;else throw new Error(Ai(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new Hi(this.database,new br(this._delegate._repo,this._delegate._path))}}class Hi extends Un{constructor(e,t){super(e,new Ri(t._repo,t._path,new I_,!1)),this.database=e,this._delegate=t}getKey(){return De("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return De("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Hi(this.database,Jl(this._delegate,e))}getParent(){De("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Hi(this.database,e):null}getRoot(){return De("Reference.root",0,0,arguments.length),new Hi(this.database,this._delegate.root)}set(e,t){De("Reference.set",1,2,arguments.length),An("Reference.set","onComplete",t,!0);const i=Gu(this._delegate,e);return t&&i.then(()=>t(null),s=>t(s)),i}update(e,t){if(De("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,Lk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_r("Reference.update",this._delegate._path),An("Reference.update","onComplete",t,!0);const i=Lq(this._delegate,e);return t&&i.then(()=>t(null),s=>t(s)),i}setWithPriority(e,t,i){De("Reference.setWithPriority",2,3,arguments.length),An("Reference.setWithPriority","onComplete",i,!0);const s=Vq(this._delegate,e,t);return i&&s.then(()=>i(null),o=>i(o)),s}remove(e){De("Reference.remove",0,1,arguments.length),An("Reference.remove","onComplete",e,!0);const t=Pq(this._delegate);return e&&t.then(()=>e(null),i=>e(i)),t}transaction(e,t,i){De("Reference.transaction",1,3,arguments.length),An("Reference.transaction","transactionUpdate",e,!1),An("Reference.transaction","onComplete",t,!0),S8("Reference.transaction","applyLocally",i);const s=E8(this._delegate,e,{applyLocally:i}).then(o=>new C8(o.committed,new _o(this.database,o.snapshot)));return t&&s.then(o=>t(null,o.committed,o.snapshot),o=>t(o,!1,null)),s}setPriority(e,t){De("Reference.setPriority",1,2,arguments.length),An("Reference.setPriority","onComplete",t,!0);const i=Mq(this._delegate,e);return t&&i.then(()=>t(null),s=>t(s)),i}push(e,t){De("Reference.push",0,2,arguments.length),An("Reference.push","onComplete",t,!0);const i=Oq(this._delegate,e),s=i.then(c=>new Hi(this.database,c));t&&s.then(()=>t(null),c=>t(c));const o=new Hi(this.database,i);return o.then=s.then.bind(s),o.catch=s.catch.bind(s,void 0),o}onDisconnect(){return _r("Reference.onDisconnect",this._delegate._path),new x8(new Dk(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:h8,forceLongPolling:d8}}useEmulator(e,t,i={}){Vk(this._delegate,e,t,i)}ref(e){if(De("database.ref",0,1,arguments.length),e instanceof Hi){const t=FC(this._delegate,e.toString());return new Hi(this,t)}else{const t=yu(this._delegate,e);return new Hi(this,t)}}refFromURL(e){De("database.refFromURL",1,1,arguments.length);const i=FC(this._delegate,e);return new Hi(this,i)}goOffline(){return De("database.goOffline",0,0,arguments.length),m8(this._delegate)}goOnline(){return De("database.goOnline",0,0,arguments.length),p8(this._delegate)}}Rf.ServerValue={TIMESTAMP:cu(),increment:n=>v8(n)};function R8({app:n,url:e,version:t,customAuthImpl:i,customAppCheckImpl:s,namespace:o,nodeAdmin:c=!1}){yD(t);const h=new Dw("database-standalone"),d=new v0("auth-internal",h);d.setComponent(new xi("auth-internal",()=>i,"PRIVATE"));let m;return s&&(m=new v0("app-check-internal",h),m.setComponent(new xi("app-check-internal",()=>s,"PRIVATE"))),{instance:new Rf(Pk(n,d,m,e,c),n),namespace:o}}var N8=Object.freeze({__proto__:null,initStandalone:R8});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D8=Rf.ServerValue;function k8(n){n.INTERNAL.registerComponent(new xi("database-compat",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:t});return new Rf(s,i)},"PUBLIC").setServiceProps({Reference:Hi,Query:Un,Database:Rf,DataSnapshot:_o,enableLogging:g8,INTERNAL:N8,ServerValue:D8}).setMultipleInstances(!0)),n.registerVersion(b8,T8)}k8(tc);const O8={apiKey:"AIzaSyDCmIQ9Kly6RWPz89D5bsAIyk9wKmWDjZc",authDomain:"caro-ai-arena.firebaseapp.com",databaseURL:"https://caro-ai-arena-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"caro-ai-arena",storageBucket:"caro-ai-arena.firebasestorage.app",messagingSenderId:"316000837643",appId:"1:316000837643:web:805db8f084712d9cabe70e",measurementId:"G-86DC259ZW2"},Ub=tc.initializeApp(O8),qd=Kj(Ub),tt=$F(Ub),Yp=f8(Ub),P8=yo.filter(n=>n.type==="emoji"&&n.price===0).map(n=>n.id),M8=n=>{const e={};for(let t=0;t<n.length;t++)for(let i=0;i<n[t].length;i++)n[t][i]&&(e[`${t}_${i}`]=n[t][i]);return e},Ew=n=>{const e=Array(et).fill(null).map(()=>Array(et).fill(null));for(const t in n){const[i,s]=t.split("_").map(Number);e[i][s]=n[t]}return e},V8=(n,e)=>{for(let t=0;t<et;t++)for(let i=0;i<et;i++)if(n[t][i]===null&&e[t][i]!==null)return{row:t,col:i};return null},L8=(n,e)=>{const t=[{r:0,c:1},{r:1,c:0},{r:1,c:1},{r:1,c:-1}];for(let i=0;i<et;i++)for(let s=0;s<et;s++)if(n[i][s]===e)for(const o of t){const c=[];for(let h=0;h<ei;h++){const d=i+h*o.r,m=s+h*o.c;if(d>=0&&d<et&&m>=0&&m<et&&n[d][m]===e)c.push({row:d,col:m});else break}if(c.length===ei)return c}return null},j8=(n,e)=>{const t=new Set(n.filter(i=>i.startsWith("emoji_")));for(const i in e)e[i]>0&&t.add(i);return Pg.filter(i=>t.has(i.id))},U8=()=>{const n=Pg.filter(e=>!["","","",""].includes(e.emoji));return n[Math.floor(Math.random()*n.length)]},jk=async(n,e)=>{const t=nt(tt,"users",n.uid),i={uid:n.uid,name:e,email:n.email,isAnonymous:n.isAnonymous,level:1,xp:0,coins:500,onlineWins:0,onlineLosses:0,onlineDraws:0,pveWins:0,pveLosses:0,pveDraws:0,ownedCosmeticIds:[yr.id,Nn.id,ii.id,Qi.id,$i.id,Wi.id,...P8],emojiInventory:{},activeThemeId:yr.id,activePieceId:Nn.id,activeAvatarId:ii.id,activeEffectId:Qi.id,activeVictoryEffectId:$i.id,activeBoomEffectId:Wi.id};await No(t,i)},bw=async n=>{const e=nt(tt,"users",n),t=await da(e);return t.exists()?t.data():null},Uk=async(n,e)=>{const t=nt(tt,"users",n);await No(t,e,{merge:!0})},F8=async(n,e)=>{await Kg(n,{displayName:e}),await Uk(n.uid,{name:e});const t=nt(tt,"onlineUsers",n.uid);try{(await da(t)).exists()&&await Er(t,{name:e})}catch{console.warn("Could not update online user name, document may not exist yet.")}},QC=async(n,e,t,i)=>{const s=n.uid,o=yu(Yp,`/status/${s}`),c=nt(tt,"onlineUsers",s),h=await da(c),d=h.exists()?h.data().status:"idle";if(d==="in_game"||d==="in_queue"){Cf(yu(Yp,".info/connected"),y=>{y.val()!==!1&&BC(o).set({state:"offline",last_changed:cu()}).then(()=>{Gu(o,{state:"online",last_changed:cu()})})}),console.log(`Presence system: User is '${d}'. Preserving status.`);return}const m={state:"online",last_changed:cu()},_={state:"offline",last_changed:cu()};Cf(yu(Yp,".info/connected"),y=>{y.val()!==!1&&BC(o).set(_).then(async()=>{await Gu(o,m),await No(c,{uid:s,name:i,level:e,avatarUrl:t,status:"idle"}),console.log("Presence system: User status set to 'idle'.")})})},B8=async n=>{const e=nt(tt,"onlineUsers",n);try{await w_(e)}catch(i){console.error("Error deleting online user doc:",i)}const t=yu(Yp,`/status/${n}`);await Gu(t,{state:"offline",last_changed:cu()})},z8=n=>{const e=Xr(d_(tt,"onlineUsers"));return ah(e,t=>{const i=t.docs.map(s=>s.data());n(i)})},Fk=async n=>{const e=nt(tt,"onlineUsers",n),t=await da(e);return t.exists()?t.data():null},q8=async n=>{const e=Xr(d_(tt,"matchmakingQueue"),Z2("uid","!=",n.uid),eD(1)),t=await lD(e);if(t.empty)return await No(nt(tt,"matchmakingQueue",n.uid),{uid:n.uid,joinedAt:uD()}),await Er(nt(tt,"onlineUsers",n.uid),{status:"in_queue"}),null;{const s=t.docs[0].id,o=await Bk(n.uid,s),c=hD(tt);return c.delete(nt(tt,"matchmakingQueue",s)),c.update(nt(tt,"onlineUsers",n.uid),{status:"in_game",gameId:o}),c.update(nt(tt,"onlineUsers",s),{status:"in_game",gameId:o}),await c.commit(),o}},G8=async n=>{await w_(nt(tt,"matchmakingQueue",n)),await Er(nt(tt,"onlineUsers",n),{status:"idle"})},H8=async(n,e)=>{const t=nt(tt,"invitations",e);await No(t,{from:n.uid,fromName:n.displayName||"Player",timestamp:Date.now()})},K8=(n,e)=>ah(nt(tt,"invitations",n),t=>{e(t.exists()?t.data():null)}),Q8=async(n,e)=>{const t=await Bk(n.uid,e.from),i=hD(tt);return i.update(nt(tt,"onlineUsers",n.uid),{status:"in_game",gameId:t}),i.update(nt(tt,"onlineUsers",e.from),{status:"in_game",gameId:t}),i.delete(nt(tt,"invitations",n.uid)),await i.commit(),t},$8=async n=>{await w_(nt(tt,"invitations",n))},Bk=async(n,e)=>{var h,d;const t=`game_${Date.now()}_${Math.random().toString(36).substring(2,7)}`,i=nt(tt,"games",t),[s,o]=await Promise.all([bw(n),bw(e)]),c={id:t,players:{X:n,O:e},playerDetails:{[n]:{name:(s==null?void 0:s.name)||"Player 1",avatarUrl:(s!=null&&s.activeAvatarId?(h=yo.find(m=>m.id===s.activeAvatarId))==null?void 0:h.item:ii).url,level:(s==null?void 0:s.level)||1,pieceId:(s==null?void 0:s.activePieceId)||Nn.id},[e]:{name:(o==null?void 0:o.name)||"Player 2",avatarUrl:(o!=null&&o.activeAvatarId?(d=yo.find(m=>m.id===o.activeAvatarId))==null?void 0:d.item:ii).url,level:(o==null?void 0:o.level)||1,pieceId:(o==null?void 0:o.activePieceId)||Nn.id}},board:{},currentPlayer:"X",status:"in_progress",winner:null,winningLine:null,createdAt:Date.now(),updatedAt:Date.now(),playerTimes:{X:vu,O:vu},turnStartedAt:Date.now()};return await No(i,c),t},W8=async(n,e,t)=>{const i=nt(tt,"games",n);try{await Er(i,{emotes:{uid:e,emoji:t,timestamp:Date.now()}})}catch(s){console.error("Failed to send emote:",s)}},Y8=async n=>{const e=nt(tt,"games",n),t=await da(e);return t.exists()?t.data():null},zk=(n,e)=>ah(nt(tt,"onlineUsers",n),t=>{if(t.exists()){const i=t.data();e(i.gameId||null)}}),X8=(n,e)=>ah(nt(tt,"games",n),t=>{e(t.exists()?t.data():null)}),J8=async(n,e,t,i)=>{const s=nt(tt,"games",n),o=await da(s);if(!o.exists())return;const c=o.data();if(c.status!=="in_progress"||c.currentPlayer!==i)return;const h=Ew(c.board);if(h[e][t]!==null)return;h[e][t]=i;const d=Math.round((Date.now()-c.turnStartedAt)/1e3),m={...c.playerTimes};if(m[i]=Math.max(0,m[i]-d),m[i]===0){await Er(s,{playerTimes:m,status:"finished",winner:i==="X"?"O":"X"});return}const _=L8(h,i),y=h.every(S=>S.every(C=>C!==null))&&!_,T={board:M8(h),currentPlayer:i==="X"?"O":"X",updatedAt:Date.now(),status:_||y?"finished":"in_progress",winner:_?i:y?"draw":null,winningLine:_||null,playerTimes:m,turnStartedAt:Date.now()};await Er(s,T)},Z8=async(n,e)=>{const t=nt(tt,"games",n);try{const i=await da(t);if(!i.exists())return;const s=i.data();s.status==="in_progress"&&s.currentPlayer!==e&&(Date.now()-s.turnStartedAt)/1e3>co+2&&(console.log(`Player ${e} is claiming a timeout victory.`),await Er(t,{status:"finished",winner:e}))}catch(i){console.error("Error claiming timeout victory:",i)}},e7=async(n,e,t)=>{const i=nt(tt,"games",n);try{await Er(i,{[`playerDetails.${e}.pieceId`]:t})}catch(s){console.log("Could not update piece skin (game may be over):",s)}},t7=async(n,e)=>{const t=nt(tt,"games",n);await Er(t,{status:"finished",winner:e==="X"?"O":"X"})},qk=async n=>{const e=nt(tt,"onlineUsers",n);try{(await da(e)).exists()&&await Er(e,{status:"idle",gameId:null})}catch(t){console.error("Failed to return user to lobby:",t)}},n7=async(n,e)=>{await qk(e)},Gk=H.createContext(void 0),i7=({children:n})=>{const[e,t]=H.useState(null),[i,s]=H.useState(!0);H.useEffect(()=>{const h=u5(qd,d=>{t(d),s(!1)});return()=>h()},[]);const c={user:e,loading:i,logOut:async()=>{e&&await B8(e.uid),await qd.signOut()}};return v.jsx(Gk.Provider,{value:c,children:!i&&n})},dh=()=>{const n=H.useContext(Gk);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},Hk=yo.filter(n=>n.type==="emoji"&&n.price===0).map(n=>n.id),Kk="caroGameState_v9_guest",Qk=H.createContext(void 0),El=n=>{if(!n)return null;const{component:e,previewComponent:t,decoratorComponent:i,...s}=n;return s},$C=()=>({coins:500,playerName:`Player_${Math.floor(1e3+Math.random()*9e3)}`,pveWins:0,pveLosses:0,pveDraws:0,onlineWins:0,onlineLosses:0,onlineDraws:0,playerLevel:1,playerXp:0,ownedCosmeticIds:[yr.id,Nn.id,Hd.id,ii.id,Qi.id,$i.id,Wi.id,...Hk],emojiInventory:{},botStats:{},activeTheme:yr,activePieceX:Nn,activePieceO:Hd,activeAvatar:ii,activeEffect:Qi,activeVictoryEffect:$i,activeBoomEffect:Wi,isSoundOn:!0,isMusicOn:!0,soundVolume:1,musicVolume:1,activeMusicUrl:u1[0].url,lastProcessedGameId:null}),WC=()=>{try{const n=localStorage.getItem(Kk);if(n){const e=JSON.parse(n),t=[Nn,Hd,...uo],i=[ii,...Og],s=[Qi,...Mg],o=[$i,...Kd],c=[Wi,...Qd],h=kg.find(F=>{var j;return F.id===((j=e.activeTheme)==null?void 0:j.id)})||yr,d=t.find(F=>{var j;return F.id===((j=e.activePieceX)==null?void 0:j.id)})||Nn,m=t.find(F=>{var j;return F.id===((j=e.activePieceO)==null?void 0:j.id)})||Hd,_=i.find(F=>{var j;return F.id===((j=e.activeAvatar)==null?void 0:j.id)})||ii,y=s.find(F=>{var j;return F.id===((j=e.activeEffect)==null?void 0:j.id)})||Qi,T=o.find(F=>{var j;return F.id===((j=e.activeVictoryEffect)==null?void 0:j.id)})||$i,S=c.find(F=>{var j;return F.id===((j=e.activeBoomEffect)==null?void 0:j.id)})||Wi,C=e.pveWins??e.wins??0,M=e.pveLosses??e.losses??0,q=e.pveDraws??e.draws??0;return{...$C(),...e,pveWins:C,pveLosses:M,pveDraws:q,onlineWins:e.onlineWins??0,onlineLosses:e.onlineLosses??0,onlineDraws:e.onlineDraws??0,activeTheme:h,activePieceX:d,activePieceO:m,activeAvatar:_,activeEffect:y,activeVictoryEffect:T,activeBoomEffect:S}}}catch(n){console.error("Failed to parse guest state",n)}return $C()},r7=({children:n})=>{const{user:e}=dh(),[t,i]=H.useState(WC),[s,o]=H.useState(!1);H.useEffect(()=>{(async()=>{if(!e){o(!1),i(WC());return}o(!1);const j=await bw(e.uid);if(j){const W=kg.find(x=>x.id===j.activeThemeId)||yr,se=uo.find(x=>x.id===j.activePieceId)||Nn,z=Og.find(x=>x.id===j.activeAvatarId)||ii,ae=Mg.find(x=>x.id===j.activeEffectId)||Qi,N=Kd.find(x=>x.id===j.activeVictoryEffectId)||$i,R=Qd.find(x=>x.id===j.activeBoomEffectId)||Wi;i(x=>({...x,playerName:j.name,coins:j.coins,onlineWins:j.onlineWins,onlineLosses:j.onlineLosses,onlineDraws:j.onlineDraws,pveWins:j.pveWins,pveLosses:j.pveLosses,pveDraws:j.pveDraws,playerLevel:j.level,playerXp:j.xp,ownedCosmeticIds:j.ownedCosmeticIds,emojiInventory:j.emojiInventory,activeTheme:W,activePieceX:se,activePieceO:se,activeAvatar:z,activeEffect:ae,activeVictoryEffect:N,activeBoomEffect:R})),await QC(e,j.level,z.url,j.name)}else{const W=t.playerName;jk(e,W),Kg(e,{displayName:W}),await QC(e,t.playerLevel,t.activeAvatar.url,W)}o(!0)})()},[e]),H.useEffect(()=>{if(e){if(!s)return;const F={name:t.playerName,coins:t.coins,onlineWins:t.onlineWins,onlineLosses:t.onlineLosses,onlineDraws:t.onlineDraws,pveWins:t.pveWins,pveLosses:t.pveLosses,pveDraws:t.pveDraws,level:t.playerLevel,xp:t.playerXp,ownedCosmeticIds:t.ownedCosmeticIds,emojiInventory:t.emojiInventory,activeThemeId:t.activeTheme.id,activePieceId:t.activePieceX.id,activeAvatarId:t.activeAvatar.id,activeEffectId:t.activeEffect.id,activeVictoryEffectId:t.activeVictoryEffect.id,activeBoomEffectId:t.activeBoomEffect.id};Uk(e.uid,F)}else try{const F={...t,activeTheme:El(t.activeTheme),activePieceX:El(t.activePieceX),activePieceO:El(t.activePieceO),activeAvatar:El(t.activeAvatar),activeEffect:El(t.activeEffect),activeVictoryEffect:El(t.activeVictoryEffect),activeBoomEffect:El(t.activeBoomEffect)};localStorage.setItem(Kk,JSON.stringify(F))}catch(F){console.error("Failed to save guest state",F)}},[t,e,s]);const c=H.useCallback(F=>{e&&F8(e,F),i(j=>({...j,playerName:F}))},[e]),h=H.useCallback(F=>t.coins<F?!1:(i(j=>({...j,coins:j.coins-F})),!0),[t.coins]),d=H.useCallback((F,j,W)=>{i(se=>{if(W&&se.lastProcessedGameId===W)return se;const z=c1[F],ae=l1[F];let N=se.playerXp+z,R=se.playerLevel,x=Jr(R);for(;N>=x;)N-=x,R++,x=Jr(R);const k=j.startsWith("bot_"),P={...se.botStats};return k&&(P[j]||(P[j]={wins:0,losses:0,draws:0}),F==="win"?P[j].wins++:F==="draw"?P[j].draws++:P[j].losses++),{...se,coins:se.coins+ae,playerXp:N,playerLevel:R,pveWins:k&&F==="win"?se.pveWins+1:se.pveWins,pveLosses:k&&F==="loss"?se.pveLosses+1:se.pveLosses,pveDraws:k&&F==="draw"?se.pveDraws+1:se.pveDraws,onlineWins:!k&&F==="win"?se.onlineWins+1:se.onlineWins,onlineLosses:!k&&F==="loss"?se.onlineLosses+1:se.onlineLosses,onlineDraws:!k&&F==="draw"?se.onlineDraws+1:se.onlineDraws,botStats:P,lastProcessedGameId:W||se.lastProcessedGameId}})},[]),m=H.useCallback(F=>{Hk.includes(F)||i(j=>{const W={...j.emojiInventory};return W[F]>0&&(W[F]-=1,W[F]===0&&delete W[F]),{...j,emojiInventory:W}})},[]),_=H.useCallback((F,j)=>{t.ownedCosmeticIds.includes(j.id)&&i(W=>{switch(F){case"theme":return{...W,activeTheme:j};case"piece":return{...W,activePieceX:j,activePieceO:j};case"avatar":return{...W,activeAvatar:j};case"effect":return{...W,activeEffect:j};case"victory":return{...W,activeVictoryEffect:j};case"boom":return{...W,activeBoomEffect:j};default:return W}})},[t.ownedCosmeticIds]),y=H.useCallback(F=>t.coins<F.price?!1:F.type==="emoji"&&F.price>0?(i(j=>{const W={...j.emojiInventory};return W[F.id]=(W[F.id]||0)+1,{...j,coins:j.coins-F.price,emojiInventory:W}}),!0):t.ownedCosmeticIds.includes(F.id)?!1:(i(j=>({...j,coins:j.coins-F.price,ownedCosmeticIds:[...j.ownedCosmeticIds,F.id]})),_(F.type,F.item),!0),[t.coins,t.ownedCosmeticIds,t.emojiInventory,_]),T=H.useCallback(()=>i(F=>({...F,isSoundOn:!F.isSoundOn})),[]),S=H.useCallback(()=>i(F=>({...F,isMusicOn:!F.isMusicOn})),[]),C=H.useCallback(F=>i(j=>({...j,soundVolume:F})),[]),M=H.useCallback(F=>i(j=>({...j,musicVolume:F})),[]),q=H.useCallback(F=>i(j=>({...j,activeMusicUrl:F})),[]);return v.jsx(Qk.Provider,{value:{gameState:t,setPlayerName:c,applyGameResult:d,spendCoins:h,purchaseCosmetic:y,consumeEmoji:m,equipTheme:F=>_("theme",F),equipPiece:F=>_("piece",F),equipAvatar:F=>_("avatar",F),equipEffect:F=>_("effect",F),equipVictoryEffect:F=>_("victory",F),equipBoomEffect:F=>_("boom",F),toggleSound:T,toggleMusic:S,setSoundVolume:C,setMusicVolume:M,equipMusic:q},children:n})},fa=()=>{const n=H.useContext(Qk);if(!n)throw new Error("useGameState must be used within a GameStateProvider");return n},Hu=({isOpen:n,onClose:e,title:t,children:i,hideCloseButton:s=!1,size:o="sm"})=>{if(!n)return null;const c={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg"};return v.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50 transition-opacity duration-300",onClick:e,children:[v.jsxs("div",{className:`bg-[#1e293b] rounded-2xl shadow-2xl p-6 m-4 w-full ${c[o]} border border-slate-700 transform transition-transform duration-300 scale-95 animate-scale-in`,onClick:h=>h.stopPropagation(),children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-3xl font-bold text-cyan-400",children:t}),!s&&e&&v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors","aria-label":"Close modal",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),v.jsx("div",{children:i})]}),v.jsx("style",{children:`
        @keyframes scale-in {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .animate-scale-in {
            animation: scale-in 0.3s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
        }
      `})]})},YC={move:"assets/sounds/move.mp3",win:"assets/sounds/win.mp3",lose:"assets/sounds/lose.mp3",click:"assets/sounds/click.mp3",announce_win:"assets/sounds/announce_win.mp3",announce_lose:"assets/sounds/announce_lose.mp3",check:"assets/sounds/check.mp3",first_move_player:"assets/sounds/first_move_player.mp3",first_move_ai:"assets/sounds/first_move_ai.mp3",deciding:"assets/sounds/deciding.mp3",boom:"assets/sounds/boom.mp3",select:"assets/sounds/select.mp3",confirm:"assets/sounds/confirm.mp3",summary:"assets/sounds/summary.mp3"},g0=new Map,XC=(n,e=!1)=>{if(g0.has(n))return g0.get(n);const t=new Audio(n);return t.loop=e,g0.set(n,t),t},JC=(n,e,t)=>{n!==void 0&&n.catch(i=>{i.name==="NotAllowedError"?console.warn("Music playback was prevented because the user hasn't interacted with the page yet. It will start automatically after the first user action."):i.name==="NotSupportedError"?console.warn(`Audio file for "${e}" not found or format not supported. Please add the file to the path: ${t}. See README.md for instructions.`):console.error(`Sound play failed for ${e}:`,i)})},gs=()=>{const{gameState:n}=fa(),e=H.useRef(null),t=H.useCallback(o=>{if(n.isSoundOn)try{const c=XC(YC[o]);c.currentTime=0;const h=o==="click"||o==="move"||o==="select"?.7:1;c.volume=n.soundVolume*h;const d=c.play();JC(d,o,YC[o])}catch(c){console.error(`Could not play sound ${o}:`,c)}},[n.isSoundOn,n.soundVolume]),i=H.useCallback(()=>{if(n.isMusicOn)try{const o=new URL(n.activeMusicUrl,window.location.origin).href;(!e.current||e.current.src!==o)&&(e.current&&e.current.pause(),e.current=XC(n.activeMusicUrl,!0)),e.current.volume=n.musicVolume;const c=e.current.play();JC(c,"music",n.activeMusicUrl)}catch(o){console.error("Could not play music:",o)}},[n.isMusicOn,n.activeMusicUrl,n.musicVolume]),s=H.useCallback(()=>{e.current&&(e.current.pause(),e.current.currentTime=0)},[]);return H.useEffect(()=>{e.current&&(e.current.volume=n.musicVolume)},[n.musicVolume]),H.useEffect(()=>{n.isMusicOn||s()},[n.isMusicOn,s]),H.useEffect(()=>{const o=()=>{document.hidden?e.current&&e.current.pause():n.isMusicOn&&i()};return document.addEventListener("visibilitychange",o),()=>{document.removeEventListener("visibilitychange",o)}},[i,n.isMusicOn]),{playSound:t,playMusic:i,stopMusic:s}},s7=({isOpen:n,onClose:e,onConfirm:t,playSound:i})=>v.jsx(Hu,{isOpen:n,onClose:e,title:"Confirm Undo",children:v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Undoing your last move will cost ",v.jsx("strong",{className:"text-yellow-400",children:"20 "}),". Are you sure?"]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>{i("select"),e()},className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:t,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors animate-confirm-glow",children:"Confirm"})]})]})}),Fb=({isOpen:n,onClose:e,onOpenShop:t,onOpenInventory:i,onResign:s,onLogOut:o})=>{const{gameState:c,toggleSound:h,toggleMusic:d,setSoundVolume:m,setMusicVolume:_,equipMusic:y}=fa(),{playSound:T}=gs(),[S,C]=H.useState(!1),M=j=>{T("select"),y(j)},q=()=>{T("select"),C(!0)},F=()=>{o&&o(),C(!1)};return v.jsxs(v.Fragment,{children:[v.jsxs(Hu,{isOpen:n,onClose:e,title:"Settings",children:[v.jsxs("div",{className:"space-y-4 text-white",children:[v.jsxs("div",{className:"rounded-lg overflow-hidden border border-slate-700 divide-y divide-slate-700",children:[v.jsxs("div",{className:"flex justify-between items-center px-4 py-3 hover:bg-slate-700/50 transition-colors",children:[v.jsx("span",{className:"font-semibold",children:"Sound"}),v.jsx("div",{className:"flex-grow flex items-center gap-4 mx-4",children:v.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:c.soundVolume,onChange:j=>m(Number(j.target.value)),disabled:!c.isSoundOn,className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"})}),v.jsx("button",{onClick:()=>{T("select"),h()},className:`font-bold w-12 text-center ${c.isSoundOn?"text-cyan-400":"text-slate-500"}`,children:c.isSoundOn?"ON":"OFF"})]}),v.jsxs("div",{className:"flex justify-between items-center px-4 py-3 hover:bg-slate-700/50 transition-colors",children:[v.jsx("span",{className:"font-semibold",children:"Music"}),v.jsx("div",{className:"flex-grow flex items-center gap-4 mx-4",children:v.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:c.musicVolume,onChange:j=>_(Number(j.target.value)),disabled:!c.isMusicOn,className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"})}),v.jsx("button",{onClick:()=>{T("select"),d()},className:`font-bold w-12 text-center ${c.isMusicOn?"text-cyan-400":"text-slate-500"}`,children:c.isMusicOn?"ON":"OFF"})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-slate-300 mb-2 px-1",children:"Select Music"}),v.jsx("div",{children:v.jsx("select",{value:c.activeMusicUrl,onChange:j=>M(j.target.value),className:"w-full bg-slate-700 border border-slate-600 text-white px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500",children:u1.map(j=>v.jsx("option",{value:j.url,children:j.name},j.id))})})]}),t&&i&&v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsx("button",{onClick:()=>{t(),e()},className:"w-full bg-purple-600 hover:bg-purple-500 font-bold py-3 rounded-lg transition-colors",children:"Shop"}),v.jsx("button",{onClick:()=>{i(),e()},className:"w-full bg-indigo-600 hover:bg-indigo-500 font-bold py-3 rounded-lg transition-colors",children:"Inventory"})]}),s&&v.jsx("button",{onClick:()=>{T("select"),s(),e()},className:"w-full bg-orange-600 hover:bg-orange-500 font-bold py-3 rounded-lg transition-colors",children:"Resign Game"}),o&&v.jsx("button",{onClick:q,className:"w-full bg-red-700 hover:bg-red-600 font-bold py-3 rounded-lg transition-colors",children:"Log Out"}),v.jsx("button",{onClick:()=>{T("select"),e()},className:"w-full bg-slate-600 hover:bg-slate-500 font-bold py-3 rounded-lg transition-colors",children:"Close"})]}),v.jsx("style",{children:`
          input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 16px; height: 16px; background: #22d3ee; cursor: pointer; border-radius: 50%; } 
          input[type="range"]::-moz-range-thumb { width: 16px; height: 16px; background: #22d3ee; cursor: pointer; border-radius: 50%; border: none; } 
          input[type="range"]:disabled::-webkit-slider-thumb { background: #64748b; } 
          input[type="range"]:disabled::-moz-range-thumb { background: #64748b; }
        `})]}),v.jsx(Hu,{isOpen:S,onClose:()=>C(!1),title:"Confirm Log Out",children:v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Are you sure you want to log out?",v.jsx("br",{}),"Any active game will be forfeit."]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>C(!1),className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:F,className:"bg-red-600 hover:bg-red-500 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Log Out"})]})]})})]})},a7=({onGoToShop:n,itemOffset:e=0})=>{const{gameState:t}=fa(),{playSound:i}=gs(),s=H.useMemo(()=>{const m=yo.filter(_=>!t.ownedCosmeticIds.includes(_.id)&&_.price>0);return m.length>0?m:[yo.find(_=>_.id==="boom_rocket")]},[t.ownedCosmeticIds]),[o,c]=H.useState(()=>e%s.length);H.useEffect(()=>{o>=s.length&&c(0)},[s.length,o]),H.useEffect(()=>{if(s.length<=1)return;const m=setInterval(()=>{c(_=>(_+1)%s.length)},5e3+e*250);return()=>clearInterval(m)},[s.length,e]);const h=s[o];if(!h)return null;const d=m=>{switch(m.type){case"piece":{const _=m.item.component;return v.jsx(_,{className:"w-14 h-14 text-cyan-300"})}case"effect":{const _=m.item.previewComponent;return v.jsx("div",{className:"w-14 h-14 flex items-center justify-center text-cyan-300",children:v.jsx(_,{})})}case"theme":{const _=m.item;return v.jsx("div",{className:`w-14 h-14 rounded-md flex items-center justify-center p-2 ${_.boardBg}`,children:v.jsx("div",{className:`w-10 h-10 rounded ${_.cellBg} border-2 ${_.gridColor}`})})}case"avatar":return v.jsx("img",{src:m.item.url,alt:m.name,className:"w-14 h-14 rounded-full object-cover bg-slate-700"});case"emoji":return v.jsx("span",{className:"text-4xl",children:m.item.emoji});default:return null}};return v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-3 w-full h-full flex flex-col items-center justify-center text-center",children:[v.jsx("h3",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-2",children:"Featured Item"}),v.jsx("div",{className:"w-20 h-20 flex items-center justify-center",children:d(h)}),v.jsx("p",{className:"text-white font-semibold mt-1 text-sm h-10 flex items-center",children:h.name}),v.jsx("button",{onClick:()=>{i("select"),n()},className:"mt-2 text-xs bg-yellow-500 text-black font-bold px-3 py-1 rounded-full hover:bg-yellow-400 transition-colors",children:"Go to Shop"})]})},o7=()=>{const{gameState:n,setPlayerName:e,spendCoins:t}=fa(),{playerName:i,playerLevel:s,playerXp:o,pveWins:c,pveLosses:h,pveDraws:d,activeAvatar:m,coins:_}=n,{playSound:y}=gs(),[T,S]=H.useState(!1),[C,M]=H.useState(i),[q,F]=H.useState(null),[j,W]=H.useState(!1),se=()=>{if(_<100){F("Not enough coins!"),setTimeout(()=>F(null),2e3);return}S(!0)},z=()=>{const U=C.trim();if(U===i){S(!1);return}U&&U.length>=3&&U.length<=15?W(!0):(F("Name must be 3-15 characters."),setTimeout(()=>F(null),2e3),M(i),S(!1))},ae=()=>{t(100)?(y("confirm"),e(C.trim())):(F("Purchase failed. Not enough coins."),setTimeout(()=>F(null),2e3)),W(!1),S(!1)},N=m.url,R=Jr(s),x=o/R*100,k=c+h+d,P=k>0?(c/k*100).toFixed(2):"0.00";return v.jsxs("div",{className:"group relative bg-slate-800/50 border border-slate-700 rounded-xl p-4 w-full h-full transition-all duration-300 hover:border-cyan-400/50 hover:shadow-lg hover:shadow-cyan-500/10 overflow-hidden",children:[v.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 bg-cyan-500/10 rounded-full blur-2xl transition-all duration-500 group-hover:scale-150"}),v.jsxs("div",{className:"relative z-10",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("img",{src:N,alt:"Player Avatar",className:"w-16 h-16 rounded-full flex-shrink-0 border-2 border-slate-600 group-hover:border-cyan-400 transition-colors object-cover bg-slate-700"}),v.jsxs("div",{className:"flex-grow text-left",children:[T?v.jsx("input",{type:"text",value:C,onChange:U=>M(U.target.value),onBlur:z,onKeyPress:U=>U.key==="Enter"&&z(),className:"bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white text-lg font-bold w-full",autoFocus:!0,maxLength:15}):v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("h2",{className:"text-xl font-bold text-white truncate",children:i}),v.jsx("button",{onClick:se,className:"text-slate-400 hover:text-white transition-colors",title:"Edit name (Costs 100 coins)",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L16.732 3.732z"})})})]}),v.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[v.jsxs("span",{className:"font-semibold text-cyan-400 text-sm",children:["Level ",s]}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("span",{className:"text-yellow-400 font-bold text-sm",children:_}),v.jsx("span",{className:"text-yellow-400",children:""})]})]})]})]}),q&&v.jsx("p",{className:"text-red-500 text-xs text-center absolute -bottom-2 left-1/2 -translate-x-1/2 w-full",children:q}),v.jsxs("div",{className:"mt-3",children:[v.jsxs("div",{className:"flex justify-between items-baseline text-xs text-slate-400 mb-1 px-1",children:[v.jsx("span",{className:"font-semibold",children:"XP"}),v.jsxs("span",{children:[o," / ",R]})]}),v.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:v.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-blue-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${x}%`}})})]}),v.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mt-4",children:[v.jsxs("div",{className:"transition-transform duration-200 hover:scale-110 p-2 rounded-lg",children:[v.jsx("p",{className:"text-green-400 font-bold text-xl",children:c}),v.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider",children:"Wins"})]}),v.jsxs("div",{className:"transition-transform duration-200 hover:scale-110 p-2 rounded-lg",children:[v.jsx("p",{className:"text-red-400 font-bold text-xl",children:h}),v.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider",children:"Losses"})]}),v.jsxs("div",{className:"transition-transform duration-200 hover:scale-110 p-2 rounded-lg",children:[v.jsxs("p",{className:"text-cyan-400 font-bold text-xl",children:[P,"%"]}),v.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider",children:"Win Rate"})]})]})]}),v.jsx(Hu,{isOpen:j,onClose:()=>W(!1),title:"Confirm Name Change",children:v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Are you sure you want to change your name to ",v.jsx("strong",{className:"text-white",children:C.trim()}),"? This will cost ",v.jsx("strong",{className:"text-yellow-400",children:"100 "}),"."]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>{y("select"),W(!1),S(!1)},className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:ae,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Confirm"})]})]})})]})},l7=({bot:n,onChallenge:e})=>{const i={easy:"border-green-500",medium:"border-purple-500",hard:"border-orange-500"}[n.skillLevel];return v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 text-center transition-all duration-300 flex flex-col backdrop-blur-sm hover:border-cyan-400",children:[v.jsx("img",{src:n.avatar,alt:n.name,className:`w-16 h-16 rounded-full mx-auto mb-3 border-2 ${i} object-cover bg-slate-700`}),v.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:n.name}),v.jsx("p",{className:"text-slate-400 text-xs mb-3 flex-grow",children:n.description}),v.jsx("button",{onClick:e,className:"mt-auto w-full bg-cyan-500 hover:bg-cyan-400 text-black font-bold py-2 px-3 rounded-lg transition-all text-sm",children:"Challenge"})]})},c7=({onStartGame:n,onGoToShop:e,onGoToInventory:t,onGoToOnline:i})=>{const[s,o]=H.useState(!1),{playSound:c}=gs(),{user:h,logOut:d}=dh(),m=y=>{c("select"),n(y)},_=()=>{c("select"),o(!0)};return v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 sm:p-6 flex flex-col items-center justify-center overflow-hidden relative",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-5xl text-center z-10 flex flex-col items-center",children:[v.jsxs("h1",{className:"text-5xl md:text-6xl font-black text-white mb-1",children:["Caro ",v.jsx("span",{className:"text-cyan-400",children:"AI Arena"})]}),v.jsx("p",{className:"text-slate-400 text-md mb-8",children:"Five in a row. Infinite possibilities."}),v.jsxs("div",{className:"w-full max-w-4xl grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[v.jsx("div",{className:"md:col-span-1",children:v.jsx(o7,{})}),v.jsx("div",{className:"md:col-span-1",children:v.jsx(a7,{onGoToShop:e,itemOffset:0})}),v.jsxs("div",{className:"md:col-span-1 grid grid-cols-2 gap-4 h-full",children:[v.jsx("button",{onClick:e,className:"w-full h-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center",children:"Shop "}),v.jsx("button",{onClick:t,className:"w-full h-full bg-gradient-to-r from-teal-500 to-blue-500 hover:from-teal-400 hover:to-blue-400 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center",children:"Inventory "}),v.jsx("button",{onClick:_,className:"w-full h-full bg-slate-700 hover:bg-slate-600 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center",children:"Settings "}),v.jsx("button",{onClick:i,className:"w-full h-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-400 hover:to-red-400 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 shadow-lg flex items-center justify-center transform hover:scale-105",children:"Play Online "})]})]}),v.jsxs("div",{className:"w-full max-w-4xl",children:[v.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Choose Your Opponent"}),v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:KM.map(y=>v.jsx(l7,{bot:y,onChallenge:()=>m(y)},y.id))})]})]}),v.jsx(Fb,{isOpen:s,onClose:()=>o(!1),onLogOut:h?d:void 0})]})},Gd="caroGameState_inProgress",$k=()=>Array(et).fill(null).map(()=>Array(et).fill(null)),u7=()=>{var n;try{const e=localStorage.getItem(Gd);if(e){const{board:t,currentPlayer:i,totalGameTime:s}=JSON.parse(e);if(t&&Array.isArray(t)&&i&&typeof s=="number"&&t.length===et&&((n=t[0])==null?void 0:n.length)===et)return{board:t,currentPlayer:i,totalGameTime:s,isDecidingFirst:!1}}}catch(e){console.error("Failed to load game state from localStorage",e),localStorage.removeItem(Gd)}return{board:$k(),currentPlayer:null,totalGameTime:vu,isDecidingFirst:!0}},h7=(n="X",e=!1)=>{const[t]=H.useState(u7),[i,s]=H.useState(t.board),[o,c]=H.useState(t.currentPlayer),[h,d]=H.useState(null),[m,_]=H.useState(!1),[y,T]=H.useState([]),[S,C]=H.useState(t.isDecidingFirst),[M,q]=H.useState(t.totalGameTime),[F,j]=H.useState(co),[W,se]=H.useState(null),z=H.useRef([]),ae=H.useRef([]),N=H.useRef(null),R=H.useRef(null);H.useEffect(()=>{if(!m&&!S&&o)try{const he={board:i,currentPlayer:o,totalGameTime:M};localStorage.setItem(Gd,JSON.stringify(he))}catch(he){console.error("Failed to save game state:",he)}else localStorage.removeItem(Gd)},[i,o,M,m,S]);const x=H.useCallback(()=>{N.current&&(clearInterval(N.current),N.current=null),R.current&&(clearInterval(R.current),R.current=null)},[]);H.useEffect(()=>{if(m||S||!o||e){x();return}return j(co),N.current=setInterval(()=>{j(he=>he<=1?(x(),d("timeout"),_(!0),0):he-1)},1e3),R.current=setInterval(()=>{q(he=>he<=1?(x(),d("draw"),_(!0),0):he-1)},1e3),()=>x()},[m,S,o,e,x]);const k=H.useCallback((he,pe)=>{const Ee=[{r:0,c:1},{r:1,c:0},{r:1,c:1},{r:1,c:-1}];for(let V=0;V<et;V++)for(let te=0;te<et;te++)if(he[V][te]===pe)for(const ce of Ee){const ye=[];let Ae=!0;for(let Ce=0;Ce<ei;Ce++){const Ve=V+Ce*ce.r,Et=te+Ce*ce.c;if(Ve<0||Ve>=et||Et<0||Et>=et||he[Ve][Et]!==pe){Ae=!1;break}ye.push({row:Ve,col:Et})}if(Ae)return ye}return null},[]),P=he=>he.every(pe=>pe.every(Ee=>Ee!==null)),U=H.useCallback((he,pe)=>{if(!o||i[he][pe]||m||S)return;z.current.push({board:i,currentPlayer:o,totalGameTime:M}),ae.current.push({row:he,col:pe}),se({row:he,col:pe});const Ee=i.map(te=>[...te]);Ee[he][pe]=o,s(Ee);const V=k(Ee,o);V?(d(o),_(!0),T(V)):P(Ee)?(d("draw"),_(!0)):c(te=>te==="X"?"O":"X")},[i,o,m,k,S,M]),D=H.useCallback(()=>{x(),s($k()),d(null),_(!1),T([]),q(vu),j(co),c(null),C(!0),z.current=[],ae.current=[],se(null),localStorage.removeItem(Gd)},[x]),pt=H.useCallback(he=>{c(he),C(!1)},[]),ct=o===n&&!m&&z.current.length>0,Z=H.useCallback(()=>{if(!ct)return;const he=z.current[z.current.length-2];if(he)z.current.pop(),z.current.pop(),ae.current.pop(),ae.current.pop(),s(he.board),c(he.currentPlayer),q(he.totalGameTime);else if(z.current.length===1){const pe=z.current.pop();ae.current.pop(),pe&&(s(pe.board),c(pe.currentPlayer),q(pe.totalGameTime))}se(ae.current[ae.current.length-1]||null),d(null),_(!1),T([]),x()},[ct,x]);return{board:i,currentPlayer:o,winner:h,isGameOver:m,makeMove:U,resetGameForRematch:D,beginGame:pt,winningLine:y,isDecidingFirst:S,totalGameTime:M,turnTimeLeft:F,resign:()=>{!o||m||(d(o===n?"O":"X"),_(!0))},undoMove:Z,canUndo:ct,moveHistory:ae.current,gameId:null,playerMark:n,lastMove:W}},d7=(n,e)=>{const[t,i]=H.useState(null),[s,o]=H.useState(()=>Ew({})),[c,h]=H.useState(null),[d,m]=H.useState(!0),_=H.useRef(0),[y,T]=H.useState(null),[S,C]=H.useState(co),[M,q]=H.useState(vu),F=H.useMemo(()=>t&&e?t.players.X===e.uid?"X":"O":"X",[t,e]);return H.useEffect(()=>{if(!n||!e){m(!1),i(null);return}m(!0);const j=X8(n,W=>{if(W){if(i(W),W.emotes&&e){const{uid:se,emoji:z,timestamp:ae}=W.emotes;se!==e.uid&&ae>_.current&&(_.current=ae,T({key:ae,emoji:z}))}o(se=>{const z=Ew(W.board);return JSON.stringify(se)!==JSON.stringify(z)&&h(V8(se,z)),z})}else i(null);m(!1)});return()=>j()},[n,e]),H.useEffect(()=>{var W;if(!t||t.status==="finished"){C(co);const se=(t==null?void 0:t.currentPlayer)||"X";q(((W=t==null?void 0:t.playerTimes)==null?void 0:W[se])??vu);return}const j=setInterval(()=>{const se=(Date.now()-t.turnStartedAt)/1e3,z=co-se;C(z);const ae=t.currentPlayer,R=t.playerTimes[ae]-se;q(Math.max(0,R)),R<-2&&t.currentPlayer!==F&&e&&Z8(t.id,F)},500);return()=>clearInterval(j)},[t,F,e]),{board:s,currentPlayer:(t==null?void 0:t.currentPlayer)||null,winner:(t==null?void 0:t.winner)||null,isGameOver:(t==null?void 0:t.status)==="finished",winningLine:(t==null?void 0:t.winningLine)||[],isDecidingFirst:!1,isLoading:d,onlineGameData:t,lastMove:c,opponentEmote:y,playerMark:F,gameId:(t==null?void 0:t.id)||null,activePlayerTime:M,turnTimeLeft:S,makeMove:(j,W)=>{n&&J8(n,j,W,F)},resign:()=>{n&&t7(n,F)},sendEmote:j=>{n&&e&&W8(n,e.uid,j)},beginGame:()=>{},resetGameForRematch:()=>{},undoMove:()=>{},canUndo:!1,moveHistory:[]}},Tw="caroOpeningBook_v1",f7=8,Wk=n=>n.map(e=>e.map(t=>t||"-").join("")).join(""),Yk=()=>{try{const n=localStorage.getItem(Tw);if(n)return new Map(JSON.parse(n))}catch(n){console.error("Failed to load or parse opening book from localStorage",n),localStorage.removeItem(Tw)}return new Map},m7=n=>{try{const e=Array.from(n.entries());localStorage.setItem(Tw,JSON.stringify(e))}catch(e){console.error("Failed to save opening book to localStorage",e)}},p7=n=>{if(!n||n.length===0)return;const e=Yk(),t=Array(15).fill(null).map(()=>Array(15).fill(null));let i="X";for(let s=0;s<n.length-1&&s<f7;s++){const o=n[s],c=n[s+1],h=Wk(t);t[o.row][o.col]===null&&(t[o.row][o.col]=i),s%2!==0&&e.set(h,c),i=i==="X"?"O":"X"}m7(e),console.log(`Opening book updated. Current size: ${e.size}`)},g7=(n,e)=>{const t=Wk(n),i=e.get(t);return i&&n[i.row][i.col]===null?(console.log("AI Move: Found in opening book.",i),i):null},Vo=(n,e)=>{const t=[{r:0,c:1},{r:1,c:0},{r:1,c:1},{r:1,c:-1}];for(let i=0;i<et;i++)for(let s=0;s<et;s++)if(n[i][s]===e)for(const o of t){let c=1;for(let h=1;h<ei;h++){const d=i+h*o.r,m=s+h*o.c;if(d>=0&&d<et&&m>=0&&m<et&&n[d][m]===e)c++;else break}if(c===ei)return!0}return!1},sm=n=>{const e=new Set;let t=!1;const i=Math.floor(et/2);for(let s=0;s<et;s++)for(let o=0;o<et;o++)if(n[s][o]!==null){t=!0;for(let c=-2;c<=2;c++)for(let h=-2;h<=2;h++){if(c===0&&h===0)continue;const d=s+c,m=o+h;d>=0&&d<et&&m>=0&&m<et&&n[d][m]===null&&e.add(`${d},${m}`)}}if(!t)return[{row:i,col:i}];if(e.size===0){const s=[];for(let o=0;o<et;o++)for(let c=0;c<et;c++)n[o][c]===null&&s.push({row:o,col:c});return s}return Array.from(e).map(s=>{const[o,c]=s.split(",").map(Number);return{row:o,col:c}})},fr={FIVE:1e7,LIVE_FOUR:5e5,DEAD_FOUR:4e5,LIVE_THREE:5e4,DEAD_THREE:1e4,LIVE_TWO:700,DEAD_TWO:100,LIVE_ONE:10,DEAD_ONE:1},Lp=(n,e)=>{const t=e==="X"?"O":"X",i=n.filter(y=>y===e).length,s=n.filter(y=>y===t).length;if(i>0&&s>0)return 0;const o=i||s,c=i>0?e:t,h=n[0],d=n[n.length-1];let m=0;h===null&&m++,d===null&&m++;let _=0;return o===5?_=fr.FIVE:o===4?_=m===2?fr.LIVE_FOUR:m===1?fr.DEAD_FOUR:0:o===3?_=m===2?fr.LIVE_THREE:m===1?fr.DEAD_THREE:0:o===2?_=m===2?fr.LIVE_TWO:m===1?fr.DEAD_TWO:0:o===1&&(_=m===2?fr.LIVE_ONE:m===1?fr.DEAD_ONE:0),c===e?_:-_},_0=(n,e)=>{let t=0;for(let i=0;i<et;i++)for(let s=0;s<et;s++){if(n[i][s]===e?t+=7-(Math.abs(i-7)+Math.abs(s-7))/2:n[i][s]!==null&&(t-=7-(Math.abs(i-7)+Math.abs(s-7))/2),s<=et-ei){const o=[];for(let c=0;c<ei;c++)o.push(n[i][s+c]);t+=Lp(o,e)}if(i<=et-ei){const o=[];for(let c=0;c<ei;c++)o.push(n[i+c][s]);t+=Lp(o,e)}if(i<=et-ei&&s<=et-ei){const o=[];for(let c=0;c<ei;c++)o.push(n[i+c][s+c]);t+=Lp(o,e)}if(i>=ei-1&&s<=et-ei){const o=[];for(let c=0;c<ei;c++)o.push(n[i-c][s+c]);t+=Lp(o,e)}}return t},Iw=(n,e,t)=>{const i=e==="X"?"O":"X",s=sm(n);let o=null,c=-1/0,h=null,d=-1/0;for(const m of s){const _=n.map(C=>[...C]);_[m.row][m.col]=i;const y=t(_,i);y>c&&(c=y,o={move:m,score:y});const T=n.map(C=>[...C]);T[m.row][m.col]=e;const S=t(T,e);S>d&&(d=S,h={move:m,score:S})}return{bestOpponentMove:o,bestAiMove:h}},Sw=(n,e,t,i,s,o,c)=>{if(e===0||Vo(n,"X")||Vo(n,"O"))return{score:c(n,o)};const h=sm(n);if(h.length===0)return{score:c(n,o)};let d=h[0];if(s){let m=-1/0;for(const _ of h){const y=n.map(S=>[...S]);y[_.row][_.col]=o;const T=Sw(y,e-1,t,i,!1,o,c);if(T.score>m&&(m=T.score,d=_),t=Math.max(t,T.score),i<=t)break}return{score:m,move:d}}else{let m=1/0;const _=o==="X"?"O":"X";for(const y of h){const T=n.map(C=>[...C]);T[y.row][y.col]=_;const S=Sw(T,e-1,t,i,!0,o,c);if(S.score<m&&(m=S.score,d=y),i=Math.min(i,S.score),i<=t)break}return{score:m,move:d}}},ZC=(n,e,t,i,s)=>{var d;const o=e==="X"?"O":"X",c=sm(n);for(const m of c){const _=n.map(y=>[...y]);if(_[m.row][m.col]=e,Vo(_,e))return m}for(const m of c){const _=n.map(y=>[...y]);if(_[m.row][m.col]=o,Vo(_,o))return m}if(s==="easy"){const{bestOpponentMove:m,bestAiMove:_}=Iw(n,e,i);return m&&m.score>=fr.DEAD_THREE?_&&_.score>m.score*1.2?(console.log("Easy AI: Found a better offensive move, ignoring block.",_.move),_.move):(console.log("Easy AI: Blocking opponent's 3-in-a-row threat.",m.move),m.move):_?_.move:c[0]}if(s==="medium"||s==="hard"){const{bestOpponentMove:m,bestAiMove:_}=Iw(n,e,i),y=fr.LIVE_THREE;if(m&&m.score>=y&&(!_||m.score>_.score))return console.log(`AI (${s}): Blocking critical player threat.`,m.move),m.move}const{move:h}=Sw(n,t,-1/0,1/0,!0,e,i);return h&&((d=n[h.row])==null?void 0:d[h.col])===null?h:(console.error("Minimax failed to return a valid move, picking a random one from available moves."),c[Math.floor(Math.random()*c.length)])},Aw=async(n,e,t,i,s,o,c,h,d)=>{if(e===0||Vo(n,"X")||Vo(n,"O"))return{score:c(n,o)};const m=d||sm(n);if(m.length===0)return{score:c(n,o)};let _=m[0];if(s){let y=-1/0;for(const T of m){h.count++,h.count%25===0&&await new Promise(M=>setTimeout(M,0));const S=n.map(M=>[...M]);S[T.row][T.col]=o;const C=await Aw(S,e-1,t,i,!1,o,c,h);if(C.score>y&&(y=C.score,_=T),t=Math.max(t,C.score),i<=t)break}return{score:y,move:_}}else{let y=1/0;const T=o==="X"?"O":"X";for(const S of m){h.count++,h.count%25===0&&await new Promise(q=>setTimeout(q,0));const C=n.map(q=>[...q]);C[S.row][S.col]=T;const M=await Aw(C,e-1,t,i,!0,o,c,h);if(M.score<y&&(y=M.score,_=S),i=Math.min(i,M.score),i<=t)break}return{score:y,move:_}}},_7=async(n,e,t,i)=>{var T;const s=e==="X"?"O":"X",o=sm(n);for(const S of o){const C=n.map(M=>[...M]);if(C[S.row][S.col]=e,Vo(C,e))return S}for(const S of o){const C=n.map(M=>[...M]);if(C[S.row][S.col]=s,Vo(C,s))return S}const{bestOpponentMove:c,bestAiMove:h}=Iw(n,e,i),d=fr.LIVE_THREE;if(c&&c.score>=d&&(!h||c.score>h.score))return console.log("AI (hard): Blocking critical player threat via tactical analysis.",c.move),c.move;const m=[];for(const S of o){const C=n.map(W=>[...W]);C[S.row][S.col]=e;const M=i(C,e),q=n.map(W=>[...W]);q[S.row][S.col]=s;const F=i(q,e),j=M-F;m.push({move:S,score:j})}m.sort((S,C)=>C.score-S.score);const _=m.slice(0,8).map(S=>S.move),{move:y}=await Aw(n,t,-1/0,1/0,!0,e,i,{count:0},_);return y&&((T=n[y.row])==null?void 0:T[y.col])===null?y:(console.error("Async Minimax failed to return a valid move, picking first available."),o[0])};let y0=null;const y7=async(n,e,t,i)=>{y0===null&&(y0=Yk());const s=g7(n,y0);if(s)return i&&i(s),new Promise(h=>setTimeout(()=>h(s),150));let o;switch(t){case"easy":o=1;break;case"medium":o=2;break;case"hard":o=3;break;default:o=1}if(console.log(`Local AI: Minimax (depth ${o}) for ${t} opponent. (Opening book miss)`),i){const h=ZC(n,e,1,_0,t);i(h)}if(t==="hard")return _7(n,e,o,_0);const c=t==="easy"?400+Math.random()*300:800+Math.random()*500;return new Promise(h=>{setTimeout(()=>{const d=ZC(n,e,o,_0,t);h(d)},c)})},v7=Ci.memo(({state:n,onClick:e,isWinningCell:t,pieces:i,showThinkingIndicator:s,theme:o,playPlacementEffect:c,isLastMove:h,effect:d})=>{const m=i.X.component,_=i.O.component,y=`animate-effect_${d.id.split("_")[1]}`;return v.jsxs("div",{className:"w-full h-full flex items-center justify-center cursor-pointer group relative",onClick:e,style:{"--tw-bg-opacity":.1},children:[v.jsx("div",{className:`absolute inset-0 border-r border-b ${o.gridColor}`}),n===null&&v.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:bg-white/10 transition-colors duration-200 rounded-sm"}),v.jsxs("div",{className:`w-full h-full relative transition-all duration-200 ${t?"bg-yellow-500/30 rounded-md scale-110":""}`,children:[n&&v.jsx("div",{className:"w-full h-full p-1.5",children:v.jsx("div",{className:`relative w-full h-full ${n==="X"?"text-cyan-400":"text-pink-500"}`,children:v.jsx("div",{className:c?y:"",children:v.jsx("div",{className:h?"last-move-highlight":"",children:n==="X"?v.jsx(m,{}):v.jsx(_,{})})})})}),s&&v.jsx("div",{className:"w-full h-full flex items-center justify-center",children:v.jsx("div",{className:"w-8 h-8 border-2 border-yellow-400 border-t-transparent rounded-full animate-spin"})})]})]})}),w7=({board:n,onCellClick:e,winningLine:t,pieces:i,aiThinkingCell:s,theme:o,lastMove:c,effect:h})=>{const d=(m,_)=>t.some(y=>y.row===m&&y.col===_);return v.jsx("div",{className:`grid ${o.cellBg} border-t border-l ${o.gridColor}`,style:{gridTemplateColumns:`repeat(${n.length}, minmax(0, 1fr))`},children:n.map((m,_)=>m.map((y,T)=>v.jsx("div",{className:"aspect-square",children:v.jsx(v7,{state:y,onClick:()=>e(_,T),isWinningCell:d(_,T),pieces:i,showThinkingIndicator:(s==null?void 0:s.row)===_&&(s==null?void 0:s.col)===T,theme:o,playPlacementEffect:(c==null?void 0:c.row)===_&&(c==null?void 0:c.col)===T,isLastMove:(c==null?void 0:c.row)===_&&(c==null?void 0:c.col)===T,effect:h})},`${_}-${T}`)))})},e1=Ci.forwardRef(({name:n,avatar:e,level:t,player:i,align:s,isCurrent:o,piece:c,skillLevel:h},d)=>{const m=c.component,_=o?"shadow-lg shadow-yellow-500/50":"",y=i==="X"?"text-cyan-400":"text-pink-500",S=h?{easy:"border-green-500",medium:"border-purple-500",hard:"border-orange-500"}[h]:"";return v.jsxs("div",{ref:d,className:`flex items-center gap-3 relative ${s==="right"?"flex-row-reverse":""}`,children:[v.jsx("img",{src:e,alt:`${n}'s avatar`,className:`w-14 h-14 rounded-full transition-all duration-300 ${_} bg-slate-700 object-cover ${h?`border-2 ${S}`:""}`,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.4))"}}),v.jsxs("div",{className:`${s==="right"?"text-right":""} text-shadow`,children:[v.jsx("h3",{className:"font-bold text-white text-lg",children:n}),v.jsxs("div",{className:`flex items-center gap-2 ${s==="right"?"flex-row-reverse":""}`,children:[v.jsxs("p",{className:"text-slate-300 text-sm",children:["Lv. ",t]}),v.jsx("div",{className:`w-5 h-5 ${y}`,children:v.jsx(m,{})})]})]})]})}),t1=(n,e,t=1200)=>{const[i,s]=H.useState(0),o=Ci.useRef(null);return H.useEffect(()=>{if(e){let c=null;const h=d=>{c||(c=d);const m=Math.min((d-c)/t,1);s(Math.floor(m*n)),m<1&&(o.current=requestAnimationFrame(h))};o.current=requestAnimationFrame(h)}else s(0);return()=>{o.current&&cancelAnimationFrame(o.current)}},[n,t,e]),i},E7=({show:n,winner:e,timedOutPlayer:t,playerMark:i,onReset:s,onExit:o,playerLevel:c,playerXp:h,gameMode:d,leaveCountdown:m})=>{const[_,y]=H.useState("start"),[T,S]=H.useState(c),C=e===i,M=e==="draw",q=t===i,F=q?"loss":C?"win":M?"draw":"loss",j=n?c1[F]:0,W=n?l1[F]:0,{didLevelUp:se,initialLevel:z,initialXp:ae,newLevel:N,finalXp:R}=H.useMemo(()=>{if(!n)return{didLevelUp:!1,initialLevel:c,initialXp:h,newLevel:c,finalXp:h};let Z=h;for(let V=1;V<c;V++)Z+=Jr(V);const fe=Z-j;let he=1,pe=fe,Ee=Jr(he);for(;pe>=Ee;)pe-=Ee,he++,Ee=Jr(he);return{didLevelUp:he<c,initialLevel:he,initialXp:pe,newLevel:c,finalXp:h}},[n,c,h,j]),x=ae/Jr(z)*100,k=se?100:(ae+j)/Jr(z)*100,P=R/Jr(N)*100,U=t1(W,_!=="start"),D=t1(j,_!=="start"),pt=H.useMemo(()=>e==="timeout"?q?"TIME'S UP!":"OPPONENT TIMED OUT":C?"YOU WIN!":M?"IT'S A DRAW!":"YOU LOSE!",[e,q,C,M]),ct=F==="win"?"text-green-400":F==="draw"?"text-yellow-400":"text-red-500";return H.useEffect(()=>{let Z=null;if(n)return S(z),Z=setTimeout(()=>{y("filling"),se?(setTimeout(()=>y("levelUp"),1200),setTimeout(()=>{S(N),y("done")},1700)):setTimeout(()=>y("done"),1200)},500),()=>{Z&&clearTimeout(Z)};y("start"),S(c)},[n,se,N,z,c]),v.jsx("div",{className:`fixed inset-0 bg-black/80 flex items-center justify-center z-40 transition-opacity duration-500 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:v.jsxs("div",{className:`text-center transition-all duration-500 ${n?"scale-100 opacity-100":"scale-95 opacity-0"}`,children:[v.jsx("h1",{className:`text-7xl font-black ${ct} mb-8`,children:pt}),v.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 w-80 mx-auto border border-slate-700 relative",children:[_==="levelUp"&&v.jsx("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 text-3xl font-bold text-yellow-300 animate-bounce",children:"LEVEL UP!"}),v.jsxs("div",{className:"text-left mb-4",children:[v.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[v.jsxs("span",{className:"font-semibold text-white",children:["Level ",T]}),v.jsx("span",{className:`text-sm bg-pink-500 text-white font-bold px-2 py-0.5 rounded-full transition-transform duration-300 ${_==="levelUp"?"scale-150":""}`,children:T})]}),v.jsx("div",{className:"bg-slate-700 h-4 rounded-full overflow-hidden relative",children:v.jsx("div",{className:"bg-pink-500 h-full absolute transition-all duration-1000 ease-out",style:{width:_==="start"?`${x}%`:_==="filling"?`${k}%`:_==="levelUp"?"100%":`${P}%`,transitionDuration:_==="done"&&se?"0s":"1s"}})}),v.jsxs("p",{className:"text-right text-sm text-slate-400 mt-1",children:[_==="done"&&se?R:ae+D,"/",Jr(T)," XP"]})]}),v.jsx("h2",{className:"font-bold text-slate-300 mb-2",children:"REWARDS"}),v.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3 flex justify-around",children:[v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("span",{className:`font-bold text-yellow-400 text-xl transition-opacity duration-500 ${_!=="start"?"opacity-100":"opacity-0"}`,children:["+",U]})]}),v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsxs("span",{className:`font-bold text-purple-400 text-xl transition-opacity duration-500 ${_!=="start"?"opacity-100":"opacity-0"}`,children:["+",D," XP"]})]})]})]}),v.jsxs("div",{className:"mt-8 space-y-3",children:[d==="pve"&&v.jsx("button",{onClick:s,className:"w-full max-w-sm bg-green-500 hover:bg-green-400 text-black font-bold py-3 px-6 rounded-lg transition-colors text-lg",children:"Play again!"}),v.jsxs("button",{onClick:o,className:"w-full max-w-sm bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 px-6 rounded-lg transition-colors",children:["Back to ",d==="online"?"Lobby":"Menu"," (",m,"s)"]})]})]})})},b7=({pieces:n,onAnimationEnd:e,playerMark:t,playSound:i,gameMode:s="pve",forcedWinner:o=null,playerInfo:c,opponentInfo:h})=>{const[d,m]=H.useState(null),[_]=H.useState(()=>o||(Math.random()<.5?"X":"O")),y=n.X.component,T=n.O.component;H.useEffect(()=>{i("deciding");const C=setTimeout(()=>{m(_),i(s==="pve"?_===t?"first_move_player":"first_move_ai":"check"),setTimeout(()=>e(_),1500)},1500);return()=>clearTimeout(C)},[_,e,t,i,s]);const S=()=>d?`${d===t?c==null?void 0:c.name:h==null?void 0:h.name} goes first!`:"Deciding who goes first...";return v.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center rounded-lg z-20",children:[v.jsxs("div",{className:"relative w-48 h-24",children:[v.jsx("div",{className:`absolute top-0 w-24 h-24 p-2 transition-all duration-500 ease-out ${d?d==="X"?"left-1/2 -translate-x-1/2 scale-125":"left-0 opacity-0 -translate-x-full":"left-0 animate-slide-in-left"}`,children:v.jsx(y,{className:"text-cyan-400"})}),v.jsx("div",{className:`absolute top-0 w-24 h-24 p-2 transition-all duration-500 ease-out ${d?d==="O"?"left-1/2 -translate-x-1/2 scale-125":"right-0 opacity-0 translate-x-full":"right-0 animate-slide-in-right"}`,children:v.jsx(T,{className:"text-pink-500"})})]}),v.jsx("p",{className:"text-white font-semibold text-lg mt-4 transition-opacity duration-300",children:S()}),v.jsx("style",{children:`
        @keyframes slide-in-left { 0% { transform: translateX(-100vw); } 80% { transform: translateX(0); } 100% { transform: translateX(0); }}
        @keyframes slide-in-right { 0% { transform: translateX(100vw); } 80% { transform: translateX(0); } 100% { transform: translateX(0); }}
        .animate-slide-in-left { animation: slide-in-left 1s cubic-bezier(0.25, 1, 0.5, 1); }
        .animate-slide-in-right { animation: slide-in-right 1s cubic-bezier(0.25, 1, 0.5, 1); }
      `})]})},T7=Ci.memo(({duration:n,isPaused:e,isGameOver:t,isDecidingFirst:i,time:s})=>{if(t||i)return v.jsx("div",{className:"w-full h-1.5 bg-slate-800 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-green-400 rounded-full",style:{width:"100%"}})});const o=Math.max(0,s/n*100),c=o<30?"bg-red-500":o<70?"bg-yellow-400":"bg-green-400";return v.jsx("div",{className:"w-full h-1.5 bg-slate-800 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full ${c} rounded-full transition-colors duration-500`,style:{width:`${o}%`,transition:e?"none":"width 0.5s linear"}})})}),n1=({emoji:n,startRef:e,onEnd:t})=>{const[i,s]=H.useState({top:0,left:0});return H.useEffect(()=>{if(e.current){const o=e.current.getBoundingClientRect();s({top:o.top+o.height/2,left:o.left+o.width/2})}},[e]),i.top===0?null:v.jsxs("div",{className:"fixed text-5xl z-30 pointer-events-none animate-emote-fall",style:{top:i.top,left:i.left},onAnimationEnd:t,children:[n,v.jsx("style",{children:`
                @keyframes emote-fall-anim {
                    0% {
                        transform: translate(-50%, -50%) scale(0.5);
                        opacity: 0;
                    }
                    20% {
                        transform: translate(-50%, -50%) scale(1.2);
                        opacity: 1;
                    }
                    80% {
                        transform: translate(-50%, 200px) scale(1);
                        opacity: 1;
                    }
                    100% {
                        transform: translate(-50%, 300px) scale(0.8);
                        opacity: 0;
                    }
                }
                .animate-emote-fall {
                    animation: emote-fall-anim 3s ease-out forwards;
                }
            `})]})},I7=n=>{const e=Math.floor(n/60),t=Math.round(n%60);return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},i1=({gameMode:n,bot:e,onlineGameId:t,onExit:i,theme:s,pieces:o,playerInfo:c,activeEffect:h,activeVictoryEffect:d,activeBoomEffect:m,isPaused:_,onOpenShop:y,onOpenInventory:T})=>{var nr,$o;const{user:S}=dh(),{gameState:C,consumeEmoji:M,spendCoins:q,applyGameResult:F}=fa(),{playSound:j}=gs(),W=h7("X",_),se=d7(n==="online"?t:null,S),z=n==="pve"?W:se,[ae,N]=H.useState(o.O),[R,x]=H.useState(null),[k,P]=H.useState(!1),[U,D]=H.useState(!1),[pt,ct]=H.useState(!1),[Z,fe]=H.useState(!1),[he,pe]=H.useState(15),[Ee,V]=H.useState("none"),[te,ce]=H.useState(null),[ye,Ae]=H.useState(null),[Ce,Ve]=H.useState(null),Et=H.useRef(!1),[bt,Ni]=H.useState(null),[Di,Tr]=H.useState(null),[ma,li]=H.useState(!1),_s=H.useCallback(()=>{li(!0)},[]),Ir=H.useRef(!1),pa=H.useRef(null),ys=H.useRef(null),vs=H.useRef(!1),er=H.useRef(null),{board:Sr,currentPlayer:ci,winner:mn,isGameOver:At,winningLine:hc,isDecidingFirst:xt,gameId:Tt,playerMark:gt,makeMove:dc,resign:qo,lastMove:Go}=z,{totalGameTime:ws}=W,{onlineGameData:Ue,isLoading:an,opponentEmote:qn,activePlayerTime:Pn,turnTimeLeft:fh}=se;Ue&&(vs.current=!0),H.useEffect(()=>{if(n==="online"&&t&&S)return()=>{n7(t,S.uid)}},[n,t,S]),H.useEffect(()=>{Et.current=!1,V("none"),ce(null),Ae(null),li(!1)},[Tt,t]),H.useEffect(()=>{const Oe=()=>{er.current&&(clearInterval(er.current),er.current=null)};return Ee==="summary"?(pe(15),er.current=setInterval(()=>{pe(ke=>ke<=1?(Oe(),i(),0):ke-1)},1e3)):Oe(),Oe},[Ee,i]),H.useEffect(()=>{Go&&j("move")},[Go,j]),H.useEffect(()=>{n==="online"&&qn&&Tr(qn)},[qn,n]),H.useEffect(()=>{var Oe;n==="online"&&t&&S&&((Oe=C.activePieceX)!=null&&Oe.id)&&e7(t,S.uid,C.activePieceX.id)},[(nr=C.activePieceX)==null?void 0:nr.id,n,t,S]);const ga=Ee!=="none";H.useEffect(()=>{n==="online"&&vs.current&&!an&&!Ue&&!ga&&i()},[n,an,Ue,i,ga]),H.useEffect(()=>{if(n==="pve"&&xt){const Oe=uo[Math.floor(Math.random()*uo.length)];N(Oe)}},[n,xt]),H.useEffect(()=>{const Oe=gt==="X"?"O":"X";if(n!=="pve"||_||xt||At||ci!==Oe||!e||Ir.current){ci!==Oe&&(Ir.current=!1);return}Ir.current=!0,Math.random()<.15&&setTimeout(()=>Tr({key:Date.now(),emoji:U8().emoji}),500),y7(Sr,Oe,e.skillLevel,ke=>x(ke)).then(({row:ke,col:Ft})=>{ke!==-1&&!At&&ci===Oe&&(x(null),W.makeMove(ke,Ft))}).finally(()=>{Ir.current=!1,x(null)})},[ci,At,Sr,_,xt,e,n,W,gt]),H.useEffect(()=>{if(At&&mn&&!Et.current){Et.current=!0;const Oe=mn===gt?"win":mn==="draw"?"draw":"loss",ke=n==="pve"?e.id:((Ue==null?void 0:Ue.players.X)===(S==null?void 0:S.uid)?Ue==null?void 0:Ue.players.O:Ue==null?void 0:Ue.players.X)||"unknown";F(Oe,ke,Tt),Oe==="win"?(j("win"),j("announce_win"),ce("You Win!")):Oe==="loss"?(j("lose"),j("announce_lose"),ce("You Lose!")):ce(mn==="timeout"?"Time Out!":"Draw!"),n==="pve"&&mn!==gt&&Oe!=="draw"&&p7(W.moveHistory),V("banner");const Ft=setTimeout(()=>{var Pi,hi;if(ce(null),mn!=="draw"&&mn!=="timeout"){Ae(mn);const bs=mn===gt?pa:ys,Ts=mn===gt?ys:pa;Ve({winner:(Pi=bs.current)==null?void 0:Pi.getBoundingClientRect(),loser:(hi=Ts.current)==null?void 0:hi.getBoundingClientRect()}),setTimeout(()=>j("boom"),800),V("effects")}},2e3),$n=setTimeout(()=>{V("summary"),j("summary")},5e3);return()=>{clearTimeout(Ft),clearTimeout($n)}}},[At,mn,gt,F,e,Tt,n,Ue,S,W.moveHistory,j]);const Es=H.useMemo(()=>{if(n==="online"&&Ue&&S){const Oe=Ue.players.X===S.uid?Ue.players.O:Ue.players.X,ke=Ue.playerDetails[Oe];return{name:(ke==null?void 0:ke.name)||"Opponent",avatar:(ke==null?void 0:ke.avatarUrl)||"assets/avatars/avatar_1.png",level:(ke==null?void 0:ke.level)||1}}return n==="pve"&&e?{name:e.name,avatar:e.avatar,level:e.level,skillLevel:e.skillLevel}:{name:"Player",avatar:"",level:1}},[n,Ue,S,e]),tr=H.useMemo(()=>{var Oe;if(n==="pve")return{X:o.X,O:ae};if(n==="online"&&Ue&&S){const ke=S.uid,Ft=Ue.players.X===ke?Ue.players.O:Ue.players.X,$n=o.X,Pi=((Oe=Ue.playerDetails[Ft])==null?void 0:Oe.pieceId)||Nn.id,bs=[Nn,Hd,...uo].find(Ts=>Ts.id===Pi)||Nn;return Ue.players.X===ke?{X:$n,O:bs}:{X:bs,O:$n}}return o},[n,Ue,S,o,ae]),ki=C.botStats[(e==null?void 0:e.id)||""]||{wins:0,losses:0},Ur=H.useMemo(()=>j8(C.ownedCosmeticIds,C.emojiInventory),[C.ownedCosmeticIds,C.emojiInventory]),Oi=(Oe,ke)=>{At||ci!==gt||Sr[Oe][ke]!==null||dc(Oe,ke)},ui=()=>{W.canUndo&&C.coins>=20&&ct(!0)},Fr=()=>{q(20)&&W.undoMove(),ct(!1)},_a=Oe=>{j("select"),Ni({key:Date.now(),emoji:Oe.emoji}),M(Oe.id),D(!1),n==="online"&&se.sendEmote(Oe.emoji)},Ho=H.useCallback(()=>{j("select"),V("none"),ce(null),Ae(null),Et.current=!1,n==="pve"&&W.resetGameForRematch()},[W,n,j]),Ar=()=>{Tt&&(navigator.clipboard.writeText(Tt),fe(!0),setTimeout(()=>fe(!1),2e3))},xr=s.decoratorComponent,pn=d.component,Ko=m.component,Cr=n==="pve"&&xt||n==="online"&&Ue&&Object.keys(Ue.board).length===0&&!At&&!ma;if(n==="online"&&an)return v.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center text-white",children:v.jsxs("div",{className:"flex flex-col items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 border-4 border-cyan-400 border-t-transparent rounded-full animate-spin"}),v.jsx("p",{className:"text-xl",children:"Entering match..."})]})});const Br=n==="pve"?ws:Pn,Qo=n==="pve"?W.turnTimeLeft:fh,ya=n==="online"&&Tt?`Room: ${($o=Tt.split("_").pop())==null?void 0:$o.substring(0,6)}`:null;return v.jsxs("div",{style:s.boardBgImage?{backgroundImage:`url(${s.boardBgImage})`}:{},className:`${s.boardBg} min-h-screen p-2 sm:p-4 flex flex-col items-center justify-center font-sans transition-colors duration-500 relative overflow-hidden bg-cover bg-center bg-no-repeat`,children:[xr&&v.jsx(xr,{}),v.jsx(TM,{}),v.jsx(HM,{}),bt&&v.jsx(n1,{emoji:bt.emoji,startRef:pa,onEnd:()=>Ni(null)},bt.key),Di&&v.jsx(n1,{emoji:Di.emoji,startRef:ys,onEnd:()=>Tr(null)},Di.key),v.jsxs("div",{className:"w-full max-w-[85vmin] mx-auto relative z-10 flex flex-col justify-center",children:[v.jsxs("header",{className:"flex flex-col justify-center items-center w-full relative mb-4",children:[v.jsx("h1",{className:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-cyan-300 to-blue-400 text-shadow",children:"Caro AI Arena"}),v.jsxs("div",{className:"relative flex items-center justify-center gap-4 mt-2",children:[v.jsx("button",{onClick:()=>{j("select"),P(!0)},className:"bg-slate-800/80 p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Settings",children:v.jsxs("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066 2.573c-.94-1.543.826 3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),n==="pve"&&v.jsx("button",{onClick:ui,disabled:!W.canUndo||C.coins<20,className:"relative bg-slate-800/80 p-2 rounded-full hover:bg-slate-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Undo",children:v.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 15l-3-3m0 0l3-3m-3 3h8a5 5 0 000-10H9"})})}),v.jsx("button",{onClick:()=>{j("select"),D(Oe=>!Oe)},className:"bg-slate-800/80 p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Emotes",children:v.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),U&&v.jsxs("div",{className:"absolute top-full mt-4 bg-slate-800/90 backdrop-blur-sm p-2 rounded-lg flex flex-wrap justify-center gap-2 animate-fade-in-down z-30",style:{width:"280px"},onMouseLeave:()=>D(!1),children:[" ",Ur.map(Oe=>v.jsx("button",{onClick:()=>_a(Oe),className:"text-3xl w-12 h-12 flex items-center justify-center rounded-md hover:bg-slate-700/50 hover:scale-110 transition-all",children:Oe.emoji},Oe.id))," "]})]})]}),v.jsxs("main",{className:"flex-grow flex flex-col justify-center relative",children:[Ee==="banner"&&te&&v.jsx("div",{className:"absolute top-28 left-1/2 -translate-x-1/2 w-max px-8 py-4 bg-slate-900/80 border border-slate-700 rounded-2xl shadow-lg z-30 pointer-events-none animate-fade-in-down-then-out",children:v.jsx("h2",{className:`text-5xl font-black ${te.includes("Win")?"text-green-400":te.includes("Lose")?"text-red-500":"text-yellow-400"}`,style:{textShadow:"0 0 15px currentColor"},children:te})}),v.jsxs("div",{className:"flex justify-between items-end px-2 mb-[4px] -mt-px",children:[v.jsx(e1,{ref:pa,name:c.name,avatar:c.avatar.url,level:c.level,align:"left",player:gt,isCurrent:ci===gt,piece:tr[gt]}),v.jsxs("div",{className:"text-center pb-1 text-shadow",children:[ya&&v.jsx("div",{className:"text-xs text-slate-400 font-mono mb-1 cursor-pointer",title:"Click to copy full Game ID",onClick:Ar,children:Z?"Copied!":ya}),n==="pve"&&e&&v.jsxs("div",{className:"text-white font-mono text-xs tracking-wider whitespace-nowrap",title:`vs ${e.name}`,children:[v.jsxs("span",{className:"text-green-400",children:["Win ",ki.wins]})," - ",v.jsxs("span",{className:"text-red-400",children:["Lose ",ki.losses]})]}),v.jsx("div",{className:"text-white font-mono text-2xl tracking-wider",children:I7(Br)})]}),v.jsx(e1,{ref:ys,name:Es.name,avatar:Es.avatar,level:Es.level,align:"right",player:gt==="X"?"O":"X",isCurrent:ci!==gt,piece:tr[gt==="X"?"O":"X"],skillLevel:n==="pve"?e==null?void 0:e.skillLevel:void 0})]}),v.jsxs("div",{className:"w-full mx-auto",children:[v.jsx(T7,{duration:co,isPaused:_,isGameOver:At,isDecidingFirst:xt||Cr,time:Qo},`${Tt}-${ci}`),v.jsxs("div",{className:"mt-px relative bg-black/40 backdrop-blur-lg rounded-xl p-2 border border-white/10 shadow-lg",children:[v.jsx(w7,{board:Sr,onCellClick:Oi,winningLine:hc,pieces:tr,aiThinkingCell:R,theme:s,lastMove:Go,effect:h}),Cr&&v.jsx(b7,{pieces:tr,onAnimationEnd:n==="pve"?W.beginGame:_s,playerMark:gt,playSound:j,gameMode:n,forcedWinner:n==="online"?Ue==null?void 0:Ue.currentPlayer:null,playerInfo:c,opponentInfo:Es})]})]})]})]}),Ee==="effects"&&ye&&Ce&&v.jsxs(v.Fragment,{children:[v.jsx(pn,{})," ",v.jsx(Ko,{winnerCoords:Ce==null?void 0:Ce.winner,loserCoords:Ce==null?void 0:Ce.loser})]}),v.jsx(E7,{show:Ee==="summary",winner:mn,timedOutPlayer:mn==="timeout"?ci===gt?gt==="X"?"O":"X":ci:null,playerMark:gt,onReset:Ho,onExit:()=>i(),playerLevel:C.playerLevel,playerXp:C.playerXp,gameMode:n,onlineGame:Ue,leaveCountdown:he}),v.jsx(s7,{isOpen:pt,onClose:()=>ct(!1),onConfirm:Fr,playSound:j}),v.jsx(Fb,{isOpen:k,onClose:()=>P(!1),onOpenShop:y,onOpenInventory:T,onResign:qo}),v.jsx("style",{children:".animate-confirm-glow { animation: confirm-glow 1.5s ease-in-out infinite; } @keyframes confirm-glow { 50% { box-shadow: 0 0 15px rgba(74, 222, 128, 0.7); } } .last-move-highlight { animation: last-move-glow 2s ease-in-out infinite; } @keyframes last-move-glow { 0% { filter: drop-shadow(0 0 12px rgba(255, 255, 100, 1)) drop-shadow(0 0 6px rgba(255, 255, 100, 1)) brightness(1.5); } 10% { filter: drop-shadow(0 0 10px rgba(255, 255, 100, 0.9)); } 55% { filter: drop-shadow(0 0 4px rgba(255, 255, 100, 0.6)); } 100% { filter: drop-shadow(0 0 10px rgba(255, 255, 100, 0.9)); } } .animate-fade-in-down-then-out { animation: fade-in-down-then-out 2s cubic-bezier(0.25, 1, 0.5, 1) forwards; } @keyframes fade-in-down-then-out { 0% { transform: translateY(-50px) translateX(-50%) scale(0.8); opacity: 0; } 20% { transform: translateY(0) translateX(-50%) scale(1); opacity: 1; } 80% { transform: translateY(0) translateX(-50%) scale(1); opacity: 1; } 100% { transform: translateY(20px) translateX(-50%) scale(0.9); opacity: 0; } }"})]})},r1=({onBack:n})=>{const{gameState:e,purchaseCosmetic:t}=fa(),{playSound:i}=gs(),[s,o]=H.useState("Skins"),[c,h]=H.useState(null),d={Skins:"piece",Avatars:"avatar",Emojis:"emoji",Themes:"theme",Effects:"effect",Victory:"victory",Booms:"boom"},m=C=>{i("confirm"),t(C),h(null)},_=C=>{i("select"),h(C)},y=yo.filter(C=>C.type===d[s]),T=C=>{switch(C.type){case"piece":{const M=C.item.component;return v.jsx(M,{className:"w-16 h-16 text-cyan-300"})}case"avatar":return v.jsx("img",{src:C.item.url,alt:C.name,className:"w-16 h-16 rounded-full object-cover bg-slate-700"});case"emoji":return v.jsx("span",{className:"text-4xl",children:C.item.emoji});case"theme":{const M=C.item;return v.jsx("div",{className:`w-16 h-16 rounded-md flex items-center justify-center p-2 bg-cover bg-center ${M.boardBg}`,style:M.boardBgImage?{backgroundImage:`url(${M.boardBgImage})`}:{},children:v.jsx("div",{className:`w-10 h-10 rounded ${M.cellBg} border-2 ${M.gridColor}`})})}case"effect":{const M=C.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(M,{})})}case"victory":{const M=C.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(M,{})})}case"boom":{const M=C.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(M,{})})}default:return null}},S=()=>v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:y.map(C=>{const M=e.ownedCosmeticIds.includes(C.id),q=e.coins>=C.price,F=C.type==="emoji"&&C.price>0,j=e.emojiInventory[C.id]||0;return v.jsxs("div",{className:"relative bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 flex flex-col items-center text-center transition-all duration-300 hover:border-cyan-400 hover:shadow-lg hover:shadow-cyan-500/10",children:[F&&j>0&&v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center border-2 border-slate-800",children:j}),v.jsx("div",{className:"h-24 w-24 mb-3 flex items-center justify-center bg-slate-900/70 rounded-lg p-2",children:T(C)}),v.jsx("h3",{className:"text-md font-semibold text-white mb-2 h-10 flex items-center justify-center",children:C.name}),M&&!F?v.jsx("button",{disabled:!0,className:"w-full mt-auto py-2 px-3 rounded-lg text-sm font-semibold bg-green-600 text-white cursor-not-allowed",children:"Owned"}):v.jsxs("button",{onClick:()=>_(C),disabled:!q,className:`w-full mt-auto py-2 px-3 rounded-lg font-semibold transition-all flex items-center justify-center gap-2 text-sm ${q?"bg-cyan-500 hover:bg-cyan-400 text-black":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:[v.jsx("span",{children:C.price}),v.jsx("span",{className:"text-yellow-800",children:""})]})]},C.id)})});return v.jsxs("div",{className:"p-4 sm:p-8 h-screen bg-slate-900 text-white relative flex flex-col",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"max-w-6xl mx-auto relative z-10 w-full flex flex-col flex-grow overflow-hidden",children:[v.jsx("header",{className:"flex-shrink-0",children:v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400",children:"Shop"}),v.jsxs("div",{className:"flex items-center gap-2 bg-slate-800 px-3 py-1 rounded-full",children:[v.jsx("span",{className:"text-yellow-400 font-bold text-lg",children:e.coins}),v.jsx("span",{className:"text-yellow-400 text-lg",children:""})]})]}),v.jsx("button",{onClick:n,className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Back"})]})}),v.jsx("div",{className:"flex-shrink-0 mb-8 border-b border-slate-700",children:v.jsx("nav",{className:"flex space-x-1 sm:space-x-2 md:space-x-4 overflow-x-auto pb-px scrollbar-hide",children:["Skins","Avatars","Emojis","Themes","Effects","Victory","Booms"].map(C=>v.jsx("button",{onClick:()=>o(C),className:`py-2 px-3 text-base sm:text-lg font-semibold transition-colors whitespace-nowrap ${s===C?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-white"}`,children:C},C))})}),v.jsx("main",{className:"flex-grow overflow-y-auto pr-2 -mr-2 scrollbar-hide",children:S()})]}),v.jsx(Hu,{isOpen:!!c,onClose:()=>h(null),title:"Confirm Purchase",children:c&&v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Are you sure you want to buy ",v.jsx("strong",{className:"text-white",children:c.name})," for ",v.jsxs("strong",{className:"text-yellow-400",children:[c.price," "]}),"?"]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>{i("select"),h(null)},className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:()=>m(c),className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors animate-confirm-glow",children:"Confirm"})]})]})})]})},s1=({onBack:n})=>{const{gameState:e,equipPiece:t,equipAvatar:i,equipTheme:s,equipEffect:o,equipVictoryEffect:c,equipBoomEffect:h}=fa(),{playSound:d}=gs(),[m,_]=H.useState("Skins"),y={Skins:"piece",Avatars:"avatar",Emojis:"emoji",Themes:"theme",Effects:"effect",Victory:"victory",Booms:"boom"},T=[...uo.map(z=>({id:z.id,name:z.name,type:"piece",price:0,item:z})),...Og.map(z=>({id:z.id,name:z.name,type:"avatar",price:0,item:z})),...Pg.map(z=>({id:z.id,name:z.name,type:"emoji",price:0,item:z})),...kg.map(z=>({id:z.id,name:z.name,type:"theme",price:0,item:z})),...Mg.map(z=>({id:z.id,name:z.name,type:"effect",price:0,item:z})),...Kd.map(z=>({id:z.id,name:z.name,type:"victory",price:0,item:z})),...Qd.map(z=>({id:z.id,name:z.name,type:"boom",price:0,item:z})),{id:Nn.id,name:Nn.name,type:"piece",price:0,item:Nn},{id:ii.id,name:ii.name,type:"avatar",price:0,item:ii},{id:yr.id,name:yr.name,type:"theme",price:0,item:yr},{id:Qi.id,name:Qi.name,type:"effect",price:0,item:Qi},{id:$i.id,name:$i.name,type:"victory",price:0,item:$i},{id:Wi.id,name:Wi.name,type:"boom",price:0,item:Wi}],S=new Map;T.forEach(z=>{S.has(z.id)||S.set(z.id,z)});const C=e.ownedCosmeticIds.map(z=>S.get(z)).filter(z=>z!==void 0),M=Object.keys(e.emojiInventory).map(z=>S.get(z)).filter(z=>z!==void 0&&(e.emojiInventory[z.id]||0)>0),q=[...C,...M],j=Array.from(new Map(q.map(z=>[z.id,z])).values()).filter(z=>z.type===y[m]),W=z=>{switch(z.type){case"piece":{const ae=z.item.component;return v.jsx(ae,{className:"w-16 h-16 text-cyan-300"})}case"avatar":return v.jsx("img",{src:z.item.url,alt:z.name,className:"w-16 h-16 rounded-full object-cover bg-slate-700"});case"emoji":return v.jsx("span",{className:"text-4xl",children:z.item.emoji});case"theme":{const ae=z.item;return v.jsx("div",{className:`w-16 h-16 rounded-md flex items-center justify-center p-2 bg-cover bg-center ${ae.boardBg}`,style:ae.boardBgImage?{backgroundImage:`url(${ae.boardBgImage})`}:{},children:v.jsx("div",{className:`w-10 h-10 rounded ${ae.cellBg} border-2 ${ae.gridColor}`})})}case"effect":{const ae=z.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(ae,{})})}case"victory":{const ae=z.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(ae,{})})}case"boom":{const ae=z.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(ae,{})})}default:return null}},se=()=>j.length>0?v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:j.map(z=>{var k;const ae=z.type==="piece"?e.activePieceX.id===z.id:z.type==="avatar"?e.activeAvatar.id===z.id:z.type==="theme"?e.activeTheme.id===z.id:z.type==="effect"?e.activeEffect.id===z.id:z.type==="victory"?e.activeVictoryEffect.id===z.id:z.type==="boom"?e.activeBoomEffect.id===z.id:!1,N=z.type==="emoji"&&(((k=yo.find(P=>P.id===z.id))==null?void 0:k.price)||0)>0,R=e.emojiInventory[z.id]||0,x=()=>{d("select"),z.type==="piece"?t(z.item):z.type==="avatar"?i(z.item):z.type==="theme"?s(z.item):z.type==="effect"?o(z.item):z.type==="victory"?c(z.item):z.type==="boom"&&h(z.item)};return v.jsxs("div",{className:"relative bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 flex flex-col items-center text-center transition-all duration-300 hover:border-cyan-400 hover:shadow-lg hover:shadow-cyan-500/10",children:[N&&R>0&&v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center border-2 border-slate-800",children:R}),v.jsx("div",{className:"h-24 w-24 mb-3 flex items-center justify-center bg-slate-900/70 rounded-lg p-2",children:W(z)}),v.jsx("h3",{className:"text-md font-semibold text-white mb-2 h-10 flex items-center justify-center",children:z.name}),v.jsx("button",{onClick:x,disabled:ae||z.type==="emoji",className:`w-full mt-auto py-2 px-3 rounded-lg text-sm font-semibold transition-all ${z.type==="emoji"?"bg-slate-600 text-slate-400 cursor-not-allowed":ae?"bg-green-500 text-white cursor-not-allowed":"bg-cyan-500 hover:bg-cyan-400 text-black"}`,children:z.type==="emoji"?"Owned":ae?"Equipped":"Equip"})]},z.id)})}):v.jsxs("div",{className:"text-center py-16",children:[v.jsx("p",{className:"text-slate-400 text-lg",children:"You don't own any items in this category yet."}),v.jsx("p",{className:"text-slate-500",children:"Visit the shop to get some!"})]});return v.jsxs("div",{className:"p-4 sm:p-8 h-screen bg-slate-900 text-white relative flex flex-col",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"max-w-6xl mx-auto relative z-10 w-full flex flex-col flex-grow overflow-hidden",children:[v.jsx("header",{className:"flex-shrink-0",children:v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400",children:"Inventory"}),v.jsx("button",{onClick:n,className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Back"})]})}),v.jsx("div",{className:"flex-shrink-0 mb-8 border-b border-slate-700",children:v.jsx("nav",{className:"flex space-x-1 sm:space-x-2 md:space-x-4 overflow-x-auto pb-px scrollbar-hide",children:["Skins","Avatars","Emojis","Themes","Effects","Victory","Booms"].map(z=>v.jsx("button",{onClick:()=>_(z),className:`py-2 px-3 text-base sm:text-lg font-semibold transition-colors whitespace-nowrap ${m===z?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-white"}`,children:z},z))})}),v.jsx("main",{className:"flex-grow overflow-y-auto pr-2 -mr-2 scrollbar-hide",children:se()})]})]})},S7=()=>{const[n,e]=H.useState(!0),[t,i]=H.useState(""),[s,o]=H.useState(""),[c,h]=H.useState(""),[d,m]=H.useState(null),[_,y]=H.useState(!1),{playSound:T}=gs(),S=async M=>{M.preventDefault(),y(!0),m(null),T("select");try{if(n)await fR(qd,t,s);else{if(c.length<3||c.length>15)throw new Error("Username must be between 3 and 15 characters.");const q=await dR(qd,t,s);await Kg(q.user,{displayName:c}),await jk(q.user,c)}}catch(q){m(q.message||"An unknown error occurred.")}finally{y(!1)}},C=async()=>{y(!0),m(null),T("confirm");try{await rR(qd)}catch(M){m(M.message||"Could not sign in as guest.")}finally{y(!1)}};return v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex flex-col items-center justify-center relative",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-md bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-2xl p-8 z-10 animate-fade-in-up",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400 text-center mb-2",children:"Caro AI Arena"}),v.jsx("p",{className:"text-slate-400 text-center mb-8",children:n?"Log in to continue":"Create an account"}),v.jsxs("form",{onSubmit:S,className:"space-y-6",children:[!n&&v.jsx("input",{type:"text",placeholder:"Username",value:c,onChange:M=>h(M.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0}),v.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:M=>i(M.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0}),v.jsx("input",{type:"password",placeholder:"Password",value:s,onChange:M=>o(M.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0}),d&&v.jsx("p",{className:"text-red-500 text-sm",children:d}),v.jsx("button",{type:"submit",disabled:_,className:"w-full bg-cyan-500 hover:bg-cyan-400 text-black font-bold py-3 rounded-lg transition-all disabled:bg-slate-600",children:_?"Processing...":n?"Log In":"Sign Up"})]}),v.jsx("div",{className:"text-center mt-6",children:v.jsx("button",{onClick:()=>{T("select"),e(!n),m(null)},className:"text-cyan-400 hover:underline",children:n?"Need an account? Sign Up":"Already have an account? Log In"})}),v.jsxs("div",{className:"flex items-center my-8",children:[v.jsx("hr",{className:"flex-grow border-slate-600"}),v.jsx("span",{className:"px-4 text-slate-400",children:"OR"}),v.jsx("hr",{className:"flex-grow border-slate-600"})]}),v.jsx("button",{onClick:C,disabled:_,className:"w-full bg-slate-600 hover:bg-slate-500 text-white font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:"Continue as Guest"})]}),v.jsx("style",{children:`
            @keyframes fade-in-up {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in-up { animation: fade-in-up 0.8s ease-out forwards; }
        `})]})},a1=({player:n,align:e})=>{const t=e==="left"?"animate-slide-in-left":"animate-slide-in-right";return v.jsxs("div",{className:`flex flex-col items-center ${t}`,children:[v.jsx("img",{src:n.avatarUrl,alt:n.name,className:"w-32 h-32 rounded-full border-4 border-slate-600 bg-slate-800 object-cover mb-4"}),v.jsx("h3",{className:"text-2xl font-bold text-white",children:n.name}),v.jsxs("p",{className:"text-cyan-400",children:["Level ",n.level]})]})},A7=({game:n,currentUserId:e,onGameStart:t})=>{H.useEffect(()=>{const c=setTimeout(()=>{t()},1500);return()=>clearTimeout(c)},[t]);const i=n.players.X===e?n.players.O:n.players.X,s=n.playerDetails[e],o=n.playerDetails[i];return!s||!o?v.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:v.jsx("p",{children:"Loading player details..."})}):v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex flex-col items-center justify-center relative overflow-hidden",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%2D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-2xl flex items-center justify-around z-10",children:[v.jsx(a1,{player:s,align:"left"}),v.jsx("div",{className:"animate-zoom-in-out",children:v.jsx("h2",{className:"text-6xl font-black text-red-500",style:{textShadow:"0 0 15px #ef4444"},children:"VS"})}),v.jsx(a1,{player:o,align:"right"})]}),v.jsx("p",{className:"absolute bottom-10 text-slate-400 animate-pulse",children:"Match Starting..."}),v.jsx("style",{children:`
                @keyframes slide-in-left {
                    from { transform: translateX(-100vw); }
                    to { transform: translateX(0); }
                }
                .animate-slide-in-left { animation: slide-in-left 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
                
                @keyframes slide-in-right {
                    from { transform: translateX(100vw); }
                    to { transform: translateX(0); }
                }
                .animate-slide-in-right { animation: slide-in-right 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards; }

                @keyframes zoom-in-out {
                    0% { transform: scale(0.5); opacity: 0; }
                    50% { transform: scale(1.2); opacity: 1; }
                    100% { transform: scale(1); opacity: 1; }
                }
                .animate-zoom-in-out { animation: zoom-in-out 1.2s ease-out forwards; animation-delay: 0.2s; }
            `})]})},x7=({onCancel:n})=>{const[e,t]=H.useState(30),i=H.useRef(null);H.useEffect(()=>{let d;const m=_=>{i.current===null&&(i.current=_);const y=_-i.current,T=Math.max(0,30-y/1e3);t(T),T>0?d=requestAnimationFrame(m):n()};return d=requestAnimationFrame(m),()=>cancelAnimationFrame(d)},[n]);const s=Math.ceil(e),c=2*Math.PI*60,h=c-e/30*c;return v.jsxs("div",{className:"fixed inset-0 bg-slate-900/90 flex flex-col items-center justify-center z-50 backdrop-blur-sm animate-fade-in",children:[v.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[v.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 140 140",children:[v.jsxs("defs",{children:[v.jsxs("linearGradient",{id:"goldGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[v.jsx("stop",{offset:"0%",stopColor:"#FBBF24"}),v.jsx("stop",{offset:"100%",stopColor:"#F59E0B"})]}),v.jsxs("linearGradient",{id:"blueGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[v.jsx("stop",{offset:"0%",stopColor:"#38bdf8"}),v.jsx("stop",{offset:"100%",stopColor:"#0ea5e9"})]}),v.jsxs("filter",{id:"glow",children:[v.jsx("feGaussianBlur",{stdDeviation:"3.5",result:"coloredBlur"}),v.jsxs("feMerge",{children:[v.jsx("feMergeNode",{in:"coloredBlur"}),v.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),v.jsx("circle",{cx:"70",cy:"70",r:"68",stroke:"url(#goldGradient)",strokeWidth:"2",fill:"transparent"}),v.jsx("circle",{cx:"70",cy:"70",r:"60",stroke:"rgba(0,0,0,0.5)",strokeWidth:"8",fill:"transparent"}),v.jsx("circle",{cx:"70",cy:"70",r:60,stroke:"url(#blueGradient)",strokeWidth:"8",fill:"transparent",strokeLinecap:"round",strokeDasharray:c,strokeDashoffset:h,className:"transform -rotate-90 origin-center",style:{filter:"url(#glow)"}})]}),v.jsx("div",{className:"absolute flex flex-col items-center justify-center text-white",children:v.jsx("span",{className:"text-5xl font-bold tracking-tighter",style:{textShadow:"0 0 10px rgba(255,255,255,0.5)"},children:s})})]}),v.jsx("h2",{className:"text-3xl font-bold text-white mt-8",style:{textShadow:"0 0 15px rgba(56, 189, 248, 0.5)"},children:"Finding Opponent"}),v.jsx("button",{onClick:n,className:"mt-8 bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.3s ease-out; }
      `})]})},C7=({onStartGame:n,onBack:e})=>{const{user:t,logOut:i}=dh(),{gameState:s}=fa(),[o,c]=H.useState([]),[h,d]=H.useState(!1),[m,_]=H.useState(null),[y,T]=H.useState({}),[S,C]=H.useState(!1),{playSound:M}=gs(),q=async x=>{d(!1);const k=await Y8(x);k?(_(k),M("confirm")):t&&qk(t.uid)};H.useEffect(()=>{if(!t)return;Fk(t.uid).then(P=>{(P==null?void 0:P.status)==="in_queue"&&d(!0)});const x=z8(P=>{c(P.filter(U=>U.uid!==t.uid))}),k=zk(t.uid,P=>{P&&q(P)});return()=>{x(),k()}},[t]);const F=x=>{t&&(M("select"),H8(t,x.uid),T(k=>({...k,[x.uid]:"invited"})),setTimeout(()=>{T(k=>{const P={...k};return delete P[x.uid],P})},11e3))},j=async()=>{if(!t)return;d(!0),M("select");const x=await q8(t);x&&q(x)},W=()=>{t&&(M("select"),G8(t.uid),d(!1))},{onlineWins:se,onlineLosses:z,onlineDraws:ae}=s,N=se+z+ae,R=N>0?(se/N*100).toFixed(2):"0.00";return m&&t?v.jsx(A7,{game:m,currentUserId:t.uid,onGameStart:()=>n(m.id)}):v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 sm:p-6 flex flex-col items-center justify-center relative",children:[h&&v.jsx(x7,{onCancel:W}),v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%2D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-4xl text-center z-10",children:[v.jsxs("header",{className:"flex justify-between items-center mb-6",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400",children:"Online Lobby"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:e,className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Menu"}),v.jsx("button",{onClick:()=>{M("select"),C(!0)},className:"bg-slate-700/80 p-2 rounded-full hover:bg-slate-600 transition-colors","aria-label":"Settings",children:v.jsxs("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066 2.573c-.94-1.543.826 3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"md:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-4 h-[60vh] flex flex-col",children:[v.jsxs("h2",{className:"text-xl font-semibold text-white mb-4 text-left",children:["Players Online (",o.length,")"]}),v.jsx("div",{className:"flex-grow overflow-y-auto pr-2 scrollbar-hide",children:o.length>0?o.map(x=>{const k=y[x.uid];return v.jsxs("div",{className:"flex items-center justify-between bg-slate-900/50 p-3 rounded-lg mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:x.avatarUrl,alt:x.name,className:"w-10 h-10 rounded-full object-cover bg-slate-700"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-semibold text-white text-left",children:x.name}),v.jsxs("p",{className:"text-slate-400 text-sm text-left",children:["Level ",x.level]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:`text-sm font-semibold ${x.status==="idle"?"text-green-400":"text-yellow-400"}`,children:x.status.replace("_"," ")}),v.jsx("button",{onClick:()=>F(x),disabled:x.status!=="idle"||!!k,className:`text-xs text-white font-bold px-3 py-1 rounded-full mt-1 transition-colors ${k?"bg-slate-600 cursor-not-allowed":"bg-blue-500 hover:bg-blue-400"}`,children:k?"Invited":"Invite"})]})]},x.uid)}):v.jsx("p",{className:"text-slate-500 text-center pt-16",children:"No other players online right now."})})]}),v.jsxs("div",{className:"md:col-span-1 flex flex-col gap-6",children:[v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4",children:[v.jsx("h3",{className:"font-semibold text-white text-lg mb-3",children:"Your Stats (Online)"}),v.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[v.jsxs("div",{className:"p-1",children:[v.jsx("p",{className:"text-green-400 font-bold text-xl",children:se}),v.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider",children:"Wins"})]}),v.jsxs("div",{className:"p-1",children:[v.jsx("p",{className:"text-red-400 font-bold text-xl",children:z}),v.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider",children:"Losses"})]}),v.jsxs("div",{className:"p-1",children:[v.jsxs("p",{className:"text-cyan-400 font-bold text-xl",children:[R,"%"]}),v.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider",children:"Win Rate"})]})]})]}),v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 flex flex-col justify-center items-center flex-grow",children:[v.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Matchmaking"}),v.jsx("p",{className:"text-slate-400 mb-6",children:"Find a random opponent and jump right into a game."}),v.jsx("button",{onClick:j,className:"w-full bg-green-500 hover:bg-green-400 text-black font-bold py-3 px-4 rounded-lg transition-all text-lg mt-auto",children:"Find Match"})]})]})]})]}),v.jsx(Fb,{isOpen:S,onClose:()=>C(!1),onLogOut:i})]})},Ed="caroActivePveGame_bot",R7=()=>v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex flex-col items-center justify-center text-center",children:[v.jsxs("h1",{className:"text-6xl md:text-8xl font-black text-white mb-2",children:["Caro ",v.jsx("span",{className:"text-cyan-400",children:"AI Arena"})]}),v.jsx("p",{className:"text-slate-400 text-xl mt-4",children:"Loading..."})]}),N7=()=>{const{user:n,logOut:e}=dh(),[t,i]=H.useState(()=>localStorage.getItem(Ed)?"pve_game":"menu"),[s,o]=H.useState(()=>{try{const pe=localStorage.getItem(Ed);return pe?JSON.parse(pe):null}catch{return localStorage.removeItem(Ed),null}}),[c,h]=H.useState(null),[d,m]=H.useState(null),{gameState:_}=fa(),{playSound:y,playMusic:T,stopMusic:S}=gs(),[C,M]=H.useState(null),[q,F]=H.useState(10),j=1440*60*1e3,W=H.useRef(null),se=H.useCallback(()=>{n&&(console.log("User has been idle for 24 hours. Logging out."),e())},[n,e]),z=H.useCallback(()=>{W.current&&clearTimeout(W.current),W.current=setTimeout(se,j)},[se]);H.useEffect(()=>{if(!n){W.current&&clearTimeout(W.current);return}const pe=["mousemove","keydown","click","scroll","touchstart"];return z(),pe.forEach(Ee=>{window.addEventListener(Ee,z)}),()=>{W.current&&clearTimeout(W.current),pe.forEach(Ee=>{window.removeEventListener(Ee,z)})}},[z,n]),H.useEffect(()=>{n&&Fk(n.uid).then(pe=>{(pe==null?void 0:pe.status)==="in_game"&&pe.gameId&&(console.log(`Rejoining active game: ${pe.gameId}`),D(pe.gameId))})},[n]),H.useEffect(()=>{t==="menu"||t==="pve_game"||t==="lobby"||t==="online_game"?T():S()},[t,T,S]),H.useEffect(()=>{if(!n)return;const pe=zk(n.uid,Ee=>{Ee&&Ee!==c&&(console.log(`Detected game change to ${Ee}. Switching...`),D(Ee))});return()=>pe()},[n,c]),H.useEffect(()=>{if(!n)return;const pe=K8(n.uid,Ee=>{Ee&&y("select"),M(Ee)});return()=>pe()},[n,y]);const ae=H.useCallback(()=>{n&&(y("select"),$8(n.uid),M(null))},[n,y]);H.useEffect(()=>{if(C){F(10);const pe=setInterval(()=>{F(Ee=>Ee<=1?(clearInterval(pe),ae(),0):Ee-1)},1e3);return()=>clearInterval(pe)}},[C,ae]);const N=async()=>{!n||!C||(await Q8(n,C),M(null))},R=H.useCallback(pe=>{try{y("select"),localStorage.setItem(Ed,JSON.stringify(pe)),o(pe),i("pve_game")}catch(Ee){console.error("Failed to save active bot:",Ee)}},[y]),x=H.useCallback(()=>{y("select"),i("shop")},[y]),k=H.useCallback(()=>{y("select"),i("inventory")},[y]),P=H.useCallback(()=>{y("select"),i("menu"),o(null),m(null),h(null),localStorage.removeItem(Ed),localStorage.removeItem("caroGameState_inProgress")},[y]),U=()=>{y("select"),i("lobby")},D=pe=>{h(pe),i("online_game")},pt=()=>{y("select"),m("shop")},ct=()=>{y("select"),m("inventory")},Z=()=>{y("select"),m(null)},fe=H.useCallback(()=>{t==="online_game"?(i("lobby"),h(null)):P()},[t,P]),he=()=>{switch(t){case"lobby":return v.jsx(C7,{onStartGame:D,onBack:P});case"online_game":return!c||!n?(i("lobby"),null):v.jsx(i1,{gameMode:"online",onlineGameId:c,onExit:fe,theme:_.activeTheme,pieces:{X:_.activePieceX,O:_.activePieceO},playerInfo:{name:_.playerName,level:_.playerLevel,avatar:_.activeAvatar,xp:_.playerXp,wins:_.onlineWins,losses:_.onlineLosses},activeEffect:_.activeEffect,activeVictoryEffect:_.activeVictoryEffect,activeBoomEffect:_.activeBoomEffect,isPaused:!!d,onOpenShop:pt,onOpenInventory:ct},c);case"pve_game":return s?v.jsx(i1,{gameMode:"pve",bot:s,onExit:fe,theme:_.activeTheme,pieces:{X:_.activePieceX,O:_.activePieceO},playerInfo:{name:_.playerName,level:_.playerLevel,avatar:_.activeAvatar,xp:_.playerXp,wins:_.pveWins,losses:_.pveLosses},activeEffect:_.activeEffect,activeVictoryEffect:_.activeVictoryEffect,activeBoomEffect:_.activeBoomEffect,isPaused:!!d,onOpenShop:pt,onOpenInventory:ct},s.id):(P(),null);case"shop":return v.jsx(r1,{onBack:P});case"inventory":return v.jsx(s1,{onBack:P});case"menu":default:return v.jsx(c7,{onStartGame:R,onGoToShop:x,onGoToInventory:k,onGoToOnline:U})}};return v.jsxs("div",{className:"bg-slate-900 relative animate-app-fade-in",children:[he(),d&&v.jsxs("div",{className:"fixed inset-0 z-50 bg-black/70 p-4 sm:p-8 overflow-y-auto",children:[d==="shop"&&v.jsx(r1,{onBack:Z}),d==="inventory"&&v.jsx(s1,{onBack:Z})]}),v.jsx(Hu,{isOpen:!!C,title:"Incoming Challenge!",children:C&&v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:[v.jsx("strong",{className:"text-white",children:C.fromName})," has challenged you to a match! ",v.jsxs("span",{className:"text-slate-400",children:["(",q,"s)"]})]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:ae,className:"bg-red-600 hover:bg-red-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Decline"}),v.jsx("button",{onClick:N,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Accept"})]})]})}),v.jsx("style",{children:`
                @keyframes app-fade-in {
                    from { opacity: 0; transform: scale(0.97); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-app-fade-in { animation: app-fade-in 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
            `})]})},D7=()=>{const{user:n,loading:e}=dh();return e?v.jsx(R7,{}):n?v.jsx(N7,{}):v.jsx(S7,{})};function k7(){return v.jsx(i7,{children:v.jsx(r7,{children:v.jsx(D7,{})})})}const Xk=document.getElementById("root");if(!Xk)throw new Error("Could not find root element to mount to");const O7=MP.createRoot(Xk);O7.render(v.jsx(Ci.StrictMode,{children:v.jsx(k7,{})}));
