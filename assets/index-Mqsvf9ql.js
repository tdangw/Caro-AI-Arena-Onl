(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function u1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Bv={exports:{}},od={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lA;function RP(){if(lA)return od;lA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,o){var c=null;if(o!==void 0&&(c=""+o),r.key!==void 0&&(c=""+r.key),"key"in r){o={};for(var h in r)h!=="key"&&(o[h]=r[h])}else o=r;return r=o.ref,{$$typeof:n,type:i,key:c,ref:r!==void 0?r:null,props:o}}return od.Fragment=e,od.jsx=t,od.jsxs=t,od}var cA;function NP(){return cA||(cA=1,Bv.exports=RP()),Bv.exports}var v=NP(),zv={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uA;function DP(){if(uA)return Pe;uA=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function I(O){return O===null||typeof O!="object"?null:(O=b&&O[b]||O["@@iterator"],typeof O=="function"?O:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,z={};function B(O,H,re){this.props=O,this.context=H,this.refs=z,this.updater=re||C}B.prototype.isReactComponent={},B.prototype.setState=function(O,H){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,H,"setState")},B.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function j(){}j.prototype=B.prototype;function X(O,H,re){this.props=O,this.context=H,this.refs=z,this.updater=re||C}var fe=X.prototype=new j;fe.constructor=X,M(fe,B.prototype),fe.isPureReactComponent=!0;var F=Array.isArray;function ae(){}var D={H:null,A:null,T:null,S:null},x=Object.prototype.hasOwnProperty;function R(O,H,re){var _e=re.ref;return{$$typeof:n,type:O,key:H,ref:_e!==void 0?_e:null,props:re}}function V(O,H){return R(O.type,H,O.props)}function L(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function P(O){var H={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(re){return H[re]})}var N=/\/+/g;function Ve(O,H){return typeof O=="object"&&O!==null&&O.key!=null?P(""+O.key):H.toString(36)}function et(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(ae,ae):(O.status="pending",O.then(function(H){O.status==="pending"&&(O.status="fulfilled",O.value=H)},function(H){O.status==="pending"&&(O.status="rejected",O.reason=H)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function te(O,H,re,_e,Te){var ke=typeof O;(ke==="undefined"||ke==="boolean")&&(O=null);var Oe=!1;if(O===null)Oe=!0;else switch(ke){case"bigint":case"string":case"number":Oe=!0;break;case"object":switch(O.$$typeof){case n:case e:Oe=!0;break;case _:return Oe=O._init,te(Oe(O._payload),H,re,_e,Te)}}if(Oe)return Te=Te(O),Oe=_e===""?"."+Ve(O,0):_e,F(Te)?(re="",Oe!=null&&(re=Oe.replace(N,"$&/")+"/"),te(Te,H,re,"",function(Gn){return Gn})):Te!=null&&(L(Te)&&(Te=V(Te,re+(Te.key==null||O&&O.key===Te.key?"":(""+Te.key).replace(N,"$&/")+"/")+Oe)),H.push(Te)),1;Oe=0;var dt=_e===""?".":_e+":";if(F(O))for(var xt=0;xt<O.length;xt++)_e=O[xt],ke=dt+Ve(_e,xt),Oe+=te(_e,H,re,ke,Te);else if(xt=I(O),typeof xt=="function")for(O=xt.call(O),xt=0;!(_e=O.next()).done;)_e=_e.value,ke=dt+Ve(_e,xt++),Oe+=te(_e,H,re,ke,Te);else if(ke==="object"){if(typeof O.then=="function")return te(et(O),H,re,_e,Te);throw H=String(O),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return Oe}function de(O,H,re){if(O==null)return O;var _e=[],Te=0;return te(O,_e,"","",function(ke){return H.call(re,ke,Te++)}),_e}function ce(O){if(O._status===-1){var H=O._result;H=H(),H.then(function(re){(O._status===0||O._status===-1)&&(O._status=1,O._result=re)},function(re){(O._status===0||O._status===-1)&&(O._status=2,O._result=re)}),O._status===-1&&(O._status=0,O._result=H)}if(O._status===1)return O._result.default;throw O._result}var Se=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},Re={map:de,forEach:function(O,H,re){de(O,function(){H.apply(this,arguments)},re)},count:function(O){var H=0;return de(O,function(){H++}),H},toArray:function(O){return de(O,function(H){return H})||[]},only:function(O){if(!L(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Pe.Activity=y,Pe.Children=Re,Pe.Component=B,Pe.Fragment=t,Pe.Profiler=r,Pe.PureComponent=X,Pe.StrictMode=i,Pe.Suspense=d,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(O){return D.H.useMemoCache(O)}},Pe.cache=function(O){return function(){return O.apply(null,arguments)}},Pe.cacheSignal=function(){return null},Pe.cloneElement=function(O,H,re){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var _e=M({},O.props),Te=O.key;if(H!=null)for(ke in H.key!==void 0&&(Te=""+H.key),H)!x.call(H,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&H.ref===void 0||(_e[ke]=H[ke]);var ke=arguments.length-2;if(ke===1)_e.children=re;else if(1<ke){for(var Oe=Array(ke),dt=0;dt<ke;dt++)Oe[dt]=arguments[dt+2];_e.children=Oe}return R(O.type,Te,_e)},Pe.createContext=function(O){return O={$$typeof:c,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:o,_context:O},O},Pe.createElement=function(O,H,re){var _e,Te={},ke=null;if(H!=null)for(_e in H.key!==void 0&&(ke=""+H.key),H)x.call(H,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(Te[_e]=H[_e]);var Oe=arguments.length-2;if(Oe===1)Te.children=re;else if(1<Oe){for(var dt=Array(Oe),xt=0;xt<Oe;xt++)dt[xt]=arguments[xt+2];Te.children=dt}if(O&&O.defaultProps)for(_e in Oe=O.defaultProps,Oe)Te[_e]===void 0&&(Te[_e]=Oe[_e]);return R(O,ke,Te)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(O){return{$$typeof:h,render:O}},Pe.isValidElement=L,Pe.lazy=function(O){return{$$typeof:_,_payload:{_status:-1,_result:O},_init:ce}},Pe.memo=function(O,H){return{$$typeof:m,type:O,compare:H===void 0?null:H}},Pe.startTransition=function(O){var H=D.T,re={};D.T=re;try{var _e=O(),Te=D.S;Te!==null&&Te(re,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(ae,Se)}catch(ke){Se(ke)}finally{H!==null&&re.types!==null&&(H.types=re.types),D.T=H}},Pe.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Pe.use=function(O){return D.H.use(O)},Pe.useActionState=function(O,H,re){return D.H.useActionState(O,H,re)},Pe.useCallback=function(O,H){return D.H.useCallback(O,H)},Pe.useContext=function(O){return D.H.useContext(O)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(O,H){return D.H.useDeferredValue(O,H)},Pe.useEffect=function(O,H){return D.H.useEffect(O,H)},Pe.useEffectEvent=function(O){return D.H.useEffectEvent(O)},Pe.useId=function(){return D.H.useId()},Pe.useImperativeHandle=function(O,H,re){return D.H.useImperativeHandle(O,H,re)},Pe.useInsertionEffect=function(O,H){return D.H.useInsertionEffect(O,H)},Pe.useLayoutEffect=function(O,H){return D.H.useLayoutEffect(O,H)},Pe.useMemo=function(O,H){return D.H.useMemo(O,H)},Pe.useOptimistic=function(O,H){return D.H.useOptimistic(O,H)},Pe.useReducer=function(O,H,re){return D.H.useReducer(O,H,re)},Pe.useRef=function(O){return D.H.useRef(O)},Pe.useState=function(O){return D.H.useState(O)},Pe.useSyncExternalStore=function(O,H,re){return D.H.useSyncExternalStore(O,H,re)},Pe.useTransition=function(){return D.H.useTransition()},Pe.version="19.2.0",Pe}var hA;function Nw(){return hA||(hA=1,zv.exports=DP()),zv.exports}var K=Nw();const Di=u1(K);var qv={exports:{}},ld={},Gv={exports:{}},Hv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dA;function kP(){return dA||(dA=1,(function(n){function e(te,de){var ce=te.length;te.push(de);e:for(;0<ce;){var Se=ce-1>>>1,Re=te[Se];if(0<r(Re,de))te[Se]=de,te[ce]=Re,ce=Se;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var de=te[0],ce=te.pop();if(ce!==de){te[0]=ce;e:for(var Se=0,Re=te.length,O=Re>>>1;Se<O;){var H=2*(Se+1)-1,re=te[H],_e=H+1,Te=te[_e];if(0>r(re,ce))_e<Re&&0>r(Te,re)?(te[Se]=Te,te[_e]=ce,Se=_e):(te[Se]=re,te[H]=ce,Se=H);else if(_e<Re&&0>r(Te,ce))te[Se]=Te,te[_e]=ce,Se=_e;else break e}}return de}function r(te,de){var ce=te.sortIndex-de.sortIndex;return ce!==0?ce:te.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var d=[],m=[],_=1,y=null,b=3,I=!1,C=!1,M=!1,z=!1,B=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function fe(te){for(var de=t(m);de!==null;){if(de.callback===null)i(m);else if(de.startTime<=te)i(m),de.sortIndex=de.expirationTime,e(d,de);else break;de=t(m)}}function F(te){if(M=!1,fe(te),!C)if(t(d)!==null)C=!0,ae||(ae=!0,P());else{var de=t(m);de!==null&&et(F,de.startTime-te)}}var ae=!1,D=-1,x=5,R=-1;function V(){return z?!0:!(n.unstable_now()-R<x)}function L(){if(z=!1,ae){var te=n.unstable_now();R=te;var de=!0;try{e:{C=!1,M&&(M=!1,j(D),D=-1),I=!0;var ce=b;try{t:{for(fe(te),y=t(d);y!==null&&!(y.expirationTime>te&&V());){var Se=y.callback;if(typeof Se=="function"){y.callback=null,b=y.priorityLevel;var Re=Se(y.expirationTime<=te);if(te=n.unstable_now(),typeof Re=="function"){y.callback=Re,fe(te),de=!0;break t}y===t(d)&&i(d),fe(te)}else i(d);y=t(d)}if(y!==null)de=!0;else{var O=t(m);O!==null&&et(F,O.startTime-te),de=!1}}break e}finally{y=null,b=ce,I=!1}de=void 0}}finally{de?P():ae=!1}}}var P;if(typeof X=="function")P=function(){X(L)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,Ve=N.port2;N.port1.onmessage=L,P=function(){Ve.postMessage(null)}}else P=function(){B(L,0)};function et(te,de){D=B(function(){te(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(te){switch(b){case 1:case 2:case 3:var de=3;break;default:de=b}var ce=b;b=de;try{return te()}finally{b=ce}},n.unstable_requestPaint=function(){z=!0},n.unstable_runWithPriority=function(te,de){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ce=b;b=te;try{return de()}finally{b=ce}},n.unstable_scheduleCallback=function(te,de,ce){var Se=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Se+ce:Se):ce=Se,te){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=ce+Re,te={id:_++,callback:de,priorityLevel:te,startTime:ce,expirationTime:Re,sortIndex:-1},ce>Se?(te.sortIndex=ce,e(m,te),t(d)===null&&te===t(m)&&(M?(j(D),D=-1):M=!0,et(F,ce-Se))):(te.sortIndex=Re,e(d,te),C||I||(C=!0,ae||(ae=!0,P()))),te},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(te){var de=b;return function(){var ce=b;b=de;try{return te.apply(this,arguments)}finally{b=ce}}}})(Hv)),Hv}var fA;function OP(){return fA||(fA=1,Gv.exports=kP()),Gv.exports}var Kv={exports:{}},$n={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mA;function PP(){if(mA)return $n;mA=1;var n=Nw();function e(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(d,m,_){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:y==null?null:""+y,children:d,containerInfo:m,implementation:_}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,m){if(d==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return $n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,$n.createPortal=function(d,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(d,m,null,_)},$n.flushSync=function(d){var m=c.T,_=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=m,i.p=_,i.d.f()}},$n.preconnect=function(d,m){typeof d=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(d,m))},$n.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},$n.preinit=function(d,m){if(typeof d=="string"&&m&&typeof m.as=="string"){var _=m.as,y=h(_,m.crossOrigin),b=typeof m.integrity=="string"?m.integrity:void 0,I=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(d,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:I}):_==="script"&&i.d.X(d,{crossOrigin:y,integrity:b,fetchPriority:I,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},$n.preinitModule=function(d,m){if(typeof d=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=h(m.as,m.crossOrigin);i.d.M(d,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(d)},$n.preload=function(d,m){if(typeof d=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,y=h(_,m.crossOrigin);i.d.L(d,_,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},$n.preloadModule=function(d,m){if(typeof d=="string")if(m){var _=h(m.as,m.crossOrigin);i.d.m(d,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(d)},$n.requestFormReset=function(d){i.d.r(d)},$n.unstable_batchedUpdates=function(d,m){return d(m)},$n.useFormState=function(d,m,_){return c.H.useFormState(d,m,_)},$n.useFormStatus=function(){return c.H.useHostTransitionStatus()},$n.version="19.2.0",$n}var pA;function MP(){if(pA)return Kv.exports;pA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Kv.exports=PP(),Kv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gA;function VP(){if(gA)return ld;gA=1;var n=OP(),e=Nw(),t=MP();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var a=s,l=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(l=a.return),s=a.return;while(s)}return a.tag===3?l:null}function c(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function h(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(i(188))}function m(s){var a=s.alternate;if(!a){if(a=o(s),a===null)throw Error(i(188));return a!==s?null:s}for(var l=s,u=a;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(u=p.return,u!==null){l=u;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return d(p),s;if(g===u)return d(p),a;g=g.sibling}throw Error(i(188))}if(l.return!==u.return)l=p,u=g;else{for(var E=!1,S=p.child;S;){if(S===l){E=!0,l=p,u=g;break}if(S===u){E=!0,u=p,l=g;break}S=S.sibling}if(!E){for(S=g.child;S;){if(S===l){E=!0,l=g,u=p;break}if(S===u){E=!0,u=g,l=p;break}S=S.sibling}if(!E)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:a}function _(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=_(s),a!==null)return a;s=s.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),X=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function P(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var N=Symbol.for("react.client.reference");function Ve(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===N?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case M:return"Fragment";case B:return"Profiler";case z:return"StrictMode";case F:return"Suspense";case ae:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case C:return"Portal";case X:return s.displayName||"Context";case j:return(s._context.displayName||"Context")+".Consumer";case fe:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case D:return a=s.displayName||null,a!==null?a:Ve(s.type)||"Memo";case x:a=s._payload,s=s._init;try{return Ve(s(a))}catch{}}return null}var et=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},Se=[],Re=-1;function O(s){return{current:s}}function H(s){0>Re||(s.current=Se[Re],Se[Re]=null,Re--)}function re(s,a){Re++,Se[Re]=s.current,s.current=a}var _e=O(null),Te=O(null),ke=O(null),Oe=O(null);function dt(s,a){switch(re(ke,a),re(Te,s),re(_e,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?DS(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=DS(a),s=kS(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}H(_e),re(_e,s)}function xt(){H(_e),H(Te),H(ke)}function Gn(s){s.memoizedState!==null&&re(Oe,s);var a=_e.current,l=kS(a,s.type);a!==l&&(re(Te,s),re(_e,l))}function Oi(s){Te.current===s&&(H(_e),H(Te)),Oe.current===s&&(H(Oe),id._currentValue=ce)}var zs,qs;function Yn(s){if(zs===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);zs=a&&a[1]||"",qs=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zs+s+qs}var Sr=!1;function Ar(s,a){if(!s||Sr)return"";Sr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(J){var Y=J}Reflect.construct(s,[],se)}else{try{se.call()}catch(J){Y=J}s.call(se.prototype)}}else{try{throw Error()}catch(J){Y=J}(se=s())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(J){if(J&&Y&&typeof J.stack=="string")return[J.stack,Y.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),E=g[0],S=g[1];if(E&&S){var k=E.split(`
`),Q=S.split(`
`);for(p=u=0;u<k.length&&!k[u].includes("DetermineComponentFrameRoot");)u++;for(;p<Q.length&&!Q[p].includes("DetermineComponentFrameRoot");)p++;if(u===k.length||p===Q.length)for(u=k.length-1,p=Q.length-1;1<=u&&0<=p&&k[u]!==Q[p];)p--;for(;1<=u&&0<=p;u--,p--)if(k[u]!==Q[p]){if(u!==1||p!==1)do if(u--,p--,0>p||k[u]!==Q[p]){var ne=`
`+k[u].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=u&&0<=p);break}}}finally{Sr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Yn(l):""}function fh(s,a){switch(s.tag){case 26:case 27:case 5:return Yn(s.type);case 16:return Yn("Lazy");case 13:return s.child!==a&&a!==null?Yn("Suspense Fallback"):Yn("Suspense");case 19:return Yn("SuspenseList");case 0:case 15:return Ar(s.type,!1);case 11:return Ar(s.type.render,!1);case 1:return Ar(s.type,!0);case 31:return Yn("Activity");default:return""}}function xr(s){try{var a="",l=null;do a+=fh(s,l),l=s,s=s.return;while(s);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var As=Object.prototype.hasOwnProperty,is=n.unstable_scheduleCallback,Cr=n.unstable_cancelCallback,va=n.unstable_shouldYield,Rr=n.unstable_requestPaint,qt=n.unstable_now,Pi=n.unstable_getCurrentPriorityLevel,tt=n.unstable_ImmediatePriority,yt=n.unstable_UserBlockingPriority,xs=n.unstable_NormalPriority,Cs=n.unstable_LowPriority,Xn=n.unstable_IdlePriority,Gt=n.log,Nr=n.unstable_setDisableYieldValue,Gs=null,an=null;function De(s){if(typeof Gt=="function"&&Nr(s),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Gs,s)}catch{}}var gn=Math.clz32?Math.clz32:dc,Ko=Math.log,$o=Math.LN2;function dc(s){return s>>>=0,s===0?32:31-(Ko(s)/$o|0)|0}var Hs=256,Jn=262144,Mi=4194304;function di(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function fi(s,a,l){var u=s.pendingLanes;if(u===0)return 0;var p=0,g=s.suspendedLanes,E=s.pingedLanes;s=s.warmLanes;var S=u&134217727;return S!==0?(u=S&~g,u!==0?p=di(u):(E&=S,E!==0?p=di(E):l||(l=S&~s,l!==0&&(p=di(l))))):(S=u&~g,S!==0?p=di(S):E!==0?p=di(E):l||(l=u&~s,l!==0&&(p=di(l)))),p===0?0:a!==0&&a!==p&&(a&g)===0&&(g=p&-p,l=a&-a,g>=l||g===32&&(l&4194048)!==0)?a:p}function Ks(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function wa(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qo(){var s=Mi;return Mi<<=1,(Mi&62914560)===0&&(Mi=4194304),s}function Rs(s){for(var a=[],l=0;31>l;l++)a.push(s);return a}function $s(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function _n(s,a,l,u,p,g){var E=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var S=s.entanglements,k=s.expirationTimes,Q=s.hiddenUpdates;for(l=E&~l;0<l;){var ne=31-gn(l),se=1<<ne;S[ne]=0,k[ne]=-1;var Y=Q[ne];if(Y!==null)for(Q[ne]=null,ne=0;ne<Y.length;ne++){var J=Y[ne];J!==null&&(J.lane&=-536870913)}l&=~se}u!==0&&Wo(s,u,0),g!==0&&p===0&&s.tag!==0&&(s.suspendedLanes|=g&~(E&~a))}function Wo(s,a,l){s.pendingLanes|=a,s.suspendedLanes&=~a;var u=31-gn(a);s.entangledLanes|=a,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function Ns(s,a){var l=s.entangledLanes|=a;for(s=s.entanglements;l;){var u=31-gn(l),p=1<<u;p&a|s[u]&a&&(s[u]|=a),l&=~p}}function Qs(s,a){var l=a&-a;return l=(l&42)!==0?1:Yo(l),(l&(s.suspendedLanes|a))!==0?0:l}function Yo(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ea(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ds(){var s=de.p;return s!==0?s:(s=window.event,s===void 0?32:tA(s.type))}function fc(s,a){var l=de.p;try{return de.p=s,a()}finally{de.p=l}}var Vi=Math.random().toString(36).slice(2),Ct="__reactFiber$"+Vi,on="__reactProps$"+Vi,Le="__reactContainer$"+Vi,Je="__reactEvents$"+Vi,ln="__reactListeners$"+Vi,Ws="__reactHandles$"+Vi,ks="__reactResources$"+Vi,ss="__reactMarker$"+Vi;function rs(s){delete s[Ct],delete s[on],delete s[Je],delete s[ln],delete s[Ws]}function Hn(s){var a=s[Ct];if(a)return a;for(var l=s.parentNode;l;){if(a=l[Le]||l[Ct]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(s=US(s);s!==null;){if(l=s[Ct])return l;s=US(s)}return a}s=l,l=s.parentNode}return null}function mi(s){if(s=s[Ct]||s[Le]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Dr(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function Li(s){var a=s[ks];return a||(a=s[ks]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function en(s){s[ss]=!0}var mc=new Set,ba={};function Zn(s,a){Ys(s,a),Ys(s+"Capture",a)}function Ys(s,a){for(ba[s]=a,s=0;s<a.length;s++)mc.add(a[s])}var z_=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mh={},ph={};function am(s){return As.call(ph,s)?!0:As.call(mh,s)?!1:z_.test(s)?ph[s]=!0:(mh[s]=!0,!1)}function Ta(s,a,l){if(am(a))if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+l)}}function Ia(s,a,l){if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+l)}}function as(s,a,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(a,l,""+u)}}function ei(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function om(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function q_(s,a,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,g=u.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return p.call(this)},set:function(E){l=""+E,g.call(this,E)}}),Object.defineProperty(s,a,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(E){l=""+E},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function pc(s){if(!s._valueTracker){var a=om(s)?"checked":"value";s._valueTracker=q_(s,a,""+s[a])}}function gh(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return s&&(u=om(s)?s.checked?"true":"false":s.value),s=u,s!==l?(a.setValue(s),!0):!1}function gc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var kr=/[\n"\\]/g;function Ht(s){return s.replace(kr,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Sa(s,a,l,u,p,g,E,S){s.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.type=E:s.removeAttribute("type"),a!=null?E==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+ei(a)):s.value!==""+ei(a)&&(s.value=""+ei(a)):E!=="submit"&&E!=="reset"||s.removeAttribute("value"),a!=null?_c(s,E,ei(a)):l!=null?_c(s,E,ei(l)):u!=null&&s.removeAttribute("value"),p==null&&g!=null&&(s.defaultChecked=!!g),p!=null&&(s.checked=p&&typeof p!="function"&&typeof p!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+ei(S):s.removeAttribute("name")}function Xo(s,a,l,u,p,g,E,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),a!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||a!=null)){pc(s);return}l=l!=null?""+ei(l):"",a=a!=null?""+ei(a):l,S||a===s.value||(s.value=a),s.defaultValue=a}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=S?s.checked:!!u,s.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.name=E),pc(s)}function _c(s,a,l){a==="number"&&gc(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ot(s,a,l,u){if(s=s.options,a){a={};for(var p=0;p<l.length;p++)a["$"+l[p]]=!0;for(l=0;l<s.length;l++)p=a.hasOwnProperty("$"+s[l].value),s[l].selected!==p&&(s[l].selected=p),p&&u&&(s[l].defaultSelected=!0)}else{for(l=""+ei(l),a=null,p=0;p<s.length;p++){if(s[p].value===l){s[p].selected=!0,u&&(s[p].defaultSelected=!0);return}a!==null||s[p].disabled||(a=s[p])}a!==null&&(a.selected=!0)}}function Jo(s,a,l){if(a!=null&&(a=""+ei(a),a!==s.value&&(s.value=a),l==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=l!=null?""+ei(l):""}function Aa(s,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(i(92));if(et(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=ei(a),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),pc(s)}function os(s,a){if(a){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=a;return}}s.textContent=a}var G_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _h(s,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":u?s.setProperty(a,l):typeof l!="number"||l===0||G_.has(a)?a==="float"?s.cssFloat=l:s[a]=(""+l).trim():s[a]=l+"px"}function lm(s,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var p in a)u=a[p],a.hasOwnProperty(p)&&l[p]!==u&&_h(s,p,u)}else for(var g in a)a.hasOwnProperty(g)&&_h(s,g,a[g])}function yh(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var H_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),K_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xs(s){return K_.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function bn(){}var yc=null;function vc(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Or=null,ji=null;function cm(s){var a=mi(s);if(a&&(s=a.stateNode)){var l=s[on]||null;e:switch(s=a.stateNode,a.type){case"input":if(Sa(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ht(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==s&&u.form===s.form){var p=u[on]||null;if(!p)throw Error(i(90));Sa(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===s.form&&gh(u)}break e;case"textarea":Jo(s,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&ot(s,!!l.multiple,a,!1)}}}var vh=!1;function um(s,a,l){if(vh)return s(a,l);vh=!0;try{var u=s(a);return u}finally{if(vh=!1,(Or!==null||ji!==null)&&(ap(),Or&&(a=Or,s=ji,ji=Or=null,cm(a),s)))for(a=0;a<s.length;a++)cm(s[a])}}function pi(s,a){var l=s.stateNode;if(l===null)return null;var u=l[on]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Os=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wh=!1;if(Os)try{var Js={};Object.defineProperty(Js,"passive",{get:function(){wh=!0}}),window.addEventListener("test",Js,Js),window.removeEventListener("test",Js,Js)}catch{wh=!1}var Ui=null,wc=null,Zs=null;function xa(){if(Zs)return Zs;var s,a=wc,l=a.length,u,p="value"in Ui?Ui.value:Ui.textContent,g=p.length;for(s=0;s<l&&a[s]===p[s];s++);var E=l-s;for(u=1;u<=E&&a[l-u]===p[g-u];u++);return Zs=p.slice(s,1<u?1-u:void 0)}function Zo(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Ca(){return!0}function Rt(){return!1}function Kn(s){function a(l,u,p,g,E){this._reactName=l,this._targetInst=p,this.type=u,this.nativeEvent=g,this.target=E,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(l=s[S],this[S]=l?l(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ca:Rt,this.isPropagationStopped=Rt,this}return y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ca)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ca)},persist:function(){},isPersistent:Ca}),a}var Pr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=Kn(Pr),Ra=y({},Pr,{view:0,detail:0}),hm=Kn(Ra),Na,Ec,ti,tl=y({},Ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ka,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ti&&(ti&&s.type==="mousemove"?(Na=s.screenX-ti.screenX,Ec=s.screenY-ti.screenY):Ec=Na=0,ti=s),Na)},movementY:function(s){return"movementY"in s?s.movementY:Ec}}),dm=Kn(tl),nl=y({},tl,{dataTransfer:0}),fm=Kn(nl),Eh=y({},Ra,{relatedTarget:0}),Da=Kn(Eh),mm=y({},Pr,{animationName:0,elapsedTime:0,pseudoElement:0}),bc=Kn(mm),$_=y({},Pr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),pm=Kn($_),il=y({},Pr,{data:0}),bh=Kn(il),gm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Th={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ih={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _m(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Ih[s])?!!a[s]:!1}function ka(){return _m}var ym=y({},Ra,{key:function(s){if(s.key){var a=gm[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Zo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Th[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ka,charCode:function(s){return s.type==="keypress"?Zo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Zo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),vm=Kn(ym),Mr=y({},tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sh=Kn(Mr),wm=y({},Ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ka}),Em=Kn(wm),bm=y({},Pr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tc=Kn(bm),ni=y({},tl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Tm=Kn(ni),Im=y({},Pr,{newState:0,oldState:0}),Oa=Kn(Im),f=[9,13,27,32],w=Os&&"CompositionEvent"in window,T=null;Os&&"documentMode"in document&&(T=document.documentMode);var A=Os&&"TextEvent"in window&&!T,G=Os&&(!w||T&&8<T&&11>=T),ee=" ",me=!1;function ft(s,a){switch(s){case"keyup":return f.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cn(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Be=!1;function Tn(s,a){switch(s){case"compositionend":return cn(a);case"keypress":return a.which!==32?null:(me=!0,ee);case"textInput":return s=a.data,s===ee&&me?null:s;default:return null}}function In(s,a){if(Be)return s==="compositionend"||!w&&ft(s,a)?(s=xa(),Zs=wc=Ui=null,Be=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return G&&a.locale!=="ko"?null:a.data;default:return null}}var Pa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gi(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Pa[s.type]:a==="textarea"}function sl(s,a,l,u){Or?ji?ji.push(u):ji=[u]:Or=u,a=fp(a,"onChange"),0<a.length&&(l=new el("onChange","change",null,l,u),s.push({event:l,listeners:a}))}var Vr=null,Ah=null;function nO(s){SS(s,0)}function Sm(s){var a=Dr(s);if(gh(a))return s}function Gb(s,a){if(s==="change")return a}var Hb=!1;if(Os){var Q_;if(Os){var W_="oninput"in document;if(!W_){var Kb=document.createElement("div");Kb.setAttribute("oninput","return;"),W_=typeof Kb.oninput=="function"}Q_=W_}else Q_=!1;Hb=Q_&&(!document.documentMode||9<document.documentMode)}function $b(){Vr&&(Vr.detachEvent("onpropertychange",Qb),Ah=Vr=null)}function Qb(s){if(s.propertyName==="value"&&Sm(Ah)){var a=[];sl(a,Ah,s,vc(s)),um(nO,a)}}function iO(s,a,l){s==="focusin"?($b(),Vr=a,Ah=l,Vr.attachEvent("onpropertychange",Qb)):s==="focusout"&&$b()}function sO(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Sm(Ah)}function rO(s,a){if(s==="click")return Sm(a)}function aO(s,a){if(s==="input"||s==="change")return Sm(a)}function oO(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Fi=typeof Object.is=="function"?Object.is:oO;function xh(s,a){if(Fi(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var l=Object.keys(s),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var p=l[u];if(!As.call(a,p)||!Fi(s[p],a[p]))return!1}return!0}function Wb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Yb(s,a){var l=Wb(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=a&&u>=a)return{node:l,offset:a-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Wb(l)}}function Xb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Xb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function Jb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=gc(s.document);a instanceof s.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)s=a.contentWindow;else break;a=gc(s.document)}return a}function Y_(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var lO=Os&&"documentMode"in document&&11>=document.documentMode,Ic=null,X_=null,Ch=null,J_=!1;function Zb(s,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;J_||Ic==null||Ic!==gc(u)||(u=Ic,"selectionStart"in u&&Y_(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ch&&xh(Ch,u)||(Ch=u,u=fp(X_,"onSelect"),0<u.length&&(a=new el("onSelect","select",null,a,l),s.push({event:a,listeners:u}),a.target=Ic)))}function rl(s,a){var l={};return l[s.toLowerCase()]=a.toLowerCase(),l["Webkit"+s]="webkit"+a,l["Moz"+s]="moz"+a,l}var Sc={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionrun:rl("Transition","TransitionRun"),transitionstart:rl("Transition","TransitionStart"),transitioncancel:rl("Transition","TransitionCancel"),transitionend:rl("Transition","TransitionEnd")},Z_={},eT={};Os&&(eT=document.createElement("div").style,"AnimationEvent"in window||(delete Sc.animationend.animation,delete Sc.animationiteration.animation,delete Sc.animationstart.animation),"TransitionEvent"in window||delete Sc.transitionend.transition);function al(s){if(Z_[s])return Z_[s];if(!Sc[s])return s;var a=Sc[s],l;for(l in a)if(a.hasOwnProperty(l)&&l in eT)return Z_[s]=a[l];return s}var tT=al("animationend"),nT=al("animationiteration"),iT=al("animationstart"),cO=al("transitionrun"),uO=al("transitionstart"),hO=al("transitioncancel"),sT=al("transitionend"),rT=new Map,ey="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ey.push("scrollEnd");function Ps(s,a){rT.set(s,a),Zn(a,[s])}var Am=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ls=[],Ac=0,ty=0;function xm(){for(var s=Ac,a=ty=Ac=0;a<s;){var l=ls[a];ls[a++]=null;var u=ls[a];ls[a++]=null;var p=ls[a];ls[a++]=null;var g=ls[a];if(ls[a++]=null,u!==null&&p!==null){var E=u.pending;E===null?p.next=p:(p.next=E.next,E.next=p),u.pending=p}g!==0&&aT(l,p,g)}}function Cm(s,a,l,u){ls[Ac++]=s,ls[Ac++]=a,ls[Ac++]=l,ls[Ac++]=u,ty|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function ny(s,a,l,u){return Cm(s,a,l,u),Rm(s)}function ol(s,a){return Cm(s,null,null,a),Rm(s)}function aT(s,a,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var p=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(p=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,p&&a!==null&&(p=31-gn(l),s=g.hiddenUpdates,u=s[p],u===null?s[p]=[a]:u.push(a),a.lane=l|536870912),g):null}function Rm(s){if(50<Yh)throw Yh=0,hv=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var xc={};function dO(s,a,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(s,a,l,u){return new dO(s,a,l,u)}function iy(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Lr(s,a){var l=s.alternate;return l===null?(l=Bi(s.tag,a,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=a,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,a=s.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function oT(s,a){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,a=l.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function Nm(s,a,l,u,p,g){var E=0;if(u=s,typeof s=="function")iy(s)&&(E=1);else if(typeof s=="string")E=_P(s,l,_e.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Bi(31,l,a,p),s.elementType=R,s.lanes=g,s;case M:return ll(l.children,p,g,a);case z:E=8,p|=24;break;case B:return s=Bi(12,l,a,p|2),s.elementType=B,s.lanes=g,s;case F:return s=Bi(13,l,a,p),s.elementType=F,s.lanes=g,s;case ae:return s=Bi(19,l,a,p),s.elementType=ae,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case X:E=10;break e;case j:E=9;break e;case fe:E=11;break e;case D:E=14;break e;case x:E=16,u=null;break e}E=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return a=Bi(E,l,a,p),a.elementType=s,a.type=u,a.lanes=g,a}function ll(s,a,l,u){return s=Bi(7,s,u,a),s.lanes=l,s}function sy(s,a,l){return s=Bi(6,s,null,a),s.lanes=l,s}function lT(s){var a=Bi(18,null,null,0);return a.stateNode=s,a}function ry(s,a,l){return a=Bi(4,s.children!==null?s.children:[],s.key,a),a.lanes=l,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var cT=new WeakMap;function cs(s,a){if(typeof s=="object"&&s!==null){var l=cT.get(s);return l!==void 0?l:(a={value:s,source:a,stack:xr(a)},cT.set(s,a),a)}return{value:s,source:a,stack:xr(a)}}var Cc=[],Rc=0,Dm=null,Rh=0,us=[],hs=0,Ma=null,er=1,tr="";function jr(s,a){Cc[Rc++]=Rh,Cc[Rc++]=Dm,Dm=s,Rh=a}function uT(s,a,l){us[hs++]=er,us[hs++]=tr,us[hs++]=Ma,Ma=s;var u=er;s=tr;var p=32-gn(u)-1;u&=~(1<<p),l+=1;var g=32-gn(a)+p;if(30<g){var E=p-p%5;g=(u&(1<<E)-1).toString(32),u>>=E,p-=E,er=1<<32-gn(a)+p|l<<p|u,tr=g+s}else er=1<<g|l<<p|u,tr=s}function ay(s){s.return!==null&&(jr(s,1),uT(s,1,0))}function oy(s){for(;s===Dm;)Dm=Cc[--Rc],Cc[Rc]=null,Rh=Cc[--Rc],Cc[Rc]=null;for(;s===Ma;)Ma=us[--hs],us[hs]=null,tr=us[--hs],us[hs]=null,er=us[--hs],us[hs]=null}function hT(s,a){us[hs++]=er,us[hs++]=tr,us[hs++]=Ma,er=a.id,tr=a.overflow,Ma=s}var Vn=null,Nt=null,Ze=!1,Va=null,ds=!1,ly=Error(i(519));function La(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nh(cs(a,s)),ly}function dT(s){var a=s.stateNode,l=s.type,u=s.memoizedProps;switch(a[Ct]=s,a[on]=u,l){case"dialog":$e("cancel",a),$e("close",a);break;case"iframe":case"object":case"embed":$e("load",a);break;case"video":case"audio":for(l=0;l<Jh.length;l++)$e(Jh[l],a);break;case"source":$e("error",a);break;case"img":case"image":case"link":$e("error",a),$e("load",a);break;case"details":$e("toggle",a);break;case"input":$e("invalid",a),Xo(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":$e("invalid",a);break;case"textarea":$e("invalid",a),Aa(a,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||RS(a.textContent,l)?(u.popover!=null&&($e("beforetoggle",a),$e("toggle",a)),u.onScroll!=null&&$e("scroll",a),u.onScrollEnd!=null&&$e("scrollend",a),u.onClick!=null&&(a.onclick=bn),a=!0):a=!1,a||La(s,!0)}function fT(s){for(Vn=s.return;Vn;)switch(Vn.tag){case 5:case 31:case 13:ds=!1;return;case 27:case 3:ds=!0;return;default:Vn=Vn.return}}function Nc(s){if(s!==Vn)return!1;if(!Ze)return fT(s),Ze=!0,!1;var a=s.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Av(s.type,s.memoizedProps)),l=!l),l&&Nt&&La(s),fT(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Nt=jS(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Nt=jS(s)}else a===27?(a=Nt,Xa(s.type)?(s=Dv,Dv=null,Nt=s):Nt=a):Nt=Vn?ms(s.stateNode.nextSibling):null;return!0}function cl(){Nt=Vn=null,Ze=!1}function cy(){var s=Va;return s!==null&&(wi===null?wi=s:wi.push.apply(wi,s),Va=null),s}function Nh(s){Va===null?Va=[s]:Va.push(s)}var uy=O(null),ul=null,Ur=null;function ja(s,a,l){re(uy,a._currentValue),a._currentValue=l}function Fr(s){s._currentValue=uy.current,H(uy)}function hy(s,a,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),s===l)break;s=s.return}}function dy(s,a,l,u){var p=s.child;for(p!==null&&(p.return=s);p!==null;){var g=p.dependencies;if(g!==null){var E=p.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=p;for(var k=0;k<a.length;k++)if(S.context===a[k]){g.lanes|=l,S=g.alternate,S!==null&&(S.lanes|=l),hy(g.return,l,s),u||(E=null);break e}g=S.next}}else if(p.tag===18){if(E=p.return,E===null)throw Error(i(341));E.lanes|=l,g=E.alternate,g!==null&&(g.lanes|=l),hy(E,l,s),E=null}else E=p.child;if(E!==null)E.return=p;else for(E=p;E!==null;){if(E===s){E=null;break}if(p=E.sibling,p!==null){p.return=E.return,E=p;break}E=E.return}p=E}}function Dc(s,a,l,u){s=null;for(var p=a,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var E=p.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var S=p.type;Fi(p.pendingProps.value,E.value)||(s!==null?s.push(S):s=[S])}}else if(p===Oe.current){if(E=p.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(s!==null?s.push(id):s=[id])}p=p.return}s!==null&&dy(a,s,l,u),a.flags|=262144}function km(s){for(s=s.firstContext;s!==null;){if(!Fi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function hl(s){ul=s,Ur=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ln(s){return mT(ul,s)}function Om(s,a){return ul===null&&hl(s),mT(s,a)}function mT(s,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Ur===null){if(s===null)throw Error(i(308));Ur=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Ur=Ur.next=a;return l}var fO=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){a.aborted=!0,s.forEach(function(l){return l()})}},mO=n.unstable_scheduleCallback,pO=n.unstable_NormalPriority,un={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fy(){return{controller:new fO,data:new Map,refCount:0}}function Dh(s){s.refCount--,s.refCount===0&&mO(pO,function(){s.controller.abort()})}var kh=null,my=0,kc=0,Oc=null;function gO(s,a){if(kh===null){var l=kh=[];my=0,kc=_v(),Oc={status:"pending",value:void 0,then:function(u){l.push(u)}}}return my++,a.then(pT,pT),a}function pT(){if(--my===0&&kh!==null){Oc!==null&&(Oc.status="fulfilled");var s=kh;kh=null,kc=0,Oc=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function _O(s,a){var l=[],u={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return s.then(function(){u.status="fulfilled",u.value=a;for(var p=0;p<l.length;p++)(0,l[p])(a)},function(p){for(u.status="rejected",u.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),u}var gT=te.S;te.S=function(s,a){ZI=qt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&gO(s,a),gT!==null&&gT(s,a)};var dl=O(null);function py(){var s=dl.current;return s!==null?s:Tt.pooledCache}function Pm(s,a){a===null?re(dl,dl.current):re(dl,a.pool)}function _T(){var s=py();return s===null?null:{parent:un._currentValue,pool:s}}var Pc=Error(i(460)),gy=Error(i(474)),Mm=Error(i(542)),Vm={then:function(){}};function yT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function vT(s,a,l){switch(l=s[l],l===void 0?s.push(a):l!==a&&(a.then(bn,bn),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,ET(s),s;default:if(typeof a.status=="string")a.then(bn,bn);else{if(s=Tt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(u){if(a.status==="pending"){var p=a;p.status="fulfilled",p.value=u}},function(u){if(a.status==="pending"){var p=a;p.status="rejected",p.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,ET(s),s}throw ml=a,Pc}}function fl(s){try{var a=s._init;return a(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ml=l,Pc):l}}var ml=null;function wT(){if(ml===null)throw Error(i(459));var s=ml;return ml=null,s}function ET(s){if(s===Pc||s===Mm)throw Error(i(483))}var Mc=null,Oh=0;function Lm(s){var a=Oh;return Oh+=1,Mc===null&&(Mc=[]),vT(Mc,s,a)}function Ph(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function jm(s,a){throw a.$$typeof===b?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function bT(s){function a(q,U){if(s){var $=q.deletions;$===null?(q.deletions=[U],q.flags|=16):$.push(U)}}function l(q,U){if(!s)return null;for(;U!==null;)a(q,U),U=U.sibling;return null}function u(q){for(var U=new Map;q!==null;)q.key!==null?U.set(q.key,q):U.set(q.index,q),q=q.sibling;return U}function p(q,U){return q=Lr(q,U),q.index=0,q.sibling=null,q}function g(q,U,$){return q.index=$,s?($=q.alternate,$!==null?($=$.index,$<U?(q.flags|=67108866,U):$):(q.flags|=67108866,U)):(q.flags|=1048576,U)}function E(q){return s&&q.alternate===null&&(q.flags|=67108866),q}function S(q,U,$,ie){return U===null||U.tag!==6?(U=sy($,q.mode,ie),U.return=q,U):(U=p(U,$),U.return=q,U)}function k(q,U,$,ie){var Ae=$.type;return Ae===M?ne(q,U,$.props.children,ie,$.key):U!==null&&(U.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===x&&fl(Ae)===U.type)?(U=p(U,$.props),Ph(U,$),U.return=q,U):(U=Nm($.type,$.key,$.props,null,q.mode,ie),Ph(U,$),U.return=q,U)}function Q(q,U,$,ie){return U===null||U.tag!==4||U.stateNode.containerInfo!==$.containerInfo||U.stateNode.implementation!==$.implementation?(U=ry($,q.mode,ie),U.return=q,U):(U=p(U,$.children||[]),U.return=q,U)}function ne(q,U,$,ie,Ae){return U===null||U.tag!==7?(U=ll($,q.mode,ie,Ae),U.return=q,U):(U=p(U,$),U.return=q,U)}function se(q,U,$){if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return U=sy(""+U,q.mode,$),U.return=q,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case I:return $=Nm(U.type,U.key,U.props,null,q.mode,$),Ph($,U),$.return=q,$;case C:return U=ry(U,q.mode,$),U.return=q,U;case x:return U=fl(U),se(q,U,$)}if(et(U)||P(U))return U=ll(U,q.mode,$,null),U.return=q,U;if(typeof U.then=="function")return se(q,Lm(U),$);if(U.$$typeof===X)return se(q,Om(q,U),$);jm(q,U)}return null}function Y(q,U,$,ie){var Ae=U!==null?U.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return Ae!==null?null:S(q,U,""+$,ie);if(typeof $=="object"&&$!==null){switch($.$$typeof){case I:return $.key===Ae?k(q,U,$,ie):null;case C:return $.key===Ae?Q(q,U,$,ie):null;case x:return $=fl($),Y(q,U,$,ie)}if(et($)||P($))return Ae!==null?null:ne(q,U,$,ie,null);if(typeof $.then=="function")return Y(q,U,Lm($),ie);if($.$$typeof===X)return Y(q,U,Om(q,$),ie);jm(q,$)}return null}function J(q,U,$,ie,Ae){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return q=q.get($)||null,S(U,q,""+ie,Ae);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case I:return q=q.get(ie.key===null?$:ie.key)||null,k(U,q,ie,Ae);case C:return q=q.get(ie.key===null?$:ie.key)||null,Q(U,q,ie,Ae);case x:return ie=fl(ie),J(q,U,$,ie,Ae)}if(et(ie)||P(ie))return q=q.get($)||null,ne(U,q,ie,Ae,null);if(typeof ie.then=="function")return J(q,U,$,Lm(ie),Ae);if(ie.$$typeof===X)return J(q,U,$,Om(U,ie),Ae);jm(U,ie)}return null}function we(q,U,$,ie){for(var Ae=null,lt=null,be=U,Fe=U=0,We=null;be!==null&&Fe<$.length;Fe++){be.index>Fe?(We=be,be=null):We=be.sibling;var ct=Y(q,be,$[Fe],ie);if(ct===null){be===null&&(be=We);break}s&&be&&ct.alternate===null&&a(q,be),U=g(ct,U,Fe),lt===null?Ae=ct:lt.sibling=ct,lt=ct,be=We}if(Fe===$.length)return l(q,be),Ze&&jr(q,Fe),Ae;if(be===null){for(;Fe<$.length;Fe++)be=se(q,$[Fe],ie),be!==null&&(U=g(be,U,Fe),lt===null?Ae=be:lt.sibling=be,lt=be);return Ze&&jr(q,Fe),Ae}for(be=u(be);Fe<$.length;Fe++)We=J(be,q,Fe,$[Fe],ie),We!==null&&(s&&We.alternate!==null&&be.delete(We.key===null?Fe:We.key),U=g(We,U,Fe),lt===null?Ae=We:lt.sibling=We,lt=We);return s&&be.forEach(function(no){return a(q,no)}),Ze&&jr(q,Fe),Ae}function xe(q,U,$,ie){if($==null)throw Error(i(151));for(var Ae=null,lt=null,be=U,Fe=U=0,We=null,ct=$.next();be!==null&&!ct.done;Fe++,ct=$.next()){be.index>Fe?(We=be,be=null):We=be.sibling;var no=Y(q,be,ct.value,ie);if(no===null){be===null&&(be=We);break}s&&be&&no.alternate===null&&a(q,be),U=g(no,U,Fe),lt===null?Ae=no:lt.sibling=no,lt=no,be=We}if(ct.done)return l(q,be),Ze&&jr(q,Fe),Ae;if(be===null){for(;!ct.done;Fe++,ct=$.next())ct=se(q,ct.value,ie),ct!==null&&(U=g(ct,U,Fe),lt===null?Ae=ct:lt.sibling=ct,lt=ct);return Ze&&jr(q,Fe),Ae}for(be=u(be);!ct.done;Fe++,ct=$.next())ct=J(be,q,Fe,ct.value,ie),ct!==null&&(s&&ct.alternate!==null&&be.delete(ct.key===null?Fe:ct.key),U=g(ct,U,Fe),lt===null?Ae=ct:lt.sibling=ct,lt=ct);return s&&be.forEach(function(CP){return a(q,CP)}),Ze&&jr(q,Fe),Ae}function Et(q,U,$,ie){if(typeof $=="object"&&$!==null&&$.type===M&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case I:e:{for(var Ae=$.key;U!==null;){if(U.key===Ae){if(Ae=$.type,Ae===M){if(U.tag===7){l(q,U.sibling),ie=p(U,$.props.children),ie.return=q,q=ie;break e}}else if(U.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===x&&fl(Ae)===U.type){l(q,U.sibling),ie=p(U,$.props),Ph(ie,$),ie.return=q,q=ie;break e}l(q,U);break}else a(q,U);U=U.sibling}$.type===M?(ie=ll($.props.children,q.mode,ie,$.key),ie.return=q,q=ie):(ie=Nm($.type,$.key,$.props,null,q.mode,ie),Ph(ie,$),ie.return=q,q=ie)}return E(q);case C:e:{for(Ae=$.key;U!==null;){if(U.key===Ae)if(U.tag===4&&U.stateNode.containerInfo===$.containerInfo&&U.stateNode.implementation===$.implementation){l(q,U.sibling),ie=p(U,$.children||[]),ie.return=q,q=ie;break e}else{l(q,U);break}else a(q,U);U=U.sibling}ie=ry($,q.mode,ie),ie.return=q,q=ie}return E(q);case x:return $=fl($),Et(q,U,$,ie)}if(et($))return we(q,U,$,ie);if(P($)){if(Ae=P($),typeof Ae!="function")throw Error(i(150));return $=Ae.call($),xe(q,U,$,ie)}if(typeof $.then=="function")return Et(q,U,Lm($),ie);if($.$$typeof===X)return Et(q,U,Om(q,$),ie);jm(q,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,U!==null&&U.tag===6?(l(q,U.sibling),ie=p(U,$),ie.return=q,q=ie):(l(q,U),ie=sy($,q.mode,ie),ie.return=q,q=ie),E(q)):l(q,U)}return function(q,U,$,ie){try{Oh=0;var Ae=Et(q,U,$,ie);return Mc=null,Ae}catch(be){if(be===Pc||be===Mm)throw be;var lt=Bi(29,be,null,q.mode);return lt.lanes=ie,lt.return=q,lt}finally{}}}var pl=bT(!0),TT=bT(!1),Ua=!1;function _y(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yy(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Fa(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ba(s,a,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(ht&2)!==0){var p=u.pending;return p===null?a.next=a:(a.next=p.next,p.next=a),u.pending=a,a=Rm(s),aT(s,null,l),a}return Cm(s,u,a,l),Rm(s)}function Mh(s,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=s.pendingLanes,l|=u,a.lanes=l,Ns(s,l)}}function vy(s,a){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var E={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?p=g=E:g=g.next=E,l=l.next}while(l!==null);g===null?p=g=a:g=g.next=a}else p=g=a;l={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=a:s.next=a,l.lastBaseUpdate=a}var wy=!1;function Vh(){if(wy){var s=Oc;if(s!==null)throw s}}function Lh(s,a,l,u){wy=!1;var p=s.updateQueue;Ua=!1;var g=p.firstBaseUpdate,E=p.lastBaseUpdate,S=p.shared.pending;if(S!==null){p.shared.pending=null;var k=S,Q=k.next;k.next=null,E===null?g=Q:E.next=Q,E=k;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,S=ne.lastBaseUpdate,S!==E&&(S===null?ne.firstBaseUpdate=Q:S.next=Q,ne.lastBaseUpdate=k))}if(g!==null){var se=p.baseState;E=0,ne=Q=k=null,S=g;do{var Y=S.lane&-536870913,J=Y!==S.lane;if(J?(Qe&Y)===Y:(u&Y)===Y){Y!==0&&Y===kc&&(wy=!0),ne!==null&&(ne=ne.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var we=s,xe=S;Y=a;var Et=l;switch(xe.tag){case 1:if(we=xe.payload,typeof we=="function"){se=we.call(Et,se,Y);break e}se=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=xe.payload,Y=typeof we=="function"?we.call(Et,se,Y):we,Y==null)break e;se=y({},se,Y);break e;case 2:Ua=!0}}Y=S.callback,Y!==null&&(s.flags|=64,J&&(s.flags|=8192),J=p.callbacks,J===null?p.callbacks=[Y]:J.push(Y))}else J={lane:Y,tag:S.tag,payload:S.payload,callback:S.callback,next:null},ne===null?(Q=ne=J,k=se):ne=ne.next=J,E|=Y;if(S=S.next,S===null){if(S=p.shared.pending,S===null)break;J=S,S=J.next,J.next=null,p.lastBaseUpdate=J,p.shared.pending=null}}while(!0);ne===null&&(k=se),p.baseState=k,p.firstBaseUpdate=Q,p.lastBaseUpdate=ne,g===null&&(p.shared.lanes=0),Ka|=E,s.lanes=E,s.memoizedState=se}}function IT(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function ST(s,a){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)IT(l[s],a)}var Vc=O(null),Um=O(0);function AT(s,a){s=Wr,re(Um,s),re(Vc,a),Wr=s|a.baseLanes}function Ey(){re(Um,Wr),re(Vc,Vc.current)}function by(){Wr=Um.current,H(Vc),H(Um)}var zi=O(null),fs=null;function za(s){var a=s.alternate;re(tn,tn.current&1),re(zi,s),fs===null&&(a===null||Vc.current!==null||a.memoizedState!==null)&&(fs=s)}function Ty(s){re(tn,tn.current),re(zi,s),fs===null&&(fs=s)}function xT(s){s.tag===22?(re(tn,tn.current),re(zi,s),fs===null&&(fs=s)):qa()}function qa(){re(tn,tn.current),re(zi,zi.current)}function qi(s){H(zi),fs===s&&(fs=null),H(tn)}var tn=O(0);function Fm(s){for(var a=s;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Rv(l)||Nv(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Br=0,je=null,vt=null,hn=null,Bm=!1,Lc=!1,gl=!1,zm=0,jh=0,jc=null,yO=0;function Kt(){throw Error(i(321))}function Iy(s,a){if(a===null)return!1;for(var l=0;l<a.length&&l<s.length;l++)if(!Fi(s[l],a[l]))return!1;return!0}function Sy(s,a,l,u,p,g){return Br=g,je=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,te.H=s===null||s.memoizedState===null?uI:Fy,gl=!1,g=l(u,p),gl=!1,Lc&&(g=RT(a,l,u,p)),CT(s),g}function CT(s){te.H=Bh;var a=vt!==null&&vt.next!==null;if(Br=0,hn=vt=je=null,Bm=!1,jh=0,jc=null,a)throw Error(i(300));s===null||dn||(s=s.dependencies,s!==null&&km(s)&&(dn=!0))}function RT(s,a,l,u){je=s;var p=0;do{if(Lc&&(jc=null),jh=0,Lc=!1,25<=p)throw Error(i(301));if(p+=1,hn=vt=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}te.H=hI,g=a(l,u)}while(Lc);return g}function vO(){var s=te.H,a=s.useState()[0];return a=typeof a.then=="function"?Uh(a):a,s=s.useState()[0],(vt!==null?vt.memoizedState:null)!==s&&(je.flags|=1024),a}function Ay(){var s=zm!==0;return zm=0,s}function xy(s,a,l){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~l}function Cy(s){if(Bm){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Bm=!1}Br=0,hn=vt=je=null,Lc=!1,jh=zm=0,jc=null}function ii(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?je.memoizedState=hn=s:hn=hn.next=s,hn}function nn(){if(vt===null){var s=je.alternate;s=s!==null?s.memoizedState:null}else s=vt.next;var a=hn===null?je.memoizedState:hn.next;if(a!==null)hn=a,vt=s;else{if(s===null)throw je.alternate===null?Error(i(467)):Error(i(310));vt=s,s={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},hn===null?je.memoizedState=hn=s:hn=hn.next=s}return hn}function qm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Uh(s){var a=jh;return jh+=1,jc===null&&(jc=[]),s=vT(jc,s,a),a=je,(hn===null?a.memoizedState:hn.next)===null&&(a=a.alternate,te.H=a===null||a.memoizedState===null?uI:Fy),s}function Gm(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Uh(s);if(s.$$typeof===X)return Ln(s)}throw Error(i(438,String(s)))}function Ry(s){var a=null,l=je.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=je.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(p){return p.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=qm(),je.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(s),u=0;u<s;u++)l[u]=V;return a.index++,l}function zr(s,a){return typeof a=="function"?a(s):a}function Hm(s){var a=nn();return Ny(a,vt,s)}function Ny(s,a,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var p=s.baseQueue,g=u.pending;if(g!==null){if(p!==null){var E=p.next;p.next=g.next,g.next=E}a.baseQueue=p=g,u.pending=null}if(g=s.baseState,p===null)s.memoizedState=g;else{a=p.next;var S=E=null,k=null,Q=a,ne=!1;do{var se=Q.lane&-536870913;if(se!==Q.lane?(Qe&se)===se:(Br&se)===se){var Y=Q.revertLane;if(Y===0)k!==null&&(k=k.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),se===kc&&(ne=!0);else if((Br&Y)===Y){Q=Q.next,Y===kc&&(ne=!0);continue}else se={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},k===null?(S=k=se,E=g):k=k.next=se,je.lanes|=Y,Ka|=Y;se=Q.action,gl&&l(g,se),g=Q.hasEagerState?Q.eagerState:l(g,se)}else Y={lane:se,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},k===null?(S=k=Y,E=g):k=k.next=Y,je.lanes|=se,Ka|=se;Q=Q.next}while(Q!==null&&Q!==a);if(k===null?E=g:k.next=S,!Fi(g,s.memoizedState)&&(dn=!0,ne&&(l=Oc,l!==null)))throw l;s.memoizedState=g,s.baseState=E,s.baseQueue=k,u.lastRenderedState=g}return p===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Dy(s){var a=nn(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,p=l.pending,g=a.memoizedState;if(p!==null){l.pending=null;var E=p=p.next;do g=s(g,E.action),E=E.next;while(E!==p);Fi(g,a.memoizedState)||(dn=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),l.lastRenderedState=g}return[g,u]}function NT(s,a,l){var u=je,p=nn(),g=Ze;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=a();var E=!Fi((vt||p).memoizedState,l);if(E&&(p.memoizedState=l,dn=!0),p=p.queue,Py(OT.bind(null,u,p,s),[s]),p.getSnapshot!==a||E||hn!==null&&hn.memoizedState.tag&1){if(u.flags|=2048,Uc(9,{destroy:void 0},kT.bind(null,u,p,l,a),null),Tt===null)throw Error(i(349));g||(Br&127)!==0||DT(u,a,l)}return l}function DT(s,a,l){s.flags|=16384,s={getSnapshot:a,value:l},a=je.updateQueue,a===null?(a=qm(),je.updateQueue=a,a.stores=[s]):(l=a.stores,l===null?a.stores=[s]:l.push(s))}function kT(s,a,l,u){a.value=l,a.getSnapshot=u,PT(a)&&MT(s)}function OT(s,a,l){return l(function(){PT(a)&&MT(s)})}function PT(s){var a=s.getSnapshot;s=s.value;try{var l=a();return!Fi(s,l)}catch{return!0}}function MT(s){var a=ol(s,2);a!==null&&Ei(a,s,2)}function ky(s){var a=ii();if(typeof s=="function"){var l=s;if(s=l(),gl){De(!0);try{l()}finally{De(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:s},a}function VT(s,a,l,u){return s.baseState=l,Ny(s,vt,typeof u=="function"?u:zr)}function wO(s,a,l,u,p){if(Qm(s))throw Error(i(485));if(s=a.action,s!==null){var g={payload:p,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){g.listeners.push(E)}};te.T!==null?l(!0):g.isTransition=!1,u(g),l=a.pending,l===null?(g.next=a.pending=g,LT(a,g)):(g.next=l.next,a.pending=l.next=g)}}function LT(s,a){var l=a.action,u=a.payload,p=s.state;if(a.isTransition){var g=te.T,E={};te.T=E;try{var S=l(p,u),k=te.S;k!==null&&k(E,S),jT(s,a,S)}catch(Q){Oy(s,a,Q)}finally{g!==null&&E.types!==null&&(g.types=E.types),te.T=g}}else try{g=l(p,u),jT(s,a,g)}catch(Q){Oy(s,a,Q)}}function jT(s,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){UT(s,a,u)},function(u){return Oy(s,a,u)}):UT(s,a,l)}function UT(s,a,l){a.status="fulfilled",a.value=l,FT(a),s.state=l,a=s.pending,a!==null&&(l=a.next,l===a?s.pending=null:(l=l.next,a.next=l,LT(s,l)))}function Oy(s,a,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,FT(a),a=a.next;while(a!==u)}s.action=null}function FT(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function BT(s,a){return a}function zT(s,a){if(Ze){var l=Tt.formState;if(l!==null){e:{var u=je;if(Ze){if(Nt){t:{for(var p=Nt,g=ds;p.nodeType!==8;){if(!g){p=null;break t}if(p=ms(p.nextSibling),p===null){p=null;break t}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){Nt=ms(p.nextSibling),u=p.data==="F!";break e}}La(u)}u=!1}u&&(a=l[0])}}return l=ii(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:BT,lastRenderedState:a},l.queue=u,l=oI.bind(null,je,u),u.dispatch=l,u=ky(!1),g=Uy.bind(null,je,!1,u.queue),u=ii(),p={state:a,dispatch:null,action:s,pending:null},u.queue=p,l=wO.bind(null,je,p,g,l),p.dispatch=l,u.memoizedState=s,[a,l,!1]}function qT(s){var a=nn();return GT(a,vt,s)}function GT(s,a,l){if(a=Ny(s,a,BT)[0],s=Hm(zr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=Uh(a)}catch(E){throw E===Pc?Mm:E}else u=a;a=nn();var p=a.queue,g=p.dispatch;return l!==a.memoizedState&&(je.flags|=2048,Uc(9,{destroy:void 0},EO.bind(null,p,l),null)),[u,g,s]}function EO(s,a){s.action=a}function HT(s){var a=nn(),l=vt;if(l!==null)return GT(a,l,s);nn(),a=a.memoizedState,l=nn();var u=l.queue.dispatch;return l.memoizedState=s,[a,u,!1]}function Uc(s,a,l,u){return s={tag:s,create:l,deps:u,inst:a,next:null},a=je.updateQueue,a===null&&(a=qm(),je.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,a.lastEffect=s),s}function KT(){return nn().memoizedState}function Km(s,a,l,u){var p=ii();je.flags|=s,p.memoizedState=Uc(1|a,{destroy:void 0},l,u===void 0?null:u)}function $m(s,a,l,u){var p=nn();u=u===void 0?null:u;var g=p.memoizedState.inst;vt!==null&&u!==null&&Iy(u,vt.memoizedState.deps)?p.memoizedState=Uc(a,g,l,u):(je.flags|=s,p.memoizedState=Uc(1|a,g,l,u))}function $T(s,a){Km(8390656,8,s,a)}function Py(s,a){$m(2048,8,s,a)}function bO(s){je.flags|=4;var a=je.updateQueue;if(a===null)a=qm(),je.updateQueue=a,a.events=[s];else{var l=a.events;l===null?a.events=[s]:l.push(s)}}function QT(s){var a=nn().memoizedState;return bO({ref:a,nextImpl:s}),function(){if((ht&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function WT(s,a){return $m(4,2,s,a)}function YT(s,a){return $m(4,4,s,a)}function XT(s,a){if(typeof a=="function"){s=s();var l=a(s);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function JT(s,a,l){l=l!=null?l.concat([s]):null,$m(4,4,XT.bind(null,a,s),l)}function My(){}function ZT(s,a){var l=nn();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&Iy(a,u[1])?u[0]:(l.memoizedState=[s,a],s)}function eI(s,a){var l=nn();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&Iy(a,u[1]))return u[0];if(u=s(),gl){De(!0);try{s()}finally{De(!1)}}return l.memoizedState=[u,a],u}function Vy(s,a,l){return l===void 0||(Br&1073741824)!==0&&(Qe&261930)===0?s.memoizedState=a:(s.memoizedState=l,s=tS(),je.lanes|=s,Ka|=s,l)}function tI(s,a,l,u){return Fi(l,a)?l:Vc.current!==null?(s=Vy(s,l,u),Fi(s,a)||(dn=!0),s):(Br&42)===0||(Br&1073741824)!==0&&(Qe&261930)===0?(dn=!0,s.memoizedState=l):(s=tS(),je.lanes|=s,Ka|=s,a)}function nI(s,a,l,u,p){var g=de.p;de.p=g!==0&&8>g?g:8;var E=te.T,S={};te.T=S,Uy(s,!1,a,l);try{var k=p(),Q=te.S;if(Q!==null&&Q(S,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var ne=_O(k,u);Fh(s,a,ne,Ki(s))}else Fh(s,a,u,Ki(s))}catch(se){Fh(s,a,{then:function(){},status:"rejected",reason:se},Ki())}finally{de.p=g,E!==null&&S.types!==null&&(E.types=S.types),te.T=E}}function TO(){}function Ly(s,a,l,u){if(s.tag!==5)throw Error(i(476));var p=iI(s).queue;nI(s,p,a,ce,l===null?TO:function(){return sI(s),l(u)})}function iI(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:ce},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:l},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function sI(s){var a=iI(s);a.next===null&&(a=s.alternate.memoizedState),Fh(s,a.next.queue,{},Ki())}function jy(){return Ln(id)}function rI(){return nn().memoizedState}function aI(){return nn().memoizedState}function IO(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var l=Ki();s=Fa(l);var u=Ba(a,s,l);u!==null&&(Ei(u,a,l),Mh(u,a,l)),a={cache:fy()},s.payload=a;return}a=a.return}}function SO(s,a,l){var u=Ki();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Qm(s)?lI(a,l):(l=ny(s,a,l,u),l!==null&&(Ei(l,s,u),cI(l,a,u)))}function oI(s,a,l){var u=Ki();Fh(s,a,l,u)}function Fh(s,a,l,u){var p={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Qm(s))lI(a,p);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var E=a.lastRenderedState,S=g(E,l);if(p.hasEagerState=!0,p.eagerState=S,Fi(S,E))return Cm(s,a,p,0),Tt===null&&xm(),!1}catch{}finally{}if(l=ny(s,a,p,u),l!==null)return Ei(l,s,u),cI(l,a,u),!0}return!1}function Uy(s,a,l,u){if(u={lane:2,revertLane:_v(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Qm(s)){if(a)throw Error(i(479))}else a=ny(s,l,u,2),a!==null&&Ei(a,s,2)}function Qm(s){var a=s.alternate;return s===je||a!==null&&a===je}function lI(s,a){Lc=Bm=!0;var l=s.pending;l===null?a.next=a:(a.next=l.next,l.next=a),s.pending=a}function cI(s,a,l){if((l&4194048)!==0){var u=a.lanes;u&=s.pendingLanes,l|=u,a.lanes=l,Ns(s,l)}}var Bh={readContext:Ln,use:Gm,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useLayoutEffect:Kt,useInsertionEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useSyncExternalStore:Kt,useId:Kt,useHostTransitionStatus:Kt,useFormState:Kt,useActionState:Kt,useOptimistic:Kt,useMemoCache:Kt,useCacheRefresh:Kt};Bh.useEffectEvent=Kt;var uI={readContext:Ln,use:Gm,useCallback:function(s,a){return ii().memoizedState=[s,a===void 0?null:a],s},useContext:Ln,useEffect:$T,useImperativeHandle:function(s,a,l){l=l!=null?l.concat([s]):null,Km(4194308,4,XT.bind(null,a,s),l)},useLayoutEffect:function(s,a){return Km(4194308,4,s,a)},useInsertionEffect:function(s,a){Km(4,2,s,a)},useMemo:function(s,a){var l=ii();a=a===void 0?null:a;var u=s();if(gl){De(!0);try{s()}finally{De(!1)}}return l.memoizedState=[u,a],u},useReducer:function(s,a,l){var u=ii();if(l!==void 0){var p=l(a);if(gl){De(!0);try{l(a)}finally{De(!1)}}}else p=a;return u.memoizedState=u.baseState=p,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:p},u.queue=s,s=s.dispatch=SO.bind(null,je,s),[u.memoizedState,s]},useRef:function(s){var a=ii();return s={current:s},a.memoizedState=s},useState:function(s){s=ky(s);var a=s.queue,l=oI.bind(null,je,a);return a.dispatch=l,[s.memoizedState,l]},useDebugValue:My,useDeferredValue:function(s,a){var l=ii();return Vy(l,s,a)},useTransition:function(){var s=ky(!1);return s=nI.bind(null,je,s.queue,!0,!1),ii().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,l){var u=je,p=ii();if(Ze){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),Tt===null)throw Error(i(349));(Qe&127)!==0||DT(u,a,l)}p.memoizedState=l;var g={value:l,getSnapshot:a};return p.queue=g,$T(OT.bind(null,u,g,s),[s]),u.flags|=2048,Uc(9,{destroy:void 0},kT.bind(null,u,g,l,a),null),l},useId:function(){var s=ii(),a=Tt.identifierPrefix;if(Ze){var l=tr,u=er;l=(u&~(1<<32-gn(u)-1)).toString(32)+l,a="_"+a+"R_"+l,l=zm++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=yO++,a="_"+a+"r_"+l.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:jy,useFormState:zT,useActionState:zT,useOptimistic:function(s){var a=ii();a.memoizedState=a.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Uy.bind(null,je,!0,l),l.dispatch=a,[s,a]},useMemoCache:Ry,useCacheRefresh:function(){return ii().memoizedState=IO.bind(null,je)},useEffectEvent:function(s){var a=ii(),l={impl:s};return a.memoizedState=l,function(){if((ht&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},Fy={readContext:Ln,use:Gm,useCallback:ZT,useContext:Ln,useEffect:Py,useImperativeHandle:JT,useInsertionEffect:WT,useLayoutEffect:YT,useMemo:eI,useReducer:Hm,useRef:KT,useState:function(){return Hm(zr)},useDebugValue:My,useDeferredValue:function(s,a){var l=nn();return tI(l,vt.memoizedState,s,a)},useTransition:function(){var s=Hm(zr)[0],a=nn().memoizedState;return[typeof s=="boolean"?s:Uh(s),a]},useSyncExternalStore:NT,useId:rI,useHostTransitionStatus:jy,useFormState:qT,useActionState:qT,useOptimistic:function(s,a){var l=nn();return VT(l,vt,s,a)},useMemoCache:Ry,useCacheRefresh:aI};Fy.useEffectEvent=QT;var hI={readContext:Ln,use:Gm,useCallback:ZT,useContext:Ln,useEffect:Py,useImperativeHandle:JT,useInsertionEffect:WT,useLayoutEffect:YT,useMemo:eI,useReducer:Dy,useRef:KT,useState:function(){return Dy(zr)},useDebugValue:My,useDeferredValue:function(s,a){var l=nn();return vt===null?Vy(l,s,a):tI(l,vt.memoizedState,s,a)},useTransition:function(){var s=Dy(zr)[0],a=nn().memoizedState;return[typeof s=="boolean"?s:Uh(s),a]},useSyncExternalStore:NT,useId:rI,useHostTransitionStatus:jy,useFormState:HT,useActionState:HT,useOptimistic:function(s,a){var l=nn();return vt!==null?VT(l,vt,s,a):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Ry,useCacheRefresh:aI};hI.useEffectEvent=QT;function By(s,a,l,u){a=s.memoizedState,l=l(u,a),l=l==null?a:y({},a,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var zy={enqueueSetState:function(s,a,l){s=s._reactInternals;var u=Ki(),p=Fa(u);p.payload=a,l!=null&&(p.callback=l),a=Ba(s,p,u),a!==null&&(Ei(a,s,u),Mh(a,s,u))},enqueueReplaceState:function(s,a,l){s=s._reactInternals;var u=Ki(),p=Fa(u);p.tag=1,p.payload=a,l!=null&&(p.callback=l),a=Ba(s,p,u),a!==null&&(Ei(a,s,u),Mh(a,s,u))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var l=Ki(),u=Fa(l);u.tag=2,a!=null&&(u.callback=a),a=Ba(s,u,l),a!==null&&(Ei(a,s,l),Mh(a,s,l))}};function dI(s,a,l,u,p,g,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,E):a.prototype&&a.prototype.isPureReactComponent?!xh(l,u)||!xh(p,g):!0}function fI(s,a,l,u){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==s&&zy.enqueueReplaceState(a,a.state,null)}function _l(s,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(s=s.defaultProps){l===a&&(l=y({},l));for(var p in s)l[p]===void 0&&(l[p]=s[p])}return l}function mI(s){Am(s)}function pI(s){console.error(s)}function gI(s){Am(s)}function Wm(s,a){try{var l=s.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function _I(s,a,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function qy(s,a,l){return l=Fa(l),l.tag=3,l.payload={element:null},l.callback=function(){Wm(s,a)},l}function yI(s){return s=Fa(s),s.tag=3,s}function vI(s,a,l,u){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var g=u.value;s.payload=function(){return p(g)},s.callback=function(){_I(a,l,u)}}var E=l.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(s.callback=function(){_I(a,l,u),typeof p!="function"&&($a===null?$a=new Set([this]):$a.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function AO(s,a,l,u,p){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&Dc(a,l,p,!0),l=zi.current,l!==null){switch(l.tag){case 31:case 13:return fs===null?op():l.alternate===null&&$t===0&&($t=3),l.flags&=-257,l.flags|=65536,l.lanes=p,u===Vm?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),mv(s,u,p)),!1;case 22:return l.flags|=65536,u===Vm?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),mv(s,u,p)),!1}throw Error(i(435,l.tag))}return mv(s,u,p),op(),!1}if(Ze)return a=zi.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=p,u!==ly&&(s=Error(i(422),{cause:u}),Nh(cs(s,l)))):(u!==ly&&(a=Error(i(423),{cause:u}),Nh(cs(a,l))),s=s.current.alternate,s.flags|=65536,p&=-p,s.lanes|=p,u=cs(u,l),p=qy(s.stateNode,u,p),vy(s,p),$t!==4&&($t=2)),!1;var g=Error(i(520),{cause:u});if(g=cs(g,l),Wh===null?Wh=[g]:Wh.push(g),$t!==4&&($t=2),a===null)return!0;u=cs(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,s=p&-p,l.lanes|=s,s=qy(l.stateNode,u,s),vy(l,s),!1;case 1:if(a=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&($a===null||!$a.has(g))))return l.flags|=65536,p&=-p,l.lanes|=p,p=yI(p),vI(p,s,l,u),vy(l,p),!1}l=l.return}while(l!==null);return!1}var Gy=Error(i(461)),dn=!1;function jn(s,a,l,u){a.child=s===null?TT(a,null,l,u):pl(a,s.child,l,u)}function wI(s,a,l,u,p){l=l.render;var g=a.ref;if("ref"in u){var E={};for(var S in u)S!=="ref"&&(E[S]=u[S])}else E=u;return hl(a),u=Sy(s,a,l,E,g,p),S=Ay(),s!==null&&!dn?(xy(s,a,p),qr(s,a,p)):(Ze&&S&&ay(a),a.flags|=1,jn(s,a,u,p),a.child)}function EI(s,a,l,u,p){if(s===null){var g=l.type;return typeof g=="function"&&!iy(g)&&g.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=g,bI(s,a,g,u,p)):(s=Nm(l.type,null,u,a,a.mode,p),s.ref=a.ref,s.return=a,a.child=s)}if(g=s.child,!Jy(s,p)){var E=g.memoizedProps;if(l=l.compare,l=l!==null?l:xh,l(E,u)&&s.ref===a.ref)return qr(s,a,p)}return a.flags|=1,s=Lr(g,u),s.ref=a.ref,s.return=a,a.child=s}function bI(s,a,l,u,p){if(s!==null){var g=s.memoizedProps;if(xh(g,u)&&s.ref===a.ref)if(dn=!1,a.pendingProps=u=g,Jy(s,p))(s.flags&131072)!==0&&(dn=!0);else return a.lanes=s.lanes,qr(s,a,p)}return Hy(s,a,l,u,p)}function TI(s,a,l,u){var p=u.children,g=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((a.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,s!==null){for(u=a.child=s.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~g}else u=0,a.child=null;return II(s,a,g,l,u)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&Pm(a,g!==null?g.cachePool:null),g!==null?AT(a,g):Ey(),xT(a);else return u=a.lanes=536870912,II(s,a,g!==null?g.baseLanes|l:l,l,u)}else g!==null?(Pm(a,g.cachePool),AT(a,g),qa(),a.memoizedState=null):(s!==null&&Pm(a,null),Ey(),qa());return jn(s,a,p,l),a.child}function zh(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function II(s,a,l,u,p){var g=py();return g=g===null?null:{parent:un._currentValue,pool:g},a.memoizedState={baseLanes:l,cachePool:g},s!==null&&Pm(a,null),Ey(),xT(a),s!==null&&Dc(s,a,u,!0),a.childLanes=p,null}function Ym(s,a){return a=Jm({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function SI(s,a,l){return pl(a,s.child,null,l),s=Ym(a,a.pendingProps),s.flags|=2,qi(a),a.memoizedState=null,s}function xO(s,a,l){var u=a.pendingProps,p=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Ze){if(u.mode==="hidden")return s=Ym(a,u),a.lanes=536870912,zh(null,s);if(Ty(a),(s=Nt)?(s=LS(s,ds),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ma!==null?{id:er,overflow:tr}:null,retryLane:536870912,hydrationErrors:null},l=lT(s),l.return=a,a.child=l,Vn=a,Nt=null)):s=null,s===null)throw La(a);return a.lanes=536870912,null}return Ym(a,u)}var g=s.memoizedState;if(g!==null){var E=g.dehydrated;if(Ty(a),p)if(a.flags&256)a.flags&=-257,a=SI(s,a,l);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(dn||Dc(s,a,l,!1),p=(l&s.childLanes)!==0,dn||p){if(u=Tt,u!==null&&(E=Qs(u,l),E!==0&&E!==g.retryLane))throw g.retryLane=E,ol(s,E),Ei(u,s,E),Gy;op(),a=SI(s,a,l)}else s=g.treeContext,Nt=ms(E.nextSibling),Vn=a,Ze=!0,Va=null,ds=!1,s!==null&&hT(a,s),a=Ym(a,u),a.flags|=4096;return a}return s=Lr(s.child,{mode:u.mode,children:u.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Xm(s,a){var l=a.ref;if(l===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(a.flags|=4194816)}}function Hy(s,a,l,u,p){return hl(a),l=Sy(s,a,l,u,void 0,p),u=Ay(),s!==null&&!dn?(xy(s,a,p),qr(s,a,p)):(Ze&&u&&ay(a),a.flags|=1,jn(s,a,l,p),a.child)}function AI(s,a,l,u,p,g){return hl(a),a.updateQueue=null,l=RT(a,u,l,p),CT(s),u=Ay(),s!==null&&!dn?(xy(s,a,g),qr(s,a,g)):(Ze&&u&&ay(a),a.flags|=1,jn(s,a,l,g),a.child)}function xI(s,a,l,u,p){if(hl(a),a.stateNode===null){var g=xc,E=l.contextType;typeof E=="object"&&E!==null&&(g=Ln(E)),g=new l(u,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=zy,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=u,g.state=a.memoizedState,g.refs={},_y(a),E=l.contextType,g.context=typeof E=="object"&&E!==null?Ln(E):xc,g.state=a.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(By(a,l,E,u),g.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(E=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),E!==g.state&&zy.enqueueReplaceState(g,g.state,null),Lh(a,u,g,p),Vh(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(s===null){g=a.stateNode;var S=a.memoizedProps,k=_l(l,S);g.props=k;var Q=g.context,ne=l.contextType;E=xc,typeof ne=="object"&&ne!==null&&(E=Ln(ne));var se=l.getDerivedStateFromProps;ne=typeof se=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,ne||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||Q!==E)&&fI(a,g,u,E),Ua=!1;var Y=a.memoizedState;g.state=Y,Lh(a,u,g,p),Vh(),Q=a.memoizedState,S||Y!==Q||Ua?(typeof se=="function"&&(By(a,l,se,u),Q=a.memoizedState),(k=Ua||dI(a,l,k,u,Y,Q,E))?(ne||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=Q),g.props=u,g.state=Q,g.context=E,u=k):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{g=a.stateNode,yy(s,a),E=a.memoizedProps,ne=_l(l,E),g.props=ne,se=a.pendingProps,Y=g.context,Q=l.contextType,k=xc,typeof Q=="object"&&Q!==null&&(k=Ln(Q)),S=l.getDerivedStateFromProps,(Q=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E!==se||Y!==k)&&fI(a,g,u,k),Ua=!1,Y=a.memoizedState,g.state=Y,Lh(a,u,g,p),Vh();var J=a.memoizedState;E!==se||Y!==J||Ua||s!==null&&s.dependencies!==null&&km(s.dependencies)?(typeof S=="function"&&(By(a,l,S,u),J=a.memoizedState),(ne=Ua||dI(a,l,ne,u,Y,J,k)||s!==null&&s.dependencies!==null&&km(s.dependencies))?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,J,k),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,J,k)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||E===s.memoizedProps&&Y===s.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&Y===s.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=J),g.props=u,g.state=J,g.context=k,u=ne):(typeof g.componentDidUpdate!="function"||E===s.memoizedProps&&Y===s.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&Y===s.memoizedState||(a.flags|=1024),u=!1)}return g=u,Xm(s,a),u=(a.flags&128)!==0,g||u?(g=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,s!==null&&u?(a.child=pl(a,s.child,null,p),a.child=pl(a,null,l,p)):jn(s,a,l,p),a.memoizedState=g.state,s=a.child):s=qr(s,a,p),s}function CI(s,a,l,u){return cl(),a.flags|=256,jn(s,a,l,u),a.child}var Ky={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $y(s){return{baseLanes:s,cachePool:_T()}}function Qy(s,a,l){return s=s!==null?s.childLanes&~l:0,a&&(s|=Hi),s}function RI(s,a,l){var u=a.pendingProps,p=!1,g=(a.flags&128)!==0,E;if((E=g)||(E=s!==null&&s.memoizedState===null?!1:(tn.current&2)!==0),E&&(p=!0,a.flags&=-129),E=(a.flags&32)!==0,a.flags&=-33,s===null){if(Ze){if(p?za(a):qa(),(s=Nt)?(s=LS(s,ds),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ma!==null?{id:er,overflow:tr}:null,retryLane:536870912,hydrationErrors:null},l=lT(s),l.return=a,a.child=l,Vn=a,Nt=null)):s=null,s===null)throw La(a);return Nv(s)?a.lanes=32:a.lanes=536870912,null}var S=u.children;return u=u.fallback,p?(qa(),p=a.mode,S=Jm({mode:"hidden",children:S},p),u=ll(u,p,l,null),S.return=a,u.return=a,S.sibling=u,a.child=S,u=a.child,u.memoizedState=$y(l),u.childLanes=Qy(s,E,l),a.memoizedState=Ky,zh(null,u)):(za(a),Wy(a,S))}var k=s.memoizedState;if(k!==null&&(S=k.dehydrated,S!==null)){if(g)a.flags&256?(za(a),a.flags&=-257,a=Yy(s,a,l)):a.memoizedState!==null?(qa(),a.child=s.child,a.flags|=128,a=null):(qa(),S=u.fallback,p=a.mode,u=Jm({mode:"visible",children:u.children},p),S=ll(S,p,l,null),S.flags|=2,u.return=a,S.return=a,u.sibling=S,a.child=u,pl(a,s.child,null,l),u=a.child,u.memoizedState=$y(l),u.childLanes=Qy(s,E,l),a.memoizedState=Ky,a=zh(null,u));else if(za(a),Nv(S)){if(E=S.nextSibling&&S.nextSibling.dataset,E)var Q=E.dgst;E=Q,u=Error(i(419)),u.stack="",u.digest=E,Nh({value:u,source:null,stack:null}),a=Yy(s,a,l)}else if(dn||Dc(s,a,l,!1),E=(l&s.childLanes)!==0,dn||E){if(E=Tt,E!==null&&(u=Qs(E,l),u!==0&&u!==k.retryLane))throw k.retryLane=u,ol(s,u),Ei(E,s,u),Gy;Rv(S)||op(),a=Yy(s,a,l)}else Rv(S)?(a.flags|=192,a.child=s.child,a=null):(s=k.treeContext,Nt=ms(S.nextSibling),Vn=a,Ze=!0,Va=null,ds=!1,s!==null&&hT(a,s),a=Wy(a,u.children),a.flags|=4096);return a}return p?(qa(),S=u.fallback,p=a.mode,k=s.child,Q=k.sibling,u=Lr(k,{mode:"hidden",children:u.children}),u.subtreeFlags=k.subtreeFlags&65011712,Q!==null?S=Lr(Q,S):(S=ll(S,p,l,null),S.flags|=2),S.return=a,u.return=a,u.sibling=S,a.child=u,zh(null,u),u=a.child,S=s.child.memoizedState,S===null?S=$y(l):(p=S.cachePool,p!==null?(k=un._currentValue,p=p.parent!==k?{parent:k,pool:k}:p):p=_T(),S={baseLanes:S.baseLanes|l,cachePool:p}),u.memoizedState=S,u.childLanes=Qy(s,E,l),a.memoizedState=Ky,zh(s.child,u)):(za(a),l=s.child,s=l.sibling,l=Lr(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,s!==null&&(E=a.deletions,E===null?(a.deletions=[s],a.flags|=16):E.push(s)),a.child=l,a.memoizedState=null,l)}function Wy(s,a){return a=Jm({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Jm(s,a){return s=Bi(22,s,null,a),s.lanes=0,s}function Yy(s,a,l){return pl(a,s.child,null,l),s=Wy(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function NI(s,a,l){s.lanes|=a;var u=s.alternate;u!==null&&(u.lanes|=a),hy(s.return,a,l)}function Xy(s,a,l,u,p,g){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:p,treeForkCount:g}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=u,E.tail=l,E.tailMode=p,E.treeForkCount=g)}function DI(s,a,l){var u=a.pendingProps,p=u.revealOrder,g=u.tail;u=u.children;var E=tn.current,S=(E&2)!==0;if(S?(E=E&1|2,a.flags|=128):E&=1,re(tn,E),jn(s,a,u,l),u=Ze?Rh:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&NI(s,l,a);else if(s.tag===19)NI(s,l,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(p){case"forwards":for(l=a.child,p=null;l!==null;)s=l.alternate,s!==null&&Fm(s)===null&&(p=l),l=l.sibling;l=p,l===null?(p=a.child,a.child=null):(p=l.sibling,l.sibling=null),Xy(a,!1,p,l,g,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,p=a.child,a.child=null;p!==null;){if(s=p.alternate,s!==null&&Fm(s)===null){a.child=p;break}s=p.sibling,p.sibling=l,l=p,p=s}Xy(a,!0,l,null,g,u);break;case"together":Xy(a,!1,null,null,void 0,u);break;default:a.memoizedState=null}return a.child}function qr(s,a,l){if(s!==null&&(a.dependencies=s.dependencies),Ka|=a.lanes,(l&a.childLanes)===0)if(s!==null){if(Dc(s,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,l=Lr(s,s.pendingProps),a.child=l,l.return=a;s.sibling!==null;)s=s.sibling,l=l.sibling=Lr(s,s.pendingProps),l.return=a;l.sibling=null}return a.child}function Jy(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&km(s)))}function CO(s,a,l){switch(a.tag){case 3:dt(a,a.stateNode.containerInfo),ja(a,un,s.memoizedState.cache),cl();break;case 27:case 5:Gn(a);break;case 4:dt(a,a.stateNode.containerInfo);break;case 10:ja(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Ty(a),null;break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(za(a),a.flags|=128,null):(l&a.child.childLanes)!==0?RI(s,a,l):(za(a),s=qr(s,a,l),s!==null?s.sibling:null);za(a);break;case 19:var p=(s.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(Dc(s,a,l,!1),u=(l&a.childLanes)!==0),p){if(u)return DI(s,a,l);a.flags|=128}if(p=a.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),re(tn,tn.current),u)break;return null;case 22:return a.lanes=0,TI(s,a,l,a.pendingProps);case 24:ja(a,un,s.memoizedState.cache)}return qr(s,a,l)}function kI(s,a,l){if(s!==null)if(s.memoizedProps!==a.pendingProps)dn=!0;else{if(!Jy(s,l)&&(a.flags&128)===0)return dn=!1,CO(s,a,l);dn=(s.flags&131072)!==0}else dn=!1,Ze&&(a.flags&1048576)!==0&&uT(a,Rh,a.index);switch(a.lanes=0,a.tag){case 16:e:{var u=a.pendingProps;if(s=fl(a.elementType),a.type=s,typeof s=="function")iy(s)?(u=_l(s,u),a.tag=1,a=xI(null,a,s,u,l)):(a.tag=0,a=Hy(null,a,s,u,l));else{if(s!=null){var p=s.$$typeof;if(p===fe){a.tag=11,a=wI(null,a,s,u,l);break e}else if(p===D){a.tag=14,a=EI(null,a,s,u,l);break e}}throw a=Ve(s)||s,Error(i(306,a,""))}}return a;case 0:return Hy(s,a,a.type,a.pendingProps,l);case 1:return u=a.type,p=_l(u,a.pendingProps),xI(s,a,u,p,l);case 3:e:{if(dt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));u=a.pendingProps;var g=a.memoizedState;p=g.element,yy(s,a),Lh(a,u,null,l);var E=a.memoizedState;if(u=E.cache,ja(a,un,u),u!==g.cache&&dy(a,[un],l,!0),Vh(),u=E.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:E.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=CI(s,a,u,l);break e}else if(u!==p){p=cs(Error(i(424)),a),Nh(p),a=CI(s,a,u,l);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Nt=ms(s.firstChild),Vn=a,Ze=!0,Va=null,ds=!0,l=TT(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(cl(),u===p){a=qr(s,a,l);break e}jn(s,a,u,l)}a=a.child}return a;case 26:return Xm(s,a),s===null?(l=qS(a.type,null,a.pendingProps,null))?a.memoizedState=l:Ze||(l=a.type,s=a.pendingProps,u=mp(ke.current).createElement(l),u[Ct]=a,u[on]=s,Un(u,l,s),en(u),a.stateNode=u):a.memoizedState=qS(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Gn(a),s===null&&Ze&&(u=a.stateNode=FS(a.type,a.pendingProps,ke.current),Vn=a,ds=!0,p=Nt,Xa(a.type)?(Dv=p,Nt=ms(u.firstChild)):Nt=p),jn(s,a,a.pendingProps.children,l),Xm(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Ze&&((p=u=Nt)&&(u=sP(u,a.type,a.pendingProps,ds),u!==null?(a.stateNode=u,Vn=a,Nt=ms(u.firstChild),ds=!1,p=!0):p=!1),p||La(a)),Gn(a),p=a.type,g=a.pendingProps,E=s!==null?s.memoizedProps:null,u=g.children,Av(p,g)?u=null:E!==null&&Av(p,E)&&(a.flags|=32),a.memoizedState!==null&&(p=Sy(s,a,vO,null,null,l),id._currentValue=p),Xm(s,a),jn(s,a,u,l),a.child;case 6:return s===null&&Ze&&((s=l=Nt)&&(l=rP(l,a.pendingProps,ds),l!==null?(a.stateNode=l,Vn=a,Nt=null,s=!0):s=!1),s||La(a)),null;case 13:return RI(s,a,l);case 4:return dt(a,a.stateNode.containerInfo),u=a.pendingProps,s===null?a.child=pl(a,null,u,l):jn(s,a,u,l),a.child;case 11:return wI(s,a,a.type,a.pendingProps,l);case 7:return jn(s,a,a.pendingProps,l),a.child;case 8:return jn(s,a,a.pendingProps.children,l),a.child;case 12:return jn(s,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,ja(a,a.type,u.value),jn(s,a,u.children,l),a.child;case 9:return p=a.type._context,u=a.pendingProps.children,hl(a),p=Ln(p),u=u(p),a.flags|=1,jn(s,a,u,l),a.child;case 14:return EI(s,a,a.type,a.pendingProps,l);case 15:return bI(s,a,a.type,a.pendingProps,l);case 19:return DI(s,a,l);case 31:return xO(s,a,l);case 22:return TI(s,a,l,a.pendingProps);case 24:return hl(a),u=Ln(un),s===null?(p=py(),p===null&&(p=Tt,g=fy(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=l),p=g),a.memoizedState={parent:u,cache:p},_y(a),ja(a,un,p)):((s.lanes&l)!==0&&(yy(s,a),Lh(a,null,null,l),Vh()),p=s.memoizedState,g=a.memoizedState,p.parent!==u?(p={parent:u,cache:u},a.memoizedState=p,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=p),ja(a,un,u)):(u=g.cache,ja(a,un,u),u!==p.cache&&dy(a,[un],l,!0))),jn(s,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Gr(s){s.flags|=4}function Zy(s,a,l,u,p){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(p&335544128)===p)if(s.stateNode.complete)s.flags|=8192;else if(rS())s.flags|=8192;else throw ml=Vm,gy}else s.flags&=-16777217}function OI(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!QS(a))if(rS())s.flags|=8192;else throw ml=Vm,gy}function Zm(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Qo():536870912,s.lanes|=a,qc|=a)}function qh(s,a){if(!Ze)switch(s.tailMode){case"hidden":a=s.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Dt(s){var a=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(a)for(var p=s.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=u,s.childLanes=l,a}function RO(s,a,l){var u=a.pendingProps;switch(oy(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(a),null;case 1:return Dt(a),null;case 3:return l=a.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Fr(un),xt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Nc(a)?Gr(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,cy())),Dt(a),null;case 26:var p=a.type,g=a.memoizedState;return s===null?(Gr(a),g!==null?(Dt(a),OI(a,g)):(Dt(a),Zy(a,p,null,u,l))):g?g!==s.memoizedState?(Gr(a),Dt(a),OI(a,g)):(Dt(a),a.flags&=-16777217):(s=s.memoizedProps,s!==u&&Gr(a),Dt(a),Zy(a,p,s,u,l)),null;case 27:if(Oi(a),l=ke.current,p=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==u&&Gr(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return Dt(a),null}s=_e.current,Nc(a)?dT(a):(s=FS(p,u,l),a.stateNode=s,Gr(a))}return Dt(a),null;case 5:if(Oi(a),p=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==u&&Gr(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return Dt(a),null}if(g=_e.current,Nc(a))dT(a);else{var E=mp(ke.current);switch(g){case 1:g=E.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:g=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":g=E.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":g=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":g=E.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof u.is=="string"?E.createElement("select",{is:u.is}):E.createElement("select"),u.multiple?g.multiple=!0:u.size&&(g.size=u.size);break;default:g=typeof u.is=="string"?E.createElement(p,{is:u.is}):E.createElement(p)}}g[Ct]=a,g[on]=u;e:for(E=a.child;E!==null;){if(E.tag===5||E.tag===6)g.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===a)break e;for(;E.sibling===null;){if(E.return===null||E.return===a)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}a.stateNode=g;e:switch(Un(g,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Gr(a)}}return Dt(a),Zy(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,l),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==u&&Gr(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(i(166));if(s=ke.current,Nc(a)){if(s=a.stateNode,l=a.memoizedProps,u=null,p=Vn,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}s[Ct]=a,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||RS(s.nodeValue,l)),s||La(a,!0)}else s=mp(s).createTextNode(u),s[Ct]=a,a.stateNode=s}return Dt(a),null;case 31:if(l=a.memoizedState,s===null||s.memoizedState!==null){if(u=Nc(a),l!==null){if(s===null){if(!u)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ct]=a}else cl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Dt(a),s=!1}else l=cy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return a.flags&256?(qi(a),a):(qi(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Dt(a),null;case 13:if(u=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(p=Nc(a),u!==null&&u.dehydrated!==null){if(s===null){if(!p)throw Error(i(318));if(p=a.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Ct]=a}else cl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Dt(a),p=!1}else p=cy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),p=!0;if(!p)return a.flags&256?(qi(a),a):(qi(a),null)}return qi(a),(a.flags&128)!==0?(a.lanes=l,a):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=a.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==p&&(u.flags|=2048)),l!==s&&l&&(a.child.flags|=8192),Zm(a,a.updateQueue),Dt(a),null);case 4:return xt(),s===null&&Ev(a.stateNode.containerInfo),Dt(a),null;case 10:return Fr(a.type),Dt(a),null;case 19:if(H(tn),u=a.memoizedState,u===null)return Dt(a),null;if(p=(a.flags&128)!==0,g=u.rendering,g===null)if(p)qh(u,!1);else{if($t!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(g=Fm(s),g!==null){for(a.flags|=128,qh(u,!1),s=g.updateQueue,a.updateQueue=s,Zm(a,s),a.subtreeFlags=0,s=l,l=a.child;l!==null;)oT(l,s),l=l.sibling;return re(tn,tn.current&1|2),Ze&&jr(a,u.treeForkCount),a.child}s=s.sibling}u.tail!==null&&qt()>sp&&(a.flags|=128,p=!0,qh(u,!1),a.lanes=4194304)}else{if(!p)if(s=Fm(g),s!==null){if(a.flags|=128,p=!0,s=s.updateQueue,a.updateQueue=s,Zm(a,s),qh(u,!0),u.tail===null&&u.tailMode==="hidden"&&!g.alternate&&!Ze)return Dt(a),null}else 2*qt()-u.renderingStartTime>sp&&l!==536870912&&(a.flags|=128,p=!0,qh(u,!1),a.lanes=4194304);u.isBackwards?(g.sibling=a.child,a.child=g):(s=u.last,s!==null?s.sibling=g:a.child=g,u.last=g)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=qt(),s.sibling=null,l=tn.current,re(tn,p?l&1|2:l&1),Ze&&jr(a,u.treeForkCount),s):(Dt(a),null);case 22:case 23:return qi(a),by(),u=a.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(Dt(a),a.subtreeFlags&6&&(a.flags|=8192)):Dt(a),l=a.updateQueue,l!==null&&Zm(a,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),s!==null&&H(dl),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Fr(un),Dt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function NO(s,a){switch(oy(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Fr(un),xt(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Oi(a),null;case 31:if(a.memoizedState!==null){if(qi(a),a.alternate===null)throw Error(i(340));cl()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(qi(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));cl()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return H(tn),null;case 4:return xt(),null;case 10:return Fr(a.type),null;case 22:case 23:return qi(a),by(),s!==null&&H(dl),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Fr(un),null;case 25:return null;default:return null}}function PI(s,a){switch(oy(a),a.tag){case 3:Fr(un),xt();break;case 26:case 27:case 5:Oi(a);break;case 4:xt();break;case 31:a.memoizedState!==null&&qi(a);break;case 13:qi(a);break;case 19:H(tn);break;case 10:Fr(a.type);break;case 22:case 23:qi(a),by(),s!==null&&H(dl);break;case 24:Fr(un)}}function Gh(s,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var p=u.next;l=p;do{if((l.tag&s)===s){u=void 0;var g=l.create,E=l.inst;u=g(),E.destroy=u}l=l.next}while(l!==p)}}catch(S){gt(a,a.return,S)}}function Ga(s,a,l){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var g=p.next;u=g;do{if((u.tag&s)===s){var E=u.inst,S=E.destroy;if(S!==void 0){E.destroy=void 0,p=a;var k=l,Q=S;try{Q()}catch(ne){gt(p,k,ne)}}}u=u.next}while(u!==g)}}catch(ne){gt(a,a.return,ne)}}function MI(s){var a=s.updateQueue;if(a!==null){var l=s.stateNode;try{ST(a,l)}catch(u){gt(s,s.return,u)}}}function VI(s,a,l){l.props=_l(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){gt(s,a,u)}}function Hh(s,a){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(p){gt(s,a,p)}}function nr(s,a){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(p){gt(s,a,p)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){gt(s,a,p)}else l.current=null}function LI(s){var a=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(p){gt(s,s.return,p)}}function ev(s,a,l){try{var u=s.stateNode;JO(u,s.type,l,a),u[on]=a}catch(p){gt(s,s.return,p)}}function jI(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Xa(s.type)||s.tag===4}function tv(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jI(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Xa(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function nv(s,a,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(s),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=bn));else if(u!==4&&(u===27&&Xa(s.type)&&(l=s.stateNode,a=null),s=s.child,s!==null))for(nv(s,a,l),s=s.sibling;s!==null;)nv(s,a,l),s=s.sibling}function ep(s,a,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,a?l.insertBefore(s,a):l.appendChild(s);else if(u!==4&&(u===27&&Xa(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(ep(s,a,l),s=s.sibling;s!==null;)ep(s,a,l),s=s.sibling}function UI(s){var a=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,p=a.attributes;p.length;)a.removeAttributeNode(p[0]);Un(a,u,l),a[Ct]=s,a[on]=l}catch(g){gt(s,s.return,g)}}var Hr=!1,fn=!1,iv=!1,FI=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function DO(s,a){if(s=s.containerInfo,Iv=Ep,s=Jb(s),Y_(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var p=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var E=0,S=-1,k=-1,Q=0,ne=0,se=s,Y=null;t:for(;;){for(var J;se!==l||p!==0&&se.nodeType!==3||(S=E+p),se!==g||u!==0&&se.nodeType!==3||(k=E+u),se.nodeType===3&&(E+=se.nodeValue.length),(J=se.firstChild)!==null;)Y=se,se=J;for(;;){if(se===s)break t;if(Y===l&&++Q===p&&(S=E),Y===g&&++ne===u&&(k=E),(J=se.nextSibling)!==null)break;se=Y,Y=se.parentNode}se=J}l=S===-1||k===-1?null:{start:S,end:k}}else l=null}l=l||{start:0,end:0}}else l=null;for(Sv={focusedElem:s,selectionRange:l},Ep=!1,Sn=a;Sn!==null;)if(a=Sn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Sn=s;else for(;Sn!==null;){switch(a=Sn,g=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)p=s[l],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=a,p=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var we=_l(l.type,p);s=u.getSnapshotBeforeUpdate(we,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(xe){gt(l,l.return,xe)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,l=s.nodeType,l===9)Cv(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Cv(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Sn=s;break}Sn=a.return}}function BI(s,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:$r(s,l),u&4&&Gh(5,l);break;case 1:if($r(s,l),u&4)if(s=l.stateNode,a===null)try{s.componentDidMount()}catch(E){gt(l,l.return,E)}else{var p=_l(l.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(p,a,s.__reactInternalSnapshotBeforeUpdate)}catch(E){gt(l,l.return,E)}}u&64&&MI(l),u&512&&Hh(l,l.return);break;case 3:if($r(s,l),u&64&&(s=l.updateQueue,s!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{ST(s,a)}catch(E){gt(l,l.return,E)}}break;case 27:a===null&&u&4&&UI(l);case 26:case 5:$r(s,l),a===null&&u&4&&LI(l),u&512&&Hh(l,l.return);break;case 12:$r(s,l);break;case 31:$r(s,l),u&4&&GI(s,l);break;case 13:$r(s,l),u&4&&HI(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=FO.bind(null,l),aP(s,l))));break;case 22:if(u=l.memoizedState!==null||Hr,!u){a=a!==null&&a.memoizedState!==null||fn,p=Hr;var g=fn;Hr=u,(fn=a)&&!g?Qr(s,l,(l.subtreeFlags&8772)!==0):$r(s,l),Hr=p,fn=g}break;case 30:break;default:$r(s,l)}}function zI(s){var a=s.alternate;a!==null&&(s.alternate=null,zI(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&rs(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ot=null,_i=!1;function Kr(s,a,l){for(l=l.child;l!==null;)qI(s,a,l),l=l.sibling}function qI(s,a,l){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Gs,l)}catch{}switch(l.tag){case 26:fn||nr(l,a),Kr(s,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:fn||nr(l,a);var u=Ot,p=_i;Xa(l.type)&&(Ot=l.stateNode,_i=!1),Kr(s,a,l),ed(l.stateNode),Ot=u,_i=p;break;case 5:fn||nr(l,a);case 6:if(u=Ot,p=_i,Ot=null,Kr(s,a,l),Ot=u,_i=p,Ot!==null)if(_i)try{(Ot.nodeType===9?Ot.body:Ot.nodeName==="HTML"?Ot.ownerDocument.body:Ot).removeChild(l.stateNode)}catch(g){gt(l,a,g)}else try{Ot.removeChild(l.stateNode)}catch(g){gt(l,a,g)}break;case 18:Ot!==null&&(_i?(s=Ot,MS(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Xc(s)):MS(Ot,l.stateNode));break;case 4:u=Ot,p=_i,Ot=l.stateNode.containerInfo,_i=!0,Kr(s,a,l),Ot=u,_i=p;break;case 0:case 11:case 14:case 15:Ga(2,l,a),fn||Ga(4,l,a),Kr(s,a,l);break;case 1:fn||(nr(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&VI(l,a,u)),Kr(s,a,l);break;case 21:Kr(s,a,l);break;case 22:fn=(u=fn)||l.memoizedState!==null,Kr(s,a,l),fn=u;break;default:Kr(s,a,l)}}function GI(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Xc(s)}catch(l){gt(a,a.return,l)}}}function HI(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Xc(s)}catch(l){gt(a,a.return,l)}}function kO(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new FI),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new FI),a;default:throw Error(i(435,s.tag))}}function tp(s,a){var l=kO(s);a.forEach(function(u){if(!l.has(u)){l.add(u);var p=BO.bind(null,s,u);u.then(p,p)}})}function yi(s,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var p=l[u],g=s,E=a,S=E;e:for(;S!==null;){switch(S.tag){case 27:if(Xa(S.type)){Ot=S.stateNode,_i=!1;break e}break;case 5:Ot=S.stateNode,_i=!1;break e;case 3:case 4:Ot=S.stateNode.containerInfo,_i=!0;break e}S=S.return}if(Ot===null)throw Error(i(160));qI(g,E,p),Ot=null,_i=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)KI(a,s),a=a.sibling}var Ms=null;function KI(s,a){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:yi(a,s),vi(s),u&4&&(Ga(3,s,s.return),Gh(3,s),Ga(5,s,s.return));break;case 1:yi(a,s),vi(s),u&512&&(fn||l===null||nr(l,l.return)),u&64&&Hr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var p=Ms;if(yi(a,s),vi(s),u&512&&(fn||l===null||nr(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":g=p.getElementsByTagName("title")[0],(!g||g[ss]||g[Ct]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(u),p.head.insertBefore(g,p.querySelector("head > title"))),Un(g,u,l),g[Ct]=s,en(g),u=g;break e;case"link":var E=KS("link","href",p).get(u+(l.href||""));if(E){for(var S=0;S<E.length;S++)if(g=E[S],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){E.splice(S,1);break t}}g=p.createElement(u),Un(g,u,l),p.head.appendChild(g);break;case"meta":if(E=KS("meta","content",p).get(u+(l.content||""))){for(S=0;S<E.length;S++)if(g=E[S],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){E.splice(S,1);break t}}g=p.createElement(u),Un(g,u,l),p.head.appendChild(g);break;default:throw Error(i(468,u))}g[Ct]=s,en(g),u=g}s.stateNode=u}else $S(p,s.type,s.stateNode);else s.stateNode=HS(p,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?$S(p,s.type,s.stateNode):HS(p,u,s.memoizedProps)):u===null&&s.stateNode!==null&&ev(s,s.memoizedProps,l.memoizedProps)}break;case 27:yi(a,s),vi(s),u&512&&(fn||l===null||nr(l,l.return)),l!==null&&u&4&&ev(s,s.memoizedProps,l.memoizedProps);break;case 5:if(yi(a,s),vi(s),u&512&&(fn||l===null||nr(l,l.return)),s.flags&32){p=s.stateNode;try{os(p,"")}catch(we){gt(s,s.return,we)}}u&4&&s.stateNode!=null&&(p=s.memoizedProps,ev(s,p,l!==null?l.memoizedProps:p)),u&1024&&(iv=!0);break;case 6:if(yi(a,s),vi(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(we){gt(s,s.return,we)}}break;case 3:if(_p=null,p=Ms,Ms=pp(a.containerInfo),yi(a,s),Ms=p,vi(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Xc(a.containerInfo)}catch(we){gt(s,s.return,we)}iv&&(iv=!1,$I(s));break;case 4:u=Ms,Ms=pp(s.stateNode.containerInfo),yi(a,s),vi(s),Ms=u;break;case 12:yi(a,s),vi(s);break;case 31:yi(a,s),vi(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,tp(s,u)));break;case 13:yi(a,s),vi(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(ip=qt()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,tp(s,u)));break;case 22:p=s.memoizedState!==null;var k=l!==null&&l.memoizedState!==null,Q=Hr,ne=fn;if(Hr=Q||p,fn=ne||k,yi(a,s),fn=ne,Hr=Q,vi(s),u&8192)e:for(a=s.stateNode,a._visibility=p?a._visibility&-2:a._visibility|1,p&&(l===null||k||Hr||fn||yl(s)),l=null,a=s;;){if(a.tag===5||a.tag===26){if(l===null){k=l=a;try{if(g=k.stateNode,p)E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{S=k.stateNode;var se=k.memoizedProps.style,Y=se!=null&&se.hasOwnProperty("display")?se.display:null;S.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(we){gt(k,k.return,we)}}}else if(a.tag===6){if(l===null){k=a;try{k.stateNode.nodeValue=p?"":k.memoizedProps}catch(we){gt(k,k.return,we)}}}else if(a.tag===18){if(l===null){k=a;try{var J=k.stateNode;p?VS(J,!0):VS(k.stateNode,!1)}catch(we){gt(k,k.return,we)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,tp(s,l))));break;case 19:yi(a,s),vi(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,tp(s,u)));break;case 30:break;case 21:break;default:yi(a,s),vi(s)}}function vi(s){var a=s.flags;if(a&2){try{for(var l,u=s.return;u!==null;){if(jI(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var p=l.stateNode,g=tv(s);ep(s,g,p);break;case 5:var E=l.stateNode;l.flags&32&&(os(E,""),l.flags&=-33);var S=tv(s);ep(s,S,E);break;case 3:case 4:var k=l.stateNode.containerInfo,Q=tv(s);nv(s,Q,k);break;default:throw Error(i(161))}}catch(ne){gt(s,s.return,ne)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function $I(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;$I(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function $r(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)BI(s,a.alternate,a),a=a.sibling}function yl(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Ga(4,a,a.return),yl(a);break;case 1:nr(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&VI(a,a.return,l),yl(a);break;case 27:ed(a.stateNode);case 26:case 5:nr(a,a.return),yl(a);break;case 22:a.memoizedState===null&&yl(a);break;case 30:yl(a);break;default:yl(a)}s=s.sibling}}function Qr(s,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,p=s,g=a,E=g.flags;switch(g.tag){case 0:case 11:case 15:Qr(p,g,l),Gh(4,g);break;case 1:if(Qr(p,g,l),u=g,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(Q){gt(u,u.return,Q)}if(u=g,p=u.updateQueue,p!==null){var S=u.stateNode;try{var k=p.shared.hiddenCallbacks;if(k!==null)for(p.shared.hiddenCallbacks=null,p=0;p<k.length;p++)IT(k[p],S)}catch(Q){gt(u,u.return,Q)}}l&&E&64&&MI(g),Hh(g,g.return);break;case 27:UI(g);case 26:case 5:Qr(p,g,l),l&&u===null&&E&4&&LI(g),Hh(g,g.return);break;case 12:Qr(p,g,l);break;case 31:Qr(p,g,l),l&&E&4&&GI(p,g);break;case 13:Qr(p,g,l),l&&E&4&&HI(p,g);break;case 22:g.memoizedState===null&&Qr(p,g,l),Hh(g,g.return);break;case 30:break;default:Qr(p,g,l)}a=a.sibling}}function sv(s,a){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Dh(l))}function rv(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Dh(s))}function Vs(s,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)QI(s,a,l,u),a=a.sibling}function QI(s,a,l,u){var p=a.flags;switch(a.tag){case 0:case 11:case 15:Vs(s,a,l,u),p&2048&&Gh(9,a);break;case 1:Vs(s,a,l,u);break;case 3:Vs(s,a,l,u),p&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Dh(s)));break;case 12:if(p&2048){Vs(s,a,l,u),s=a.stateNode;try{var g=a.memoizedProps,E=g.id,S=g.onPostCommit;typeof S=="function"&&S(E,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(k){gt(a,a.return,k)}}else Vs(s,a,l,u);break;case 31:Vs(s,a,l,u);break;case 13:Vs(s,a,l,u);break;case 23:break;case 22:g=a.stateNode,E=a.alternate,a.memoizedState!==null?g._visibility&2?Vs(s,a,l,u):Kh(s,a):g._visibility&2?Vs(s,a,l,u):(g._visibility|=2,Fc(s,a,l,u,(a.subtreeFlags&10256)!==0||!1)),p&2048&&sv(E,a);break;case 24:Vs(s,a,l,u),p&2048&&rv(a.alternate,a);break;default:Vs(s,a,l,u)}}function Fc(s,a,l,u,p){for(p=p&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var g=s,E=a,S=l,k=u,Q=E.flags;switch(E.tag){case 0:case 11:case 15:Fc(g,E,S,k,p),Gh(8,E);break;case 23:break;case 22:var ne=E.stateNode;E.memoizedState!==null?ne._visibility&2?Fc(g,E,S,k,p):Kh(g,E):(ne._visibility|=2,Fc(g,E,S,k,p)),p&&Q&2048&&sv(E.alternate,E);break;case 24:Fc(g,E,S,k,p),p&&Q&2048&&rv(E.alternate,E);break;default:Fc(g,E,S,k,p)}a=a.sibling}}function Kh(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=s,u=a,p=u.flags;switch(u.tag){case 22:Kh(l,u),p&2048&&sv(u.alternate,u);break;case 24:Kh(l,u),p&2048&&rv(u.alternate,u);break;default:Kh(l,u)}a=a.sibling}}var $h=8192;function Bc(s,a,l){if(s.subtreeFlags&$h)for(s=s.child;s!==null;)WI(s,a,l),s=s.sibling}function WI(s,a,l){switch(s.tag){case 26:Bc(s,a,l),s.flags&$h&&s.memoizedState!==null&&yP(l,Ms,s.memoizedState,s.memoizedProps);break;case 5:Bc(s,a,l);break;case 3:case 4:var u=Ms;Ms=pp(s.stateNode.containerInfo),Bc(s,a,l),Ms=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=$h,$h=16777216,Bc(s,a,l),$h=u):Bc(s,a,l));break;default:Bc(s,a,l)}}function YI(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Qh(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Sn=u,JI(u,s)}YI(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)XI(s),s=s.sibling}function XI(s){switch(s.tag){case 0:case 11:case 15:Qh(s),s.flags&2048&&Ga(9,s,s.return);break;case 3:Qh(s);break;case 12:Qh(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,np(s)):Qh(s);break;default:Qh(s)}}function np(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Sn=u,JI(u,s)}YI(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Ga(8,a,a.return),np(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,np(a));break;default:np(a)}s=s.sibling}}function JI(s,a){for(;Sn!==null;){var l=Sn;switch(l.tag){case 0:case 11:case 15:Ga(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Dh(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Sn=u;else e:for(l=s;Sn!==null;){u=Sn;var p=u.sibling,g=u.return;if(zI(u),u===l){Sn=null;break e}if(p!==null){p.return=g,Sn=p;break e}Sn=g}}}var OO={getCacheForType:function(s){var a=Ln(un),l=a.data.get(s);return l===void 0&&(l=s(),a.data.set(s,l)),l},cacheSignal:function(){return Ln(un).controller.signal}},PO=typeof WeakMap=="function"?WeakMap:Map,ht=0,Tt=null,Ke=null,Qe=0,pt=0,Gi=null,Ha=!1,zc=!1,av=!1,Wr=0,$t=0,Ka=0,vl=0,ov=0,Hi=0,qc=0,Wh=null,wi=null,lv=!1,ip=0,ZI=0,sp=1/0,rp=null,$a=null,yn=0,Qa=null,Gc=null,Yr=0,cv=0,uv=null,eS=null,Yh=0,hv=null;function Ki(){return(ht&2)!==0&&Qe!==0?Qe&-Qe:te.T!==null?_v():Ds()}function tS(){if(Hi===0)if((Qe&536870912)===0||Ze){var s=Jn;Jn<<=1,(Jn&3932160)===0&&(Jn=262144),Hi=s}else Hi=536870912;return s=zi.current,s!==null&&(s.flags|=32),Hi}function Ei(s,a,l){(s===Tt&&(pt===2||pt===9)||s.cancelPendingCommit!==null)&&(Hc(s,0),Wa(s,Qe,Hi,!1)),$s(s,l),((ht&2)===0||s!==Tt)&&(s===Tt&&((ht&2)===0&&(vl|=l),$t===4&&Wa(s,Qe,Hi,!1)),ir(s))}function nS(s,a,l){if((ht&6)!==0)throw Error(i(327));var u=!l&&(a&127)===0&&(a&s.expiredLanes)===0||Ks(s,a),p=u?LO(s,a):fv(s,a,!0),g=u;do{if(p===0){zc&&!u&&Wa(s,a,0,!1);break}else{if(l=s.current.alternate,g&&!MO(l)){p=fv(s,a,!1),g=!1;continue}if(p===2){if(g=a,s.errorRecoveryDisabledLanes&g)var E=0;else E=s.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){a=E;e:{var S=s;p=Wh;var k=S.current.memoizedState.isDehydrated;if(k&&(Hc(S,E).flags|=256),E=fv(S,E,!1),E!==2){if(av&&!k){S.errorRecoveryDisabledLanes|=g,vl|=g,p=4;break e}g=wi,wi=p,g!==null&&(wi===null?wi=g:wi.push.apply(wi,g))}p=E}if(g=!1,p!==2)continue}}if(p===1){Hc(s,0),Wa(s,a,0,!0);break}e:{switch(u=s,g=p,g){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Wa(u,a,Hi,!Ha);break e;case 2:wi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(p=ip+300-qt(),10<p)){if(Wa(u,a,Hi,!Ha),fi(u,0,!0)!==0)break e;Yr=a,u.timeoutHandle=OS(iS.bind(null,u,l,wi,rp,lv,a,Hi,vl,qc,Ha,g,"Throttled",-0,0),p);break e}iS(u,l,wi,rp,lv,a,Hi,vl,qc,Ha,g,null,-0,0)}}break}while(!0);ir(s)}function iS(s,a,l,u,p,g,E,S,k,Q,ne,se,Y,J){if(s.timeoutHandle=-1,se=a.subtreeFlags,se&8192||(se&16785408)===16785408){se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:bn},WI(a,g,se);var we=(g&62914560)===g?ip-qt():(g&4194048)===g?ZI-qt():0;if(we=vP(se,we),we!==null){Yr=g,s.cancelPendingCommit=we(hS.bind(null,s,a,g,l,u,p,E,S,k,ne,se,null,Y,J)),Wa(s,g,E,!Q);return}}hS(s,a,g,l,u,p,E,S,k)}function MO(s){for(var a=s;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var p=l[u],g=p.getSnapshot;p=p.value;try{if(!Fi(g(),p))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Wa(s,a,l,u){a&=~ov,a&=~vl,s.suspendedLanes|=a,s.pingedLanes&=~a,u&&(s.warmLanes|=a),u=s.expirationTimes;for(var p=a;0<p;){var g=31-gn(p),E=1<<g;u[g]=-1,p&=~E}l!==0&&Wo(s,l,a)}function ap(){return(ht&6)===0?(Xh(0),!1):!0}function dv(){if(Ke!==null){if(pt===0)var s=Ke.return;else s=Ke,Ur=ul=null,Cy(s),Mc=null,Oh=0,s=Ke;for(;s!==null;)PI(s.alternate,s),s=s.return;Ke=null}}function Hc(s,a){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,tP(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Yr=0,dv(),Tt=s,Ke=l=Lr(s.current,null),Qe=a,pt=0,Gi=null,Ha=!1,zc=Ks(s,a),av=!1,qc=Hi=ov=vl=Ka=$t=0,wi=Wh=null,lv=!1,(a&8)!==0&&(a|=a&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=a;0<u;){var p=31-gn(u),g=1<<p;a|=s[p],u&=~g}return Wr=a,xm(),l}function sS(s,a){je=null,te.H=Bh,a===Pc||a===Mm?(a=wT(),pt=3):a===gy?(a=wT(),pt=4):pt=a===Gy?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Gi=a,Ke===null&&($t=1,Wm(s,cs(a,s.current)))}function rS(){var s=zi.current;return s===null?!0:(Qe&4194048)===Qe?fs===null:(Qe&62914560)===Qe||(Qe&536870912)!==0?s===fs:!1}function aS(){var s=te.H;return te.H=Bh,s===null?Bh:s}function oS(){var s=te.A;return te.A=OO,s}function op(){$t=4,Ha||(Qe&4194048)!==Qe&&zi.current!==null||(zc=!0),(Ka&134217727)===0&&(vl&134217727)===0||Tt===null||Wa(Tt,Qe,Hi,!1)}function fv(s,a,l){var u=ht;ht|=2;var p=aS(),g=oS();(Tt!==s||Qe!==a)&&(rp=null,Hc(s,a)),a=!1;var E=$t;e:do try{if(pt!==0&&Ke!==null){var S=Ke,k=Gi;switch(pt){case 8:dv(),E=6;break e;case 3:case 2:case 9:case 6:zi.current===null&&(a=!0);var Q=pt;if(pt=0,Gi=null,Kc(s,S,k,Q),l&&zc){E=0;break e}break;default:Q=pt,pt=0,Gi=null,Kc(s,S,k,Q)}}VO(),E=$t;break}catch(ne){sS(s,ne)}while(!0);return a&&s.shellSuspendCounter++,Ur=ul=null,ht=u,te.H=p,te.A=g,Ke===null&&(Tt=null,Qe=0,xm()),E}function VO(){for(;Ke!==null;)lS(Ke)}function LO(s,a){var l=ht;ht|=2;var u=aS(),p=oS();Tt!==s||Qe!==a?(rp=null,sp=qt()+500,Hc(s,a)):zc=Ks(s,a);e:do try{if(pt!==0&&Ke!==null){a=Ke;var g=Gi;t:switch(pt){case 1:pt=0,Gi=null,Kc(s,a,g,1);break;case 2:case 9:if(yT(g)){pt=0,Gi=null,cS(a);break}a=function(){pt!==2&&pt!==9||Tt!==s||(pt=7),ir(s)},g.then(a,a);break e;case 3:pt=7;break e;case 4:pt=5;break e;case 7:yT(g)?(pt=0,Gi=null,cS(a)):(pt=0,Gi=null,Kc(s,a,g,7));break;case 5:var E=null;switch(Ke.tag){case 26:E=Ke.memoizedState;case 5:case 27:var S=Ke;if(E?QS(E):S.stateNode.complete){pt=0,Gi=null;var k=S.sibling;if(k!==null)Ke=k;else{var Q=S.return;Q!==null?(Ke=Q,lp(Q)):Ke=null}break t}}pt=0,Gi=null,Kc(s,a,g,5);break;case 6:pt=0,Gi=null,Kc(s,a,g,6);break;case 8:dv(),$t=6;break e;default:throw Error(i(462))}}jO();break}catch(ne){sS(s,ne)}while(!0);return Ur=ul=null,te.H=u,te.A=p,ht=l,Ke!==null?0:(Tt=null,Qe=0,xm(),$t)}function jO(){for(;Ke!==null&&!va();)lS(Ke)}function lS(s){var a=kI(s.alternate,s,Wr);s.memoizedProps=s.pendingProps,a===null?lp(s):Ke=a}function cS(s){var a=s,l=a.alternate;switch(a.tag){case 15:case 0:a=AI(l,a,a.pendingProps,a.type,void 0,Qe);break;case 11:a=AI(l,a,a.pendingProps,a.type.render,a.ref,Qe);break;case 5:Cy(a);default:PI(l,a),a=Ke=oT(a,Wr),a=kI(l,a,Wr)}s.memoizedProps=s.pendingProps,a===null?lp(s):Ke=a}function Kc(s,a,l,u){Ur=ul=null,Cy(a),Mc=null,Oh=0;var p=a.return;try{if(AO(s,p,a,l,Qe)){$t=1,Wm(s,cs(l,s.current)),Ke=null;return}}catch(g){if(p!==null)throw Ke=p,g;$t=1,Wm(s,cs(l,s.current)),Ke=null;return}a.flags&32768?(Ze||u===1?s=!0:zc||(Qe&536870912)!==0?s=!1:(Ha=s=!0,(u===2||u===9||u===3||u===6)&&(u=zi.current,u!==null&&u.tag===13&&(u.flags|=16384))),uS(a,s)):lp(a)}function lp(s){var a=s;do{if((a.flags&32768)!==0){uS(a,Ha);return}s=a.return;var l=RO(a.alternate,a,Wr);if(l!==null){Ke=l;return}if(a=a.sibling,a!==null){Ke=a;return}Ke=a=s}while(a!==null);$t===0&&($t=5)}function uS(s,a){do{var l=NO(s.alternate,s);if(l!==null){l.flags&=32767,Ke=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(s=s.sibling,s!==null)){Ke=s;return}Ke=s=l}while(s!==null);$t=6,Ke=null}function hS(s,a,l,u,p,g,E,S,k){s.cancelPendingCommit=null;do cp();while(yn!==0);if((ht&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(g=a.lanes|a.childLanes,g|=ty,_n(s,l,g,E,S,k),s===Tt&&(Ke=Tt=null,Qe=0),Gc=a,Qa=s,Yr=l,cv=g,uv=p,eS=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,zO(xs,function(){return gS(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=te.T,te.T=null,p=de.p,de.p=2,E=ht,ht|=4;try{DO(s,a,l)}finally{ht=E,de.p=p,te.T=u}}yn=1,dS(),fS(),mS()}}function dS(){if(yn===1){yn=0;var s=Qa,a=Gc,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=te.T,te.T=null;var u=de.p;de.p=2;var p=ht;ht|=4;try{KI(a,s);var g=Sv,E=Jb(s.containerInfo),S=g.focusedElem,k=g.selectionRange;if(E!==S&&S&&S.ownerDocument&&Xb(S.ownerDocument.documentElement,S)){if(k!==null&&Y_(S)){var Q=k.start,ne=k.end;if(ne===void 0&&(ne=Q),"selectionStart"in S)S.selectionStart=Q,S.selectionEnd=Math.min(ne,S.value.length);else{var se=S.ownerDocument||document,Y=se&&se.defaultView||window;if(Y.getSelection){var J=Y.getSelection(),we=S.textContent.length,xe=Math.min(k.start,we),Et=k.end===void 0?xe:Math.min(k.end,we);!J.extend&&xe>Et&&(E=Et,Et=xe,xe=E);var q=Yb(S,xe),U=Yb(S,Et);if(q&&U&&(J.rangeCount!==1||J.anchorNode!==q.node||J.anchorOffset!==q.offset||J.focusNode!==U.node||J.focusOffset!==U.offset)){var $=se.createRange();$.setStart(q.node,q.offset),J.removeAllRanges(),xe>Et?(J.addRange($),J.extend(U.node,U.offset)):($.setEnd(U.node,U.offset),J.addRange($))}}}}for(se=[],J=S;J=J.parentNode;)J.nodeType===1&&se.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<se.length;S++){var ie=se[S];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Ep=!!Iv,Sv=Iv=null}finally{ht=p,de.p=u,te.T=l}}s.current=a,yn=2}}function fS(){if(yn===2){yn=0;var s=Qa,a=Gc,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=te.T,te.T=null;var u=de.p;de.p=2;var p=ht;ht|=4;try{BI(s,a.alternate,a)}finally{ht=p,de.p=u,te.T=l}}yn=3}}function mS(){if(yn===4||yn===3){yn=0,Rr();var s=Qa,a=Gc,l=Yr,u=eS;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?yn=5:(yn=0,Gc=Qa=null,pS(s,s.pendingLanes));var p=s.pendingLanes;if(p===0&&($a=null),Ea(l),a=a.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Gs,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=te.T,p=de.p,de.p=2,te.T=null;try{for(var g=s.onRecoverableError,E=0;E<u.length;E++){var S=u[E];g(S.value,{componentStack:S.stack})}}finally{te.T=a,de.p=p}}(Yr&3)!==0&&cp(),ir(s),p=s.pendingLanes,(l&261930)!==0&&(p&42)!==0?s===hv?Yh++:(Yh=0,hv=s):Yh=0,Xh(0)}}function pS(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Dh(a)))}function cp(){return dS(),fS(),mS(),gS()}function gS(){if(yn!==5)return!1;var s=Qa,a=cv;cv=0;var l=Ea(Yr),u=te.T,p=de.p;try{de.p=32>l?32:l,te.T=null,l=uv,uv=null;var g=Qa,E=Yr;if(yn=0,Gc=Qa=null,Yr=0,(ht&6)!==0)throw Error(i(331));var S=ht;if(ht|=4,XI(g.current),QI(g,g.current,E,l),ht=S,Xh(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Gs,g)}catch{}return!0}finally{de.p=p,te.T=u,pS(s,a)}}function _S(s,a,l){a=cs(l,a),a=qy(s.stateNode,a,2),s=Ba(s,a,2),s!==null&&($s(s,2),ir(s))}function gt(s,a,l){if(s.tag===3)_S(s,s,l);else for(;a!==null;){if(a.tag===3){_S(a,s,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&($a===null||!$a.has(u))){s=cs(l,s),l=yI(2),u=Ba(a,l,2),u!==null&&(vI(l,u,a,s),$s(u,2),ir(u));break}}a=a.return}}function mv(s,a,l){var u=s.pingCache;if(u===null){u=s.pingCache=new PO;var p=new Set;u.set(a,p)}else p=u.get(a),p===void 0&&(p=new Set,u.set(a,p));p.has(l)||(av=!0,p.add(l),s=UO.bind(null,s,a,l),a.then(s,s))}function UO(s,a,l){var u=s.pingCache;u!==null&&u.delete(a),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Tt===s&&(Qe&l)===l&&($t===4||$t===3&&(Qe&62914560)===Qe&&300>qt()-ip?(ht&2)===0&&Hc(s,0):ov|=l,qc===Qe&&(qc=0)),ir(s)}function yS(s,a){a===0&&(a=Qo()),s=ol(s,a),s!==null&&($s(s,a),ir(s))}function FO(s){var a=s.memoizedState,l=0;a!==null&&(l=a.retryLane),yS(s,l)}function BO(s,a){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,p=s.memoizedState;p!==null&&(l=p.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(a),yS(s,l)}function zO(s,a){return is(s,a)}var up=null,$c=null,pv=!1,hp=!1,gv=!1,Ya=0;function ir(s){s!==$c&&s.next===null&&($c===null?up=$c=s:$c=$c.next=s),hp=!0,pv||(pv=!0,GO())}function Xh(s,a){if(!gv&&hp){gv=!0;do for(var l=!1,u=up;u!==null;){if(s!==0){var p=u.pendingLanes;if(p===0)var g=0;else{var E=u.suspendedLanes,S=u.pingedLanes;g=(1<<31-gn(42|s)+1)-1,g&=p&~(E&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,bS(u,g))}else g=Qe,g=fi(u,u===Tt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Ks(u,g)||(l=!0,bS(u,g));u=u.next}while(l);gv=!1}}function qO(){vS()}function vS(){hp=pv=!1;var s=0;Ya!==0&&eP()&&(s=Ya);for(var a=qt(),l=null,u=up;u!==null;){var p=u.next,g=wS(u,a);g===0?(u.next=null,l===null?up=p:l.next=p,p===null&&($c=l)):(l=u,(s!==0||(g&3)!==0)&&(hp=!0)),u=p}yn!==0&&yn!==5||Xh(s),Ya!==0&&(Ya=0)}function wS(s,a){for(var l=s.suspendedLanes,u=s.pingedLanes,p=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var E=31-gn(g),S=1<<E,k=p[E];k===-1?((S&l)===0||(S&u)!==0)&&(p[E]=wa(S,a)):k<=a&&(s.expiredLanes|=S),g&=~S}if(a=Tt,l=Qe,l=fi(s,s===a?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===a&&(pt===2||pt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Cr(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Ks(s,l)){if(a=l&-l,a===s.callbackPriority)return a;switch(u!==null&&Cr(u),Ea(l)){case 2:case 8:l=yt;break;case 32:l=xs;break;case 268435456:l=Xn;break;default:l=xs}return u=ES.bind(null,s),l=is(l,u),s.callbackPriority=a,s.callbackNode=l,a}return u!==null&&u!==null&&Cr(u),s.callbackPriority=2,s.callbackNode=null,2}function ES(s,a){if(yn!==0&&yn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(cp()&&s.callbackNode!==l)return null;var u=Qe;return u=fi(s,s===Tt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(nS(s,u,a),wS(s,qt()),s.callbackNode!=null&&s.callbackNode===l?ES.bind(null,s):null)}function bS(s,a){if(cp())return null;nS(s,a,!0)}function GO(){nP(function(){(ht&6)!==0?is(tt,qO):vS()})}function _v(){if(Ya===0){var s=kc;s===0&&(s=Hs,Hs<<=1,(Hs&261888)===0&&(Hs=256)),Ya=s}return Ya}function TS(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Xs(""+s)}function IS(s,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,s.id&&l.setAttribute("form",s.id),a.parentNode.insertBefore(l,a),s=new FormData(s),l.parentNode.removeChild(l),s}function HO(s,a,l,u,p){if(a==="submit"&&l&&l.stateNode===p){var g=TS((p[on]||null).action),E=u.submitter;E&&(a=(a=E[on]||null)?TS(a.formAction):E.getAttribute("formAction"),a!==null&&(g=a,E=null));var S=new el("action","action",null,u,p);s.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ya!==0){var k=E?IS(p,E):new FormData(p);Ly(l,{pending:!0,data:k,method:p.method,action:g},null,k)}}else typeof g=="function"&&(S.preventDefault(),k=E?IS(p,E):new FormData(p),Ly(l,{pending:!0,data:k,method:p.method,action:g},g,k))},currentTarget:p}]})}}for(var yv=0;yv<ey.length;yv++){var vv=ey[yv],KO=vv.toLowerCase(),$O=vv[0].toUpperCase()+vv.slice(1);Ps(KO,"on"+$O)}Ps(tT,"onAnimationEnd"),Ps(nT,"onAnimationIteration"),Ps(iT,"onAnimationStart"),Ps("dblclick","onDoubleClick"),Ps("focusin","onFocus"),Ps("focusout","onBlur"),Ps(cO,"onTransitionRun"),Ps(uO,"onTransitionStart"),Ps(hO,"onTransitionCancel"),Ps(sT,"onTransitionEnd"),Ys("onMouseEnter",["mouseout","mouseover"]),Ys("onMouseLeave",["mouseout","mouseover"]),Ys("onPointerEnter",["pointerout","pointerover"]),Ys("onPointerLeave",["pointerout","pointerover"]),Zn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jh));function SS(s,a){a=(a&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],p=u.event;u=u.listeners;e:{var g=void 0;if(a)for(var E=u.length-1;0<=E;E--){var S=u[E],k=S.instance,Q=S.currentTarget;if(S=S.listener,k!==g&&p.isPropagationStopped())break e;g=S,p.currentTarget=Q;try{g(p)}catch(ne){Am(ne)}p.currentTarget=null,g=k}else for(E=0;E<u.length;E++){if(S=u[E],k=S.instance,Q=S.currentTarget,S=S.listener,k!==g&&p.isPropagationStopped())break e;g=S,p.currentTarget=Q;try{g(p)}catch(ne){Am(ne)}p.currentTarget=null,g=k}}}}function $e(s,a){var l=a[Je];l===void 0&&(l=a[Je]=new Set);var u=s+"__bubble";l.has(u)||(AS(a,s,2,!1),l.add(u))}function wv(s,a,l){var u=0;a&&(u|=4),AS(l,s,u,a)}var dp="_reactListening"+Math.random().toString(36).slice(2);function Ev(s){if(!s[dp]){s[dp]=!0,mc.forEach(function(l){l!=="selectionchange"&&(QO.has(l)||wv(l,!1,s),wv(l,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[dp]||(a[dp]=!0,wv("selectionchange",!1,a))}}function AS(s,a,l,u){switch(tA(a)){case 2:var p=bP;break;case 8:p=TP;break;default:p=Vv}l=p.bind(null,a,l,s),p=void 0,!wh||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(p=!0),u?p!==void 0?s.addEventListener(a,l,{capture:!0,passive:p}):s.addEventListener(a,l,!0):p!==void 0?s.addEventListener(a,l,{passive:p}):s.addEventListener(a,l,!1)}function bv(s,a,l,u,p){var g=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var S=u.stateNode.containerInfo;if(S===p)break;if(E===4)for(E=u.return;E!==null;){var k=E.tag;if((k===3||k===4)&&E.stateNode.containerInfo===p)return;E=E.return}for(;S!==null;){if(E=Hn(S),E===null)return;if(k=E.tag,k===5||k===6||k===26||k===27){u=g=E;continue e}S=S.parentNode}}u=u.return}um(function(){var Q=g,ne=vc(l),se=[];e:{var Y=rT.get(s);if(Y!==void 0){var J=el,we=s;switch(s){case"keypress":if(Zo(l)===0)break e;case"keydown":case"keyup":J=vm;break;case"focusin":we="focus",J=Da;break;case"focusout":we="blur",J=Da;break;case"beforeblur":case"afterblur":J=Da;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=dm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=fm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Em;break;case tT:case nT:case iT:J=bc;break;case sT:J=Tc;break;case"scroll":case"scrollend":J=hm;break;case"wheel":J=Tm;break;case"copy":case"cut":case"paste":J=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Sh;break;case"toggle":case"beforetoggle":J=Oa}var xe=(a&4)!==0,Et=!xe&&(s==="scroll"||s==="scrollend"),q=xe?Y!==null?Y+"Capture":null:Y;xe=[];for(var U=Q,$;U!==null;){var ie=U;if($=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||$===null||q===null||(ie=pi(U,q),ie!=null&&xe.push(Zh(U,ie,$))),Et)break;U=U.return}0<xe.length&&(Y=new J(Y,we,null,l,ne),se.push({event:Y,listeners:xe}))}}if((a&7)===0){e:{if(Y=s==="mouseover"||s==="pointerover",J=s==="mouseout"||s==="pointerout",Y&&l!==yc&&(we=l.relatedTarget||l.fromElement)&&(Hn(we)||we[Le]))break e;if((J||Y)&&(Y=ne.window===ne?ne:(Y=ne.ownerDocument)?Y.defaultView||Y.parentWindow:window,J?(we=l.relatedTarget||l.toElement,J=Q,we=we?Hn(we):null,we!==null&&(Et=o(we),xe=we.tag,we!==Et||xe!==5&&xe!==27&&xe!==6)&&(we=null)):(J=null,we=Q),J!==we)){if(xe=dm,ie="onMouseLeave",q="onMouseEnter",U="mouse",(s==="pointerout"||s==="pointerover")&&(xe=Sh,ie="onPointerLeave",q="onPointerEnter",U="pointer"),Et=J==null?Y:Dr(J),$=we==null?Y:Dr(we),Y=new xe(ie,U+"leave",J,l,ne),Y.target=Et,Y.relatedTarget=$,ie=null,Hn(ne)===Q&&(xe=new xe(q,U+"enter",we,l,ne),xe.target=$,xe.relatedTarget=Et,ie=xe),Et=ie,J&&we)t:{for(xe=WO,q=J,U=we,$=0,ie=q;ie;ie=xe(ie))$++;ie=0;for(var Ae=U;Ae;Ae=xe(Ae))ie++;for(;0<$-ie;)q=xe(q),$--;for(;0<ie-$;)U=xe(U),ie--;for(;$--;){if(q===U||U!==null&&q===U.alternate){xe=q;break t}q=xe(q),U=xe(U)}xe=null}else xe=null;J!==null&&xS(se,Y,J,xe,!1),we!==null&&Et!==null&&xS(se,Et,we,xe,!0)}}e:{if(Y=Q?Dr(Q):window,J=Y.nodeName&&Y.nodeName.toLowerCase(),J==="select"||J==="input"&&Y.type==="file")var lt=Gb;else if(gi(Y))if(Hb)lt=aO;else{lt=sO;var be=iO}else J=Y.nodeName,!J||J.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?Q&&yh(Q.elementType)&&(lt=Gb):lt=rO;if(lt&&(lt=lt(s,Q))){sl(se,lt,l,ne);break e}be&&be(s,Y,Q),s==="focusout"&&Q&&Y.type==="number"&&Q.memoizedProps.value!=null&&_c(Y,"number",Y.value)}switch(be=Q?Dr(Q):window,s){case"focusin":(gi(be)||be.contentEditable==="true")&&(Ic=be,X_=Q,Ch=null);break;case"focusout":Ch=X_=Ic=null;break;case"mousedown":J_=!0;break;case"contextmenu":case"mouseup":case"dragend":J_=!1,Zb(se,l,ne);break;case"selectionchange":if(lO)break;case"keydown":case"keyup":Zb(se,l,ne)}var Fe;if(w)e:{switch(s){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Be?ft(s,l)&&(We="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(We="onCompositionStart");We&&(G&&l.locale!=="ko"&&(Be||We!=="onCompositionStart"?We==="onCompositionEnd"&&Be&&(Fe=xa()):(Ui=ne,wc="value"in Ui?Ui.value:Ui.textContent,Be=!0)),be=fp(Q,We),0<be.length&&(We=new bh(We,s,null,l,ne),se.push({event:We,listeners:be}),Fe?We.data=Fe:(Fe=cn(l),Fe!==null&&(We.data=Fe)))),(Fe=A?Tn(s,l):In(s,l))&&(We=fp(Q,"onBeforeInput"),0<We.length&&(be=new bh("onBeforeInput","beforeinput",null,l,ne),se.push({event:be,listeners:We}),be.data=Fe)),HO(se,s,Q,l,ne)}SS(se,a)})}function Zh(s,a,l){return{instance:s,listener:a,currentTarget:l}}function fp(s,a){for(var l=a+"Capture",u=[];s!==null;){var p=s,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=pi(s,l),p!=null&&u.unshift(Zh(s,p,g)),p=pi(s,a),p!=null&&u.push(Zh(s,p,g))),s.tag===3)return u;s=s.return}return[]}function WO(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function xS(s,a,l,u,p){for(var g=a._reactName,E=[];l!==null&&l!==u;){var S=l,k=S.alternate,Q=S.stateNode;if(S=S.tag,k!==null&&k===u)break;S!==5&&S!==26&&S!==27||Q===null||(k=Q,p?(Q=pi(l,g),Q!=null&&E.unshift(Zh(l,Q,k))):p||(Q=pi(l,g),Q!=null&&E.push(Zh(l,Q,k)))),l=l.return}E.length!==0&&s.push({event:a,listeners:E})}var YO=/\r\n?/g,XO=/\u0000|\uFFFD/g;function CS(s){return(typeof s=="string"?s:""+s).replace(YO,`
`).replace(XO,"")}function RS(s,a){return a=CS(a),CS(s)===a}function wt(s,a,l,u,p,g){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||os(s,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&os(s,""+u);break;case"className":Ia(s,"class",u);break;case"tabIndex":Ia(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ia(s,l,u);break;case"style":lm(s,u,g);break;case"data":if(a!=="object"){Ia(s,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Xs(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(a!=="input"&&wt(s,a,"name",p.name,p,null),wt(s,a,"formEncType",p.formEncType,p,null),wt(s,a,"formMethod",p.formMethod,p,null),wt(s,a,"formTarget",p.formTarget,p,null)):(wt(s,a,"encType",p.encType,p,null),wt(s,a,"method",p.method,p,null),wt(s,a,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Xs(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=bn);break;case"onScroll":u!=null&&$e("scroll",s);break;case"onScrollEnd":u!=null&&$e("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Xs(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":$e("beforetoggle",s),$e("toggle",s),Ta(s,"popover",u);break;case"xlinkActuate":as(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":as(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":as(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":as(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":as(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":as(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":as(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":as(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":as(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ta(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=H_.get(l)||l,Ta(s,l,u))}}function Tv(s,a,l,u,p,g){switch(l){case"style":lm(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?os(s,u):(typeof u=="number"||typeof u=="bigint")&&os(s,""+u);break;case"onScroll":u!=null&&$e("scroll",s);break;case"onScrollEnd":u!=null&&$e("scrollend",s);break;case"onClick":u!=null&&(s.onclick=bn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ba.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),a=l.slice(2,p?l.length-7:void 0),g=s[on]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(a,g,p),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(a,u,p);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Ta(s,l,u)}}}function Un(s,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",s),$e("load",s);var u=!1,p=!1,g;for(g in l)if(l.hasOwnProperty(g)){var E=l[g];if(E!=null)switch(g){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:wt(s,a,g,E,l,null)}}p&&wt(s,a,"srcSet",l.srcSet,l,null),u&&wt(s,a,"src",l.src,l,null);return;case"input":$e("invalid",s);var S=g=E=p=null,k=null,Q=null;for(u in l)if(l.hasOwnProperty(u)){var ne=l[u];if(ne!=null)switch(u){case"name":p=ne;break;case"type":E=ne;break;case"checked":k=ne;break;case"defaultChecked":Q=ne;break;case"value":g=ne;break;case"defaultValue":S=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,a));break;default:wt(s,a,u,ne,l,null)}}Xo(s,g,S,k,Q,E,p,!1);return;case"select":$e("invalid",s),u=E=g=null;for(p in l)if(l.hasOwnProperty(p)&&(S=l[p],S!=null))switch(p){case"value":g=S;break;case"defaultValue":E=S;break;case"multiple":u=S;default:wt(s,a,p,S,l,null)}a=g,l=E,s.multiple=!!u,a!=null?ot(s,!!u,a,!1):l!=null&&ot(s,!!u,l,!0);return;case"textarea":$e("invalid",s),g=p=u=null;for(E in l)if(l.hasOwnProperty(E)&&(S=l[E],S!=null))switch(E){case"value":u=S;break;case"defaultValue":p=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:wt(s,a,E,S,l,null)}Aa(s,u,p,g);return;case"option":for(k in l)if(l.hasOwnProperty(k)&&(u=l[k],u!=null))switch(k){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:wt(s,a,k,u,l,null)}return;case"dialog":$e("beforetoggle",s),$e("toggle",s),$e("cancel",s),$e("close",s);break;case"iframe":case"object":$e("load",s);break;case"video":case"audio":for(u=0;u<Jh.length;u++)$e(Jh[u],s);break;case"image":$e("error",s),$e("load",s);break;case"details":$e("toggle",s);break;case"embed":case"source":case"link":$e("error",s),$e("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in l)if(l.hasOwnProperty(Q)&&(u=l[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:wt(s,a,Q,u,l,null)}return;default:if(yh(a)){for(ne in l)l.hasOwnProperty(ne)&&(u=l[ne],u!==void 0&&Tv(s,a,ne,u,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(u=l[S],u!=null&&wt(s,a,S,u,l,null))}function JO(s,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,E=null,S=null,k=null,Q=null,ne=null;for(J in l){var se=l[J];if(l.hasOwnProperty(J)&&se!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":k=se;default:u.hasOwnProperty(J)||wt(s,a,J,null,u,se)}}for(var Y in u){var J=u[Y];if(se=l[Y],u.hasOwnProperty(Y)&&(J!=null||se!=null))switch(Y){case"type":g=J;break;case"name":p=J;break;case"checked":Q=J;break;case"defaultChecked":ne=J;break;case"value":E=J;break;case"defaultValue":S=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,a));break;default:J!==se&&wt(s,a,Y,J,u,se)}}Sa(s,E,S,k,Q,ne,g,p);return;case"select":J=E=S=Y=null;for(g in l)if(k=l[g],l.hasOwnProperty(g)&&k!=null)switch(g){case"value":break;case"multiple":J=k;default:u.hasOwnProperty(g)||wt(s,a,g,null,u,k)}for(p in u)if(g=u[p],k=l[p],u.hasOwnProperty(p)&&(g!=null||k!=null))switch(p){case"value":Y=g;break;case"defaultValue":S=g;break;case"multiple":E=g;default:g!==k&&wt(s,a,p,g,u,k)}a=S,l=E,u=J,Y!=null?ot(s,!!l,Y,!1):!!u!=!!l&&(a!=null?ot(s,!!l,a,!0):ot(s,!!l,l?[]:"",!1));return;case"textarea":J=Y=null;for(S in l)if(p=l[S],l.hasOwnProperty(S)&&p!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:wt(s,a,S,null,u,p)}for(E in u)if(p=u[E],g=l[E],u.hasOwnProperty(E)&&(p!=null||g!=null))switch(E){case"value":Y=p;break;case"defaultValue":J=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==g&&wt(s,a,E,p,u,g)}Jo(s,Y,J);return;case"option":for(var we in l)if(Y=l[we],l.hasOwnProperty(we)&&Y!=null&&!u.hasOwnProperty(we))switch(we){case"selected":s.selected=!1;break;default:wt(s,a,we,null,u,Y)}for(k in u)if(Y=u[k],J=l[k],u.hasOwnProperty(k)&&Y!==J&&(Y!=null||J!=null))switch(k){case"selected":s.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:wt(s,a,k,Y,u,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xe in l)Y=l[xe],l.hasOwnProperty(xe)&&Y!=null&&!u.hasOwnProperty(xe)&&wt(s,a,xe,null,u,Y);for(Q in u)if(Y=u[Q],J=l[Q],u.hasOwnProperty(Q)&&Y!==J&&(Y!=null||J!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(i(137,a));break;default:wt(s,a,Q,Y,u,J)}return;default:if(yh(a)){for(var Et in l)Y=l[Et],l.hasOwnProperty(Et)&&Y!==void 0&&!u.hasOwnProperty(Et)&&Tv(s,a,Et,void 0,u,Y);for(ne in u)Y=u[ne],J=l[ne],!u.hasOwnProperty(ne)||Y===J||Y===void 0&&J===void 0||Tv(s,a,ne,Y,u,J);return}}for(var q in l)Y=l[q],l.hasOwnProperty(q)&&Y!=null&&!u.hasOwnProperty(q)&&wt(s,a,q,null,u,Y);for(se in u)Y=u[se],J=l[se],!u.hasOwnProperty(se)||Y===J||Y==null&&J==null||wt(s,a,se,Y,u,J)}function NS(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ZO(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var p=l[u],g=p.transferSize,E=p.initiatorType,S=p.duration;if(g&&S&&NS(E)){for(E=0,S=p.responseEnd,u+=1;u<l.length;u++){var k=l[u],Q=k.startTime;if(Q>S)break;var ne=k.transferSize,se=k.initiatorType;ne&&NS(se)&&(k=k.responseEnd,E+=ne*(k<S?1:(S-Q)/(k-Q)))}if(--u,a+=8*(g+E)/(p.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Iv=null,Sv=null;function mp(s){return s.nodeType===9?s:s.ownerDocument}function DS(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function kS(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function Av(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var xv=null;function eP(){var s=window.event;return s&&s.type==="popstate"?s===xv?!1:(xv=s,!0):(xv=null,!1)}var OS=typeof setTimeout=="function"?setTimeout:void 0,tP=typeof clearTimeout=="function"?clearTimeout:void 0,PS=typeof Promise=="function"?Promise:void 0,nP=typeof queueMicrotask=="function"?queueMicrotask:typeof PS<"u"?function(s){return PS.resolve(null).then(s).catch(iP)}:OS;function iP(s){setTimeout(function(){throw s})}function Xa(s){return s==="head"}function MS(s,a){var l=a,u=0;do{var p=l.nextSibling;if(s.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(p),Xc(a);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")ed(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,ed(l);for(var g=l.firstChild;g;){var E=g.nextSibling,S=g.nodeName;g[ss]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=E}}else l==="body"&&ed(s.ownerDocument.body);l=p}while(l);Xc(a)}function VS(s,a){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function Cv(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Cv(l),rs(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function sP(s,a,l,u){for(;s.nodeType===1;){var p=l;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[ss])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==p.rel||s.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||s.getAttribute("title")!==(p.title==null?null:p.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(p.src==null?null:p.src)||s.getAttribute("type")!==(p.type==null?null:p.type)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=ms(s.nextSibling),s===null)break}return null}function rP(s,a,l){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=ms(s.nextSibling),s===null))return null;return s}function LS(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ms(s.nextSibling),s===null))return null;return s}function Rv(s){return s.data==="$?"||s.data==="$~"}function Nv(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function aP(s,a){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||l.readyState!=="loading")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function ms(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var Dv=null;function jS(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(a===0)return ms(s.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}s=s.nextSibling}return null}function US(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return s;a--}else l!=="/$"&&l!=="/&"||a++}s=s.previousSibling}return null}function FS(s,a,l){switch(a=mp(l),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function ed(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);rs(s)}var ps=new Map,BS=new Set;function pp(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Xr=de.d;de.d={f:oP,r:lP,D:cP,C:uP,L:hP,m:dP,X:mP,S:fP,M:pP};function oP(){var s=Xr.f(),a=ap();return s||a}function lP(s){var a=mi(s);a!==null&&a.tag===5&&a.type==="form"?sI(a):Xr.r(s)}var Qc=typeof document>"u"?null:document;function zS(s,a,l){var u=Qc;if(u&&typeof a=="string"&&a){var p=Ht(a);p='link[rel="'+s+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),BS.has(p)||(BS.add(p),s={rel:s,crossOrigin:l,href:a},u.querySelector(p)===null&&(a=u.createElement("link"),Un(a,"link",s),en(a),u.head.appendChild(a)))}}function cP(s){Xr.D(s),zS("dns-prefetch",s,null)}function uP(s,a){Xr.C(s,a),zS("preconnect",s,a)}function hP(s,a,l){Xr.L(s,a,l);var u=Qc;if(u&&s&&a){var p='link[rel="preload"][as="'+Ht(a)+'"]';a==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+Ht(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+Ht(l.imageSizes)+'"]')):p+='[href="'+Ht(s)+'"]';var g=p;switch(a){case"style":g=Wc(s);break;case"script":g=Yc(s)}ps.has(g)||(s=y({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:s,as:a},l),ps.set(g,s),u.querySelector(p)!==null||a==="style"&&u.querySelector(td(g))||a==="script"&&u.querySelector(nd(g))||(a=u.createElement("link"),Un(a,"link",s),en(a),u.head.appendChild(a)))}}function dP(s,a){Xr.m(s,a);var l=Qc;if(l&&s){var u=a&&typeof a.as=="string"?a.as:"script",p='link[rel="modulepreload"][as="'+Ht(u)+'"][href="'+Ht(s)+'"]',g=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Yc(s)}if(!ps.has(g)&&(s=y({rel:"modulepreload",href:s},a),ps.set(g,s),l.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(nd(g)))return}u=l.createElement("link"),Un(u,"link",s),en(u),l.head.appendChild(u)}}}function fP(s,a,l){Xr.S(s,a,l);var u=Qc;if(u&&s){var p=Li(u).hoistableStyles,g=Wc(s);a=a||"default";var E=p.get(g);if(!E){var S={loading:0,preload:null};if(E=u.querySelector(td(g)))S.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":a},l),(l=ps.get(g))&&kv(s,l);var k=E=u.createElement("link");en(k),Un(k,"link",s),k._p=new Promise(function(Q,ne){k.onload=Q,k.onerror=ne}),k.addEventListener("load",function(){S.loading|=1}),k.addEventListener("error",function(){S.loading|=2}),S.loading|=4,gp(E,a,u)}E={type:"stylesheet",instance:E,count:1,state:S},p.set(g,E)}}}function mP(s,a){Xr.X(s,a);var l=Qc;if(l&&s){var u=Li(l).hoistableScripts,p=Yc(s),g=u.get(p);g||(g=l.querySelector(nd(p)),g||(s=y({src:s,async:!0},a),(a=ps.get(p))&&Ov(s,a),g=l.createElement("script"),en(g),Un(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function pP(s,a){Xr.M(s,a);var l=Qc;if(l&&s){var u=Li(l).hoistableScripts,p=Yc(s),g=u.get(p);g||(g=l.querySelector(nd(p)),g||(s=y({src:s,async:!0,type:"module"},a),(a=ps.get(p))&&Ov(s,a),g=l.createElement("script"),en(g),Un(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(p,g))}}function qS(s,a,l,u){var p=(p=ke.current)?pp(p):null;if(!p)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Wc(l.href),l=Li(p).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Wc(l.href);var g=Li(p).hoistableStyles,E=g.get(s);if(E||(p=p.ownerDocument||p,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,E),(g=p.querySelector(td(s)))&&!g._p&&(E.instance=g,E.state.loading=5),ps.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ps.set(s,l),g||gP(p,s,l,E.state))),a&&u===null)throw Error(i(528,""));return E}if(a&&u!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Yc(l),l=Li(p).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Wc(s){return'href="'+Ht(s)+'"'}function td(s){return'link[rel="stylesheet"]['+s+"]"}function GS(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function gP(s,a,l,u){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=s.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),Un(a,"link",l),en(a),s.head.appendChild(a))}function Yc(s){return'[src="'+Ht(s)+'"]'}function nd(s){return"script[async]"+s}function HS(s,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=s.querySelector('style[data-href~="'+Ht(l.href)+'"]');if(u)return a.instance=u,en(u),u;var p=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),en(u),Un(u,"style",p),gp(u,l.precedence,s),a.instance=u;case"stylesheet":p=Wc(l.href);var g=s.querySelector(td(p));if(g)return a.state.loading|=4,a.instance=g,en(g),g;u=GS(l),(p=ps.get(p))&&kv(u,p),g=(s.ownerDocument||s).createElement("link"),en(g);var E=g;return E._p=new Promise(function(S,k){E.onload=S,E.onerror=k}),Un(g,"link",u),a.state.loading|=4,gp(g,l.precedence,s),a.instance=g;case"script":return g=Yc(l.src),(p=s.querySelector(nd(g)))?(a.instance=p,en(p),p):(u=l,(p=ps.get(g))&&(u=y({},l),Ov(u,p)),s=s.ownerDocument||s,p=s.createElement("script"),en(p),Un(p,"link",u),s.head.appendChild(p),a.instance=p);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,gp(u,l.precedence,s));return a.instance}function gp(s,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,g=p,E=0;E<u.length;E++){var S=u[E];if(S.dataset.precedence===a)g=S;else if(g!==p)break}g?g.parentNode.insertBefore(s,g.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(s,a.firstChild))}function kv(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function Ov(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var _p=null;function KS(s,a,l){if(_p===null){var u=new Map,p=_p=new Map;p.set(l,u)}else p=_p,u=p.get(l),u||(u=new Map,p.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),p=0;p<l.length;p++){var g=l[p];if(!(g[ss]||g[Ct]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var E=g.getAttribute(a)||"";E=s+E;var S=u.get(E);S?S.push(g):u.set(E,[g])}}return u}function $S(s,a,l){s=s.ownerDocument||s,s.head.insertBefore(l,a==="title"?s.querySelector("head > title"):null)}function _P(s,a,l){if(l===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function QS(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function yP(s,a,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var p=Wc(u.href),g=a.querySelector(td(p));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=yp.bind(s),a.then(s,s)),l.state.loading|=4,l.instance=g,en(g);return}g=a.ownerDocument||a,u=GS(u),(p=ps.get(p))&&kv(u,p),g=g.createElement("link"),en(g);var E=g;E._p=new Promise(function(S,k){E.onload=S,E.onerror=k}),Un(g,"link",u),l.instance=g}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=yp.bind(s),a.addEventListener("load",l),a.addEventListener("error",l))}}var Pv=0;function vP(s,a){return s.stylesheets&&s.count===0&&wp(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&wp(s,s.stylesheets),s.unsuspend){var g=s.unsuspend;s.unsuspend=null,g()}},6e4+a);0<s.imgBytes&&Pv===0&&(Pv=62500*ZO());var p=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&wp(s,s.stylesheets),s.unsuspend)){var g=s.unsuspend;s.unsuspend=null,g()}},(s.imgBytes>Pv?50:800)+a);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function yp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)wp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var vp=null;function wp(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,vp=new Map,a.forEach(wP,s),vp=null,yp.call(s))}function wP(s,a){if(!(a.state.loading&4)){var l=vp.get(s);if(l)var u=l.get(null);else{l=new Map,vp.set(s,l);for(var p=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var E=p[g];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(l.set(E.dataset.precedence,E),u=E)}u&&l.set(null,u)}p=a.instance,E=p.getAttribute("data-precedence"),g=l.get(E)||u,g===u&&l.set(null,p),l.set(E,p),this.count++,u=yp.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),g?g.parentNode.insertBefore(p,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(p,s.firstChild)),a.state.loading|=4}}var id={$$typeof:X,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function EP(s,a,l,u,p,g,E,S,k){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Rs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rs(0),this.hiddenUpdates=Rs(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function WS(s,a,l,u,p,g,E,S,k,Q,ne,se){return s=new EP(s,a,l,E,k,Q,ne,se,S),a=1,g===!0&&(a|=24),g=Bi(3,null,null,a),s.current=g,g.stateNode=s,a=fy(),a.refCount++,s.pooledCache=a,a.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:a},_y(g),s}function YS(s){return s?(s=xc,s):xc}function XS(s,a,l,u,p,g){p=YS(p),u.context===null?u.context=p:u.pendingContext=p,u=Fa(a),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=Ba(s,u,a),l!==null&&(Ei(l,s,a),Mh(l,s,a))}function JS(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<a?l:a}}function Mv(s,a){JS(s,a),(s=s.alternate)&&JS(s,a)}function ZS(s){if(s.tag===13||s.tag===31){var a=ol(s,67108864);a!==null&&Ei(a,s,67108864),Mv(s,67108864)}}function eA(s){if(s.tag===13||s.tag===31){var a=Ki();a=Yo(a);var l=ol(s,a);l!==null&&Ei(l,s,a),Mv(s,a)}}var Ep=!0;function bP(s,a,l,u){var p=te.T;te.T=null;var g=de.p;try{de.p=2,Vv(s,a,l,u)}finally{de.p=g,te.T=p}}function TP(s,a,l,u){var p=te.T;te.T=null;var g=de.p;try{de.p=8,Vv(s,a,l,u)}finally{de.p=g,te.T=p}}function Vv(s,a,l,u){if(Ep){var p=Lv(u);if(p===null)bv(s,a,u,bp,l),nA(s,u);else if(SP(p,s,a,l,u))u.stopPropagation();else if(nA(s,u),a&4&&-1<IP.indexOf(s)){for(;p!==null;){var g=mi(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var E=di(g.pendingLanes);if(E!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;E;){var k=1<<31-gn(E);S.entanglements[1]|=k,E&=~k}ir(g),(ht&6)===0&&(sp=qt()+500,Xh(0))}}break;case 31:case 13:S=ol(g,2),S!==null&&Ei(S,g,2),ap(),Mv(g,2)}if(g=Lv(u),g===null&&bv(s,a,u,bp,l),g===p)break;p=g}p!==null&&u.stopPropagation()}else bv(s,a,u,null,l)}}function Lv(s){return s=vc(s),jv(s)}var bp=null;function jv(s){if(bp=null,s=Hn(s),s!==null){var a=o(s);if(a===null)s=null;else{var l=a.tag;if(l===13){if(s=c(a),s!==null)return s;s=null}else if(l===31){if(s=h(a),s!==null)return s;s=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return bp=s,null}function tA(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pi()){case tt:return 2;case yt:return 8;case xs:case Cs:return 32;case Xn:return 268435456;default:return 32}default:return 32}}var Uv=!1,Ja=null,Za=null,eo=null,sd=new Map,rd=new Map,to=[],IP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nA(s,a){switch(s){case"focusin":case"focusout":Ja=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":sd.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":rd.delete(a.pointerId)}}function ad(s,a,l,u,p,g){return s===null||s.nativeEvent!==g?(s={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[p]},a!==null&&(a=mi(a),a!==null&&ZS(a)),s):(s.eventSystemFlags|=u,a=s.targetContainers,p!==null&&a.indexOf(p)===-1&&a.push(p),s)}function SP(s,a,l,u,p){switch(a){case"focusin":return Ja=ad(Ja,s,a,l,u,p),!0;case"dragenter":return Za=ad(Za,s,a,l,u,p),!0;case"mouseover":return eo=ad(eo,s,a,l,u,p),!0;case"pointerover":var g=p.pointerId;return sd.set(g,ad(sd.get(g)||null,s,a,l,u,p)),!0;case"gotpointercapture":return g=p.pointerId,rd.set(g,ad(rd.get(g)||null,s,a,l,u,p)),!0}return!1}function iA(s){var a=Hn(s.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){s.blockedOn=a,fc(s.priority,function(){eA(l)});return}}else if(a===31){if(a=h(l),a!==null){s.blockedOn=a,fc(s.priority,function(){eA(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Tp(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var l=Lv(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);yc=u,l.target.dispatchEvent(u),yc=null}else return a=mi(l),a!==null&&ZS(a),s.blockedOn=l,!1;a.shift()}return!0}function sA(s,a,l){Tp(s)&&l.delete(a)}function AP(){Uv=!1,Ja!==null&&Tp(Ja)&&(Ja=null),Za!==null&&Tp(Za)&&(Za=null),eo!==null&&Tp(eo)&&(eo=null),sd.forEach(sA),rd.forEach(sA)}function Ip(s,a){s.blockedOn===a&&(s.blockedOn=null,Uv||(Uv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,AP)))}var Sp=null;function rA(s){Sp!==s&&(Sp=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Sp===s&&(Sp=null);for(var a=0;a<s.length;a+=3){var l=s[a],u=s[a+1],p=s[a+2];if(typeof u!="function"){if(jv(u||l)===null)continue;break}var g=mi(l);g!==null&&(s.splice(a,3),a-=3,Ly(g,{pending:!0,data:p,method:l.method,action:u},u,p))}}))}function Xc(s){function a(k){return Ip(k,s)}Ja!==null&&Ip(Ja,s),Za!==null&&Ip(Za,s),eo!==null&&Ip(eo,s),sd.forEach(a),rd.forEach(a);for(var l=0;l<to.length;l++){var u=to[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<to.length&&(l=to[0],l.blockedOn===null);)iA(l),l.blockedOn===null&&to.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var p=l[u],g=l[u+1],E=p[on]||null;if(typeof g=="function")E||rA(l);else if(E){var S=null;if(g&&g.hasAttribute("formAction")){if(p=g,E=g[on]||null)S=E.formAction;else if(jv(p)!==null)continue}else S=E.action;typeof S=="function"?l[u+1]=S:(l.splice(u,3),u-=3),rA(l)}}}function aA(){function s(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(E){return p=E})},focusReset:"manual",scroll:"manual"})}function a(){p!==null&&(p(),p=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),p!==null&&(p(),p=null)}}}function Fv(s){this._internalRoot=s}Ap.prototype.render=Fv.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,u=Ki();XS(l,u,s,a,null,null)},Ap.prototype.unmount=Fv.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;XS(s.current,2,null,s,null,null),ap(),a[Le]=null}};function Ap(s){this._internalRoot=s}Ap.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ds();s={blockedOn:null,target:s,priority:a};for(var l=0;l<to.length&&a!==0&&a<to[l].priority;l++);to.splice(l,0,s),l===0&&iA(s)}};var oA=e.version;if(oA!=="19.2.0")throw Error(i(527,oA,"19.2.0"));de.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(a),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var xP={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xp.isDisabled&&xp.supportsFiber)try{Gs=xp.inject(xP),an=xp}catch{}}return ld.createRoot=function(s,a){if(!r(s))throw Error(i(299));var l=!1,u="",p=mI,g=pI,E=gI;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),a=WS(s,1,!1,null,null,l,u,null,p,g,E,aA),s[Le]=a.current,Ev(s),new Fv(a)},ld.hydrateRoot=function(s,a,l){if(!r(s))throw Error(i(299));var u=!1,p="",g=mI,E=pI,S=gI,k=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.formState!==void 0&&(k=l.formState)),a=WS(s,1,!0,a,l??null,u,p,k,g,E,S,aA),a.context=YS(null),l=a.current,u=Ki(),u=Yo(u),p=Fa(u),p.callback=null,Ba(l,p,u),l=u,a.current.lanes=l,$s(a,l),ir(a),s[Le]=a.current,Ev(s),new Ap(a)},ld.version="19.2.0",ld}var _A;function LP(){if(_A)return qv.exports;_A=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qv.exports=VP(),qv.exports}var jP=LP();const UP=u1(jP),it=15,si=5,vu=900,fo=180,h1={win:50,draw:20,loss:10},d1={win:30,draw:10,loss:5},ar=n=>100+(n-1)*50,Cp=[{name:"Sắt",tiers:3,baseCp:0,icon:"🛡️"},{name:"Đồng",tiers:3,baseCp:300,icon:"🥉"},{name:"Bạc",tiers:3,baseCp:600,icon:"🥈"},{name:"Vàng",tiers:3,baseCp:900,icon:"🥇"},{name:"Kim Cương",tiers:3,baseCp:1200,icon:"💎"},{name:"Cao Thủ",tiers:3,baseCp:1500,icon:"👑"},{name:"Thách Đấu",tiers:0,baseCp:1800,icon:"🔥"}],FP=n=>{const e=Number.isFinite(n)?Math.max(0,n):0;let t=Cp[0];for(let d=Cp.length-1;d>=0;d--)if(e>=Cp[d].baseCp){t=Cp[d];break}if(t.name==="Thách Đấu")return{name:"Thách Đấu",cpInTier:e,icon:t.icon};const i=e-t.baseCp,r=100,o=t.tiers-Math.floor(i/r),c=i%r,h={3:"III",2:"II",1:"I"}[o]||"I";return{name:`${t.name} ${h}`,cpInTier:c,icon:t.icon}},BP=(n,e,t)=>{const r=t==="win"?1:t==="draw"?.5:0,o=1/(1+Math.pow(10,(e-n)/400)),c=40*(r-o);return t==="win"?Math.max(1,Math.round(c)):t==="loss"?Math.min(-1,Math.round(c)):Math.round(c)},zP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M17.2,3H6.8l-5.2,9l5.2,9h10.4l5.2-9L17.2,3z"})}),qP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12,2L1,21h22L12,2z"})}),GP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),HP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.03-3.58 2.37-6.53 5.5-7.65L8.5 3.5C4.73 4.83 2 8.57 2 13zm18 0c0-4.43-3.27-8.17-7.5-9.5L11.5 5.35c3.13 1.12 5.47 4.07 5.5 7.65h2zM12 5V3c4.42 0 8 3.58 8 8h-2c0-3.31-2.69-6-6-6zm0 14v2c-4.42 0-8-3.58-8-8h2c0 3.31 2.69 6 6 6z"})}),KP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.5 13c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-4-4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-4 4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-1-6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"})}),$P=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C8.69 2 6 4.69 6 8v6c0 1.1.9 2 2 2h2v4h4v-4h2c1.1 0 2-.9 2-2V8c0-3.31-2.69-6-6-6zm-2 10c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm4 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})}),QP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v5.5l3.5 3.5-1.42 1.42L11 13.41V7z"})}),WP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:v.jsx("circle",{cx:"50",cy:"50",r:"40",stroke:"currentColor",strokeWidth:"12"})}),YP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:v.jsx("path",{d:"M10 10 L90 90 M90 10 L10 90",stroke:"currentColor",strokeWidth:"12",strokeLinecap:"round"})}),XP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2 L2 12 L12 22 L22 12 Z"})}),JP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),ZP=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),eM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"})}),tM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M7 2v11h3v9l7-12h-4l4-8z"})}),nM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.53c-.25.58-.56 1.12-.9 1.6l-2.8-2.81c.81-.43 1.51-1.03 2-1.79.49-.76.79-1.68.8-2.65.01-.98-.24-1.92-.7-2.75l1.45-1.45C18.53 7.8 19 9.83 19 12c0 2.21-.81 4.24-2.1 5.86v.01z"})}),iM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 14.17l-3.17-3.17 1.41-1.41 1.76 1.76V7h2v6.17l1.76-1.76 1.41 1.41L13 16.17z"})}),sM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"})}),rM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M3 3v18h18V3H3zm16 16H5V5h14v14z"})}),aM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11.5 4c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-4.09-2.7-7.54-6.42-8.62C13.43 4.12 12.5 4 11.5 4z"})}),oM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-14h2v4h3v2h-3v4h-2v-4H8v-2h3V6z"})}),lM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M19 8h-1.81c-.45-1.73-1.98-3-3.88-3s-3.43 1.27-3.88 3H7.69l-1.63 4.9A2 2 0 0 0 8 15h8a2 2 0 0 0 1.94-2.1L16.31 8h1.88c.55 0 1-.45 1-1s-.45-1-1-1zm-7 8c-1.66 0-3-1.34-3-3h6c0 1.66-1.34 3-3 3z"})}),cM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5z"})}),uM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C21.27 7.61 17 4.5 12 4.5zm0 13c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"})}),hM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M13.5 1.5c-3.1 0-5.4 2.3-5.4 5.4 0 2 .9 3.7 2.3 4.7-1.3 1.1-2.2 2.7-2.2 4.5 0 3.2 2.6 5.8 5.8 5.8s5.8-2.6 5.8-5.8c0-1.9-.9-3.5-2.2-4.5 1.4-1 2.3-2.7 2.3-4.7 0-3.1-2.3-5.4-5.4-5.4z"})}),dM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:v.jsx("path",{d:"M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6z"})}),fM=({className:n})=>v.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:v.jsx("path",{d:"M1,9 L5,5 L9,9 L13,5 L17,9 L21,5 L23,7 L19,11 L23,15 L21,17 L17,13 L13,17 L9,13 L5,17 L1,13 L5,9 M9,11 A2,2 0 1,1 9,10.99"})}),mM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(25)].map((n,e)=>v.jsx("div",{className:"absolute text-cyan-200/50",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.8+Math.random()*1.2}rem`,animationName:"snowfall, sway",animationDuration:`${10+Math.random()*10}s, ${4+Math.random()*4}s`,animationDelay:`${Math.random()*15}s, ${Math.random()*4}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*80}px`},children:"❄"},e))}),v.jsx("style",{children:`
            @keyframes snowfall {
                from {
                    transform: translateY(0vh) rotate(0deg);
                    opacity: 1;
                }
                to {
                    transform: translateY(105vh) rotate(720deg);
                    opacity: 0;
                }
            }
             @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),pM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0 opacity-20 animate-scanlines"}),v.jsx("style",{children:`
            @keyframes scanlines {
                0% { background-position: 0 0; }
                100% { background-position: 0 50px; }
            }
            .animate-scanlines {
                background: linear-gradient(to bottom, transparent 0%, transparent 50%, rgba(24, 24, 27, 0.5) 50%, rgba(24, 24, 27, 0.5) 100%);
                background-size: 100% 4px;
                animation: scanlines 0.5s linear infinite;
            }
        `})]})),gM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(15)].map((n,e)=>v.jsx("div",{className:"absolute text-pink-400/50",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,fontSize:`${.5+Math.random()*1}rem`,animationName:"glint, drift",animationDelay:`${Math.random()*8}s`,animationDuration:`${4+Math.random()*4}s, ${4+Math.random()*4}s`,animationTimingFunction:"ease-in-out, linear",animationIterationCount:"infinite, infinite"},children:"✦"},e))}),v.jsx("style",{children:`
            @keyframes glint {
                0%, 100% { transform: scale(0.8); opacity: 0; }
                50% { transform: scale(1.5); opacity: 1; }
                75% { transform: scale(1.2); opacity: 0.8; }
            }
            @keyframes drift {
                from { transform: translateY(0); }
                to { transform: translateY(-80px); opacity: 0; }
            }
        `})]})),_M=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(12)].map((n,e)=>v.jsx("div",{className:"absolute text-orange-400/50",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${1+Math.random()*1.5}rem`,animationName:"fall, sway",animationDuration:`${7+Math.random()*8}s, ${4+Math.random()*5}s`,animationDelay:`${Math.random()*10}s, ${Math.random()*5}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*150}px`},children:Math.random()>.5?"🍁":"🍂"},e))}),v.jsx("style",{children:`
            @keyframes fall {
                to {
                    transform: translateY(105vh) rotate(720deg);
                    opacity: 0;
                }
            }
            @keyframes sway {
                0%, 100% { margin-left: 0px; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),yM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(15)].map((n,e)=>v.jsx("div",{className:"absolute text-pink-200/60",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.8+Math.random()*1.2}rem`,animationName:"fall, sway",animationDuration:`${8+Math.random()*7}s, ${5+Math.random()*5}s`,animationDelay:`${Math.random()*12}s, ${Math.random()*5}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*120}px`},children:"🌸"},e))}),v.jsx("style",{children:`
            @keyframes fall {
                to { transform: translateY(105vh) rotate(720deg); opacity: 0; }
            }
            @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),vM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"absolute -top-24 -right-24 w-96 h-96 pointer-events-none z-0",children:[v.jsx("div",{className:"absolute inset-0 bg-yellow-300 rounded-full blur-3xl animate-pulse-slow opacity-10"}),v.jsx("div",{className:"absolute inset-10 bg-yellow-200 rounded-full blur-2xl animate-pulse-slow opacity-20"})]}),v.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[[...Array(3)].map((n,e)=>v.jsx("div",{className:"absolute h-[150%] w-[150%]",style:{top:"-25%",right:"-25%",background:"linear-gradient(225deg, rgba(253, 224, 71, 0.08), rgba(253, 224, 71, 0))",transformOrigin:"top right",animation:`god-ray-pulse 8s ease-in-out infinite ${e*2.5}s`}},e)),[...Array(30)].map((n,e)=>v.jsx("div",{className:"absolute w-0.5 h-12 bg-gradient-to-b from-cyan-200/0 to-cyan-200/30",style:{top:"-20%",left:`${Math.random()*100}%`,animation:`rain-fall ${.5+Math.random()*.5}s linear infinite`,animationDelay:`${Math.random()*5}s`}},e))]}),v.jsx("style",{children:`
            @keyframes pulse-slow { 50% { opacity: 0.4; transform: scale(1.05); } }
            .animate-pulse-slow { animation: pulse-slow 10s ease-in-out infinite; }
            @keyframes god-ray-pulse {
                0%, 100% { opacity: 0; transform: rotate(15deg); }
                50% { opacity: 0.6; transform: rotate(20deg); }
            }
            @keyframes rain-fall {
                from { transform: translateY(0vh); }
                to { transform: translateY(120vh); }
            }
        `})]})),wM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(40)].map((n,e)=>v.jsx("div",{className:"absolute text-blue-200/60",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.6+Math.random()*1}rem`,animationName:"snowfall, sway",animationDuration:`${8+Math.random()*8}s, ${3+Math.random()*4}s`,animationDelay:`${Math.random()*12}s, ${Math.random()*4}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*120}px`},children:Math.random()>.3?"❄":"•"},e))}),v.jsx("style",{children:`
            @keyframes snowfall {
                from {
                    transform: translateY(0vh) rotate(0deg);
                    opacity: 1;
                }
                to {
                    transform: translateY(105vh) rotate(360deg);
                    opacity: 0;
                }
            }
             @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),EM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[[...Array(60)].map((n,e)=>v.jsx("div",{className:"absolute w-0.5 h-0.5 bg-white rounded-full animate-twinkle",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*10}s`,animationDuration:`${2+Math.random()*3}s`,opacity:Math.random()*.5+.2}},`star-${e}`)),[...Array(3)].map((n,e)=>v.jsx("div",{className:"absolute h-0.5 w-24 bg-gradient-to-l from-white/50 to-transparent animate-shooting-star",style:{top:`${Math.random()*60-10}%`,left:`${Math.random()*60+50}%`,animationDelay:`${3+Math.random()*12}s`,animationDuration:`${1.5+Math.random()*1}s`}},`shooting-star-${e}`))]}),v.jsx("style",{children:`
            @keyframes twinkle {
                0%, 100% { opacity: 0.2; transform: scale(0.8); }
                50% { opacity: 1; transform: scale(1.2); filter: drop-shadow(0 0 3px white); }
            }
            .animate-twinkle { animation: twinkle ease-in-out infinite; }

            @keyframes shooting-star {
                from {
                    transform: rotate(135deg) translateX(0);
                    opacity: 1;
                }
                to {
                    transform: rotate(135deg) translateX(150vmin);
                    opacity: 0;
                }
            }
            .animate-shooting-star { animation: shooting-star linear infinite; }
        `})]})),bM=Di.memo(()=>v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/3 bg-gradient-to-t from-orange-900/40 to-transparent pointer-events-none z-0 animate-pulse-slow"}),v.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(25)].map((n,e)=>v.jsx("div",{className:"absolute rounded-full",style:{bottom:"-5%",left:`${Math.random()*100}%`,width:`${2+Math.random()*3}px`,height:`${2+Math.random()*3}px`,backgroundColor:`rgba(251, 146, 60, ${.5+Math.random()*.5})`,boxShadow:"0 0 6px 3px #f97316, 0 0 12px 6px #ef4444",animationName:"emberRise, emberWobble",animationDuration:`${4+Math.random()*6}s, ${3+Math.random()*3}s`,animationDelay:`${Math.random()*8}s, ${Math.random()*3}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--wobble-amount":`${(Math.random()-.5)*80}px`}},e))}),v.jsx("style",{children:`
            @keyframes emberRise {
                from {
                    transform: translateY(0) scale(1);
                    opacity: 1;
                }
                to {
                    transform: translateY(-105vh) scale(0.5);
                    opacity: 0;
                }
            }
             @keyframes emberWobble {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--wobble-amount); }
            }
            @keyframes pulse-slow { 
                50% { opacity: 0.6; } 
            }
            .animate-pulse-slow { animation: pulse-slow 6s ease-in-out infinite; }
        `})]})),Es={id:"theme_default",name:"Default",boardBg:"bg-slate-900",cellBg:"bg-transparent",gridColor:"border-slate-500",nameColor:"text-white"},kg=[{id:"theme_ice",name:"Ice",boardBg:"bg-[#0c1a3e]",boardBgImage:"assets/themes/ice.png",cellBg:"bg-transparent",gridColor:"border-cyan-400/50",nameColor:"text-cyan-100",decoratorComponent:mM},{id:"theme_retro",name:"Retro",boardBg:"bg-[#281e36]",boardBgImage:"assets/themes/retro.png",cellBg:"bg-transparent",gridColor:"border-yellow-400/50",nameColor:"text-yellow-100",decoratorComponent:pM},{id:"theme_ruby",name:"Ruby",boardBg:"bg-[#3b0f2d]",boardBgImage:"assets/themes/ruby.png",cellBg:"bg-transparent",gridColor:"border-pink-400/50",nameColor:"text-pink-100",decoratorComponent:gM},{id:"theme_autumn",name:"Autumn",boardBg:"bg-[#4a2525]",boardBgImage:"assets/themes/autumn.png",cellBg:"bg-transparent",gridColor:"border-orange-400/50",nameColor:"text-orange-100",decoratorComponent:_M},{id:"theme_spring",name:"Spring",boardBg:"bg-[#4d7c5a]",boardBgImage:"assets/themes/spring.png",cellBg:"bg-transparent",gridColor:"border-pink-200/60",nameColor:"text-pink-50",decoratorComponent:yM},{id:"theme_summer",name:"Summer",boardBg:"bg-[#005f73]",boardBgImage:"assets/themes/summer.png",cellBg:"bg-transparent",gridColor:"border-yellow-200/50",nameColor:"text-yellow-50",decoratorComponent:vM},{id:"theme_winter",name:"Winter",boardBg:"bg-[#1a2b4a]",boardBgImage:"assets/themes/winter.png",cellBg:"bg-transparent",gridColor:"border-blue-200/50",nameColor:"text-blue-100",decoratorComponent:wM},{id:"theme_space",name:"Space",boardBg:"bg-[#0c0a1f]",boardBgImage:"assets/themes/space.png",cellBg:"bg-transparent",gridColor:"border-purple-400/50",nameColor:"text-purple-200",decoratorComponent:EM},{id:"theme_fire",name:"Fire",boardBg:"bg-[#2d0d0d]",boardBgImage:"assets/themes/fire.png",cellBg:"bg-transparent",gridColor:"border-orange-500/50",nameColor:"text-yellow-200",decoratorComponent:bM}],kn={id:"piece_default_x",name:"Cross",component:YP},Hd={id:"piece_default_o",name:"Circle",component:WP},mo=[{id:"piece_hexagon",name:"Hexagon",component:zP},{id:"piece_triangle",name:"Triangle",component:qP},{id:"piece_plus",name:"Plus",component:GP},{id:"piece_sun",name:"Sun",component:HP},{id:"piece_paw",name:"Paw Print",component:KP},{id:"piece_ghost",name:"Ghost",component:$P},{id:"piece_peace",name:"Peace Sign",component:QP},{id:"piece_diamond",name:"Diamond",component:XP},{id:"piece_star",name:"Star",component:JP},{id:"piece_heart",name:"Heart",component:ZP},{id:"piece_music",name:"Music Note",component:eM},{id:"piece_bolt",name:"Bolt",component:tM},{id:"piece_planet",name:"Planet",component:nM},{id:"piece_rocket",name:"Rocket",component:iM},{id:"piece_shield",name:"Shield",component:sM},{id:"piece_square",name:"Square",component:rM},{id:"piece_moon",name:"Moon",component:aM},{id:"piece_anchor",name:"Anchor",component:oM},{id:"piece_bug",name:"Bug",component:lM},{id:"piece_crown",name:"Crown",component:cM},{id:"piece_eye",name:"Eye",component:uM},{id:"piece_fire",name:"Fire",component:hM},{id:"piece_flag",name:"Flag",component:dM},{id:"piece_dragon",name:"Dragon",component:fM}],oi={id:"avatar_default",name:"Guest",url:"assets/avatars/avatar_1.png"},Og=[{id:"avatar_2",name:"Rebel",url:"assets/avatars/avatar_2.png"},{id:"avatar_3",name:"Scholar",url:"assets/avatars/avatar_3.png"},{id:"avatar_4",name:"Ninja",url:"assets/avatars/avatar_4.png"},{id:"avatar_5",name:"Knight",url:"assets/avatars/avatar_5.png"}],Pg=[{id:"emoji_wave",name:"Wave",emoji:"👋"},{id:"emoji_cool",name:"Cool",emoji:"😎"},{id:"emoji_laugh",name:"Laugh",emoji:"😂"},{id:"emoji_wow",name:"Wow",emoji:"😮"},{id:"emoji_think",name:"Thinking",emoji:"🤔"},{id:"emoji_gg",name:"Good Game",emoji:"🤝"},{id:"emoji_thumbs_up",name:"Thumbs Up",emoji:"👍"},{id:"emoji_clap",name:"Clapping",emoji:"👏"},{id:"emoji_fire",name:"Fire",emoji:"🔥"},{id:"emoji_mind_blown",name:"Mind Blown",emoji:"🤯"},{id:"emoji_cry",name:"Crying",emoji:"😭"},{id:"emoji_angry",name:"Angry",emoji:"😠"},{id:"emoji_sleep",name:"Sleeping",emoji:"😴"},{id:"emoji_facepalm",name:"Facepalm",emoji:"🤦"},{id:"emoji_shrug",name:"Shrug",emoji:"🤷"},{id:"emoji_heart",name:"Heart",emoji:"❤️"},{id:"emoji_rocket",name:"Rocket",emoji:"🚀"},{id:"emoji_star_struck",name:"Star-Struck",emoji:"🤩"},{id:"emoji_wink",name:"Wink",emoji:"😉"},{id:"emoji_eyes",name:"Eyes",emoji:"👀"},{id:"emoji_pray",name:"Pray",emoji:"🙏"},{id:"emoji_celebrate",name:"Celebrate",emoji:"🎉"},{id:"emoji_sad",name:"Sad",emoji:"😢"},{id:"emoji_zany",name:"Zany",emoji:"🤪"},{id:"emoji_skull",name:"Skull",emoji:"💀"},{id:"emoji_clown",name:"Clown",emoji:"🤡"},{id:"emoji_fleur",name:"Fleur-de-lis",emoji:"⚜️"},{id:"emoji_dragon",name:"Dragon",emoji:"🐉"},{id:"emoji_robot",name:"Robot",emoji:"🤖"},{id:"emoji_tophat",name:"Top Hat",emoji:"🎩"}],Ed=({className:n})=>v.jsx("div",{className:n,children:v.jsx("div",{})}),TM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",children:[v.jsx("path",{d:"M50 10 L50 70 M30 50 L50 70 L70 50",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),v.jsx("circle",{cx:"50",cy:"80",r:"10",fill:"currentColor"})]}),IM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",children:[v.jsx("path",{d:"M 50,50 m -35,0 a 35,35 0 1,0 70,0 a 35,35 0 1,0 -70,0",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeDasharray:"150 220",strokeDashoffset:"0"}),v.jsx("path",{d:"M80 50 L65 40 M80 50 L65 60",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round"})]}),SM=()=>v.jsx("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:v.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"currentColor"})}),AM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-400",children:[v.jsx("circle",{cx:"50",cy:"50",r:"15",stroke:"currentColor",strokeWidth:"4",fill:"none"}),v.jsx("circle",{cx:"50",cy:"50",r:"30",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"4 8"})]}),xM=()=>v.jsx("svg",{viewBox:"0 0 100 100",className:"text-cyan-400",children:v.jsxs("circle",{cx:"50",cy:"50",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",children:[v.jsx("animate",{attributeName:"r",from:"10",to:"40",dur:"1s",repeatCount:"indefinite",begin:"0s"}),v.jsx("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",repeatCount:"indefinite",begin:"0s"})]})}),CM=()=>`
  /* Universal Glow for all effects */
  @keyframes piece-glow {
    0%, 100% { filter: drop-shadow(0 0 2px transparent); }
    50% { filter: drop-shadow(0 0 12px currentColor) drop-shadow(0 0 5px currentColor) brightness(1.2); }
  }

  /* Drop: Piece falls from above and lands with a bounce. */
  @keyframes piece-drop-fall {
    0% { transform: translateY(-200%); opacity: 0; }
    80% { transform: translateY(0); opacity: 1; }
    90% { transform: translateY(-10%); }
    100% { transform: translateY(0); }
  }
  .animate-effect_drop { animation: piece-drop-fall 0.4s cubic-bezier(0.5, 0, 0.25, 1.5) forwards; }

  /* Rotate: Spins 360 degrees. */
  @keyframes piece-rotate-spin {
    from { transform: rotate(-360deg) scale(0.5); opacity: 0; }
    to { transform: rotate(0deg) scale(1); opacity: 1; }
  }
  .animate-effect_rotate { animation: piece-rotate-spin 0.35s ease-out forwards; }

  /* Flash: An elegant, bright golden flash that bursts outwards */
  @keyframes piece-flash-burst {
    0% { transform: scale(0); opacity: 0.8; }
    100% { transform: scale(1.8); opacity: 0; }
  }
   @keyframes piece-flash-self {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); filter: brightness(3); }
  }
  .animate-effect_flash { animation: piece-flash-self 0.3s ease-in-out forwards; }
  .animate-effect_flash::after {
    content: '';
    position: absolute;
    inset: -20%;
    border-radius: 99px;
    background: radial-gradient(circle, currentColor 0%, transparent 70%);
    opacity: 0;
    transform: scale(0);
    animation: piece-flash-burst 0.35s ease-out forwards;
  }

  /* Phase: Holographic activation rings, no longer obscures piece */
  @keyframes piece-phase-fade-in {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
  }
  @keyframes piece-phase-rings {
    from { transform: scale(0.5); opacity: 1; }
    to { transform: scale(1.5); opacity: 0; }
  }
  .animate-effect_phase { animation: piece-phase-fade-in 0.4s ease-out forwards; }
  .animate-effect_phase::before, .animate-effect_phase::after {
    content: '';
    position: absolute;
    inset: 0;
    border: 2px solid currentColor;
    border-radius: 99px;
    opacity: 0;
    transform: scale(0.5);
    animation: piece-phase-rings 0.45s ease-out forwards;
  }
  .animate-effect_phase::after { animation-delay: 0.1s; }

  /* Ripple: Expanding shockwave */
  @keyframes piece-ripple {
    from { transform: scale(0); opacity: 0.7; }
    to { transform: scale(3); opacity: 0; }
  }
  .animate-effect_ripple { animation: piece-glow 0.5s ease-out forwards; }
  .animate-effect_ripple::before {
    content: ''; position: absolute; inset: 0; border-radius: 99px;
    border: 3px solid currentColor;
    animation: piece-ripple 0.4s ease-out forwards;
  }
`,RM=()=>v.jsx("style",{children:CM()}),Yi={id:"effect_flash",name:"Flash",component:Ed,previewComponent:SM},Mg=[{id:"effect_rotate",name:"Rotate",component:Ed,previewComponent:IM},{id:"effect_drop",name:"Drop",component:Ed,previewComponent:TM},{id:"effect_phase",name:"Phase",component:Ed,previewComponent:AM},{id:"effect_ripple",name:"Ripple",component:Ed,previewComponent:xM}],NM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:[v.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"currentColor"}),v.jsx("path",{d:"M20 20 L30 30 M70 30 L80 20 M70 70 L80 80 M20 80 L30 70",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),DM=()=>v.jsx("svg",{viewBox:"0 0 100 100",children:v.jsxs("g",{transform:"translate(15 15) scale(0.7)",children:[v.jsx("rect",{x:"10",y:"20",width:"15",height:"8",fill:"#34D399",transform:"rotate(-30 17.5 24)"}),v.jsx("rect",{x:"50",y:"15",width:"15",height:"8",fill:"#F472B6",transform:"rotate(20 57.5 19)"}),v.jsx("rect",{x:"70",y:"60",width:"15",height:"8",fill:"#60A5FA",transform:"rotate(-10 77.5 64)"}),v.jsx("rect",{x:"25",y:"70",width:"15",height:"8",fill:"#FBBF24",transform:"rotate(40 32.5 74)"})]})}),kM=()=>v.jsx("svg",{viewBox:"0 0 100 100",children:v.jsxs("g",{strokeWidth:"4",strokeLinecap:"round",children:[v.jsx("path",{d:"M50 50 L50 30",stroke:"#F472B6"}),v.jsx("path",{d:"M50 50 L70 50",stroke:"#60A5FA"}),v.jsx("path",{d:"M50 50 L30 50",stroke:"#34D399"}),v.jsx("path",{d:"M50 50 L50 70",stroke:"#FBBF24"})]})}),OM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:[v.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"none",stroke:"currentColor",strokeWidth:"4"}),v.jsx("text",{x:"25",y:"30",fontSize:"30",children:"✨"}),v.jsx("text",{x:"75",y:"75",fontSize:"30",children:"✨"})]}),PM=()=>v.jsx("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:v.jsxs("g",{stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round",children:[v.jsx("path",{d:"M30 70 L30 30 M20 40 L30 30 L40 40"}),v.jsx("path",{d:"M70 70 L70 30 M60 40 L70 30 L80 40"})]})}),MM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-pink-500",children:[v.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),v.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:"❤️"})]}),VM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-orange-500",children:[v.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),v.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:"🚀"})]}),LM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-500",children:[v.jsx("path",{d:"M20 50 C 40 30, 60 70, 80 50",stroke:"currentColor",strokeWidth:"6",fill:"none"}),v.jsx("circle",{cx:"15",cy:"50",r:"8",fill:"currentColor"})]}),jM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-slate-300",children:[v.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),v.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:"👻"})]}),UM=()=>v.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-400",children:[v.jsx("circle",{cx:"50",cy:"50",r:"25",fill:"black"}),v.jsx("path",{d:"M 50,50 m -15,0 a 15,15 0 1,0 30,0 a 15,15 0 1,0 -30,0",stroke:"currentColor",strokeWidth:"4",fill:"none",transform:"rotate(45 50 50)",strokeDasharray:"10 10"})]}),FM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:Array(30).fill(0).map((n,e)=>v.jsx("div",{className:"absolute w-2 h-2 bg-yellow-300 rounded-full animate-particle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`}},e))}),BM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:[...Array(50)].map((n,e)=>v.jsx("div",{className:"absolute h-4 animate-confetti",style:{width:"8px",left:`${Math.random()*100}%`,animationDelay:`${Math.random()*.2}s`,animationDuration:`${2+Math.random()*2}s`,backgroundColor:["#34D399","#F472B6","#60A5FA","#FBBF24"][e%4]}},e))}),zM=()=>{const n=["#F472B6","#60A5FA","#34D399","#FBBF24","#A78BFA","#FDE047"],e=[{delay:.2,scale:1,left:"45%",top:"40%"},{delay:.7,scale:.8,left:"65%",top:"50%"},{delay:1.2,scale:1.2,left:"35%",top:"30%"},{delay:1.6,scale:.9,left:"55%",top:"60%"},{delay:2,scale:1.1,left:"40%",top:"55%"}];return v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:e.map((t,i)=>v.jsx("div",{className:"absolute animate-firework-container",style:{left:t.left,top:t.top,transform:`scale(${t.scale})`,animationDelay:`${t.delay}s`},children:[...Array(35)].map((r,o)=>{const c=Math.random()*360,h=60+Math.random()*70;return v.jsx("div",{className:"absolute w-2 h-2 rounded-full animate-firework-particle",style:{backgroundColor:n[o%n.length],"--angle":`${c}deg`,"--distance":`${h}px`,"--duration":`${.9+Math.random()*.5}s`}},o)})},i))})},qM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:Array(25).fill(0).map((n,e)=>v.jsx("div",{className:"animate-starlight",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,transform:`scale(${.5+Math.random()*.5})`},children:"✨"},e))}),GM=()=>v.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:[...Array(15)].map((n,e)=>v.jsx("div",{className:"absolute bottom-0 w-2 animate-ascension-beam",style:{left:`${5+Math.random()*90}%`,animationDelay:`${Math.random()*2.5}s`,animationDuration:`${2.5+Math.random()*2}s`}},e))}),_r=n=>n?{x:n.left+n.width/2,y:n.top+n.height/2}:{x:0,y:0},HM=({winnerCoords:n,loserCoords:e})=>{const t=_r(n),i=_r(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:"❤️"}),v.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},KM=({winnerCoords:n,loserCoords:e})=>{const t=_r(n),i=_r(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:"🚀"}),v.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},$M=({winnerCoords:n,loserCoords:e})=>{const t=_r(n),i=_r(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute w-8 h-8 rounded-full bg-purple-500 animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}}),v.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},QM=({winnerCoords:n,loserCoords:e})=>{const t=_r(n),i=_r(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:"👻"}),v.jsx("div",{className:"animate-boom-ghost-wail",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:[...Array(8)].map((r,o)=>v.jsx("div",{className:"absolute text-2xl top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",style:{transform:`rotate(${o*45}deg) translateY(-50px)`},children:"👻"},o))})]})},WM=({winnerCoords:n,loserCoords:e})=>{const t=_r(n),i=_r(e);return!n||!e?null:v.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[v.jsx("div",{className:"absolute w-8 h-8 rounded-full bg-black border-2 border-purple-500 animate-boom-void-travel",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}}),v.jsxs("div",{className:"w-48 h-48 animate-boom-void-impact-container",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:[v.jsx("div",{className:"absolute inset-0 animate-boom-void-black-hole"}),v.jsx("div",{className:"absolute inset-0 animate-boom-void-particles",children:[...Array(12)].map((r,o)=>v.jsx("div",{className:"absolute w-1 h-8 bg-purple-400 animate-boom-void-particle",style:{"--i":o}},o))})]})]})},YM=()=>`
  /* Victory: Default Particle Burst */
  @keyframes particle { 0% { transform: scale(1) translateY(0); opacity: 1; } 100% { transform: scale(0) translateY(-100px); opacity: 0; } }
  .animate-particle { animation: particle 2s ease-out forwards; }
  /* Victory: Confetti */
  @keyframes confetti-fall { from { transform: translateY(-20vh) rotate(0deg); } to { transform: translateY(100vh) rotate(1080deg); } }
  .animate-confetti { animation: confetti-fall linear infinite; }
  /* Victory: Starlight */
  @keyframes starlight-twinkle { 0%, 100% { transform: scale(0.5); opacity: 0.5; } 50% { transform: scale(1.2); opacity: 1; filter: drop-shadow(0 0 5px currentColor); } }
  .animate-starlight { position: absolute; color: #fef08a; font-size: 1.5rem; animation: starlight-twinkle 2s ease-in-out infinite; }
  
  /* Victory: Fireworks */
  @keyframes firework-burst {
    0% { transform: rotate(var(--angle)) translateY(0) scale(1.5); opacity: 1; }
    100% { transform: rotate(var(--angle)) translateY(var(--distance)) scale(0); opacity: 0; }
  }
  .animate-firework-particle {
    animation: firework-burst var(--duration) cubic-bezier(0.2, 0.8, 0.7, 1) forwards;
    filter: drop-shadow(0 0 4px currentColor);
  }
  .animate-firework-container { opacity: 0; animation: firework-fade-in 0.1s linear forwards; animation-delay: inherit; }
  @keyframes firework-fade-in { to { opacity: 1; } }

  /* Victory: Ascension */
  @keyframes light-beam-rise {
    from { transform: translateY(0) scaleY(1); opacity: 0; }
    20% { opacity: 0.7; }
    80% { opacity: 0.7; }
    to { transform: translateY(-100vh) scaleY(3); opacity: 0; }
  }
  .animate-ascension-beam {
    height: 30vh;
    background: linear-gradient(to top, rgba(253, 224, 71, 0), rgba(253, 224, 71, 0.6), rgba(253, 224, 71, 0));
    filter: drop-shadow(0 0 6px #fde047);
    animation: light-beam-rise ease-in forwards;
  }

  /* Boom: Projectile Travel & Vanish (FIXED: Centered and vanishes on impact) */
  @keyframes boom-travel-vanish {
    0% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
    10% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(1); opacity: 1; }
    89% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1); opacity: 1; }
    100% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1.5); opacity: 0; }
  }
  .animate-boom-travel-vanish {
    position: fixed; top: 0; left: 0;
    animation: boom-travel-vanish 1s ease-in-out forwards;
  }
  
  /* Boom: Impact flash at destination */
  @keyframes boom-impact-flash { 
      0% { transform: translate(-50%,-50%) scale(0); opacity: 1; filter: brightness(1.5); } 
      50% { filter: brightness(2.5); }
      100% { transform: translate(-50%,-50%) scale(3); opacity: 0; filter: brightness(1); } 
  }
  .animate-boom-impact {
    position: fixed;
    left: var(--end-x); top: var(--end-y);
    width: 100px; height: 100px; border-radius: 99px;
    background: radial-gradient(circle, white 0%, #FFD700 40%, #FF8C00 70%, transparent 85%);
    transform: translate(-50%, -50%);
    opacity: 0;
    animation: boom-impact-flash 0.4s ease-out forwards;
    animation-delay: 0.85s; /* Delay until travel is almost complete */
  }

  /* Boom: Ghostly Wail Impact */
  @keyframes boom-ghost-wail-anim {
      from { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
      to { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 0; }
  }
  .animate-boom-ghost-wail {
      position: fixed;
      left: var(--end-x); top: var(--end-y);
      width: 150px; height: 150px;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      animation: boom-ghost-wail-anim 0.8s ease-out forwards;
      animation-delay: 0.85s;
  }

  /* Boom: Void Collapse */
  @keyframes boom-void-travel-anim {
      0% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
      10% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(1); opacity: 1; }
      89% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
  }
  .animate-boom-void-travel {
      position: fixed; top: 0; left: 0;
      filter: drop-shadow(0 0 8px #a855f7);
      animation: boom-void-travel-anim 1s ease-in-out forwards;
  }
  .animate-boom-void-impact-container {
      position: fixed;
      top: var(--end-y);
      left: var(--end-x);
      transform: translate(-50%, -50%);
      opacity: 0;
      animation: firework-fade-in 0.1s linear forwards;
      animation-delay: 0.85s;
  }
  @keyframes boom-void-black-hole-anim {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 0.5; }
    30% { transform: translate(-50%, -50%) scale(0.6); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(0.5) rotate(90deg); opacity: 1; }
  }
  .animate-boom-void-black-hole {
    position: absolute; top: 50%; left: 50%;
    width: 100%; height: 100%;
    transform-origin: center;
    transform: translate(-50%, -50%) scale(0);
    background: radial-gradient(circle, #2d0b45 10%, black 60%);
    border-radius: 50%;
    filter: blur(8px);
    animation: boom-void-black-hole-anim 0.8s ease-out forwards;
  }
  @keyframes boom-void-particles-rotate {
      from { transform: scale(1.5) rotate(0deg); }
      to { transform: scale(1.5) rotate(-360deg); }
  }
  .animate-boom-void-particles {
      transform-origin: center;
      animation: boom-void-particles-rotate 0.8s ease-in forwards;
  }
  @keyframes boom-void-particle-suck {
      from { transform: rotate(calc(var(--i) * 30deg)) translateY(0) scaleY(1); opacity: 1; }
      to { transform: rotate(calc(var(--i) * 30deg)) translateY(-70px) scaleY(0.2); opacity: 0; }
  }
  .animate-boom-void-particle {
      top: 50%; left: 50%;
      transform-origin: center bottom;
      animation: boom-void-particle-suck 0.5s ease-in forwards;
  }
`,XM=()=>v.jsx("style",{children:YM()}),Xi={id:"victory_default",name:"Glimmer",component:FM,previewComponent:NM},Kd=[{id:"victory_confetti",name:"Confetti",component:BM,previewComponent:DM},{id:"victory_fireworks",name:"Fireworks",component:zM,previewComponent:kM},{id:"victory_starlight",name:"Starlight",component:qM,previewComponent:OM},{id:"victory_ascension",name:"Ascension",component:GM,previewComponent:PM}],Ji={id:"boom_heart",name:"Heart",component:HM,previewComponent:MM},$d=[{id:"boom_rocket",name:"Rocket Barrage",component:KM,previewComponent:VM},{id:"boom_missile",name:"Magic Missile",component:$M,previewComponent:LM},{id:"boom_ghost",name:"Ghostly Wail",component:QM,previewComponent:jM},{id:"boom_void_collapse",name:"Void Collapse",component:WM,previewComponent:UM}],JM=[{id:"bot_easy",name:"Meow",avatar:"assets/avatars/bot_1.png",level:1,skillLevel:"easy",description:"Một chú mèo nhỏ mới tập chơi! Tuyệt vời cho những màn đấu không căng não."},{id:"bot_medium",name:"Nova",avatar:"assets/avatars/bot_2.png",level:5,skillLevel:"medium",description:"Một cô gái xinh đẹp đã thành thạo chiến lược. Hứa hẹn một ván đấu mãn nhãn."},{id:"bot_hard",name:"Kael",avatar:"assets/avatars/bot_3.png",level:10,skillLevel:"hard",description:"Một hacker trẻ, suy nghĩ rất kỹ trước khi hành động, thất bại là điều hiển nhiên."}],f1=[{id:"music_default",name:"Celestial",url:"assets/sounds/music.mp3"},{id:"music_chill",name:"Chillhop",url:"assets/sounds/music_1.mp3"},{id:"music_action",name:"Action",url:"assets/sounds/music_2.mp3"},{id:"music_synth",name:"Synthwave",url:"assets/sounds/music_3.mp3"}],Eo=[{id:Es.id,name:Es.name,type:"theme",price:0,item:Es},...kg.map(n=>({id:n.id,name:n.name,type:"theme",price:500,item:n})),{id:oi.id,name:oi.name,type:"avatar",price:0,item:oi},...Og.map(n=>({id:n.id,name:n.name,type:"avatar",price:300,item:n})),{id:kn.id,name:kn.name,type:"piece",price:0,item:kn},...mo.filter(n=>n.id!=="piece_dragon").map(n=>({id:n.id,name:n.name,type:"piece",price:250,item:n})),{id:"piece_dragon",name:"Dragon",type:"piece",price:750,item:mo.find(n=>n.id==="piece_dragon")},{id:Yi.id,name:Yi.name,type:"effect",price:0,item:Yi},...Mg.map(n=>({id:n.id,name:n.name,type:"effect",price:400,item:n})),{id:Xi.id,name:Xi.name,type:"victory",price:0,item:Xi},...Kd.filter(n=>n.id!=="victory_ascension").map(n=>({id:n.id,name:n.name,type:"victory",price:750,item:n})),{id:"victory_ascension",name:"Ascension",type:"victory",price:900,item:Kd.find(n=>n.id==="victory_ascension")},{id:Ji.id,name:Ji.name,type:"boom",price:0,item:Ji},...$d.filter(n=>n.id!=="boom_void_collapse").map(n=>({id:n.id,name:n.name,type:"boom",price:1e3,item:n})),{id:"boom_void_collapse",name:"Void Collapse",type:"boom",price:1200,item:$d.find(n=>n.id==="boom_void_collapse")},...Pg.map(n=>({id:n.id,name:n.name,type:"emoji",price:n.id==="emoji_wave"||n.id==="emoji_think"?0:50,item:n}))];var yA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const he=function(n,e){if(!n)throw Ku(e)},Ku=function(n){return new Error("Firebase Database ("+m1.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},ZM=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=n[t++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=n[t++],c=n[t++],h=n[t++],d=((r&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],c=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|c&63)}}return e.join("")},Dw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const o=n[r],c=r+1<n.length,h=c?n[r+1]:0,d=r+2<n.length,m=d?n[r+2]:0,_=o>>2,y=(o&3)<<4|h>>4;let b=(h&15)<<2|m>>6,I=m&63;d||(I=64,c||(b=64)),i.push(t[_],t[y],t[b],t[I])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(p1(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ZM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const o=t[n.charAt(r++)],h=r<n.length?t[n.charAt(r)]:0;++r;const m=r<n.length?t[n.charAt(r)]:64;++r;const y=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||h==null||m==null||y==null)throw new eV;const b=o<<2|h>>4;if(i.push(b),m!==64){const I=h<<4&240|m>>2;if(i.push(I),y!==64){const C=m<<6&192|y;i.push(C)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class eV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const g1=function(n){const e=p1(n);return Dw.encodeByteArray(e,!0)},Xp=function(n){return g1(n).replace(/\./g,"")},Jp=function(n){try{return Dw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tV(n){return Qd(void 0,n)}function Qd(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!nV(t)||(n[t]=Qd(n[t],e[t]));return n}function nV(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV=()=>_1().__FIREBASE_DEFAULTS__,sV=()=>{if(typeof process>"u"||typeof yA>"u")return;const n=yA.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},rV=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Jp(n[1]);return e&&JSON.parse(e)},Vg=()=>{try{return iV()||sV()||rV()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},y1=n=>{var e,t;return(t=(e=Vg())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},v1=n=>{const e=y1(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},w1=()=>{var n;return(n=Vg())===null||n===void 0?void 0:n.config},E1=n=>{var e;return(e=Vg())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Xp(JSON.stringify(t)),Xp(JSON.stringify(c)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bt())}function Ow(){var n;const e=(n=Vg())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function aV(){return typeof window<"u"||T1()}function T1(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function oV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function I1(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Lg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function S1(){const n=Bt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function lV(){return m1.NODE_ADMIN===!0}function A1(){return!Ow()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Wd(){try{return typeof indexedDB=="object"}catch{return!1}}function cV(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var o;e(((o=r.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uV="FirebaseError";class li extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=uV,Object.setPrototypeOf(this,li.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ec.prototype.create)}}class ec{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],c=o?hV(o,i):"Error",h=`${this.serviceName}: ${c} (${r}).`;return new li(r,h,i)}}function hV(n,e){return n.replace(dV,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const dV=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(n){return JSON.parse(n)}function vn(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1=function(n){let e={},t={},i={},r="";try{const o=n.split(".");e=Yd(Jp(o[0])||""),t=Yd(Jp(o[1])||""),r=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}},fV=function(n){const e=x1(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},mV=function(n){const e=x1(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ul(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Zp(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function eg(n,e,t){const i={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function wu(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const o=n[r],c=e[r];if(vA(o)&&vA(c)){if(!wu(o,c))return!1}else if(o!==c)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function vA(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function cu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,o]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function bd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let y=0;y<16;y++)i[y]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let y=0;y<16;y++)i[y]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let y=16;y<80;y++){const b=i[y-3]^i[y-8]^i[y-14]^i[y-16];i[y]=(b<<1|b>>>31)&4294967295}let r=this.chain_[0],o=this.chain_[1],c=this.chain_[2],h=this.chain_[3],d=this.chain_[4],m,_;for(let y=0;y<80;y++){y<40?y<20?(m=h^o&(c^h),_=1518500249):(m=o^c^h,_=1859775393):y<60?(m=o&c|h&(o|c),_=2400959708):(m=o^c^h,_=3395469782);const b=(r<<5|r>>>27)+m+d+_+i[y]&4294967295;d=h,h=c,c=(o<<30|o>>>2)&4294967295,o=r,r=b}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let r=0;const o=this.buf_;let c=this.inbuf_;for(;r<t;){if(c===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(o[c]=e.charCodeAt(r),++c,++r,c===this.blockSize){this.compress_(o),c=0;break}}else for(;r<t;)if(o[c]=e[r],++c,++r,c===this.blockSize){this.compress_(o),c=0;break}}this.inbuf_=c,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[r]>>o&255,++i;return e}}function C1(n,e){const t=new gV(n,e);return t.subscribe.bind(t)}class gV{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");_V(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=$v),r.error===void 0&&(r.error=$v),r.complete===void 0&&(r.complete=$v);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _V(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function $v(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne=function(n,e,t,i){let r;if(i<e?r="at least "+e:i>t&&(r=t===0?"none":"no more than "+t),r){const o=n+" failed: Was called with "+i+(i===1?" argument.":" arguments.")+" Expects "+r+".";throw new Error(o)}};function Ri(n,e){return`${n} failed: ${e} argument `}function Cn(n,e,t,i){if(!(i&&!t)&&typeof t!="function")throw new Error(Ri(n,e)+"must be a valid function.")}function wA(n,e,t,i){if(t&&(typeof t!="object"||t===null))throw new Error(Ri(n,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){const o=r-55296;i++,he(i<n.length,"Surrogate pair missing trail surrogate.");const c=n.charCodeAt(i)-56320;r=65536+(o<<10)+c}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},jg=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(n){return n&&n._delegate?n._delegate:n}class Ni{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Ii;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wV(e))try{this.getOrInitializeService({instanceIdentifier:bl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=bl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=bl){return this.instances.has(e)}getOptions(e=bl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&c.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(r,o);const c=this.instances.get(r);return c&&e(c,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:vV(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=bl){return this.component?this.component.multipleInstances?e:bl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vV(n){return n===bl?void 0:n}function wV(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new E0(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw=[];var Ge;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ge||(Ge={}));const R1={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},EV=Ge.INFO,bV={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},TV=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=bV[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $u{constructor(e){this.name=e,this._logLevel=EV,this._logHandler=TV,this._userLogHandler=null,Mw.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?R1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}function IV(n){Mw.forEach(e=>{e.setLogLevel(n)})}function SV(n,e){for(const t of Mw){let i=null;e&&e.level&&(i=R1[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(r,o,...c)=>{const h=c.map(d=>{if(d==null)return null;if(typeof d=="string")return d;if(typeof d=="number"||typeof d=="boolean")return d.toString();if(d instanceof Error)return d.message;try{return JSON.stringify(d)}catch{return null}}).filter(d=>d).join(" ");o>=(i??r.logLevel)&&n({level:Ge[o].toLowerCase(),message:h,args:c,type:r.name})}}}const AV=(n,e)=>e.some(t=>n instanceof t);let EA,bA;function xV(){return EA||(EA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CV(){return bA||(bA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N1=new WeakMap,b0=new WeakMap,D1=new WeakMap,Qv=new WeakMap,Vw=new WeakMap;function RV(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(po(n.result)),r()},c=()=>{i(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&N1.set(t,n)}).catch(()=>{}),Vw.set(e,n),e}function NV(n){if(b0.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),r()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});b0.set(n,e)}let T0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return b0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||D1.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return po(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function DV(n){T0=n(T0)}function kV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Wv(this),e,...t);return D1.set(i,e.sort?e.sort():[e]),po(i)}:CV().includes(n)?function(...e){return n.apply(Wv(this),e),po(N1.get(this))}:function(...e){return po(n.apply(Wv(this),e))}}function OV(n){return typeof n=="function"?kV(n):(n instanceof IDBTransaction&&NV(n),AV(n,xV())?new Proxy(n,T0):n)}function po(n){if(n instanceof IDBRequest)return RV(n);if(Qv.has(n))return Qv.get(n);const e=OV(n);return e!==n&&(Qv.set(n,e),Vw.set(e,n)),e}const Wv=n=>Vw.get(n);function PV(n,e,{blocked:t,upgrade:i,blocking:r,terminated:o}={}){const c=indexedDB.open(n,e),h=po(c);return i&&c.addEventListener("upgradeneeded",d=>{i(po(c.result),d.oldVersion,d.newVersion,po(c.transaction),d)}),t&&c.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),r&&d.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const MV=["get","getKey","getAll","getAllKeys","count"],VV=["put","add","delete","clear"],Yv=new Map;function TA(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Yv.get(e))return Yv.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=VV.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||MV.includes(t)))return;const o=async function(c,...h){const d=this.transaction(c,r?"readwrite":"readonly");let m=d.store;return i&&(m=m.index(h.shift())),(await Promise.all([m[t](...h),r&&d.done]))[0]};return Yv.set(e,o),o}DV(n=>({...n,get:(e,t,i)=>TA(e,t)||n.get(e,t,i),has:(e,t)=>!!TA(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(jV(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function jV(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tg="@firebase/app",I0="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra=new $u("@firebase/app"),UV="@firebase/app-compat",FV="@firebase/analytics-compat",BV="@firebase/analytics",zV="@firebase/app-check-compat",qV="@firebase/app-check",GV="@firebase/auth",HV="@firebase/auth-compat",KV="@firebase/database",$V="@firebase/data-connect",QV="@firebase/database-compat",WV="@firebase/functions",YV="@firebase/functions-compat",XV="@firebase/installations",JV="@firebase/installations-compat",ZV="@firebase/messaging",eL="@firebase/messaging-compat",tL="@firebase/performance",nL="@firebase/performance-compat",iL="@firebase/remote-config",sL="@firebase/remote-config-compat",rL="@firebase/storage",aL="@firebase/storage-compat",oL="@firebase/firestore",lL="@firebase/vertexai-preview",cL="@firebase/firestore-compat",uL="firebase",hL="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo="[DEFAULT]",dL={[tg]:"fire-core",[UV]:"fire-core-compat",[BV]:"fire-analytics",[FV]:"fire-analytics-compat",[qV]:"fire-app-check",[zV]:"fire-app-check-compat",[GV]:"fire-auth",[HV]:"fire-auth-compat",[KV]:"fire-rtdb",[$V]:"fire-data-connect",[QV]:"fire-rtdb-compat",[WV]:"fire-fn",[YV]:"fire-fn-compat",[XV]:"fire-iid",[JV]:"fire-iid-compat",[ZV]:"fire-fcm",[eL]:"fire-fcm-compat",[tL]:"fire-perf",[nL]:"fire-perf-compat",[iL]:"fire-rc",[sL]:"fire-rc-compat",[rL]:"fire-gcs",[aL]:"fire-gcs-compat",[oL]:"fire-fst",[cL]:"fire-fst-compat",[lL]:"fire-vertex","fire-js":"fire-js",[uL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=new Map,Eu=new Map,bu=new Map;function Xd(n,e){try{n.container.addComponent(e)}catch(t){ra.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function k1(n,e){n.container.addOrOverwriteComponent(e)}function aa(n){const e=n.name;if(bu.has(e))return ra.debug(`There were multiple attempts to register component ${e}.`),!1;bu.set(e,n);for(const t of To.values())Xd(t,n);for(const t of Eu.values())Xd(t,n);return!0}function Qu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function fL(n,e,t=bo){Qu(n,e).clearInstance(t)}function O1(n){return n.options!==void 0}function Qt(n){return n.settings!==void 0}function mL(){bu.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bs=new ec("app","Firebase",pL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P1=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bs.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL extends P1{constructor(e,t,i,r){const o=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,c={name:i,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,c,r);else{const h=e;super(h.options,c,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:o},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Zi(tg,I0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){jw(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw bs.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=hL;function Lw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:bo,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw bs.create("bad-app-name",{appName:String(r)});if(t||(t=w1()),!t)throw bs.create("no-options");const o=To.get(r);if(o){if(wu(t,o.options)&&wu(i,o.config))return o;throw bs.create("duplicate-app",{appName:r})}const c=new Pw(r);for(const d of bu.values())c.addComponent(d);const h=new P1(t,i,c);return To.set(r,h),h}function _L(n,e){if(aV()&&!T1())throw bs.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;O1(n)?t=n.options:t=n;const i=Object.assign(Object.assign({},e),t);i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const r=m=>[...m].reduce((_,y)=>Math.imul(31,_)+y.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw bs.create("finalization-registry-not-supported",{});const o=""+r(JSON.stringify(i)),c=Eu.get(o);if(c)return c.incRefCount(e.releaseOnDeref),c;const h=new Pw(o);for(const m of bu.values())h.addComponent(m);const d=new gL(t,e,o,h);return Eu.set(o,d),d}function Ug(n=bo){const e=To.get(n);if(!e&&n===bo&&w1())return Lw();if(!e)throw bs.create("no-app",{appName:n});return e}function yL(){return Array.from(To.values())}async function jw(n){let e=!1;const t=n.name;To.has(t)?(e=!0,To.delete(t)):Eu.has(t)&&n.decRefCount()<=0&&(Eu.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)}function Zi(n,e,t){var i;let r=(i=dL[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const o=r.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const h=[`Unable to register library "${r}" with version "${e}":`];o&&h.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&c&&h.push("and"),c&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ra.warn(h.join(" "));return}aa(new Ni(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function M1(n,e){if(n!==null&&typeof n!="function")throw bs.create("invalid-log-argument");SV(n,e)}function V1(n){IV(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vL="firebase-heartbeat-database",wL=1,Jd="firebase-heartbeat-store";let Xv=null;function L1(){return Xv||(Xv=PV(vL,wL,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Jd)}catch(t){console.warn(t)}}}}).catch(n=>{throw bs.create("idb-open",{originalErrorMessage:n.message})})),Xv}async function EL(n){try{const t=(await L1()).transaction(Jd),i=await t.objectStore(Jd).get(j1(n));return await t.done,i}catch(e){if(e instanceof li)ra.warn(e.message);else{const t=bs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ra.warn(t.message)}}}async function IA(n,e){try{const i=(await L1()).transaction(Jd,"readwrite");await i.objectStore(Jd).put(e,j1(n)),await i.done}catch(t){if(t instanceof li)ra.warn(t.message);else{const i=bs.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ra.warn(i.message)}}}function j1(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=1024,TL=720*60*60*1e3;class IL{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new AL(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=SA();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const h=new Date(c.date).valueOf();return Date.now()-h<=TL}),this._storage.overwrite(this._heartbeatsCache))}catch(i){ra.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=SA(),{heartbeatsToSend:i,unsentEntries:r}=SL(this._heartbeatsCache.heartbeats),o=Xp(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ra.warn(t),""}}}function SA(){return new Date().toISOString().substring(0,10)}function SL(n,e=bL){const t=[];let i=n.slice();for(const r of n){const o=t.find(c=>c.agent===r.agent);if(o){if(o.dates.push(r.date),AA(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),AA(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class AL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wd()?cV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await EL(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return IA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return IA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function AA(n){return Xp(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(n){aa(new Ni("platform-logger",e=>new LV(e),"PRIVATE")),aa(new Ni("heartbeat",e=>new IL(e),"PRIVATE")),Zi(tg,I0,n),Zi(tg,I0,"esm2017"),Zi("fire-js","")}xL("");const CL=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:li,SDK_VERSION:ha,_DEFAULT_ENTRY_NAME:bo,_addComponent:Xd,_addOrOverwriteComponent:k1,_apps:To,_clearComponents:mL,_components:bu,_getProvider:Qu,_isFirebaseApp:O1,_isFirebaseServerApp:Qt,_registerComponent:aa,_removeServiceInstance:fL,_serverApps:Eu,deleteApp:jw,getApp:Ug,getApps:yL,initializeApp:Lw,initializeServerApp:_L,onLog:M1,registerVersion:Zi,setLogLevel:V1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e,t){this._delegate=e,this.firebase=t,Xd(e,new Ni("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),jw(this._delegate)))}_getService(e,t=bo){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=bo){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Xd(this._delegate,e)}_addOrOverwriteComponent(e){k1(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},xA=new ec("app-compat","Firebase",NL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(n){const e={},t={__esModule:!0,initializeApp:o,app:r,registerVersion:Zi,setLogLevel:V1,onLog:M1,apps:null,SDK_VERSION:ha,INTERNAL:{registerComponent:h,removeApp:i,useAsService:d,modularAPIs:CL}};t.default=t,Object.defineProperty(t,"apps",{get:c});function i(m){delete e[m]}function r(m){if(m=m||bo,!es(e,m))throw xA.create("no-app",{appName:m});return e[m]}r.App=n;function o(m,_={}){const y=Lw(m,_);if(es(e,y.name))return e[y.name];const b=new n(y,t);return e[y.name]=b,b}function c(){return Object.keys(e).map(m=>e[m])}function h(m){const _=m.name,y=_.replace("-compat","");if(aa(m)&&m.type==="PUBLIC"){const b=(I=r())=>{if(typeof I[y]!="function")throw xA.create("invalid-app-argument",{appName:_});return I[y]()};m.serviceProps!==void 0&&Qd(b,m.serviceProps),t[y]=b,n.prototype[y]=function(...I){return this._getService.bind(this,_).apply(this,m.multipleInstances?I:[])}}return m.type==="PUBLIC"?t[y]:null}function d(m,_){return _==="serverAuth"?null:_}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(){const n=DL(RL);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:U1,extendNamespace:e,createSubscribe:C1,ErrorFactory:ec,deepExtend:Qd});function e(t){Qd(n,t)}return n}const kL=U1();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=new $u("@firebase/app-compat"),OL="@firebase/app-compat",PL="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ML(n){Zi(OL,PL,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=_1();if(n.firebase!==void 0){CA.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&CA.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const nc=kL;ML();var VL="firebase",LL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nc.registerVersion(VL,LL,"app-compat");function Uw(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}const cd={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Jc={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function F1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const UL=jL,FL=F1,B1=new ec("auth","Firebase",F1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=new $u("@firebase/auth");function BL(n,...e){ng.logLevel<=Ge.WARN&&ng.warn(`Auth (${ha}): ${n}`,...e)}function Up(n,...e){ng.logLevel<=Ge.ERROR&&ng.error(`Auth (${ha}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(n,...e){throw Bw(n,...e)}function wn(n,...e){return Bw(n,...e)}function Fw(n,e,t){const i=Object.assign(Object.assign({},FL()),{[e]:t});return new ec("auth","Firebase",i).create(e,{appName:n.name})}function On(n){return Fw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Wu(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Pn(n,"argument-error"),Fw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Bw(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return B1.create(n,...e)}function ue(n,e,...t){if(!n)throw Bw(e,...t)}function hr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Up(e),new Error(e)}function Fs(n,e){n||hr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function zw(){return RA()==="http:"||RA()==="https:"}function RA(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zw()||I1()||"connection"in navigator)?navigator.onLine:!0}function qL(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fs(t>e,"Short delay should be less than long delay!"),this.isMobile=kw()||Lg()}get(){return zL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qw(n,e){Fs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL=new Nf(3e4,6e4);function Jt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Zt(n,e,t,i,r={}){return q1(n,r,async()=>{let o={},c={};i&&(e==="GET"?c=i:o={body:JSON.stringify(i)});const h=tc(Object.assign({key:n.config.apiKey},c)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:d},o);return oV()||(m.referrerPolicy="no-referrer"),z1.fetch()(G1(n,n.config.apiHost,t,h),m)})}async function q1(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},GL),e);try{const r=new $L(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Td(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const h=o.ok?c.errorMessage:c.error.message,[d,m]=h.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Td(n,"credential-already-in-use",c);if(d==="EMAIL_EXISTS")throw Td(n,"email-already-in-use",c);if(d==="USER_DISABLED")throw Td(n,"user-disabled",c);const _=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Fw(n,_,m);Pn(n,_)}}catch(r){if(r instanceof li)throw r;Pn(n,"network-request-failed",{message:String(r)})}}async function da(n,e,t,i,r={}){const o=await Zt(n,e,t,i,r);return"mfaPendingCredential"in o&&Pn(n,"multi-factor-auth-required",{_serverResponse:o}),o}function G1(n,e,t,i){const r=`${e}${t}?${i}`;return n.config.emulator?qw(n.config,r):`${n.config.apiScheme}://${r}`}function KL(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class $L{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(wn(this.auth,"network-request-failed")),HL.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Td(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=wn(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(n){return n!==void 0&&n.getResponse!==void 0}function DA(n){return n!==void 0&&n.enterprise!==void 0}class QL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return KL(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WL(n){return(await Zt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function YL(n,e){return Zt(n,"GET","/v2/recaptchaConfig",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XL(n,e){return Zt(n,"POST","/v1/accounts:delete",e)}async function JL(n,e){return Zt(n,"POST","/v1/accounts:update",e)}async function H1(n,e){return Zt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZL(n,e=!1){const t=ye(n),i=await t.getIdToken(e),r=Fg(i);ue(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const o=typeof r.firebase=="object"?r.firebase:void 0,c=o==null?void 0:o.sign_in_provider;return{claims:r,token:i,authTime:Rd(Jv(r.auth_time)),issuedAtTime:Rd(Jv(r.iat)),expirationTime:Rd(Jv(r.exp)),signInProvider:c||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Jv(n){return Number(n)*1e3}function Fg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Up("JWT malformed, contained fewer than 3 sections"),null;try{const r=Jp(t);return r?JSON.parse(r):(Up("Failed to decode base64 JWT payload"),null)}catch(r){return Up("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function kA(n){const e=Fg(n);return ue(e,"internal-error"),ue(typeof e.exp<"u","internal-error"),ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oa(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof li&&e4(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function e4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rd(this.lastLoginAt),this.creationTime=Rd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(n){var e;const t=n.auth,i=await n.getIdToken(),r=await oa(n,H1(t,{idToken:i}));ue(r==null?void 0:r.users.length,t,"internal-error");const o=r.users[0];n._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?K1(o.providerUserInfo):[],h=i4(n.providerData,c),d=n.isAnonymous,m=!(n.email&&o.passwordHash)&&!(h!=null&&h.length),_=d?m:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new S0(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(n,y)}async function n4(n){const e=ye(n);await ef(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function i4(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function K1(n){return n.map(e=>{var{providerId:t}=e,i=Uw(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s4(n,e){const t=await q1(n,{},async()=>{const i=tc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,c=G1(n,r,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",z1.fetch()(c,{method:"POST",headers:h,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function r4(n,e){return Zt(n,"POST","/v2/accounts:revokeToken",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ue(e.idToken,"internal-error"),ue(typeof e.idToken<"u","internal-error"),ue(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):kA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ue(e.length!==0,"internal-error");const t=kA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:o}=await s4(e,t);this.updateTokensAndExpiration(i,r,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:o}=t,c=new hu;return i&&(ue(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),r&&(ue(typeof r=="string","internal-error",{appName:e}),c.accessToken=r),o&&(ue(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hu,this.toJSON())}_performRefresh(){return hr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(n,e){ue(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Zr{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,o=Uw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new t4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new S0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await oa(this,this.stsTokenManager.getToken(this.auth,e));return ue(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ZL(this,e)}reload(){return n4(this)}_assign(e){this!==e&&(ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Zr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await ef(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qt(this.auth.app))return Promise.reject(On(this.auth));const e=await this.getIdToken();return await oa(this,XL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,o,c,h,d,m,_;const y=(i=t.displayName)!==null&&i!==void 0?i:void 0,b=(r=t.email)!==null&&r!==void 0?r:void 0,I=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,C=(c=t.photoURL)!==null&&c!==void 0?c:void 0,M=(h=t.tenantId)!==null&&h!==void 0?h:void 0,z=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,B=(m=t.createdAt)!==null&&m!==void 0?m:void 0,j=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:X,emailVerified:fe,isAnonymous:F,providerData:ae,stsTokenManager:D}=t;ue(X&&D,e,"internal-error");const x=hu.fromJSON(this.name,D);ue(typeof X=="string",e,"internal-error"),io(y,e.name),io(b,e.name),ue(typeof fe=="boolean",e,"internal-error"),ue(typeof F=="boolean",e,"internal-error"),io(I,e.name),io(C,e.name),io(M,e.name),io(z,e.name),io(B,e.name),io(j,e.name);const R=new Zr({uid:X,auth:e,email:b,emailVerified:fe,displayName:y,isAnonymous:F,photoURL:C,phoneNumber:I,tenantId:M,stsTokenManager:x,createdAt:B,lastLoginAt:j});return ae&&Array.isArray(ae)&&(R.providerData=ae.map(V=>Object.assign({},V))),z&&(R._redirectEventId=z),R}static async _fromIdTokenResponse(e,t,i=!1){const r=new hu;r.updateFromServerResponse(t);const o=new Zr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await ef(o),o}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];ue(r.localId!==void 0,"internal-error");const o=r.providerUserInfo!==void 0?K1(r.providerUserInfo):[],c=!(r.email&&r.passwordHash)&&!(o!=null&&o.length),h=new hu;h.updateFromIdToken(i);const d=new Zr({uid:r.localId,auth:e,stsTokenManager:h,isAnonymous:c}),m={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new S0(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,m),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA=new Map;function Wi(n){Fs(n instanceof Function,"Expected a class definition");let e=OA.get(n);return e?(Fs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,OA.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}$1.type="NONE";const Tu=$1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pl(n,e,t){return`firebase:${n}:${e}:${t}`}class du{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:o}=this.auth;this.fullUserKey=Pl(this.userKey,r.apiKey,o),this.fullPersistenceKey=Pl("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Zr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new du(Wi(Tu),e,i);const r=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=r[0]||Wi(Tu);const c=Pl(i,e.config.apiKey,e.name);let h=null;for(const m of t)try{const _=await m._get(c);if(_){const y=Zr._fromJSON(e,_);m!==o&&(h=y),o=m;break}}catch{}const d=r.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new du(o,e,i):(o=d[0],h&&await o._set(c,h.toJSON()),await Promise.all(t.map(async m=>{if(m!==o)try{await m._remove(c)}catch{}})),new du(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(X1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Q1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(J1(e))return"Blackberry";if(Z1(e))return"Webos";if(W1(e))return"Safari";if((e.includes("chrome/")||Y1(e))&&!e.includes("edge/"))return"Chrome";if(Df(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function Q1(n=Bt()){return/firefox\//i.test(n)}function W1(n=Bt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Y1(n=Bt()){return/crios\//i.test(n)}function X1(n=Bt()){return/iemobile/i.test(n)}function Df(n=Bt()){return/android/i.test(n)}function J1(n=Bt()){return/blackberry/i.test(n)}function Z1(n=Bt()){return/webos/i.test(n)}function kf(n=Bt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function a4(n=Bt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function o4(n=Bt()){var e;return kf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function l4(){return S1()&&document.documentMode===10}function eR(n=Bt()){return kf(n)||Df(n)||Z1(n)||J1(n)||/windows phone/i.test(n)||X1(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(n,e=[]){let t;switch(n){case"Browser":t=PA(Bt());break;case"Worker":t=`${PA(Bt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ha}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((c,h)=>{try{const d=e(o);c(d)}catch(d){h(d)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u4(n,e={}){return Zt(n,"GET","/v2/passwordPolicy",Jt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=6;class d4{constructor(e){var t,i,r,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:h4,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,o,c,h;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(i=d.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(r=d.containsLowercaseLetter)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(c=d.containsNumericCharacter)!==null&&c!==void 0?c:!0),d.isValid&&(d.isValid=(h=d.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),d}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new MA(this),this.idTokenSubscription=new MA(this),this.beforeStateQueue=new c4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=B1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Wi(t)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await du.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await H1(this,{idToken:e}),i=await Zr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Qt(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,h=r==null?void 0:r._redirectEventId,d=await this.tryRedirectSignIn(e);(!c||c===h)&&(d!=null&&d.user)&&(r=d.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(c){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ef(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qt(this.app))return Promise.reject(On(this));const t=e?ye(e):null;return t&&ue(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qt(this.app)?Promise.reject(On(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qt(this.app)?Promise.reject(On(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await u4(this),t=new d4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ec("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await r4(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Wi(e)||this._popupRedirectResolver;ue(t,this,"argument-error"),this.redirectPersistenceManager=await du.create(this,[Wi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(ue(h,this,"internal-error"),h.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,i,r);return()=>{c=!0,d()}}else{const d=e.addObserver(t);return()=>{c=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&BL(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Wt(n){return ye(n)}class MA{constructor(e){this.auth=e,this.observer=null,this.addObserver=C1(t=>this.observer=t)}get next(){return ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function m4(n){Of=n}function Gw(n){return Of.loadJS(n)}function p4(){return Of.recaptchaV2Script}function g4(){return Of.recaptchaEnterpriseScript}function _4(){return Of.gapiScript}function nR(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const y4="recaptcha-enterprise",v4="NO_RECAPTCHA";class w4{constructor(e){this.type=y4,this.auth=Wt(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,h)=>{YL(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new QL(d);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,c(m.siteKey)}}).catch(d=>{h(d)})})}function r(o,c,h){const d=window.grecaptcha;DA(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(m=>{c(m)}).catch(()=>{c(v4)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,c)=>{i(this.auth).then(h=>{if(!t&&DA(window.grecaptcha))r(h,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let d=g4();d.length!==0&&(d+=h),Gw(d).then(()=>{r(h,o,c)}).catch(m=>{c(m)})}}).catch(h=>{c(h)})})}}async function VA(n,e,t,i=!1){const r=new w4(n);let o;try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const c=Object.assign({},e);return i?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function tf(n,e,t,i){var r;if(!((r=n._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await VA(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await VA(n,e,t,t==="getOobCode");return i(n,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E4(n,e){const t=Qu(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),o=t.getOptions();if(wu(o,e??{}))return r;Pn(r,"already-initialized")}return t.initialize({options:e})}function b4(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Wi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function iR(n,e,t){const i=Wt(n);ue(i._canInitEmulator,i,"emulator-config-failed"),ue(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(t!=null&&t.disableWarnings),o=sR(e),{host:c,port:h}=T4(e),d=h===null?"":`:${h}`;i.config.emulator={url:`${o}//${c}${d}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:c,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||I4()}function sR(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function T4(n){const e=sR(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const o=r[1];return{host:o,port:LA(i.substr(o.length+1))}}else{const[o,c]=i.split(":");return{host:o,port:LA(c)}}}function LA(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function I4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return hr("not implemented")}_getIdTokenResponse(e){return hr("not implemented")}_linkToIdToken(e,t){return hr("not implemented")}_getReauthenticationResolver(e){return hr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(n,e){return Zt(n,"POST","/v1/accounts:resetPassword",Jt(n,e))}async function S4(n,e){return Zt(n,"POST","/v1/accounts:update",e)}async function A4(n,e){return Zt(n,"POST","/v1/accounts:signUp",e)}async function x4(n,e){return Zt(n,"POST","/v1/accounts:update",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C4(n,e){return da(n,"POST","/v1/accounts:signInWithPassword",Jt(n,e))}async function Bg(n,e){return Zt(n,"POST","/v1/accounts:sendOobCode",Jt(n,e))}async function R4(n,e){return Bg(n,e)}async function N4(n,e){return Bg(n,e)}async function D4(n,e){return Bg(n,e)}async function k4(n,e){return Bg(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O4(n,e){return da(n,"POST","/v1/accounts:signInWithEmailLink",Jt(n,e))}async function P4(n,e){return da(n,"POST","/v1/accounts:signInWithEmailLink",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends Yu{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new nf(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new nf(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tf(e,t,"signInWithPassword",C4);case"emailLink":return O4(e,{email:this._email,oobCode:this._password});default:Pn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tf(e,i,"signUpPassword",A4);case"emailLink":return P4(e,{idToken:t,email:this._email,oobCode:this._password});default:Pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ia(n,e){return da(n,"POST","/v1/accounts:signInWithIdp",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4="http://localhost";class yr extends Yu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Pn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,o=Uw(t,["providerId","signInMethod"]);if(!i||!r)return null;const c=new yr(i,r);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return ia(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ia(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ia(e,t)}buildRequest(){const e={requestUri:M4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=tc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V4(n,e){return Zt(n,"POST","/v1/accounts:sendVerificationCode",Jt(n,e))}async function L4(n,e){return da(n,"POST","/v1/accounts:signInWithPhoneNumber",Jt(n,e))}async function j4(n,e){const t=await da(n,"POST","/v1/accounts:signInWithPhoneNumber",Jt(n,e));if(t.temporaryProof)throw Td(n,"account-exists-with-different-credential",t);return t}const U4={USER_NOT_FOUND:"user-not-found"};async function F4(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return da(n,"POST","/v1/accounts:signInWithPhoneNumber",Jt(n,t),U4)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml extends Yu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ml({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ml({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return L4(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return j4(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return F4(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:i,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:i,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:i,phoneNumber:r,temporaryProof:o}=e;return!i&&!t&&!r&&!o?null:new Ml({verificationId:t,verificationCode:i,phoneNumber:r,temporaryProof:o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B4(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function z4(n){const e=cu(bd(n)).link,t=e?cu(bd(e)).deep_link_id:null,i=cu(bd(n)).deep_link_id;return(i?cu(bd(i)).link:null)||i||t||e||n}class zg{constructor(e){var t,i,r,o,c,h;const d=cu(bd(e)),m=(t=d.apiKey)!==null&&t!==void 0?t:null,_=(i=d.oobCode)!==null&&i!==void 0?i:null,y=B4((r=d.mode)!==null&&r!==void 0?r:null);ue(m&&_&&y,"argument-error"),this.apiKey=m,this.operation=y,this.code=_,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=d.languageCode)!==null&&c!==void 0?c:null,this.tenantId=(h=d.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const t=z4(e);try{return new zg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(){this.providerId=Fo.PROVIDER_ID}static credential(e,t){return nf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=zg.parseLink(t);return ue(i,"argument-error"),nf._fromEmailAndCode(e,i.code,i.tenantId)}}Fo.PROVIDER_ID="password";Fo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Fo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu extends fa{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class fu extends Xu{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ue("providerId"in t&&"signInMethod"in t,"argument-error"),yr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ue(e.idToken||e.accessToken,"argument-error"),yr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return fu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return fu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:r,pendingToken:o,nonce:c,providerId:h}=e;if(!i&&!r&&!t&&!o||!h)return null;try{return new fu(h)._credential({idToken:t,accessToken:i,nonce:c,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or extends Xu{constructor(){super("facebook.com")}static credential(e){return yr._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return or.credentialFromTaggedObject(e)}static credentialFromError(e){return or.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return or.credential(e.oauthAccessToken)}catch{return null}}}or.FACEBOOK_SIGN_IN_METHOD="facebook.com";or.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends Xu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yr._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return lr.credential(t,i)}catch{return null}}}lr.GOOGLE_SIGN_IN_METHOD="google.com";lr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr extends Xu{constructor(){super("github.com")}static credential(e){return yr._fromParams({providerId:cr.PROVIDER_ID,signInMethod:cr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cr.credentialFromTaggedObject(e)}static credentialFromError(e){return cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cr.credential(e.oauthAccessToken)}catch{return null}}}cr.GITHUB_SIGN_IN_METHOD="github.com";cr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4="http://localhost";class Iu extends Yu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return ia(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ia(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ia(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,pendingToken:o}=t;return!i||!r||!o||i!==r?null:new Iu(i,o)}static _create(e,t){return new Iu(e,t)}buildRequest(){return{requestUri:q4,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4="saml.";class ig extends fa{constructor(e){ue(e.startsWith(G4),"argument-error"),super(e)}static credentialFromResult(e){return ig.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return ig.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Iu.fromJSON(e);return ue(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:i}=e;if(!t||!i)return null;try{return Iu._create(i,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur extends Xu{constructor(){super("twitter.com")}static credential(e,t){return yr._fromParams({providerId:ur.PROVIDER_ID,signInMethod:ur.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ur.credentialFromTaggedObject(e)}static credentialFromError(e){return ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ur.credential(t,i)}catch{return null}}}ur.TWITTER_SIGN_IN_METHOD="twitter.com";ur.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR(n,e){return da(n,"POST","/v1/accounts:signUp",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const o=await Zr._fromIdTokenResponse(e,i,r),c=jA(i);return new Ts({user:o,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=jA(i);return new Ts({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function jA(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oR(n){var e;if(Qt(n.app))return Promise.reject(On(n));const t=Wt(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ts({user:t.currentUser,providerId:null,operationType:"signIn"});const i=await aR(t,{returnSecureToken:!0}),r=await Ts._fromIdTokenResponse(t,"signIn",i,!0);return await t._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg extends li{constructor(e,t,i,r){var o;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,sg.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new sg(e,t,i,r)}}function lR(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?sg._fromErrorAndOperation(n,o,e,i):o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4(n,e){const t=ye(n);await qg(!0,t,e);const{providerUserInfo:i}=await JL(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),r=cR(i||[]);return t.providerData=t.providerData.filter(o=>r.has(o.providerId)),r.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Hw(n,e,t=!1){const i=await oa(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ts._forOperation(n,"link",i)}async function qg(n,e,t){await ef(e);const i=cR(e.providerData),r=n===!1?"provider-already-linked":"no-such-provider";ue(i.has(t)===n,e.auth,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uR(n,e,t=!1){const{auth:i}=n;if(Qt(i.app))return Promise.reject(On(i));const r="reauthenticate";try{const o=await oa(n,lR(i,r,e,n),t);ue(o.idToken,i,"internal-error");const c=Fg(o.idToken);ue(c,i,"internal-error");const{sub:h}=c;return ue(n.uid===h,i,"user-mismatch"),Ts._forOperation(n,r,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Pn(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hR(n,e,t=!1){if(Qt(n.app))return Promise.reject(On(n));const i="signIn",r=await lR(n,i,e),o=await Ts._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(o.user),o}async function Gg(n,e){return hR(Wt(n),e)}async function dR(n,e){const t=ye(n);return await qg(!1,t,e.providerId),Hw(t,e)}async function fR(n,e){return uR(ye(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K4(n,e){return da(n,"POST","/v1/accounts:signInWithCustomToken",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $4(n,e){if(Qt(n.app))return Promise.reject(On(n));const t=Wt(n),i=await K4(t,{token:e,returnSecureToken:!0}),r=await Ts._fromIdTokenResponse(t,"signIn",i);return await t._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Kw._fromServerResponse(e,t):"totpInfo"in t?$w._fromServerResponse(e,t):Pn(e,"internal-error")}}class Kw extends Pf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Kw(t)}}class $w extends Pf{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new $w(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(n,e,t){var i;ue(((i=t.url)===null||i===void 0?void 0:i.length)>0,n,"invalid-continue-uri"),ue(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ue(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ue(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qw(n){const e=Wt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Q4(n,e,t){const i=Wt(n),r={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Hg(i,r,t),await tf(i,r,"getOobCode",N4)}async function W4(n,e,t){await rR(ye(n),{oobCode:e,newPassword:t}).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Qw(n),i})}async function Y4(n,e){await x4(ye(n),{oobCode:e})}async function mR(n,e){const t=ye(n),i=await rR(t,{oobCode:e}),r=i.requestType;switch(ue(r,t,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ue(i.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ue(i.mfaInfo,t,"internal-error");default:ue(i.email,t,"internal-error")}let o=null;return i.mfaInfo&&(o=Pf._fromServerResponse(Wt(t),i.mfaInfo)),{data:{email:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.newEmail:i.email)||null,previousEmail:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.email:i.newEmail)||null,multiFactorInfo:o},operation:r}}async function X4(n,e){const{data:t}=await mR(ye(n),e);return t.email}async function pR(n,e,t){if(Qt(n.app))return Promise.reject(On(n));const i=Wt(n),c=await tf(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aR).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&Qw(n),d}),h=await Ts._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(h.user),h}function gR(n,e,t){return Qt(n.app)?Promise.reject(On(n)):Gg(ye(n),Fo.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Qw(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J4(n,e,t){const i=Wt(n),r={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(c,h){ue(h.handleCodeInApp,i,"argument-error"),h&&Hg(i,c,h)}o(r,t),await tf(i,r,"getOobCode",D4)}function Z4(n,e){const t=zg.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function e5(n,e,t){if(Qt(n.app))return Promise.reject(On(n));const i=ye(n),r=Fo.credentialWithLink(e,t||Zd());return ue(r._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),Gg(i,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t5(n,e){return Zt(n,"POST","/v1/accounts:createAuthUri",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n5(n,e){const t=zw()?Zd():"http://localhost",i={identifier:e,continueUri:t},{signinMethods:r}=await t5(ye(n),i);return r||[]}async function i5(n,e){const t=ye(n),r={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Hg(t.auth,r,e);const{email:o}=await R4(t.auth,r);o!==n.email&&await n.reload()}async function s5(n,e,t){const i=ye(n),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Hg(i.auth,o,t);const{email:c}=await k4(i.auth,o);c!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r5(n,e){return Zt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kg(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=ye(n),o={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await oa(i,r5(i.auth,o));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const h=i.providerData.find(({providerId:d})=>d==="password");h&&(h.displayName=i.displayName,h.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}function a5(n,e){const t=ye(n);return Qt(t.auth.app)?Promise.reject(On(t.auth)):_R(t,e,null)}function o5(n,e){return _R(ye(n),null,e)}async function _R(n,e,t){const{auth:i}=n,o={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(o.email=e),t&&(o.password=t);const c=await oa(n,S4(i,o));await n._updateTokensIfNecessary(c,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(n){var e,t;if(!n)return null;const{providerId:i}=n,r=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},o=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!i&&(n!=null&&n.idToken)){const c=(t=(e=Fg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(c){const h=c!=="anonymous"&&c!=="custom"?c:null;return new mu(o,h)}}if(!i)return null;switch(i){case"facebook.com":return new c5(o,r);case"github.com":return new u5(o,r);case"google.com":return new h5(o,r);case"twitter.com":return new d5(o,r,n.screenName||null);case"custom":case"anonymous":return new mu(o,null);default:return new mu(o,i,r)}}class mu{constructor(e,t,i={}){this.isNewUser=e,this.providerId=t,this.profile=i}}class yR extends mu{constructor(e,t,i,r){super(e,t,i),this.username=r}}class c5 extends mu{constructor(e,t){super(e,"facebook.com",t)}}class u5 extends yR{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class h5 extends mu{constructor(e,t){super(e,"google.com",t)}}class d5 extends yR{constructor(e,t,i){super(e,"twitter.com",t,i)}}function f5(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:l5(t)}function m5(n,e,t,i){return ye(n).onIdTokenChanged(e,t,i)}function p5(n,e,t){return ye(n).beforeAuthStateChanged(e,t)}function g5(n,e,t,i){return ye(n).onAuthStateChanged(e,t,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,t,i){this.type=e,this.credential=t,this.user=i}static _fromIdtoken(e,t){return new Nl("enroll",e,t)}static _fromMfaPendingCredential(e){return new Nl("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,i;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Nl._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((i=e.multiFactorSession)===null||i===void 0)&&i.idToken)return Nl._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,t,i){this.session=e,this.hints=t,this.signInResolver=i}static _fromError(e,t){const i=Wt(e),r=t.customData._serverResponse,o=(r.mfaInfo||[]).map(h=>Pf._fromServerResponse(i,h));ue(r.mfaPendingCredential,i,"internal-error");const c=Nl._fromMfaPendingCredential(r.mfaPendingCredential);return new Ww(c,o,async h=>{const d=await h._process(i,c);delete r.mfaInfo,delete r.mfaPendingCredential;const m=Object.assign(Object.assign({},r),{idToken:d.idToken,refreshToken:d.refreshToken});switch(t.operationType){case"signIn":const _=await Ts._fromIdTokenResponse(i,t.operationType,m);return await i._updateCurrentUser(_.user),_;case"reauthenticate":return ue(t.user,i,"internal-error"),Ts._forOperation(t.user,t.operationType,m);default:Pn(i,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function _5(n,e){var t;const i=ye(n),r=e;return ue(e.customData.operationType,i,"argument-error"),ue((t=r.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,i,"argument-error"),Ww._fromError(i,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(n,e){return Zt(n,"POST","/v2/accounts/mfaEnrollment:start",Jt(n,e))}function v5(n,e){return Zt(n,"POST","/v2/accounts/mfaEnrollment:finalize",Jt(n,e))}function w5(n,e){return Zt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Jt(n,e))}class Yw{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(i=>Pf._fromServerResponse(e.auth,i)))})}static _fromUser(e){return new Yw(e)}async getSession(){return Nl._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const i=e,r=await this.getSession(),o=await oa(this.user,i._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,i=await this.user.getIdToken();try{const r=await oa(this.user,w5(this.user.auth,{idToken:i,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==t),await this.user._updateTokensIfNecessary(r),await this.user.reload()}catch(r){throw r}}}const Zv=new WeakMap;function E5(n){const e=ye(n);return Zv.has(e)||Zv.set(e,Yw._fromUser(e)),Zv.get(e)}const rg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(rg,"1"),this.storage.removeItem(rg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5=1e3,T5=10;class wR extends vR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,h,d)=>{this.notifyListeners(c,d)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);l4()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,T5):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},b5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}wR.type="LOCAL";const $g=wR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER extends vR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ER.type="SESSION";const Io=ER;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I5(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Qg(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:o}=t.data,c=this.handlersMap[r];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const h=Array.from(c).map(async m=>m(t.origin,o)),d=await I5(h);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mf(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,c;return new Promise((h,d)=>{const m=Mf("",20);r.port1.start();const _=setTimeout(()=>{d(new Error("unsupported_event"))},i);c={messageChannel:r,onMessage(y){const b=y;if(b.data.eventId===m)switch(b.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(b.data.response);break;default:clearTimeout(_),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(c),r.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[r.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function A5(n){pn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function x5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function C5(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function R5(){return Xw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR="firebaseLocalStorageDb",N5=1,ag="firebaseLocalStorage",TR="fbase_key";class Vf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Wg(n,e){return n.transaction([ag],e?"readwrite":"readonly").objectStore(ag)}function D5(){const n=indexedDB.deleteDatabase(bR);return new Vf(n).toPromise()}function A0(){const n=indexedDB.open(bR,N5);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(ag,{keyPath:TR})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(ag)?e(i):(i.close(),await D5(),e(await A0()))})})}async function UA(n,e,t){const i=Wg(n,!0).put({[TR]:e,value:t});return new Vf(i).toPromise()}async function k5(n,e){const t=Wg(n,!1).get(e),i=await new Vf(t).toPromise();return i===void 0?null:i.value}function FA(n,e){const t=Wg(n,!0).delete(e);return new Vf(t).toPromise()}const O5=800,P5=3;class IR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await A0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>P5)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Xw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qg._getInstance(R5()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await x5(),!this.activeServiceWorker)return;this.sender=new S5(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||C5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await A0();return await UA(e,rg,"1"),await FA(e,rg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>UA(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>k5(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>FA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const o=Wg(r,!1).getAll();return new Vf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:o}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),O5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IR.type="LOCAL";const Su=IR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M5(n,e){return Zt(n,"POST","/v2/accounts/mfaSignIn:start",Jt(n,e))}function V5(n,e){return Zt(n,"POST","/v2/accounts/mfaSignIn:finalize",Jt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5=500,j5=6e4,Rp=1e12;class U5{constructor(e){this.auth=e,this.counter=Rp,this._widgets=new Map}render(e,t){const i=this.counter;return this._widgets.set(i,new F5(e,this.auth.name,t||{})),this.counter++,i}reset(e){var t;const i=e||Rp;(t=this._widgets.get(i))===null||t===void 0||t.delete(),this._widgets.delete(i)}getResponse(e){var t;const i=e||Rp;return((t=this._widgets.get(i))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const i=e||Rp;return(t=this._widgets.get(i))===null||t===void 0||t.execute(),""}}class F5{constructor(e,t,i){this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r=typeof e=="string"?document.getElementById(e):e;ue(r,"argument-error",{appName:t}),this.container=r,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=B5(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},j5)},L5))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function B5(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<n;i++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0=nR("rcb"),z5=new Nf(3e4,6e4);class q5{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=pn().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return ue(G5(t),e,"argument-error"),this.shouldResolveImmediately(t)&&NA(pn().grecaptcha)?Promise.resolve(pn().grecaptcha):new Promise((i,r)=>{const o=pn().setTimeout(()=>{r(wn(e,"network-request-failed"))},z5.get());pn()[e0]=()=>{pn().clearTimeout(o),delete pn()[e0];const h=pn().grecaptcha;if(!h||!NA(h)){r(wn(e,"internal-error"));return}const d=h.render;h.render=(m,_)=>{const y=d(m,_);return this.counter++,y},this.hostLanguage=t,i(h)};const c=`${p4()}?${tc({onload:e0,render:"explicit",hl:t})}`;Gw(c).catch(()=>{clearTimeout(o),r(wn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=pn().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function G5(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class H5{async load(e){return new U5(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR="recaptcha",K5={theme:"light",type:"image"};let $5=class{constructor(e,t,i=Object.assign({},K5)){this.parameters=i,this.type=SR,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Wt(e),this.isInvisible=this.parameters.size==="invisible",ue(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const r=typeof t=="string"?document.getElementById(t):t;ue(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new H5:new q5,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),i=t.getResponse(e);return i||new Promise(r=>{const o=c=>{c&&(this.tokenChangeListeners.delete(o),r(c))};this.tokenChangeListeners.add(o),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ue(!this.parameters.sitekey,this.auth,"argument-error"),ue(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ue(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(i=>i(t)),typeof e=="function")e(t);else if(typeof e=="string"){const i=pn()[e];typeof i=="function"&&i(t)}}}assertNotDestroyed(){ue(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ue(zw()&&!Xw(),this.auth,"internal-error"),await Q5(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await WL(this.auth);ue(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ue(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function Q5(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Ml._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function W5(n,e,t){if(Qt(n.app))return Promise.reject(On(n));const i=Wt(n),r=await Yg(i,e,ye(t));return new Jw(r,o=>Gg(i,o))}async function Y5(n,e,t){const i=ye(n);await qg(!1,i,"phone");const r=await Yg(i.auth,e,ye(t));return new Jw(r,o=>dR(i,o))}async function X5(n,e,t){const i=ye(n);if(Qt(i.auth.app))return Promise.reject(On(i.auth));const r=await Yg(i.auth,e,ye(t));return new Jw(r,o=>fR(i,o))}async function Yg(n,e,t){var i;const r=await t.verify();try{ue(typeof r=="string",n,"argument-error"),ue(t.type===SR,n,"argument-error");let o;if(typeof e=="string"?o={phoneNumber:e}:o=e,"session"in o){const c=o.session;if("phoneNumber"in o)return ue(c.type==="enroll",n,"internal-error"),(await y5(n,{idToken:c.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{ue(c.type==="signin",n,"internal-error");const h=((i=o.multiFactorHint)===null||i===void 0?void 0:i.uid)||o.multiFactorUid;return ue(h,n,"missing-multi-factor-info"),(await M5(n,{mfaPendingCredential:c.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:c}=await V4(n,{phoneNumber:o.phoneNumber,recaptchaToken:r});return c}}finally{t._reset()}}async function J5(n,e){const t=ye(n);if(Qt(t.auth.app))return Promise.reject(On(t.auth));await Hw(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fl=class Fp{constructor(e){this.providerId=Fp.PROVIDER_ID,this.auth=Wt(e)}verifyPhoneNumber(e,t){return Yg(this.auth,e,ye(t))}static credential(e,t){return Ml._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Fp.credentialFromTaggedObject(t)}static credentialFromError(e){return Fp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:i}=e;return t&&i?Ml._fromTokenResponse(t,i):null}};Fl.PROVIDER_ID="phone";Fl.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(n,e){return e?Wi(e):(ue(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw extends Yu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ia(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ia(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ia(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Z5(n){return hR(n.auth,new Zw(n),n.bypassAuthState)}function ej(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),uR(t,new Zw(n),n.bypassAuthState)}async function tj(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),Hw(t,new Zw(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e,t,i,r,o=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:o,error:c,type:h}=e;if(c){this.reject(c);return}const d={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Z5;case"linkViaPopup":case"linkViaRedirect":return tj;case"reauthViaPopup":case"reauthViaRedirect":return ej;default:Pn(this.auth,"internal-error")}}resolve(e){Fs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj=new Nf(2e3,1e4);async function ij(n,e,t){if(Qt(n.app))return Promise.reject(wn(n,"operation-not-supported-in-this-environment"));const i=Wt(n);Wu(n,e,fa);const r=ic(i,t);return new ea(i,"signInViaPopup",e,r).executeNotNull()}async function sj(n,e,t){const i=ye(n);if(Qt(i.auth.app))return Promise.reject(wn(i.auth,"operation-not-supported-in-this-environment"));Wu(i.auth,e,fa);const r=ic(i.auth,t);return new ea(i.auth,"reauthViaPopup",e,r,i).executeNotNull()}async function rj(n,e,t){const i=ye(n);Wu(i.auth,e,fa);const r=ic(i.auth,t);return new ea(i.auth,"linkViaPopup",e,r,i).executeNotNull()}class ea extends AR{constructor(e,t,i,r,o){super(e,t,r,o),this.provider=i,this.authWindow=null,this.pollId=null,ea.currentPopupAction&&ea.currentPopupAction.cancel(),ea.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ue(e,this.auth,"internal-error"),e}async onExecution(){Fs(this.filter.length===1,"Popup operations only handle one event");const e=Mf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(wn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(wn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ea.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nj.get())};e()}}ea.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aj="pendingRedirect",Nd=new Map;class oj extends AR{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Nd.get(this.auth._key());if(!e){try{const i=await lj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Nd.set(this.auth._key(),e)}return this.bypassAuthState||Nd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lj(n,e){const t=CR(e),i=xR(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}async function eE(n,e){return xR(n)._set(CR(e),"true")}function cj(){Nd.clear()}function tE(n,e){Nd.set(n._key(),e)}function xR(n){return Wi(n._redirectPersistence)}function CR(n){return Pl(aj,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(n,e,t){return hj(n,e,t)}async function hj(n,e,t){if(Qt(n.app))return Promise.reject(On(n));const i=Wt(n);Wu(n,e,fa),await i._initializationPromise;const r=ic(i,t);return await eE(r,i),r._openRedirect(i,e,"signInViaRedirect")}function dj(n,e,t){return fj(n,e,t)}async function fj(n,e,t){const i=ye(n);if(Wu(i.auth,e,fa),Qt(i.auth.app))return Promise.reject(On(i.auth));await i.auth._initializationPromise;const r=ic(i.auth,t);await eE(r,i.auth);const o=await RR(i);return r._openRedirect(i.auth,e,"reauthViaRedirect",o)}function mj(n,e,t){return pj(n,e,t)}async function pj(n,e,t){const i=ye(n);Wu(i.auth,e,fa),await i.auth._initializationPromise;const r=ic(i.auth,t);await qg(!1,i,e.providerId),await eE(r,i.auth);const o=await RR(i);return r._openRedirect(i.auth,e,"linkViaRedirect",o)}async function gj(n,e){return await Wt(n)._initializationPromise,Xg(n,e,!1)}async function Xg(n,e,t=!1){if(Qt(n.app))return Promise.reject(On(n));const i=Wt(n),r=ic(i,e),c=await new oj(i,r,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}async function RR(n){const e=Mf(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j=600*1e3;class NR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!DR(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(wn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_j&&this.cachedEventUids.clear(),this.cachedEventUids.has(BA(e))}saveEventToCache(e){this.cachedEventUids.add(BA(e)),this.lastProcessedEventTime=Date.now()}}function BA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function DR({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function yj(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return DR(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kR(n,e={}){return Zt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wj=/^https?/;async function Ej(n){if(n.config.emulator)return;const{authorizedDomains:e}=await kR(n);for(const t of e)try{if(bj(t))return}catch{}Pn(n,"unauthorized-domain")}function bj(n){const e=Zd(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!wj.test(t))return!1;if(vj.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj=new Nf(3e4,6e4);function zA(){const n=pn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Ij(n){return new Promise((e,t)=>{var i,r,o;function c(){zA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zA(),t(wn(n,"network-request-failed"))},timeout:Tj.get()})}if(!((r=(i=pn().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((o=pn().gapi)===null||o===void 0)&&o.load)c();else{const h=nR("iframefcb");return pn()[h]=()=>{gapi.load?c():t(wn(n,"network-request-failed"))},Gw(`${_4()}?onload=${h}`).catch(d=>t(d))}}).catch(e=>{throw Bp=null,e})}let Bp=null;function Sj(n){return Bp=Bp||Ij(n),Bp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=new Nf(5e3,15e3),xj="__/auth/iframe",Cj="emulator/auth/iframe",Rj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Nj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dj(n){const e=n.config;ue(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?qw(e,Cj):`https://${n.config.authDomain}/${xj}`,i={apiKey:e.apiKey,appName:n.name,v:ha},r=Nj.get(n.config.apiHost);r&&(i.eid=r);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${tc(i).slice(1)}`}async function kj(n){const e=await Sj(n),t=pn().gapi;return ue(t,n,"internal-error"),e.open({where:document.body,url:Dj(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Rj,dontclear:!0},i=>new Promise(async(r,o)=>{await i.restyle({setHideOnLeave:!1});const c=wn(n,"network-request-failed"),h=pn().setTimeout(()=>{o(c)},Aj.get());function d(){pn().clearTimeout(h),r(i)}i.ping(d).then(d,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Pj=500,Mj=600,Vj="_blank",Lj="http://localhost";class qA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jj(n,e,t,i=Pj,r=Mj){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const d=Object.assign(Object.assign({},Oj),{width:i.toString(),height:r.toString(),top:o,left:c}),m=Bt().toLowerCase();t&&(h=Y1(m)?Vj:t),Q1(m)&&(e=e||Lj,d.scrollbars="yes");const _=Object.entries(d).reduce((b,[I,C])=>`${b}${I}=${C},`,"");if(o4(m)&&h!=="_self")return Uj(e||"",h),new qA(null);const y=window.open(e||"",h,_);ue(y,n,"popup-blocked");try{y.focus()}catch{}return new qA(y)}function Uj(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj="__/auth/handler",Bj="emulator/auth/handler",zj=encodeURIComponent("fac");async function x0(n,e,t,i,r,o){ue(n.config.authDomain,n,"auth-domain-config-required"),ue(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ha,eventId:r};if(e instanceof fa){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",Zp(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,y]of Object.entries(o||{}))c[_]=y}if(e instanceof Xu){const _=e.getScopes().filter(y=>y!=="");_.length>0&&(c.scopes=_.join(","))}n.tenantId&&(c.tid=n.tenantId);const h=c;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const d=await n._getAppCheckToken(),m=d?`#${zj}=${encodeURIComponent(d)}`:"";return`${qj(n)}?${tc(h).slice(1)}${m}`}function qj({config:n}){return n.emulator?qw(n,Bj):`https://${n.authDomain}/${Fj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0="webStorageSupport";class Gj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Io,this._completeRedirectFn=Xg,this._overrideRedirectResult=tE}async _openPopup(e,t,i,r){var o;Fs((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await x0(e,t,i,Zd(),r);return jj(e,c,Mf())}async _openRedirect(e,t,i,r){await this._originValidation(e);const o=await x0(e,t,i,Zd(),r);return A5(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Fs(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await kj(e),i=new NR(e);return t.register("authEvent",r=>(ue(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(t0,{type:t0},r=>{var o;const c=(o=r==null?void 0:r[0])===null||o===void 0?void 0:o[t0];c!==void 0&&t(!!c),Pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Ej(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eR()||W1()||kf()}}const OR=Gj;class Hj{constructor(e){this.factorId=e}_process(e,t,i){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,i);case"signin":return this._finalizeSignIn(e,t.credential);default:return hr("unexpected MultiFactorSessionType")}}}class nE extends Hj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new nE(e)}_finalizeEnroll(e,t,i){return v5(e,{idToken:t,displayName:i,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return V5(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class PR{constructor(){}static assertion(e){return nE._fromCredential(e)}}PR.FACTOR_ID="phone";var GA="@firebase/auth",HA="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $j(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Qj(n){aa(new Ni("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;ue(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:c,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tR(n)},m=new f4(i,r,o,d);return b4(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),aa(new Ni("auth-internal",e=>{const t=Wt(e.getProvider("auth").getImmediate());return(i=>new Kj(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zi(GA,HA,$j(n)),Zi(GA,HA,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=300,Yj=E1("authIdTokenMaxAge")||Wj;let KA=null;const Xj=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Yj)return;const r=t==null?void 0:t.token;KA!==r&&(KA=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Jj(n=Ug()){const e=Qu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=E4(n,{popupRedirectResolver:OR,persistence:[Su,$g,Io]}),i=E1("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const c=Xj(o.toString());p5(t,c,()=>c(t.currentUser)),m5(t,h=>c(h))}}const r=y1("auth");return r&&iR(t,`http://${r}`),t}function Zj(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}m4({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const o=wn("internal-error");o.customData=r,t(o)},i.type="text/javascript",i.charset="UTF-8",Zj().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Qj("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e3=2e3;async function t3(n,e,t){var i;const{BuildInfo:r}=Bl();Fs(e.sessionId,"AuthEvent did not contain a session ID");const o=await a3(e.sessionId),c={};return kf()?c.ibi=r.packageName:Df()?c.apn=r.packageName:Pn(n,"operation-not-supported-in-this-environment"),r.displayName&&(c.appDisplayName=r.displayName),c.sessionId=o,x0(n,t,e.type,void 0,(i=e.eventId)!==null&&i!==void 0?i:void 0,c)}async function n3(n){const{BuildInfo:e}=Bl(),t={};kf()?t.iosBundleId=e.packageName:Df()?t.androidPackageName=e.packageName:Pn(n,"operation-not-supported-in-this-environment"),await kR(n,t)}function i3(n){const{cordova:e}=Bl();return new Promise(t=>{e.plugins.browsertab.isAvailable(i=>{let r=null;i?e.plugins.browsertab.openUrl(n):r=e.InAppBrowser.open(n,a4()?"_blank":"_system","location=yes"),t(r)})})}async function s3(n,e,t){const{cordova:i}=Bl();let r=()=>{};try{await new Promise((o,c)=>{let h=null;function d(){var y;o();const b=(y=i.plugins.browsertab)===null||y===void 0?void 0:y.close;typeof b=="function"&&b(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function m(){h||(h=window.setTimeout(()=>{c(wn(n,"redirect-cancelled-by-user"))},e3))}function _(){(document==null?void 0:document.visibilityState)==="visible"&&m()}e.addPassiveListener(d),document.addEventListener("resume",m,!1),Df()&&document.addEventListener("visibilitychange",_,!1),r=()=>{e.removePassiveListener(d),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",_,!1),h&&window.clearTimeout(h)}})}finally{r()}}function r3(n){var e,t,i,r,o,c,h,d,m,_;const y=Bl();ue(typeof((e=y==null?void 0:y.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ue(typeof((t=y==null?void 0:y.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ue(typeof((o=(r=(i=y==null?void 0:y.cordova)===null||i===void 0?void 0:i.plugins)===null||r===void 0?void 0:r.browsertab)===null||o===void 0?void 0:o.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ue(typeof((d=(h=(c=y==null?void 0:y.cordova)===null||c===void 0?void 0:c.plugins)===null||h===void 0?void 0:h.browsertab)===null||d===void 0?void 0:d.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ue(typeof((_=(m=y==null?void 0:y.cordova)===null||m===void 0?void 0:m.InAppBrowser)===null||_===void 0?void 0:_.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function a3(n){const e=o3(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(r=>r.toString(16).padStart(2,"0")).join("")}function o3(n){if(Fs(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3=20;class c3 extends NR{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function u3(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:f3(),postBody:null,tenantId:n.tenantId,error:wn(n,"no-auth-event")}}function h3(n,e){return C0()._set(R0(n),e)}async function $A(n){const e=await C0()._get(R0(n));return e&&await C0()._remove(R0(n)),e}function d3(n,e){var t,i;const r=p3(e);if(r.includes("/__/auth/callback")){const o=zp(r),c=o.firebaseError?m3(decodeURIComponent(o.firebaseError)):null,h=(i=(t=c==null?void 0:c.code)===null||t===void 0?void 0:t.split("auth/"))===null||i===void 0?void 0:i[1],d=h?wn(h):null;return d?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:d,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:r,postBody:null}}return null}function f3(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<l3;t++){const i=Math.floor(Math.random()*e.length);n.push(e.charAt(i))}return n.join("")}function C0(){return Wi($g)}function R0(n){return Pl("authEvent",n.config.apiKey,n.name)}function m3(n){try{return JSON.parse(n)}catch{return null}}function p3(n){const e=zp(n),t=e.link?decodeURIComponent(e.link):void 0,i=zp(t).link,r=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return zp(r).link||r||i||t||n}function zp(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return cu(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3=500;class _3{constructor(){this._redirectPersistence=Io,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Xg,this._overrideRedirectResult=tE}async _initialize(e){const t=e._key();let i=this.eventManagers.get(t);return i||(i=new c3(e),this.eventManagers.set(t,i),this.attachCallbackListeners(e,i)),i}_openPopup(e){Pn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,i,r){r3(e);const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),cj(),await this._originValidation(e);const c=u3(e,i,r);await h3(e,c);const h=await t3(e,c,t),d=await i3(h);return s3(e,o,d)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=n3(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:i,handleOpenURL:r,BuildInfo:o}=Bl(),c=setTimeout(async()=>{await $A(e),t.onEvent(QA())},g3),h=async _=>{clearTimeout(c);const y=await $A(e);let b=null;y&&(_!=null&&_.url)&&(b=d3(y,_.url)),t.onEvent(b||QA())};typeof i<"u"&&typeof i.subscribe=="function"&&i.subscribe(null,h);const d=r,m=`${o.packageName.toLowerCase()}://`;Bl().handleOpenURL=async _=>{if(_.toLowerCase().startsWith(m)&&h({url:_}),typeof d=="function")try{d(_)}catch(y){console.error(y)}}}}const y3=_3;function QA(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:wn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v3(n,e){Wt(n)._logFramework(e)}var w3="@firebase/auth-compat",E3="0.5.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b3=1e3;function Dd(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function T3(){return Dd()==="http:"||Dd()==="https:"}function MR(n=Bt()){return!!((Dd()==="file:"||Dd()==="ionic:"||Dd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function I3(){return Lg()||Ow()}function S3(){return S1()&&(document==null?void 0:document.documentMode)===11}function A3(n=Bt()){return/Edge\/\d+/.test(n)}function x3(n=Bt()){return S3()||A3(n)}function VR(){try{const n=self.localStorage,e=Mf();if(n)return n.setItem(e,"1"),n.removeItem(e),x3()?Wd():!0}catch{return iE()&&Wd()}return!1}function iE(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function n0(){return(T3()||I1()||MR())&&!I3()&&VR()&&!iE()}function LR(){return MR()&&typeof document<"u"}async function C3(){return LR()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},b3);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function R3(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i={LOCAL:"local",NONE:"none",SESSION:"session"},ud=ue,jR="persistence";function N3(n,e){if(ud(Object.values($i).includes(e),n,"invalid-persistence-type"),Lg()){ud(e!==$i.SESSION,n,"unsupported-persistence-type");return}if(Ow()){ud(e===$i.NONE,n,"unsupported-persistence-type");return}if(iE()){ud(e===$i.NONE||e===$i.LOCAL&&Wd(),n,"unsupported-persistence-type");return}ud(e===$i.NONE||VR(),n,"unsupported-persistence-type")}async function N0(n){await n._initializationPromise;const e=UR(),t=Pl(jR,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function D3(n,e){const t=UR();if(!t)return[];const i=Pl(jR,n,e);switch(t.getItem(i)){case $i.NONE:return[Tu];case $i.LOCAL:return[Su,Io];case $i.SESSION:return[Io];default:return[]}}function UR(){var n;try{return((n=R3())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3=ue;class lo{constructor(){this.browserResolver=Wi(OR),this.cordovaResolver=Wi(y3),this.underlyingResolver=null,this._redirectPersistence=Io,this._completeRedirectFn=Xg,this._overrideRedirectResult=tE}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,i,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,i,r)}async _openRedirect(e,t,i,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,i,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return LR()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return k3(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await C3();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(n){return n.unwrap()}function O3(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P3(n){return BR(n)}function M3(n,e){var t;const i=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const r=e;r.resolver=new V3(n,_5(n,e))}else if(i){const r=BR(e),o=e;r&&(o.credential=r,o.tenantId=i.tenantId||void 0,o.email=i.email||void 0,o.phoneNumber=i.phoneNumber||void 0)}}function BR(n){const{_tokenResponse:e}=n instanceof li?n.customData:n;if(!e)return null;if(!(n instanceof li)&&"temporaryProof"in e&&"phoneNumber"in e)return Fl.credentialFromResult(n);const t=e.providerId;if(!t||t===cd.PASSWORD)return null;let i;switch(t){case cd.GOOGLE:i=lr;break;case cd.FACEBOOK:i=or;break;case cd.GITHUB:i=cr;break;case cd.TWITTER:i=ur;break;default:const{oauthIdToken:r,oauthAccessToken:o,oauthTokenSecret:c,pendingToken:h,nonce:d}=e;return!o&&!c&&!r&&!h?null:h?t.startsWith("saml.")?Iu._create(t,h):yr._fromParams({providerId:t,signInMethod:t,pendingToken:h,idToken:r,accessToken:o}):new fu(t).credential({idToken:r,accessToken:o,rawNonce:d})}return n instanceof li?i.credentialFromError(n):i.credentialFromResult(n)}function bi(n,e){return e.catch(t=>{throw t instanceof li&&M3(n,t),t}).then(t=>{const i=t.operationType,r=t.user;return{operationType:i,credential:P3(t),additionalUserInfo:f5(t),user:Jg.getOrCreate(r)}})}async function D0(n,e){const t=await e;return{verificationId:t.verificationId,confirm:i=>bi(n,t.confirm(i))}}class V3{constructor(e,t){this.resolver=t,this.auth=O3(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return bi(FR(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jg=class Id{constructor(e){this._delegate=e,this.multiFactor=E5(e)}static getOrCreate(e){return Id.USER_MAP.has(e)||Id.USER_MAP.set(e,new Id(e)),Id.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return bi(this.auth,dR(this._delegate,e))}async linkWithPhoneNumber(e,t){return D0(this.auth,Y5(this._delegate,e,t))}async linkWithPopup(e){return bi(this.auth,rj(this._delegate,e,lo))}async linkWithRedirect(e){return await N0(Wt(this.auth)),mj(this._delegate,e,lo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return bi(this.auth,fR(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return D0(this.auth,X5(this._delegate,e,t))}reauthenticateWithPopup(e){return bi(this.auth,sj(this._delegate,e,lo))}async reauthenticateWithRedirect(e){return await N0(Wt(this.auth)),dj(this._delegate,e,lo)}sendEmailVerification(e){return i5(this._delegate,e)}async unlink(e){return await H4(this._delegate,e),this}updateEmail(e){return a5(this._delegate,e)}updatePassword(e){return o5(this._delegate,e)}updatePhoneNumber(e){return J5(this._delegate,e)}updateProfile(e){return Kg(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return s5(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Jg.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd=ue;class k0{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:i}=e.options;hd(i,"invalid-api-key",{appName:e.name}),hd(i,"invalid-api-key",{appName:e.name});const r=typeof window<"u"?lo:void 0;this._delegate=t.initialize({options:{persistence:L3(i,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(UL),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Jg.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){iR(this._delegate,e,t)}applyActionCode(e){return Y4(this._delegate,e)}checkActionCode(e){return mR(this._delegate,e)}confirmPasswordReset(e,t){return W4(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return bi(this._delegate,pR(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return n5(this._delegate,e)}isSignInWithEmailLink(e){return Z4(this._delegate,e)}async getRedirectResult(){hd(n0(),this._delegate,"operation-not-supported-in-this-environment");const e=await gj(this._delegate,lo);return e?bi(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){v3(this._delegate,e)}onAuthStateChanged(e,t,i){const{next:r,error:o,complete:c}=WA(e,t,i);return this._delegate.onAuthStateChanged(r,o,c)}onIdTokenChanged(e,t,i){const{next:r,error:o,complete:c}=WA(e,t,i);return this._delegate.onIdTokenChanged(r,o,c)}sendSignInLinkToEmail(e,t){return J4(this._delegate,e,t)}sendPasswordResetEmail(e,t){return Q4(this._delegate,e,t||void 0)}async setPersistence(e){N3(this._delegate,e);let t;switch(e){case $i.SESSION:t=Io;break;case $i.LOCAL:t=await Wi(Su)._isAvailable()?Su:$g;break;case $i.NONE:t=Tu;break;default:return Pn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return bi(this._delegate,oR(this._delegate))}signInWithCredential(e){return bi(this._delegate,Gg(this._delegate,e))}signInWithCustomToken(e){return bi(this._delegate,$4(this._delegate,e))}signInWithEmailAndPassword(e,t){return bi(this._delegate,gR(this._delegate,e,t))}signInWithEmailLink(e,t){return bi(this._delegate,e5(this._delegate,e,t))}signInWithPhoneNumber(e,t){return D0(this._delegate,W5(this._delegate,e,t))}async signInWithPopup(e){return hd(n0(),this._delegate,"operation-not-supported-in-this-environment"),bi(this._delegate,ij(this._delegate,e,lo))}async signInWithRedirect(e){return hd(n0(),this._delegate,"operation-not-supported-in-this-environment"),await N0(this._delegate),uj(this._delegate,e,lo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return X4(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}k0.Persistence=$i;function WA(n,e,t){let i=n;typeof n!="function"&&({next:i,error:e,complete:t}=n);const r=i;return{next:c=>r(c&&Jg.getOrCreate(c)),error:e,complete:t}}function L3(n,e){const t=D3(n,e);if(typeof self<"u"&&!t.includes(Su)&&t.push(Su),typeof window<"u")for(const i of[$g,Io])t.includes(i)||t.push(i);return t.includes(Tu)||t.push(Tu),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(){this.providerId="phone",this._delegate=new Fl(FR(nc.auth()))}static credential(e,t){return Fl.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}sE.PHONE_SIGN_IN_METHOD=Fl.PHONE_SIGN_IN_METHOD;sE.PROVIDER_ID=Fl.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3=ue;class U3{constructor(e,t,i=nc.app()){var r;j3((r=i.options)===null||r===void 0?void 0:r.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new $5(i.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F3="auth-compat";function B3(n){n.INTERNAL.registerComponent(new Ni(F3,e=>{const t=e.getProvider("app-compat").getImmediate(),i=e.getProvider("auth");return new k0(t,i)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Jc.EMAIL_SIGNIN,PASSWORD_RESET:Jc.PASSWORD_RESET,RECOVER_EMAIL:Jc.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Jc.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Jc.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Jc.VERIFY_EMAIL}},EmailAuthProvider:Fo,FacebookAuthProvider:or,GithubAuthProvider:cr,GoogleAuthProvider:lr,OAuthProvider:fu,SAMLAuthProvider:ig,PhoneAuthProvider:sE,PhoneMultiFactorGenerator:PR,RecaptchaVerifier:U3,TwitterAuthProvider:ur,Auth:k0,AuthCredential:Yu,Error:li}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(w3,E3)}B3(nc);var YA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vl,zR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,x){function R(){}R.prototype=x.prototype,D.D=x.prototype,D.prototype=new R,D.prototype.constructor=D,D.C=function(V,L,P){for(var N=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)N[Ve-2]=arguments[Ve];return x.prototype[L].apply(V,N)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(D,x,R){R||(R=0);var V=Array(16);if(typeof x=="string")for(var L=0;16>L;++L)V[L]=x.charCodeAt(R++)|x.charCodeAt(R++)<<8|x.charCodeAt(R++)<<16|x.charCodeAt(R++)<<24;else for(L=0;16>L;++L)V[L]=x[R++]|x[R++]<<8|x[R++]<<16|x[R++]<<24;x=D.g[0],R=D.g[1],L=D.g[2];var P=D.g[3],N=x+(P^R&(L^P))+V[0]+3614090360&4294967295;x=R+(N<<7&4294967295|N>>>25),N=P+(L^x&(R^L))+V[1]+3905402710&4294967295,P=x+(N<<12&4294967295|N>>>20),N=L+(R^P&(x^R))+V[2]+606105819&4294967295,L=P+(N<<17&4294967295|N>>>15),N=R+(x^L&(P^x))+V[3]+3250441966&4294967295,R=L+(N<<22&4294967295|N>>>10),N=x+(P^R&(L^P))+V[4]+4118548399&4294967295,x=R+(N<<7&4294967295|N>>>25),N=P+(L^x&(R^L))+V[5]+1200080426&4294967295,P=x+(N<<12&4294967295|N>>>20),N=L+(R^P&(x^R))+V[6]+2821735955&4294967295,L=P+(N<<17&4294967295|N>>>15),N=R+(x^L&(P^x))+V[7]+4249261313&4294967295,R=L+(N<<22&4294967295|N>>>10),N=x+(P^R&(L^P))+V[8]+1770035416&4294967295,x=R+(N<<7&4294967295|N>>>25),N=P+(L^x&(R^L))+V[9]+2336552879&4294967295,P=x+(N<<12&4294967295|N>>>20),N=L+(R^P&(x^R))+V[10]+4294925233&4294967295,L=P+(N<<17&4294967295|N>>>15),N=R+(x^L&(P^x))+V[11]+2304563134&4294967295,R=L+(N<<22&4294967295|N>>>10),N=x+(P^R&(L^P))+V[12]+1804603682&4294967295,x=R+(N<<7&4294967295|N>>>25),N=P+(L^x&(R^L))+V[13]+4254626195&4294967295,P=x+(N<<12&4294967295|N>>>20),N=L+(R^P&(x^R))+V[14]+2792965006&4294967295,L=P+(N<<17&4294967295|N>>>15),N=R+(x^L&(P^x))+V[15]+1236535329&4294967295,R=L+(N<<22&4294967295|N>>>10),N=x+(L^P&(R^L))+V[1]+4129170786&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^L&(x^R))+V[6]+3225465664&4294967295,P=x+(N<<9&4294967295|N>>>23),N=L+(x^R&(P^x))+V[11]+643717713&4294967295,L=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(L^P))+V[0]+3921069994&4294967295,R=L+(N<<20&4294967295|N>>>12),N=x+(L^P&(R^L))+V[5]+3593408605&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^L&(x^R))+V[10]+38016083&4294967295,P=x+(N<<9&4294967295|N>>>23),N=L+(x^R&(P^x))+V[15]+3634488961&4294967295,L=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(L^P))+V[4]+3889429448&4294967295,R=L+(N<<20&4294967295|N>>>12),N=x+(L^P&(R^L))+V[9]+568446438&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^L&(x^R))+V[14]+3275163606&4294967295,P=x+(N<<9&4294967295|N>>>23),N=L+(x^R&(P^x))+V[3]+4107603335&4294967295,L=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(L^P))+V[8]+1163531501&4294967295,R=L+(N<<20&4294967295|N>>>12),N=x+(L^P&(R^L))+V[13]+2850285829&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^L&(x^R))+V[2]+4243563512&4294967295,P=x+(N<<9&4294967295|N>>>23),N=L+(x^R&(P^x))+V[7]+1735328473&4294967295,L=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(L^P))+V[12]+2368359562&4294967295,R=L+(N<<20&4294967295|N>>>12),N=x+(R^L^P)+V[5]+4294588738&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^L)+V[8]+2272392833&4294967295,P=x+(N<<11&4294967295|N>>>21),N=L+(P^x^R)+V[11]+1839030562&4294967295,L=P+(N<<16&4294967295|N>>>16),N=R+(L^P^x)+V[14]+4259657740&4294967295,R=L+(N<<23&4294967295|N>>>9),N=x+(R^L^P)+V[1]+2763975236&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^L)+V[4]+1272893353&4294967295,P=x+(N<<11&4294967295|N>>>21),N=L+(P^x^R)+V[7]+4139469664&4294967295,L=P+(N<<16&4294967295|N>>>16),N=R+(L^P^x)+V[10]+3200236656&4294967295,R=L+(N<<23&4294967295|N>>>9),N=x+(R^L^P)+V[13]+681279174&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^L)+V[0]+3936430074&4294967295,P=x+(N<<11&4294967295|N>>>21),N=L+(P^x^R)+V[3]+3572445317&4294967295,L=P+(N<<16&4294967295|N>>>16),N=R+(L^P^x)+V[6]+76029189&4294967295,R=L+(N<<23&4294967295|N>>>9),N=x+(R^L^P)+V[9]+3654602809&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^L)+V[12]+3873151461&4294967295,P=x+(N<<11&4294967295|N>>>21),N=L+(P^x^R)+V[15]+530742520&4294967295,L=P+(N<<16&4294967295|N>>>16),N=R+(L^P^x)+V[2]+3299628645&4294967295,R=L+(N<<23&4294967295|N>>>9),N=x+(L^(R|~P))+V[0]+4096336452&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~L))+V[7]+1126891415&4294967295,P=x+(N<<10&4294967295|N>>>22),N=L+(x^(P|~R))+V[14]+2878612391&4294967295,L=P+(N<<15&4294967295|N>>>17),N=R+(P^(L|~x))+V[5]+4237533241&4294967295,R=L+(N<<21&4294967295|N>>>11),N=x+(L^(R|~P))+V[12]+1700485571&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~L))+V[3]+2399980690&4294967295,P=x+(N<<10&4294967295|N>>>22),N=L+(x^(P|~R))+V[10]+4293915773&4294967295,L=P+(N<<15&4294967295|N>>>17),N=R+(P^(L|~x))+V[1]+2240044497&4294967295,R=L+(N<<21&4294967295|N>>>11),N=x+(L^(R|~P))+V[8]+1873313359&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~L))+V[15]+4264355552&4294967295,P=x+(N<<10&4294967295|N>>>22),N=L+(x^(P|~R))+V[6]+2734768916&4294967295,L=P+(N<<15&4294967295|N>>>17),N=R+(P^(L|~x))+V[13]+1309151649&4294967295,R=L+(N<<21&4294967295|N>>>11),N=x+(L^(R|~P))+V[4]+4149444226&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~L))+V[11]+3174756917&4294967295,P=x+(N<<10&4294967295|N>>>22),N=L+(x^(P|~R))+V[2]+718787259&4294967295,L=P+(N<<15&4294967295|N>>>17),N=R+(P^(L|~x))+V[9]+3951481745&4294967295,D.g[0]=D.g[0]+x&4294967295,D.g[1]=D.g[1]+(L+(N<<21&4294967295|N>>>11))&4294967295,D.g[2]=D.g[2]+L&4294967295,D.g[3]=D.g[3]+P&4294967295}i.prototype.u=function(D,x){x===void 0&&(x=D.length);for(var R=x-this.blockSize,V=this.B,L=this.h,P=0;P<x;){if(L==0)for(;P<=R;)r(this,D,P),P+=this.blockSize;if(typeof D=="string"){for(;P<x;)if(V[L++]=D.charCodeAt(P++),L==this.blockSize){r(this,V),L=0;break}}else for(;P<x;)if(V[L++]=D[P++],L==this.blockSize){r(this,V),L=0;break}}this.h=L,this.o+=x},i.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var x=1;x<D.length-8;++x)D[x]=0;var R=8*this.o;for(x=D.length-8;x<D.length;++x)D[x]=R&255,R/=256;for(this.u(D),D=Array(16),x=R=0;4>x;++x)for(var V=0;32>V;V+=8)D[R++]=this.g[x]>>>V&255;return D};function o(D,x){var R=h;return Object.prototype.hasOwnProperty.call(R,D)?R[D]:R[D]=x(D)}function c(D,x){this.h=x;for(var R=[],V=!0,L=D.length-1;0<=L;L--){var P=D[L]|0;V&&P==x||(R[L]=P,V=!1)}this.g=R}var h={};function d(D){return-128<=D&&128>D?o(D,function(x){return new c([x|0],0>x?-1:0)}):new c([D|0],0>D?-1:0)}function m(D){if(isNaN(D)||!isFinite(D))return y;if(0>D)return z(m(-D));for(var x=[],R=1,V=0;D>=R;V++)x[V]=D/R|0,R*=4294967296;return new c(x,0)}function _(D,x){if(D.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(D.charAt(0)=="-")return z(_(D.substring(1),x));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(x,8)),V=y,L=0;L<D.length;L+=8){var P=Math.min(8,D.length-L),N=parseInt(D.substring(L,L+P),x);8>P?(P=m(Math.pow(x,P)),V=V.j(P).add(m(N))):(V=V.j(R),V=V.add(m(N)))}return V}var y=d(0),b=d(1),I=d(16777216);n=c.prototype,n.m=function(){if(M(this))return-z(this).m();for(var D=0,x=1,R=0;R<this.g.length;R++){var V=this.i(R);D+=(0<=V?V:4294967296+V)*x,x*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(C(this))return"0";if(M(this))return"-"+z(this).toString(D);for(var x=m(Math.pow(D,6)),R=this,V="";;){var L=fe(R,x).g;R=B(R,L.j(x));var P=((0<R.g.length?R.g[0]:R.h)>>>0).toString(D);if(R=L,C(R))return P+V;for(;6>P.length;)P="0"+P;V=P+V}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function C(D){if(D.h!=0)return!1;for(var x=0;x<D.g.length;x++)if(D.g[x]!=0)return!1;return!0}function M(D){return D.h==-1}n.l=function(D){return D=B(this,D),M(D)?-1:C(D)?0:1};function z(D){for(var x=D.g.length,R=[],V=0;V<x;V++)R[V]=~D.g[V];return new c(R,~D.h).add(b)}n.abs=function(){return M(this)?z(this):this},n.add=function(D){for(var x=Math.max(this.g.length,D.g.length),R=[],V=0,L=0;L<=x;L++){var P=V+(this.i(L)&65535)+(D.i(L)&65535),N=(P>>>16)+(this.i(L)>>>16)+(D.i(L)>>>16);V=N>>>16,P&=65535,N&=65535,R[L]=N<<16|P}return new c(R,R[R.length-1]&-2147483648?-1:0)};function B(D,x){return D.add(z(x))}n.j=function(D){if(C(this)||C(D))return y;if(M(this))return M(D)?z(this).j(z(D)):z(z(this).j(D));if(M(D))return z(this.j(z(D)));if(0>this.l(I)&&0>D.l(I))return m(this.m()*D.m());for(var x=this.g.length+D.g.length,R=[],V=0;V<2*x;V++)R[V]=0;for(V=0;V<this.g.length;V++)for(var L=0;L<D.g.length;L++){var P=this.i(V)>>>16,N=this.i(V)&65535,Ve=D.i(L)>>>16,et=D.i(L)&65535;R[2*V+2*L]+=N*et,j(R,2*V+2*L),R[2*V+2*L+1]+=P*et,j(R,2*V+2*L+1),R[2*V+2*L+1]+=N*Ve,j(R,2*V+2*L+1),R[2*V+2*L+2]+=P*Ve,j(R,2*V+2*L+2)}for(V=0;V<x;V++)R[V]=R[2*V+1]<<16|R[2*V];for(V=x;V<2*x;V++)R[V]=0;return new c(R,0)};function j(D,x){for(;(D[x]&65535)!=D[x];)D[x+1]+=D[x]>>>16,D[x]&=65535,x++}function X(D,x){this.g=D,this.h=x}function fe(D,x){if(C(x))throw Error("division by zero");if(C(D))return new X(y,y);if(M(D))return x=fe(z(D),x),new X(z(x.g),z(x.h));if(M(x))return x=fe(D,z(x)),new X(z(x.g),x.h);if(30<D.g.length){if(M(D)||M(x))throw Error("slowDivide_ only works with positive integers.");for(var R=b,V=x;0>=V.l(D);)R=F(R),V=F(V);var L=ae(R,1),P=ae(V,1);for(V=ae(V,2),R=ae(R,2);!C(V);){var N=P.add(V);0>=N.l(D)&&(L=L.add(R),P=N),V=ae(V,1),R=ae(R,1)}return x=B(D,L.j(x)),new X(L,x)}for(L=y;0<=D.l(x);){for(R=Math.max(1,Math.floor(D.m()/x.m())),V=Math.ceil(Math.log(R)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),P=m(R),N=P.j(x);M(N)||0<N.l(D);)R-=V,P=m(R),N=P.j(x);C(P)&&(P=b),L=L.add(P),D=B(D,N)}return new X(L,D)}n.A=function(D){return fe(this,D).h},n.and=function(D){for(var x=Math.max(this.g.length,D.g.length),R=[],V=0;V<x;V++)R[V]=this.i(V)&D.i(V);return new c(R,this.h&D.h)},n.or=function(D){for(var x=Math.max(this.g.length,D.g.length),R=[],V=0;V<x;V++)R[V]=this.i(V)|D.i(V);return new c(R,this.h|D.h)},n.xor=function(D){for(var x=Math.max(this.g.length,D.g.length),R=[],V=0;V<x;V++)R[V]=this.i(V)^D.i(V);return new c(R,this.h^D.h)};function F(D){for(var x=D.g.length+1,R=[],V=0;V<x;V++)R[V]=D.i(V)<<1|D.i(V-1)>>>31;return new c(R,D.h)}function ae(D,x){var R=x>>5;x%=32;for(var V=D.g.length-R,L=[],P=0;P<V;P++)L[P]=0<x?D.i(P+R)>>>x|D.i(P+R+1)<<32-x:D.i(P+R);return new c(L,D.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,zR=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=_,Vl=c}).apply(typeof YA<"u"?YA:typeof self<"u"?self:typeof window<"u"?window:{});var Np=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qR,Sd,GR,qp,O0,HR,KR,$R;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,w,T){return f==Array.prototype||f==Object.prototype||(f[w]=T.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Np=="object"&&Np];for(var w=0;w<f.length;++w){var T=f[w];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var i=t(this);function r(f,w){if(w)e:{var T=i;f=f.split(".");for(var A=0;A<f.length-1;A++){var G=f[A];if(!(G in T))break e;T=T[G]}f=f[f.length-1],A=T[f],w=w(A),w!=A&&w!=null&&e(T,f,{configurable:!0,writable:!0,value:w})}}function o(f,w){f instanceof String&&(f+="");var T=0,A=!1,G={next:function(){if(!A&&T<f.length){var ee=T++;return{value:w(ee,f[ee]),done:!1}}return A=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}r("Array.prototype.values",function(f){return f||function(){return o(this,function(w,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},h=this||self;function d(f){var w=typeof f;return w=w!="object"?w:f?Array.isArray(f)?"array":w:"null",w=="array"||w=="object"&&typeof f.length=="number"}function m(f){var w=typeof f;return w=="object"&&f!=null||w=="function"}function _(f,w,T){return f.call.apply(f.bind,arguments)}function y(f,w,T){if(!f)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,A),f.apply(w,G)}}return function(){return f.apply(w,arguments)}}function b(f,w,T){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:y,b.apply(null,arguments)}function I(f,w){var T=Array.prototype.slice.call(arguments,1);return function(){var A=T.slice();return A.push.apply(A,arguments),f.apply(this,A)}}function C(f,w){function T(){}T.prototype=w.prototype,f.aa=w.prototype,f.prototype=new T,f.prototype.constructor=f,f.Qb=function(A,G,ee){for(var me=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)me[ft-2]=arguments[ft];return w.prototype[G].apply(A,me)}}function M(f){const w=f.length;if(0<w){const T=Array(w);for(let A=0;A<w;A++)T[A]=f[A];return T}return[]}function z(f,w){for(let T=1;T<arguments.length;T++){const A=arguments[T];if(d(A)){const G=f.length||0,ee=A.length||0;f.length=G+ee;for(let me=0;me<ee;me++)f[G+me]=A[me]}else f.push(A)}}class B{constructor(w,T){this.i=w,this.j=T,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function j(f){return/^[\s\xa0]*$/.test(f)}function X(){var f=h.navigator;return f&&(f=f.userAgent)?f:""}function fe(f){return fe[" "](f),f}fe[" "]=function(){};var F=X().indexOf("Gecko")!=-1&&!(X().toLowerCase().indexOf("webkit")!=-1&&X().indexOf("Edge")==-1)&&!(X().indexOf("Trident")!=-1||X().indexOf("MSIE")!=-1)&&X().indexOf("Edge")==-1;function ae(f,w,T){for(const A in f)w.call(T,f[A],A,f)}function D(f,w){for(const T in f)w.call(void 0,f[T],T,f)}function x(f){const w={};for(const T in f)w[T]=f[T];return w}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(f,w){let T,A;for(let G=1;G<arguments.length;G++){A=arguments[G];for(T in A)f[T]=A[T];for(let ee=0;ee<R.length;ee++)T=R[ee],Object.prototype.hasOwnProperty.call(A,T)&&(f[T]=A[T])}}function L(f){var w=1;f=f.split(":");const T=[];for(;0<w&&f.length;)T.push(f.shift()),w--;return f.length&&T.push(f.join(":")),T}function P(f){h.setTimeout(()=>{throw f},0)}function N(){var f=Se;let w=null;return f.g&&(w=f.g,f.g=f.g.next,f.g||(f.h=null),w.next=null),w}class Ve{constructor(){this.h=this.g=null}add(w,T){const A=et.get();A.set(w,T),this.h?this.h.next=A:this.g=A,this.h=A}}var et=new B(()=>new te,f=>f.reset());class te{constructor(){this.next=this.g=this.h=null}set(w,T){this.h=w,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let de,ce=!1,Se=new Ve,Re=()=>{const f=h.Promise.resolve(void 0);de=()=>{f.then(O)}};var O=()=>{for(var f;f=N();){try{f.h.call(f.g)}catch(T){P(T)}var w=et;w.j(f),100>w.h&&(w.h++,f.next=w.g,w.g=f)}ce=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(f,w){this.type=f,this.g=this.target=w,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var _e=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var f=!1,w=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const T=()=>{};h.addEventListener("test",T,w),h.removeEventListener("test",T,w)}catch{}return f})();function Te(f,w){if(re.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var T=this.type=f.type,A=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=w,w=f.relatedTarget){if(F){e:{try{fe(w.nodeName);var G=!0;break e}catch{}G=!1}G||(w=null)}}else T=="mouseover"?w=f.fromElement:T=="mouseout"&&(w=f.toElement);this.relatedTarget=w,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ke[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Te.aa.h.call(this)}}C(Te,re);var ke={2:"touch",3:"pen",4:"mouse"};Te.prototype.h=function(){Te.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),dt=0;function xt(f,w,T,A,G){this.listener=f,this.proxy=null,this.src=w,this.type=T,this.capture=!!A,this.ha=G,this.key=++dt,this.da=this.fa=!1}function Gn(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Oi(f){this.src=f,this.g={},this.h=0}Oi.prototype.add=function(f,w,T,A,G){var ee=f.toString();f=this.g[ee],f||(f=this.g[ee]=[],this.h++);var me=qs(f,w,A,G);return-1<me?(w=f[me],T||(w.fa=!1)):(w=new xt(w,this.src,ee,!!A,G),w.fa=T,f.push(w)),w};function zs(f,w){var T=w.type;if(T in f.g){var A=f.g[T],G=Array.prototype.indexOf.call(A,w,void 0),ee;(ee=0<=G)&&Array.prototype.splice.call(A,G,1),ee&&(Gn(w),f.g[T].length==0&&(delete f.g[T],f.h--))}}function qs(f,w,T,A){for(var G=0;G<f.length;++G){var ee=f[G];if(!ee.da&&ee.listener==w&&ee.capture==!!T&&ee.ha==A)return G}return-1}var Yn="closure_lm_"+(1e6*Math.random()|0),Sr={};function Ar(f,w,T,A,G){if(Array.isArray(w)){for(var ee=0;ee<w.length;ee++)Ar(f,w[ee],T,A,G);return null}return T=Pi(T),f&&f[Oe]?f.K(w,T,m(A)?!!A.capture:!1,G):fh(f,w,T,!1,A,G)}function fh(f,w,T,A,G,ee){if(!w)throw Error("Invalid event type");var me=m(G)?!!G.capture:!!G,ft=Rr(f);if(ft||(f[Yn]=ft=new Oi(f)),T=ft.add(w,T,A,me,ee),T.proxy)return T;if(A=xr(),T.proxy=A,A.src=f,A.listener=T,f.addEventListener)_e||(G=me),G===void 0&&(G=!1),f.addEventListener(w.toString(),A,G);else if(f.attachEvent)f.attachEvent(Cr(w.toString()),A);else if(f.addListener&&f.removeListener)f.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return T}function xr(){function f(T){return w.call(f.src,f.listener,T)}const w=va;return f}function As(f,w,T,A,G){if(Array.isArray(w))for(var ee=0;ee<w.length;ee++)As(f,w[ee],T,A,G);else A=m(A)?!!A.capture:!!A,T=Pi(T),f&&f[Oe]?(f=f.i,w=String(w).toString(),w in f.g&&(ee=f.g[w],T=qs(ee,T,A,G),-1<T&&(Gn(ee[T]),Array.prototype.splice.call(ee,T,1),ee.length==0&&(delete f.g[w],f.h--)))):f&&(f=Rr(f))&&(w=f.g[w.toString()],f=-1,w&&(f=qs(w,T,A,G)),(T=-1<f?w[f]:null)&&is(T))}function is(f){if(typeof f!="number"&&f&&!f.da){var w=f.src;if(w&&w[Oe])zs(w.i,f);else{var T=f.type,A=f.proxy;w.removeEventListener?w.removeEventListener(T,A,f.capture):w.detachEvent?w.detachEvent(Cr(T),A):w.addListener&&w.removeListener&&w.removeListener(A),(T=Rr(w))?(zs(T,f),T.h==0&&(T.src=null,w[Yn]=null)):Gn(f)}}}function Cr(f){return f in Sr?Sr[f]:Sr[f]="on"+f}function va(f,w){if(f.da)f=!0;else{w=new Te(w,this);var T=f.listener,A=f.ha||f.src;f.fa&&is(f),f=T.call(A,w)}return f}function Rr(f){return f=f[Yn],f instanceof Oi?f:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pi(f){return typeof f=="function"?f:(f[qt]||(f[qt]=function(w){return f.handleEvent(w)}),f[qt])}function tt(){H.call(this),this.i=new Oi(this),this.M=this,this.F=null}C(tt,H),tt.prototype[Oe]=!0,tt.prototype.removeEventListener=function(f,w,T,A){As(this,f,w,T,A)};function yt(f,w){var T,A=f.F;if(A)for(T=[];A;A=A.F)T.push(A);if(f=f.M,A=w.type||w,typeof w=="string")w=new re(w,f);else if(w instanceof re)w.target=w.target||f;else{var G=w;w=new re(A,f),V(w,G)}if(G=!0,T)for(var ee=T.length-1;0<=ee;ee--){var me=w.g=T[ee];G=xs(me,A,!0,w)&&G}if(me=w.g=f,G=xs(me,A,!0,w)&&G,G=xs(me,A,!1,w)&&G,T)for(ee=0;ee<T.length;ee++)me=w.g=T[ee],G=xs(me,A,!1,w)&&G}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var f=this.i,w;for(w in f.g){for(var T=f.g[w],A=0;A<T.length;A++)Gn(T[A]);delete f.g[w],f.h--}}this.F=null},tt.prototype.K=function(f,w,T,A){return this.i.add(String(f),w,!1,T,A)},tt.prototype.L=function(f,w,T,A){return this.i.add(String(f),w,!0,T,A)};function xs(f,w,T,A){if(w=f.i.g[String(w)],!w)return!0;w=w.concat();for(var G=!0,ee=0;ee<w.length;++ee){var me=w[ee];if(me&&!me.da&&me.capture==T){var ft=me.listener,cn=me.ha||me.src;me.fa&&zs(f.i,me),G=ft.call(cn,A)!==!1&&G}}return G&&!A.defaultPrevented}function Cs(f,w,T){if(typeof f=="function")T&&(f=b(f,T));else if(f&&typeof f.handleEvent=="function")f=b(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:h.setTimeout(f,w||0)}function Xn(f){f.g=Cs(()=>{f.g=null,f.i&&(f.i=!1,Xn(f))},f.l);const w=f.h;f.h=null,f.m.apply(null,w)}class Gt extends H{constructor(w,T){super(),this.m=w,this.l=T,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Xn(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nr(f){H.call(this),this.h=f,this.g={}}C(Nr,H);var Gs=[];function an(f){ae(f.g,function(w,T){this.g.hasOwnProperty(T)&&is(w)},f),f.g={}}Nr.prototype.N=function(){Nr.aa.N.call(this),an(this)},Nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var De=h.JSON.stringify,gn=h.JSON.parse,Ko=class{stringify(f){return h.JSON.stringify(f,void 0)}parse(f){return h.JSON.parse(f,void 0)}};function $o(){}$o.prototype.h=null;function dc(f){return f.h||(f.h=f.i())}function Hs(){}var Jn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Mi(){re.call(this,"d")}C(Mi,re);function di(){re.call(this,"c")}C(di,re);var fi={},Ks=null;function wa(){return Ks=Ks||new tt}fi.La="serverreachability";function Qo(f){re.call(this,fi.La,f)}C(Qo,re);function Rs(f){const w=wa();yt(w,new Qo(w))}fi.STAT_EVENT="statevent";function $s(f,w){re.call(this,fi.STAT_EVENT,f),this.stat=w}C($s,re);function _n(f){const w=wa();yt(w,new $s(w,f))}fi.Ma="timingevent";function Wo(f,w){re.call(this,fi.Ma,f),this.size=w}C(Wo,re);function Ns(f,w){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){f()},w)}function Qs(){this.g=!0}Qs.prototype.xa=function(){this.g=!1};function Yo(f,w,T,A,G,ee){f.info(function(){if(f.g)if(ee)for(var me="",ft=ee.split("&"),cn=0;cn<ft.length;cn++){var Be=ft[cn].split("=");if(1<Be.length){var Tn=Be[0];Be=Be[1];var In=Tn.split("_");me=2<=In.length&&In[1]=="type"?me+(Tn+"="+Be+"&"):me+(Tn+"=redacted&")}}else me=null;else me=ee;return"XMLHTTP REQ ("+A+") [attempt "+G+"]: "+w+`
`+T+`
`+me})}function Ea(f,w,T,A,G,ee,me){f.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+G+"]: "+w+`
`+T+`
`+ee+" "+me})}function Ds(f,w,T,A){f.info(function(){return"XMLHTTP TEXT ("+w+"): "+Vi(f,T)+(A?" "+A:"")})}function fc(f,w){f.info(function(){return"TIMEOUT: "+w})}Qs.prototype.info=function(){};function Vi(f,w){if(!f.g)return w;if(!w)return null;try{var T=JSON.parse(w);if(T){for(f=0;f<T.length;f++)if(Array.isArray(T[f])){var A=T[f];if(!(2>A.length)){var G=A[1];if(Array.isArray(G)&&!(1>G.length)){var ee=G[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(var me=1;me<G.length;me++)G[me]=""}}}}return De(T)}catch{return w}}var Ct={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},on={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Le;function Je(){}C(Je,$o),Je.prototype.g=function(){return new XMLHttpRequest},Je.prototype.i=function(){return{}},Le=new Je;function ln(f,w,T,A){this.j=f,this.i=w,this.l=T,this.R=A||1,this.U=new Nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ws}function Ws(){this.i=null,this.g="",this.h=!1}var ks={},ss={};function rs(f,w,T){f.L=1,f.v=Jo(Ht(w)),f.m=T,f.P=!0,Hn(f,null)}function Hn(f,w){f.F=Date.now(),Li(f),f.A=Ht(f.v);var T=f.A,A=f.R;Array.isArray(A)||(A=[String(A)]),Or(T.i,"t",A),f.C=0,T=f.j.J,f.h=new Ws,f.g=Em(f.j,T?w:null,!f.m),0<f.O&&(f.M=new Gt(b(f.Y,f,f.g),f.O)),w=f.U,T=f.g,A=f.ca;var G="readystatechange";Array.isArray(G)||(G&&(Gs[0]=G.toString()),G=Gs);for(var ee=0;ee<G.length;ee++){var me=Ar(T,G[ee],A||w.handleEvent,!1,w.h||w);if(!me)break;w.g[me.key]=me}w=f.H?x(f.H):{},f.m?(f.u||(f.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,w)):(f.u="GET",f.g.ea(f.A,f.u,null,w)),Rs(),Yo(f.i,f.u,f.A,f.l,f.R,f.m)}ln.prototype.ca=function(f){f=f.target;const w=this.M;w&&ti(f)==3?w.j():this.Y(f)},ln.prototype.Y=function(f){try{if(f==this.g)e:{const In=ti(this.g);var w=this.g.Ba();const Pa=this.g.Z();if(!(3>In)&&(In!=3||this.g&&(this.h.h||this.g.oa()||tl(this.g)))){this.J||In!=4||w==7||(w==8||0>=Pa?Rs(3):Rs(2)),mc(this);var T=this.g.Z();this.X=T;t:if(mi(this)){var A=tl(this.g);f="";var G=A.length,ee=ti(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zn(this),ba(this);var me="";break t}this.h.i=new h.TextDecoder}for(w=0;w<G;w++)this.h.h=!0,f+=this.h.i.decode(A[w],{stream:!(ee&&w==G-1)});A.length=0,this.h.g+=f,this.C=0,me=this.h.g}else me=this.g.oa();if(this.o=T==200,Ea(this.i,this.u,this.A,this.l,this.R,In,T),this.o){if(this.T&&!this.K){t:{if(this.g){var ft,cn=this.g;if((ft=cn.g?cn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(ft)){var Be=ft;break t}}Be=null}if(T=Be)Ds(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ys(this,T);else{this.o=!1,this.s=3,_n(12),Zn(this),ba(this);break e}}if(this.P){T=!0;let gi;for(;!this.J&&this.C<me.length;)if(gi=Dr(this,me),gi==ss){In==4&&(this.s=4,_n(14),T=!1),Ds(this.i,this.l,null,"[Incomplete Response]");break}else if(gi==ks){this.s=4,_n(15),Ds(this.i,this.l,me,"[Invalid Chunk]"),T=!1;break}else Ds(this.i,this.l,gi,null),Ys(this,gi);if(mi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),In!=4||me.length!=0||this.h.h||(this.s=1,_n(16),T=!1),this.o=this.o&&T,!T)Ds(this.i,this.l,me,"[Invalid Chunked Response]"),Zn(this),ba(this);else if(0<me.length&&!this.W){this.W=!0;var Tn=this.j;Tn.g==this&&Tn.ba&&!Tn.M&&(Tn.j.info("Great, no buffering proxy detected. Bytes received: "+me.length),Ih(Tn),Tn.M=!0,_n(11))}}else Ds(this.i,this.l,me,null),Ys(this,me);In==4&&Zn(this),this.o&&!this.J&&(In==4?ym(this.j,this):(this.o=!1,Li(this)))}else dm(this.g),T==400&&0<me.indexOf("Unknown SID")?(this.s=3,_n(12)):(this.s=0,_n(13)),Zn(this),ba(this)}}}catch{}finally{}};function mi(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Dr(f,w){var T=f.C,A=w.indexOf(`
`,T);return A==-1?ss:(T=Number(w.substring(T,A)),isNaN(T)?ks:(A+=1,A+T>w.length?ss:(w=w.slice(A,A+T),f.C=A+T,w)))}ln.prototype.cancel=function(){this.J=!0,Zn(this)};function Li(f){f.S=Date.now()+f.I,en(f,f.I)}function en(f,w){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Ns(b(f.ba,f),w)}function mc(f){f.B&&(h.clearTimeout(f.B),f.B=null)}ln.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(fc(this.i,this.A),this.L!=2&&(Rs(),_n(17)),Zn(this),this.s=2,ba(this)):en(this,this.S-f)};function ba(f){f.j.G==0||f.J||ym(f.j,f)}function Zn(f){mc(f);var w=f.M;w&&typeof w.ma=="function"&&w.ma(),f.M=null,an(f.U),f.g&&(w=f.g,f.g=null,w.abort(),w.ma())}function Ys(f,w){try{var T=f.j;if(T.G!=0&&(T.g==f||Ta(T.h,f))){if(!f.K&&Ta(T.h,f)&&T.G==3){try{var A=T.Da.g.parse(w)}catch{A=null}if(Array.isArray(A)&&A.length==3){var G=A;if(G[0]==0){e:if(!T.u){if(T.g)if(T.g.F+3e3<f.F)ka(T),Da(T);else break e;Th(T),_n(18)}}else T.za=G[1],0<T.za-T.T&&37500>G[2]&&T.F&&T.v==0&&!T.C&&(T.C=Ns(b(T.Za,T),6e3));if(1>=am(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else Mr(T,11)}else if((f.K||T.g==f)&&ka(T),!j(w))for(G=T.Da.g.parse(w),w=0;w<G.length;w++){let Be=G[w];if(T.T=Be[0],Be=Be[1],T.G==2)if(Be[0]=="c"){T.K=Be[1],T.ia=Be[2];const Tn=Be[3];Tn!=null&&(T.la=Tn,T.j.info("VER="+T.la));const In=Be[4];In!=null&&(T.Aa=In,T.j.info("SVER="+T.Aa));const Pa=Be[5];Pa!=null&&typeof Pa=="number"&&0<Pa&&(A=1.5*Pa,T.L=A,T.j.info("backChannelRequestTimeoutMs_="+A)),A=T;const gi=f.g;if(gi){const sl=gi.g?gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sl){var ee=A.h;ee.g||sl.indexOf("spdy")==-1&&sl.indexOf("quic")==-1&&sl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Ia(ee,ee.h),ee.h=null))}if(A.D){const Vr=gi.g?gi.g.getResponseHeader("X-HTTP-Session-Id"):null;Vr&&(A.ya=Vr,ot(A.I,A.D,Vr))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-f.F,T.j.info("Handshake RTT: "+T.R+"ms")),A=T;var me=f;if(A.qa=wm(A,A.J?A.ia:null,A.W),me.K){as(A.h,me);var ft=me,cn=A.L;cn&&(ft.I=cn),ft.B&&(mc(ft),Li(ft)),A.g=me}else gm(A);0<T.i.length&&bc(T)}else Be[0]!="stop"&&Be[0]!="close"||Mr(T,7);else T.G==3&&(Be[0]=="stop"||Be[0]=="close"?Be[0]=="stop"?Mr(T,7):Eh(T):Be[0]!="noop"&&T.l&&T.l.ta(Be),T.v=0)}}Rs(4)}catch{}}var z_=class{constructor(f,w){this.g=f,this.map=w}};function mh(f){this.l=f||10,h.PerformanceNavigationTiming?(f=h.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ph(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function am(f){return f.h?1:f.g?f.g.size:0}function Ta(f,w){return f.h?f.h==w:f.g?f.g.has(w):!1}function Ia(f,w){f.g?f.g.add(w):f.h=w}function as(f,w){f.h&&f.h==w?f.h=null:f.g&&f.g.has(w)&&f.g.delete(w)}mh.prototype.cancel=function(){if(this.i=ei(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function ei(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let w=f.i;for(const T of f.g.values())w=w.concat(T.D);return w}return M(f.i)}function om(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(d(f)){for(var w=[],T=f.length,A=0;A<T;A++)w.push(f[A]);return w}w=[],T=0;for(A in f)w[T++]=f[A];return w}function q_(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(d(f)||typeof f=="string"){var w=[];f=f.length;for(var T=0;T<f;T++)w.push(T);return w}w=[],T=0;for(const A in f)w[T++]=A;return w}}}function pc(f,w){if(f.forEach&&typeof f.forEach=="function")f.forEach(w,void 0);else if(d(f)||typeof f=="string")Array.prototype.forEach.call(f,w,void 0);else for(var T=q_(f),A=om(f),G=A.length,ee=0;ee<G;ee++)w.call(void 0,A[ee],T&&T[ee],f)}var gh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gc(f,w){if(f){f=f.split("&");for(var T=0;T<f.length;T++){var A=f[T].indexOf("="),G=null;if(0<=A){var ee=f[T].substring(0,A);G=f[T].substring(A+1)}else ee=f[T];w(ee,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function kr(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof kr){this.h=f.h,Sa(this,f.j),this.o=f.o,this.g=f.g,Xo(this,f.s),this.l=f.l;var w=f.i,T=new Xs;T.i=w.i,w.g&&(T.g=new Map(w.g),T.h=w.h),_c(this,T),this.m=f.m}else f&&(w=String(f).match(gh))?(this.h=!1,Sa(this,w[1]||"",!0),this.o=Aa(w[2]||""),this.g=Aa(w[3]||"",!0),Xo(this,w[4]),this.l=Aa(w[5]||"",!0),_c(this,w[6]||"",!0),this.m=Aa(w[7]||"")):(this.h=!1,this.i=new Xs(null,this.h))}kr.prototype.toString=function(){var f=[],w=this.j;w&&f.push(os(w,_h,!0),":");var T=this.g;return(T||w=="file")&&(f.push("//"),(w=this.o)&&f.push(os(w,_h,!0),"@"),f.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&f.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&f.push("/"),f.push(os(T,T.charAt(0)=="/"?yh:lm,!0))),(T=this.i.toString())&&f.push("?",T),(T=this.m)&&f.push("#",os(T,K_)),f.join("")};function Ht(f){return new kr(f)}function Sa(f,w,T){f.j=T?Aa(w,!0):w,f.j&&(f.j=f.j.replace(/:$/,""))}function Xo(f,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);f.s=w}else f.s=null}function _c(f,w,T){w instanceof Xs?(f.i=w,cm(f.i,f.h)):(T||(w=os(w,H_)),f.i=new Xs(w,f.h))}function ot(f,w,T){f.i.set(w,T)}function Jo(f){return ot(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Aa(f,w){return f?w?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function os(f,w,T){return typeof f=="string"?(f=encodeURI(f).replace(w,G_),T&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function G_(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var _h=/[#\/\?@]/g,lm=/[#\?:]/g,yh=/[#\?]/g,H_=/[#\?@]/g,K_=/#/g;function Xs(f,w){this.h=this.g=null,this.i=f||null,this.j=!!w}function bn(f){f.g||(f.g=new Map,f.h=0,f.i&&gc(f.i,function(w,T){f.add(decodeURIComponent(w.replace(/\+/g," ")),T)}))}n=Xs.prototype,n.add=function(f,w){bn(this),this.i=null,f=ji(this,f);var T=this.g.get(f);return T||this.g.set(f,T=[]),T.push(w),this.h+=1,this};function yc(f,w){bn(f),w=ji(f,w),f.g.has(w)&&(f.i=null,f.h-=f.g.get(w).length,f.g.delete(w))}function vc(f,w){return bn(f),w=ji(f,w),f.g.has(w)}n.forEach=function(f,w){bn(this),this.g.forEach(function(T,A){T.forEach(function(G){f.call(w,G,A,this)},this)},this)},n.na=function(){bn(this);const f=Array.from(this.g.values()),w=Array.from(this.g.keys()),T=[];for(let A=0;A<w.length;A++){const G=f[A];for(let ee=0;ee<G.length;ee++)T.push(w[A])}return T},n.V=function(f){bn(this);let w=[];if(typeof f=="string")vc(this,f)&&(w=w.concat(this.g.get(ji(this,f))));else{f=Array.from(this.g.values());for(let T=0;T<f.length;T++)w=w.concat(f[T])}return w},n.set=function(f,w){return bn(this),this.i=null,f=ji(this,f),vc(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[w]),this.h+=1,this},n.get=function(f,w){return f?(f=this.V(f),0<f.length?String(f[0]):w):w};function Or(f,w,T){yc(f,w),0<T.length&&(f.i=null,f.g.set(ji(f,w),M(T)),f.h+=T.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],w=Array.from(this.g.keys());for(var T=0;T<w.length;T++){var A=w[T];const ee=encodeURIComponent(String(A)),me=this.V(A);for(A=0;A<me.length;A++){var G=ee;me[A]!==""&&(G+="="+encodeURIComponent(String(me[A]))),f.push(G)}}return this.i=f.join("&")};function ji(f,w){return w=String(w),f.j&&(w=w.toLowerCase()),w}function cm(f,w){w&&!f.j&&(bn(f),f.i=null,f.g.forEach(function(T,A){var G=A.toLowerCase();A!=G&&(yc(this,A),Or(this,G,T))},f)),f.j=w}function vh(f,w){const T=new Qs;if(h.Image){const A=new Image;A.onload=I(pi,T,"TestLoadImage: loaded",!0,w,A),A.onerror=I(pi,T,"TestLoadImage: error",!1,w,A),A.onabort=I(pi,T,"TestLoadImage: abort",!1,w,A),A.ontimeout=I(pi,T,"TestLoadImage: timeout",!1,w,A),h.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=f}else w(!1)}function um(f,w){const T=new Qs,A=new AbortController,G=setTimeout(()=>{A.abort(),pi(T,"TestPingServer: timeout",!1,w)},1e4);fetch(f,{signal:A.signal}).then(ee=>{clearTimeout(G),ee.ok?pi(T,"TestPingServer: ok",!0,w):pi(T,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(G),pi(T,"TestPingServer: error",!1,w)})}function pi(f,w,T,A,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),A(T)}catch{}}function Os(){this.g=new Ko}function wh(f,w,T){const A=T||"";try{pc(f,function(G,ee){let me=G;m(G)&&(me=De(G)),w.push(A+ee+"="+encodeURIComponent(me))})}catch(G){throw w.push(A+"type="+encodeURIComponent("_badmap")),G}}function Js(f){this.l=f.Ub||null,this.j=f.eb||!1}C(Js,$o),Js.prototype.g=function(){return new Ui(this.l,this.j)},Js.prototype.i=(function(f){return function(){return f}})({});function Ui(f,w){tt.call(this),this.D=f,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Ui,tt),n=Ui.prototype,n.open=function(f,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=w,this.readyState=1,xa(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(w.body=f),(this.D||h).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zs(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,xa(this)),this.g&&(this.readyState=3,xa(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;wc(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function wc(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var w=f.value?f.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!f.done}))&&(this.response=this.responseText+=w)}f.done?Zs(this):xa(this),this.readyState==3&&wc(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,Zs(this))},n.Qa=function(f){this.g&&(this.response=f,Zs(this))},n.ga=function(){this.g&&Zs(this)};function Zs(f){f.readyState=4,f.l=null,f.j=null,f.v=null,xa(f)}n.setRequestHeader=function(f,w){this.u.append(f,w)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],w=this.h.entries();for(var T=w.next();!T.done;)T=T.value,f.push(T[0]+": "+T[1]),T=w.next();return f.join(`\r
`)};function xa(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ui.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Zo(f){let w="";return ae(f,function(T,A){w+=A,w+=":",w+=T,w+=`\r
`}),w}function Ca(f,w,T){e:{for(A in T){var A=!1;break e}A=!0}A||(T=Zo(T),typeof f=="string"?T!=null&&encodeURIComponent(String(T)):ot(f,w,T))}function Rt(f){tt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Rt,tt);var Kn=/^https?$/i,Pr=["POST","PUT"];n=Rt.prototype,n.Ha=function(f){this.J=f},n.ea=function(f,w,T,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);w=w?w.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Le.g(),this.v=this.o?dc(this.o):dc(Le),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(w,String(f),!0),this.B=!1}catch(ee){el(this,ee);return}if(f=T||"",T=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var G in A)T.set(G,A[G]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ee of A.keys())T.set(ee,A.get(ee));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(T.keys()).find(ee=>ee.toLowerCase()=="content-type"),G=h.FormData&&f instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Pr,w,void 0))||A||G||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,me]of T)this.g.setRequestHeader(ee,me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ec(this),this.u=!0,this.g.send(f),this.u=!1}catch(ee){el(this,ee)}};function el(f,w){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=w,f.m=5,Ra(f),Na(f)}function Ra(f){f.A||(f.A=!0,yt(f,"complete"),yt(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,yt(this,"complete"),yt(this,"abort"),Na(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Na(this,!0)),Rt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?hm(this):this.bb())},n.bb=function(){hm(this)};function hm(f){if(f.h&&typeof c<"u"&&(!f.v[1]||ti(f)!=4||f.Z()!=2)){if(f.u&&ti(f)==4)Cs(f.Ea,0,f);else if(yt(f,"readystatechange"),ti(f)==4){f.h=!1;try{const me=f.Z();e:switch(me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var T;if(!(T=w)){var A;if(A=me===0){var G=String(f.D).match(gh)[1]||null;!G&&h.self&&h.self.location&&(G=h.self.location.protocol.slice(0,-1)),A=!Kn.test(G?G.toLowerCase():"")}T=A}if(T)yt(f,"complete"),yt(f,"success");else{f.m=6;try{var ee=2<ti(f)?f.g.statusText:""}catch{ee=""}f.l=ee+" ["+f.Z()+"]",Ra(f)}}finally{Na(f)}}}}function Na(f,w){if(f.g){Ec(f);const T=f.g,A=f.v[0]?()=>{}:null;f.g=null,f.v=null,w||yt(f,"ready");try{T.onreadystatechange=A}catch{}}}function Ec(f){f.I&&(h.clearTimeout(f.I),f.I=null)}n.isActive=function(){return!!this.g};function ti(f){return f.g?f.g.readyState:0}n.Z=function(){try{return 2<ti(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var w=this.g.responseText;return f&&w.indexOf(f)==0&&(w=w.substring(f.length)),gn(w)}};function tl(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function dm(f){const w={};f=(f.g&&2<=ti(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<f.length;A++){if(j(f[A]))continue;var T=L(f[A]);const G=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const ee=w[G]||[];w[G]=ee,ee.push(T)}D(w,function(A){return A.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function nl(f,w,T){return T&&T.internalChannelParams&&T.internalChannelParams[f]||w}function fm(f){this.Aa=0,this.i=[],this.j=new Qs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=nl("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=nl("baseRetryDelayMs",5e3,f),this.cb=nl("retryDelaySeedMs",1e4,f),this.Wa=nl("forwardChannelMaxRetries",2,f),this.wa=nl("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new mh(f&&f.concurrentRequestLimit),this.Da=new Os,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=fm.prototype,n.la=8,n.G=1,n.connect=function(f,w,T,A){_n(0),this.W=f,this.H=w||{},T&&A!==void 0&&(this.H.OSID=T,this.H.OAID=A),this.F=this.X,this.I=wm(this,null,this.W),bc(this)};function Eh(f){if(mm(f),f.G==3){var w=f.U++,T=Ht(f.I);if(ot(T,"SID",f.K),ot(T,"RID",w),ot(T,"TYPE","terminate"),il(f,T),w=new ln(f,f.j,w),w.L=2,w.v=Jo(Ht(T)),T=!1,h.navigator&&h.navigator.sendBeacon)try{T=h.navigator.sendBeacon(w.v.toString(),"")}catch{}!T&&h.Image&&(new Image().src=w.v,T=!0),T||(w.g=Em(w.j,null),w.g.ea(w.v)),w.F=Date.now(),Li(w)}Sh(f)}function Da(f){f.g&&(Ih(f),f.g.cancel(),f.g=null)}function mm(f){Da(f),f.u&&(h.clearTimeout(f.u),f.u=null),ka(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&h.clearTimeout(f.s),f.s=null)}function bc(f){if(!ph(f.h)&&!f.s){f.s=!0;var w=f.Ga;de||Re(),ce||(de(),ce=!0),Se.add(w,f),f.B=0}}function $_(f,w){return am(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=w.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Ns(b(f.Ga,f,w),vm(f,f.B)),f.B++,!0)}n.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const G=new ln(this,this.j,f);let ee=this.o;if(this.S&&(ee?(ee=x(ee),V(ee,this.S)):ee=this.S),this.m!==null||this.O||(G.H=ee,ee=null),this.P)e:{for(var w=0,T=0;T<this.i.length;T++){t:{var A=this.i[T];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(w+=A,4096<w){w=T;break e}if(w===4096||T===this.i.length-1){w=T+1;break e}}w=1e3}else w=1e3;w=bh(this,G,w),T=Ht(this.I),ot(T,"RID",f),ot(T,"CVER",22),this.D&&ot(T,"X-HTTP-Session-Id",this.D),il(this,T),ee&&(this.O?w="headers="+encodeURIComponent(String(Zo(ee)))+"&"+w:this.m&&Ca(T,this.m,ee)),Ia(this.h,G),this.Ua&&ot(T,"TYPE","init"),this.P?(ot(T,"$req",w),ot(T,"SID","null"),G.T=!0,rs(G,T,null)):rs(G,T,w),this.G=2}}else this.G==3&&(f?pm(this,f):this.i.length==0||ph(this.h)||pm(this))};function pm(f,w){var T;w?T=w.l:T=f.U++;const A=Ht(f.I);ot(A,"SID",f.K),ot(A,"RID",T),ot(A,"AID",f.T),il(f,A),f.m&&f.o&&Ca(A,f.m,f.o),T=new ln(f,f.j,T,f.B+1),f.m===null&&(T.H=f.o),w&&(f.i=w.D.concat(f.i)),w=bh(f,T,1e3),T.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ia(f.h,T),rs(T,A,w)}function il(f,w){f.H&&ae(f.H,function(T,A){ot(w,A,T)}),f.l&&pc({},function(T,A){ot(w,A,T)})}function bh(f,w,T){T=Math.min(f.i.length,T);var A=f.l?b(f.l.Na,f.l,f):null;e:{var G=f.i;let ee=-1;for(;;){const me=["count="+T];ee==-1?0<T?(ee=G[0].g,me.push("ofs="+ee)):ee=0:me.push("ofs="+ee);let ft=!0;for(let cn=0;cn<T;cn++){let Be=G[cn].g;const Tn=G[cn].map;if(Be-=ee,0>Be)ee=Math.max(0,G[cn].g-100),ft=!1;else try{wh(Tn,me,"req"+Be+"_")}catch{A&&A(Tn)}}if(ft){A=me.join("&");break e}}}return f=f.i.splice(0,T),w.D=f,A}function gm(f){if(!f.g&&!f.u){f.Y=1;var w=f.Fa;de||Re(),ce||(de(),ce=!0),Se.add(w,f),f.v=0}}function Th(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Ns(b(f.Fa,f),vm(f,f.v)),f.v++,!0)}n.Fa=function(){if(this.u=null,_m(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Ns(b(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_n(10),Da(this),_m(this))};function Ih(f){f.A!=null&&(h.clearTimeout(f.A),f.A=null)}function _m(f){f.g=new ln(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var w=Ht(f.qa);ot(w,"RID","rpc"),ot(w,"SID",f.K),ot(w,"AID",f.T),ot(w,"CI",f.F?"0":"1"),!f.F&&f.ja&&ot(w,"TO",f.ja),ot(w,"TYPE","xmlhttp"),il(f,w),f.m&&f.o&&Ca(w,f.m,f.o),f.L&&(f.g.I=f.L);var T=f.g;f=f.ia,T.L=1,T.v=Jo(Ht(w)),T.m=null,T.P=!0,Hn(T,f)}n.Za=function(){this.C!=null&&(this.C=null,Da(this),Th(this),_n(19))};function ka(f){f.C!=null&&(h.clearTimeout(f.C),f.C=null)}function ym(f,w){var T=null;if(f.g==w){ka(f),Ih(f),f.g=null;var A=2}else if(Ta(f.h,w))T=w.D,as(f.h,w),A=1;else return;if(f.G!=0){if(w.o)if(A==1){T=w.m?w.m.length:0,w=Date.now()-w.F;var G=f.B;A=wa(),yt(A,new Wo(A,T)),bc(f)}else gm(f);else if(G=w.s,G==3||G==0&&0<w.X||!(A==1&&$_(f,w)||A==2&&Th(f)))switch(T&&0<T.length&&(w=f.h,w.i=w.i.concat(T)),G){case 1:Mr(f,5);break;case 4:Mr(f,10);break;case 3:Mr(f,6);break;default:Mr(f,2)}}}function vm(f,w){let T=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(T*=2),T*w}function Mr(f,w){if(f.j.info("Error code "+w),w==2){var T=b(f.fb,f),A=f.Xa;const G=!A;A=new kr(A||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Sa(A,"https"),Jo(A),G?vh(A.toString(),T):um(A.toString(),T)}else _n(2);f.G=0,f.l&&f.l.sa(w),Sh(f),mm(f)}n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),_n(2)):(this.j.info("Failed to ping google.com"),_n(1))};function Sh(f){if(f.G=0,f.ka=[],f.l){const w=ei(f.h);(w.length!=0||f.i.length!=0)&&(z(f.ka,w),z(f.ka,f.i),f.h.i.length=0,M(f.i),f.i.length=0),f.l.ra()}}function wm(f,w,T){var A=T instanceof kr?Ht(T):new kr(T);if(A.g!="")w&&(A.g=w+"."+A.g),Xo(A,A.s);else{var G=h.location;A=G.protocol,w=w?w+"."+G.hostname:G.hostname,G=+G.port;var ee=new kr(null);A&&Sa(ee,A),w&&(ee.g=w),G&&Xo(ee,G),T&&(ee.l=T),A=ee}return T=f.D,w=f.ya,T&&w&&ot(A,T,w),ot(A,"VER",f.la),il(f,A),A}function Em(f,w,T){if(w&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=f.Ca&&!f.pa?new Rt(new Js({eb:T})):new Rt(f.pa),w.Ha(f.J),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bm(){}n=bm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Tc(){}Tc.prototype.g=function(f,w){return new ni(f,w)};function ni(f,w){tt.call(this),this.g=new fm(w),this.l=f,this.h=w&&w.messageUrlParams||null,f=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(f?f["X-WebChannel-Content-Type"]=w.messageContentType:f={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(f?f["X-WebChannel-Client-Profile"]=w.va:f={"X-WebChannel-Client-Profile":w.va}),this.g.S=f,(f=w&&w.Sb)&&!j(f)&&(this.g.m=f),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!j(w)&&(this.g.D=w,f=this.h,f!==null&&w in f&&(f=this.h,w in f&&delete f[w])),this.j=new Oa(this)}C(ni,tt),ni.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ni.prototype.close=function(){Eh(this.g)},ni.prototype.o=function(f){var w=this.g;if(typeof f=="string"){var T={};T.__data__=f,f=T}else this.u&&(T={},T.__data__=De(f),f=T);w.i.push(new z_(w.Ya++,f)),w.G==3&&bc(w)},ni.prototype.N=function(){this.g.l=null,delete this.j,Eh(this.g),delete this.g,ni.aa.N.call(this)};function Tm(f){Mi.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var w=f.__sm__;if(w){e:{for(const T in w){f=T;break e}f=void 0}(this.i=f)&&(f=this.i,w=w!==null&&f in w?w[f]:void 0),this.data=w}else this.data=f}C(Tm,Mi);function Im(){di.call(this),this.status=1}C(Im,di);function Oa(f){this.g=f}C(Oa,bm),Oa.prototype.ua=function(){yt(this.g,"a")},Oa.prototype.ta=function(f){yt(this.g,new Tm(f))},Oa.prototype.sa=function(f){yt(this.g,new Im)},Oa.prototype.ra=function(){yt(this.g,"b")},Tc.prototype.createWebChannel=Tc.prototype.g,ni.prototype.send=ni.prototype.o,ni.prototype.open=ni.prototype.m,ni.prototype.close=ni.prototype.close,$R=function(){return new Tc},KR=function(){return wa()},HR=fi,O0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ct.NO_ERROR=0,Ct.TIMEOUT=8,Ct.HTTP_ERROR=6,qp=Ct,on.COMPLETE="complete",GR=on,Hs.EventType=Jn,Jn.OPEN="a",Jn.CLOSE="b",Jn.ERROR="c",Jn.MESSAGE="d",tt.prototype.listen=tt.prototype.K,Sd=Hs,Rt.prototype.listenOnce=Rt.prototype.L,Rt.prototype.getLastError=Rt.prototype.Ka,Rt.prototype.getLastErrorCode=Rt.prototype.Ba,Rt.prototype.getStatus=Rt.prototype.Z,Rt.prototype.getResponseJson=Rt.prototype.Oa,Rt.prototype.getResponseText=Rt.prototype.oa,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Ha,qR=Rt}).apply(typeof Np<"u"?Np:typeof self<"u"?self:typeof window<"u"?window:{});const XA="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Rn.UNAUTHENTICATED=new Rn(null),Rn.GOOGLE_CREDENTIALS=new Rn("google-credentials-uid"),Rn.FIRST_PARTY=new Rn("first-party-uid"),Rn.MOCK_USER=new Rn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ju="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So=new $u("@firebase/firestore");function su(){return So.logLevel}function z3(n){So.setLogLevel(n)}function le(n,...e){if(So.logLevel<=Ge.DEBUG){const t=e.map(rE);So.debug(`Firestore (${Ju}): ${n}`,...t)}}function sn(n,...e){if(So.logLevel<=Ge.ERROR){const t=e.map(rE);So.error(`Firestore (${Ju}): ${n}`,...t)}}function vr(n,...e){if(So.logLevel<=Ge.WARN){const t=e.map(rE);So.warn(`Firestore (${Ju}): ${n}`,...t)}}function rE(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(n="Unexpected state"){const e=`FIRESTORE (${Ju}) INTERNAL ASSERTION FAILED: `+n;throw sn(e),new Error(e)}function Ee(n,e){n||ve()}function q3(n,e){n||ve()}function ge(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends li{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class G3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Rn.UNAUTHENTICATED)))}shutdown(){}}class H3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class K3{constructor(e){this.t=e,this.currentUser=Rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ee(this.o===void 0);let i=this.i;const r=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve();let o=new zn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new zn,e.enqueueRetryable((()=>r(this.currentUser)))};const c=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await r(this.currentUser)}))},h=d=>{le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((d=>h(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(le("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new zn)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ee(typeof i.accessToken=="string"),new QR(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ee(e===null||typeof e=="string"),new Rn(e)}}class $3{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Rn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Q3{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new $3(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Rn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class W3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Y3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ee(this.o===void 0);const i=o=>{o.error!=null&&le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.R;return this.R=o.token,le("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const r=o=>{le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((o=>r(o))),setTimeout((()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?r(o):le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ee(typeof t.token=="string"),this.R=t.token,new W3(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=X3(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%e.length))}return i}}function Me(n,e){return n<e?-1:n>e?1:0}function Au(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function YR(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new oe(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new oe(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new oe(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return jt.fromMillis(Date.now())}static fromDate(e){return jt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new jt(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new jt(0,0))}static max(){return new Ie(new jt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,t,i){t===void 0?t=0:t>e.length&&ve(),i===void 0?i=e.length-t:i>e.length-t&&ve(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return sf.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof sf?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const o=e.get(r),c=t.get(r);if(o<c)return-1;if(o>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ye extends sf{construct(e,t,i){return new Ye(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new oe(Z.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ye(t)}static emptyPath(){return new Ye([])}}const J3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mt extends sf{construct(e,t,i){return new Mt(e,t,i)}static isValidIdentifier(e){return J3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Mt(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const o=()=>{if(i.length===0)throw new oe(Z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;r<e.length;){const h=e[r];if(h==="\\"){if(r+1===e.length)throw new oe(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[r+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new oe(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,r+=2}else h==="`"?(c=!c,r++):h!=="."||c?(i+=h,r++):(o(),r++)}if(o(),c)throw new oe(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Mt(t)}static emptyPath(){return new Mt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(Ye.fromString(e))}static fromName(e){return new pe(Ye.fromString(e).popFirst(5))}static empty(){return new pe(Ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new Ye(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function P0(n){return n.fields.find((e=>e.kind===2))}function Tl(n){return n.fields.filter((e=>e.kind!==2))}og.UNKNOWN_ID=-1;class Gp{constructor(e,t){this.fieldPath=e,this.kind=t}}class rf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new rf(0,ts.min())}}function XR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ie.fromTimestamp(i===1e9?new jt(t+1,0):new jt(t,i));return new ts(r,pe.empty(),e)}function JR(n){return new ts(n.readTime,n.key,-1)}class ts{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ts(Ie.min(),pe.empty(),-1)}static max(){return new ts(Ie.max(),pe.empty(),-1)}}function aE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(n.documentKey,e.documentKey),t!==0?t:Me(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bo(n){if(n.code!==Z.FAILED_PRECONDITION||n.message!==ZR)throw n;le("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ve(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new W(((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof W?t:W.resolve(t)}catch(t){return W.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):W.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):W.reject(t)}static resolve(e){return new W(((t,i)=>{t(e)}))}static reject(e){return new W(((t,i)=>{i(e)}))}static waitFor(e){return new W(((t,i)=>{let r=0,o=0,c=!1;e.forEach((h=>{++r,h.next((()=>{++o,c&&o===r&&t()}),(d=>i(d)))})),c=!0,o===r&&t()}))}static or(e){let t=W.resolve(!1);for(const i of e)t=t.next((r=>r?W.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,o)=>{i.push(t.call(this,r,o))})),this.waitFor(i)}static mapArray(e,t){return new W(((i,r)=>{const o=e.length,c=new Array(o);let h=0;for(let d=0;d<o;d++){const m=d;t(e[m]).next((_=>{c[m]=_,++h,h===o&&i(c)}),(_=>r(_)))}}))}static doWhile(e,t){return new W(((i,r)=>{const o=()=>{e()===!0?t().next((()=>{o()}),r):i()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new zn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new kd(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{const r=oE(i.target.error);this.V.reject(new kd(e,r))}}static open(e,t,i,r){try{return new Zg(t,e.transaction(r,i))}catch(o){throw new kd(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(le("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new eU(t)}}class mr{constructor(e,t,i){this.name=e,this.version=t,this.p=i,mr.S(Bt())===12.2&&sn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return le("SimpleDb","Removing database:",e),Sl(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Wd())return!1;if(mr.v())return!0;const e=Bt(),t=mr.S(e),i=0<t&&t<10,r=tN(e),o=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}async M(e){return this.db||(le("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=o=>{const c=o.target.result;t(c)},r.onblocked=()=>{i(new kd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=o=>{const c=o.target.error;c.name==="VersionError"?i(new oe(Z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?i(new oe(Z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):i(new kd(e,c))},r.onupgradeneeded=o=>{le("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const c=o.target.result;this.p.O(c,r.transaction,o.oldVersion,this.version).next((()=>{le("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const o=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.M(e);const h=Zg.open(this.db,e,o?"readonly":"readwrite",i),d=r(h).next((m=>(h.g(),m))).catch((m=>(h.abort(m),W.reject(m)))).toPromise();return d.catch((()=>{})),await h.m,d}catch(h){const d=h,m=d.name!=="FirebaseError"&&c<3;if(le("SimpleDb","Transaction failed with error:",d.message,"Retrying:",m),this.close(),!m)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Z3{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Sl(this.B.delete())}}class kd extends oe{constructor(e,t){super(Z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function zo(n){return n.name==="IndexedDbTransactionError"}class eU{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(le("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(le("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Sl(i)}add(e){return le("SimpleDb","ADD",this.store.name,e,e),Sl(this.store.add(e))}get(e){return Sl(this.store.get(e)).next((t=>(t===void 0&&(t=null),le("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return le("SimpleDb","DELETE",this.store.name,e),Sl(this.store.delete(e))}count(){return le("SimpleDb","COUNT",this.store.name),Sl(this.store.count())}U(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const o=r.getAll(i.range);return new W(((c,h)=>{o.onerror=d=>{h(d.target.error)},o.onsuccess=d=>{c(d.target.result)}}))}{const o=this.cursor(i),c=[];return this.W(o,((h,d)=>{c.push(d)})).next((()=>c))}}G(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new W(((r,o)=>{i.onerror=c=>{o(c.target.error)},i.onsuccess=c=>{r(c.target.result)}}))}j(e,t){le("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.H=!1;const r=this.cursor(i);return this.W(r,((o,c,h)=>h.delete()))}J(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.W(r,t)}Y(e){const t=this.cursor({});return new W(((i,r)=>{t.onerror=o=>{const c=oE(o.target.error);r(c)},t.onsuccess=o=>{const c=o.target.result;c?e(c.primaryKey,c.value).next((h=>{h?c.continue():i()})):i()}}))}W(e,t){const i=[];return new W(((r,o)=>{e.onerror=c=>{o(c.target.error)},e.onsuccess=c=>{const h=c.target.result;if(!h)return void r();const d=new Z3(h),m=t(h.primaryKey,h.value,d);if(m instanceof W){const _=m.catch((y=>(d.done(),W.reject(y))));i.push(_)}d.isDone?r():d.K===null?h.continue():h.continue(d.K)}})).next((()=>W.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.H?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Sl(n){return new W(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=oE(i.target.error);t(r)}}))}let JA=!1;function oE(n){const e=mr.S(Bt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new oe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return JA||(JA=!0,setTimeout((()=>{throw i}),0)),i}}return n}class tU{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){le("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{le("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){zo(t)?le("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Bo(t)}await this.X(6e4)}))}}class nU{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const i=new Set;let r=t,o=!0;return W.doWhile((()=>o===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!i.has(c))return le("IndexBackfiller",`Processing collection: ${c}`),this.ne(e,c,r).next((h=>{r-=h,i.add(c)}));o=!1})))).next((()=>t-r))}ne(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((o=>{const c=o.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this.re(r,o))).next((h=>(le("IndexBackfiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>c.size))}))))}re(e,t){let i=e;return t.changes.forEach(((r,o)=>{const c=JR(o);aE(c,i)>0&&(i=c)})),new ts(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Si.oe=-1;function Lf(n){return n==null}function af(n){return n===0&&1/n==-1/0}function nN(n){return typeof n=="number"&&Number.isInteger(n)&&!af(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ZA(e)),e=iU(n.get(t),e);return ZA(e)}function iU(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const o=n.charAt(r);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function ZA(n){return n+""}function dr(n){const e=n.length;if(Ee(e>=2),e===2)return Ee(n.charAt(0)===""&&n.charAt(1)===""),Ye.emptyPath();const t=e-2,i=[];let r="";for(let o=0;o<e;){const c=n.indexOf("",o);switch((c<0||c>t)&&ve(),n.charAt(c+1)){case"":const h=n.substring(o,c);let d;r.length===0?d=h:(r+=h,d=r,r=""),i.push(d);break;case"":r+=n.substring(o,c),r+="\0";break;case"":r+=n.substring(o,c+1);break;default:ve()}o=c+2}return new Ye(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(n,e){return[n,ci(e)]}function iN(n,e,t){return[n,ci(e),t]}const sU={},rU=["prefixPath","collectionGroup","readTime","documentId"],aU=["prefixPath","collectionGroup","documentId"],oU=["collectionGroup","readTime","prefixPath","documentId"],lU=["canonicalId","targetId"],cU=["targetId","path"],uU=["path","targetId"],hU=["collectionId","parent"],dU=["indexId","uid"],fU=["uid","sequenceNumber"],mU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],pU=["indexId","uid","orderedDocumentKey"],gU=["userId","collectionPath","documentId"],_U=["userId","collectionPath","largestBatchId"],yU=["userId","collectionGroup","largestBatchId"],sN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vU=[...sN,"documentOverlays"],rN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],aN=rN,lE=[...aN,"indexConfiguration","indexState","indexEntries"],wU=lE,EU=[...lE,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0 extends eN{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function En(n,e){const t=ge(n);return mr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function sc(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function oN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zt=class V0{constructor(e,t){this.comparator=e,this.root=t||go.EMPTY}insert(e,t){return new V0(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,go.BLACK,null,null))}remove(e){return new V0(this.comparator,this.root.remove(e,this.comparator).copy(null,null,go.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dp(this.root,e,this.comparator,!0)}},Dp=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},go=class Jr{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??Jr.RED,this.left=r??Jr.EMPTY,this.right=o??Jr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new Jr(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Jr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Jr.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ve();const e=this.left.check();if(e!==this.right.check())throw ve();return e+(this.isRed()?0:1)}};go.EMPTY=null,go.RED=!0,go.BLACK=!1;go.EMPTY=new class{constructor(){this.size=0}get key(){throw ve()}get value(){throw ve()}get color(){throw ve()}get left(){throw ve()}get right(){throw ve()}copy(e,t,i,r,o){return this}insert(e,t,i){return new go(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.comparator=e,this.data=new zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nx(this.data.getIterator())}getIteratorFrom(e){return new nx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new bt(this.comparator);return t.data=e,t}}class nx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Zc(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.fields=e,e.sort(Mt.comparator)}static empty(){return new Ai([])}unionWith(e){let t=new bt(Mt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ai(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Au(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new lN("Invalid base64 string: "+o):o}})(e);return new Yt(t)}static fromUint8Array(e){const t=(function(r){let o="";for(let c=0;c<r.length;++c)o+=String.fromCharCode(r[c]);return o})(e);return new Yt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yt.EMPTY_BYTE_STRING=new Yt("");const TU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function la(n){if(Ee(!!n),typeof n=="string"){let e=0;const t=TU.exec(n);if(Ee(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Pt(n.seconds),nanos:Pt(n.nanos)}}function Pt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ao(n){return typeof n=="string"?Yt.fromBase64String(n):Yt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function cE(n){const e=n.mapValue.fields.__previous_value__;return e_(e)?cE(e):e}function of(n){const e=la(n.mapValue.fields.__local_write_time__.timestampValue);return new jt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IU{constructor(e,t,i,r,o,c,h,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=m}}class xo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new xo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof xo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Kp={nullValue:"NULL_VALUE"};function zl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?e_(n)?4:cN(n)?9007199254740991:t_(n)?10:11:ve()}function wr(n,e){if(n===e)return!0;const t=zl(n);if(t!==zl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return of(n).isEqual(of(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const c=la(r.timestampValue),h=la(o.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return Ao(r.bytesValue).isEqual(Ao(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return Pt(r.geoPointValue.latitude)===Pt(o.geoPointValue.latitude)&&Pt(r.geoPointValue.longitude)===Pt(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return Pt(r.integerValue)===Pt(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const c=Pt(r.doubleValue),h=Pt(o.doubleValue);return c===h?af(c)===af(h):isNaN(c)&&isNaN(h)}return!1})(n,e);case 9:return Au(n.arrayValue.values||[],e.arrayValue.values||[],wr);case 10:case 11:return(function(r,o){const c=r.mapValue.fields||{},h=o.mapValue.fields||{};if(tx(c)!==tx(h))return!1;for(const d in c)if(c.hasOwnProperty(d)&&(h[d]===void 0||!wr(c[d],h[d])))return!1;return!0})(n,e);default:return ve()}}function lf(n,e){return(n.values||[]).find((t=>wr(t,e)))!==void 0}function Co(n,e){if(n===e)return 0;const t=zl(n),i=zl(e);if(t!==i)return Me(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(n.booleanValue,e.booleanValue);case 2:return(function(o,c){const h=Pt(o.integerValue||o.doubleValue),d=Pt(c.integerValue||c.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1})(n,e);case 3:return ix(n.timestampValue,e.timestampValue);case 4:return ix(of(n),of(e));case 5:return Me(n.stringValue,e.stringValue);case 6:return(function(o,c){const h=Ao(o),d=Ao(c);return h.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){const h=o.split("/"),d=c.split("/");for(let m=0;m<h.length&&m<d.length;m++){const _=Me(h[m],d[m]);if(_!==0)return _}return Me(h.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){const h=Me(Pt(o.latitude),Pt(c.latitude));return h!==0?h:Me(Pt(o.longitude),Pt(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return sx(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var h,d,m,_;const y=o.fields||{},b=c.fields||{},I=(h=y.value)===null||h===void 0?void 0:h.arrayValue,C=(d=b.value)===null||d===void 0?void 0:d.arrayValue,M=Me(((m=I==null?void 0:I.values)===null||m===void 0?void 0:m.length)||0,((_=C==null?void 0:C.values)===null||_===void 0?void 0:_.length)||0);return M!==0?M:sx(I,C)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===co.mapValue&&c===co.mapValue)return 0;if(o===co.mapValue)return 1;if(c===co.mapValue)return-1;const h=o.fields||{},d=Object.keys(h),m=c.fields||{},_=Object.keys(m);d.sort(),_.sort();for(let y=0;y<d.length&&y<_.length;++y){const b=Me(d[y],_[y]);if(b!==0)return b;const I=Co(h[d[y]],m[_[y]]);if(I!==0)return I}return Me(d.length,_.length)})(n.mapValue,e.mapValue);default:throw ve()}}function ix(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Me(n,e);const t=la(n),i=la(e),r=Me(t.seconds,i.seconds);return r!==0?r:Me(t.nanos,i.nanos)}function sx(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const o=Co(t[r],i[r]);if(o)return o}return Me(t.length,i.length)}function xu(n){return L0(n)}function L0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=la(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ao(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const o of t.values||[])r?r=!1:i+=",",i+=L0(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",o=!0;for(const c of i)o?o=!1:r+=",",r+=`${c}:${L0(t.fields[c])}`;return r+"}"})(n.mapValue):ve()}function ql(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function j0(n){return!!n&&"integerValue"in n}function cf(n){return!!n&&"arrayValue"in n}function rx(n){return!!n&&"nullValue"in n}function ax(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function $p(n){return!!n&&"mapValue"in n}function t_(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Od(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return sc(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Od(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Od(n.arrayValue.values[t]);return e}return Object.assign({},n)}function cN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const uN={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function SU(n){return"nullValue"in n?Kp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ql(xo.empty(),pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?t_(n)?uN:{mapValue:{}}:ve()}function AU(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ql(xo.empty(),pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?uN:"mapValue"in n?t_(n)?{mapValue:{}}:co:ve()}function ox(n,e){const t=Co(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function lx(n,e){const t=Co(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.value=e}static empty(){return new Bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!$p(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Od(t)}setAll(e){let t=Mt.emptyPath(),i={},r=[];e.forEach(((c,h)=>{if(!t.isImmediateParentOf(h)){const d=this.getFieldsMap(t);this.applyChanges(d,i,r),i={},r=[],t=h.popLast()}c?i[h.lastSegment()]=Od(c):r.push(h.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){const t=this.field(e.popLast());$p(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];$p(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){sc(t,((r,o)=>e[r]=o));for(const r of i)delete e[r]}clone(){return new Bn(Od(this.value))}}function hN(n){const e=[];return sc(n.fields,((t,i)=>{const r=new Mt([t]);if($p(i)){const o=hN(i.mapValue).fields;if(o.length===0)e.push(r);else for(const c of o)e.push(r.child(c))}else e.push(r)})),new Ai(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,t,i,r,o,c,h){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=c,this.documentState=h}static newInvalidDocument(e){return new kt(e,0,Ie.min(),Ie.min(),Ie.min(),Bn.empty(),0)}static newFoundDocument(e,t,i,r){return new kt(e,1,t,Ie.min(),i,r,0)}static newNoDocument(e,t){return new kt(e,2,t,Ie.min(),Ie.min(),Bn.empty(),0)}static newUnknownDocument(e,t){return new kt(e,3,t,Ie.min(),Ie.min(),Bn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof kt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,t){this.position=e,this.inclusive=t}}function cx(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const o=e[r],c=n.position[r];if(o.field.isKeyField()?i=pe.comparator(pe.fromName(c.referenceValue),t.key):i=Co(c,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function ux(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t="asc"){this.field=e,this.dir=t}}function xU(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{}class Xe extends dN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new CU(e,t,i):t==="array-contains"?new DU(e,i):t==="in"?new yN(e,i):t==="not-in"?new kU(e,i):t==="array-contains-any"?new OU(e,i):new Xe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new RU(e,i):new NU(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Co(t,this.value)):t!==null&&zl(this.value)===zl(t)&&this.matchesComparison(Co(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _t extends dN{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new _t(e,t)}matches(e){return Cu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Cu(n){return n.op==="and"}function U0(n){return n.op==="or"}function uE(n){return fN(n)&&Cu(n)}function fN(n){for(const e of n.filters)if(e instanceof _t)return!1;return!0}function F0(n){if(n instanceof Xe)return n.field.canonicalString()+n.op.toString()+xu(n.value);if(uE(n))return n.filters.map((e=>F0(e))).join(",");{const e=n.filters.map((t=>F0(t))).join(",");return`${n.op}(${e})`}}function mN(n,e){return n instanceof Xe?(function(i,r){return r instanceof Xe&&i.op===r.op&&i.field.isEqual(r.field)&&wr(i.value,r.value)})(n,e):n instanceof _t?(function(i,r){return r instanceof _t&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((o,c,h)=>o&&mN(c,r.filters[h])),!0):!1})(n,e):void ve()}function pN(n,e){const t=n.filters.concat(e);return _t.create(t,n.op)}function gN(n){return n instanceof Xe?(function(t){return`${t.field.canonicalString()} ${t.op} ${xu(t.value)}`})(n):n instanceof _t?(function(t){return t.op.toString()+" {"+t.getFilters().map(gN).join(" ,")+"}"})(n):"Filter"}class CU extends Xe{constructor(e,t,i){super(e,t,i),this.key=pe.fromName(i.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class RU extends Xe{constructor(e,t){super(e,"in",t),this.keys=_N("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class NU extends Xe{constructor(e,t){super(e,"not-in",t),this.keys=_N("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function _N(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((i=>pe.fromName(i.referenceValue)))}class DU extends Xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cf(t)&&lf(t.arrayValue,this.value)}}class yN extends Xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&lf(this.value.arrayValue,t)}}class kU extends Xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(lf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!lf(this.value.arrayValue,t)}}class OU extends Xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>lf(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(e,t=null,i=[],r=[],o=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=c,this.endAt=h,this.ue=null}}function B0(n,e=null,t=[],i=[],r=null,o=null,c=null){return new PU(n,e,t,i,r,o,c)}function Gl(n){const e=ge(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>F0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(o){return o.field.canonicalString()+o.dir})(i))).join(","),Lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>xu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>xu(i))).join(",")),e.ue=t}return e.ue}function jf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!xU(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ux(n.startAt,e.startAt)&&ux(n.endAt,e.endAt)}function lg(n){return pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function cg(n,e){return n.filters.filter((t=>t instanceof Xe&&t.field.isEqual(e)))}function hx(n,e,t){let i=Kp,r=!0;for(const o of cg(n,e)){let c=Kp,h=!0;switch(o.op){case"<":case"<=":c=SU(o.value);break;case"==":case"in":case">=":c=o.value;break;case">":c=o.value,h=!1;break;case"!=":case"not-in":c=Kp}ox({value:i,inclusive:r},{value:c,inclusive:h})<0&&(i=c,r=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];ox({value:i,inclusive:r},{value:c,inclusive:t.inclusive})<0&&(i=c,r=t.inclusive);break}}return{value:i,inclusive:r}}function dx(n,e,t){let i=co,r=!0;for(const o of cg(n,e)){let c=co,h=!0;switch(o.op){case">=":case">":c=AU(o.value),h=!1;break;case"==":case"in":case"<=":c=o.value;break;case"<":c=o.value,h=!1;break;case"!=":case"not-in":c=co}lx({value:i,inclusive:r},{value:c,inclusive:h})>0&&(i=c,r=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];lx({value:i,inclusive:r},{value:c,inclusive:t.inclusive})>0&&(i=c,r=t.inclusive);break}}return{value:i,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e,t=null,i=[],r=[],o=null,c="F",h=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=c,this.startAt=h,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function vN(n,e,t,i,r,o,c,h){return new ma(n,e,t,i,r,o,c,h)}function Zu(n){return new ma(n)}function fx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function hE(n){return n.collectionGroup!==null}function pu(n){const e=ge(n);if(e.ce===null){e.ce=[];const t=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new bt(Mt.comparator);return c.filters.forEach((d=>{d.getFlattenedFilters().forEach((m=>{m.isInequality()&&(h=h.add(m.field))}))})),h})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new uf(o,i))})),t.has(Mt.keyField().canonicalString())||e.ce.push(new uf(Mt.keyField(),i))}return e.ce}function ui(n){const e=ge(n);return e.le||(e.le=MU(e,pu(n))),e.le}function MU(n,e){if(n.limitType==="F")return B0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const o=r.dir==="desc"?"asc":"desc";return new uf(r.field,o)}));const t=n.endAt?new Ro(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ro(n.startAt.position,n.startAt.inclusive):null;return B0(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function z0(n,e){const t=n.filters.concat([e]);return new ma(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ug(n,e,t){return new ma(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Uf(n,e){return jf(ui(n),ui(e))&&n.limitType===e.limitType}function wN(n){return`${Gl(ui(n))}|lt:${n.limitType}`}function ru(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>gN(r))).join(", ")}]`),Lf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>xu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>xu(r))).join(",")),`Target(${i})`})(ui(n))}; limitType=${n.limitType})`}function Ff(n,e){return e.isFoundDocument()&&(function(i,r){const o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):pe.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,r){for(const o of pu(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const o of i.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(c,h,d){const m=cx(c,h,d);return c.inclusive?m<=0:m<0})(i.startAt,pu(i),r)||i.endAt&&!(function(c,h,d){const m=cx(c,h,d);return c.inclusive?m>=0:m>0})(i.endAt,pu(i),r))})(n,e)}function EN(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function bN(n){return(e,t)=>{let i=!1;for(const r of pu(n)){const o=VU(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function VU(n,e,t){const i=n.field.isKeyField()?pe.comparator(e.key,t.key):(function(o,c,h){const d=c.data.field(o),m=h.data.field(o);return d!==null&&m!==null?Co(d,m):ve()})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){sc(this.inner,((t,i)=>{for(const[r,o]of i)e(r,o)}))}isEmpty(){return oN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LU=new zt(pe.comparator);function xi(){return LU}const TN=new zt(pe.comparator);function Ad(...n){let e=TN;for(const t of n)e=e.insert(t.key,t);return e}function IN(n){let e=TN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function fr(){return Pd()}function SN(){return Pd()}function Pd(){return new qo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const jU=new zt(pe.comparator),UU=new bt(pe.comparator);function Ue(...n){let e=UU;for(const t of n)e=e.add(t);return e}const FU=new bt(Me);function dE(){return FU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:af(e)?"-0":e}}function AN(n){return{integerValue:""+n}}function xN(n,e){return nN(e)?AN(e):fE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(){this._=void 0}}function BU(n,e,t){return n instanceof Ru?(function(r,o){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&e_(o)&&(o=cE(o)),o&&(c.fields.__previous_value__=o),{mapValue:c}})(t,e):n instanceof Hl?RN(n,e):n instanceof Kl?NN(n,e):(function(r,o){const c=CN(r,o),h=mx(c)+mx(r.Pe);return j0(c)&&j0(r.Pe)?AN(h):fE(r.serializer,h)})(n,e)}function zU(n,e,t){return n instanceof Hl?RN(n,e):n instanceof Kl?NN(n,e):t}function CN(n,e){return n instanceof Nu?(function(i){return j0(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}class Ru extends n_{}class Hl extends n_{constructor(e){super(),this.elements=e}}function RN(n,e){const t=DN(e);for(const i of n.elements)t.some((r=>wr(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Kl extends n_{constructor(e){super(),this.elements=e}}function NN(n,e){let t=DN(e);for(const i of n.elements)t=t.filter((r=>!wr(r,i)));return{arrayValue:{values:t}}}class Nu extends n_{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function mx(n){return Pt(n.integerValue||n.doubleValue)}function DN(n){return cf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,t){this.field=e,this.transform=t}}function qU(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Hl&&r instanceof Hl||i instanceof Kl&&r instanceof Kl?Au(i.elements,r.elements,wr):i instanceof Nu&&r instanceof Nu?wr(i.Pe,r.Pe):i instanceof Ru&&r instanceof Ru})(n.transform,e.transform)}class GU{constructor(e,t){this.version=e,this.transformResults=t}}class Vt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vt}static exists(e){return new Vt(void 0,e)}static updateTime(e){return new Vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class i_{}function kN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new th(n.key,Vt.none()):new eh(n.key,n.data,Vt.none());{const t=n.data,i=Bn.empty();let r=new bt(Mt.comparator);for(let o of e.fields)if(!r.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?i.delete(o):i.set(o,c),r=r.add(o)}return new pa(n.key,i,new Ai(r.toArray()),Vt.none())}}function HU(n,e,t){n instanceof eh?(function(r,o,c){const h=r.value.clone(),d=gx(r.fieldTransforms,o,c.transformResults);h.setAll(d),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):n instanceof pa?(function(r,o,c){if(!Qp(r.precondition,o))return void o.convertToUnknownDocument(c.version);const h=gx(r.fieldTransforms,o,c.transformResults),d=o.data;d.setAll(ON(r)),d.setAll(h),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):(function(r,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Md(n,e,t,i){return n instanceof eh?(function(o,c,h,d){if(!Qp(o.precondition,c))return h;const m=o.value.clone(),_=_x(o.fieldTransforms,d,c);return m.setAll(_),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof pa?(function(o,c,h,d){if(!Qp(o.precondition,c))return h;const m=_x(o.fieldTransforms,d,c),_=c.data;return _.setAll(ON(o)),_.setAll(m),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((y=>y.field)))})(n,e,t,i):(function(o,c,h){return Qp(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(n,e,t)}function KU(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),o=CN(i.transform,r||null);o!=null&&(t===null&&(t=Bn.empty()),t.set(i.field,o))}return t||null}function px(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Au(i,r,((o,c)=>qU(o,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class eh extends i_{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class pa extends i_{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function ON(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function gx(n,e,t){const i=new Map;Ee(n.length===t.length);for(let r=0;r<t.length;r++){const o=n[r],c=o.transform,h=e.data.field(o.field);i.set(o.field,zU(c,h,t[r]))}return i}function _x(n,e,t){const i=new Map;for(const r of n){const o=r.transform,c=t.data.field(r.field);i.set(r.field,BU(o,c,e))}return i}class th extends i_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mE extends i_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(e.key)&&HU(o,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Md(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Md(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=SN();return this.mutations.forEach((r=>{const o=e.get(r.key),c=o.overlayedDocument;let h=this.applyToLocalView(c,o.mutatedFields);h=t.has(r.key)?null:h;const d=kN(c,h);d!==null&&i.set(r.key,d),c.isValidDocument()||c.convertToNoDocument(Ie.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ue())}isEqual(e){return this.batchId===e.batchId&&Au(this.mutations,e.mutations,((t,i)=>px(t,i)))&&Au(this.baseMutations,e.baseMutations,((t,i)=>px(t,i)))}}class gE{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ee(e.mutations.length===i.length);let r=(function(){return jU})();const o=e.mutations;for(let c=0;c<o.length;c++)r=r.insert(o[c].key,i[c].version);return new gE(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn,nt;function PN(n){switch(n){default:return ve();case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0}}function MN(n){if(n===void 0)return sn("GRPC error has no .code"),Z.UNKNOWN;switch(n){case mn.OK:return Z.OK;case mn.CANCELLED:return Z.CANCELLED;case mn.UNKNOWN:return Z.UNKNOWN;case mn.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case mn.INTERNAL:return Z.INTERNAL;case mn.UNAVAILABLE:return Z.UNAVAILABLE;case mn.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case mn.NOT_FOUND:return Z.NOT_FOUND;case mn.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case mn.ABORTED:return Z.ABORTED;case mn.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case mn.DATA_LOSS:return Z.DATA_LOSS;default:return ve()}}(nt=mn||(mn={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU=new Vl([4294967295,4294967295],0);function yx(n){const e=VN().encode(n),t=new zR;return t.update(e),new Uint8Array(t.digest())}function vx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Vl([t,i],0),new Vl([r,o],0)]}class yE{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new xd(`Invalid padding: ${t}`);if(i<0)throw new xd(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new xd(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new xd(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Vl.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(Vl.fromNumber(i)));return r.compare(QU)===1&&(r=new Vl([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=yx(e),[i,r]=vx(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,r,o);if(!this.de(c))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new yE(o,r,t);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.Ie===0)return;const t=yx(e),[i,r]=vx(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,r,o);this.Ae(c)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class xd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,qf.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new zf(Ie.min(),r,new zt(Me),xi(),Ue())}}class qf{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new qf(i,t,Ue(),Ue(),Ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}}class LN{constructor(e,t){this.targetId=e,this.me=t}}class jN{constructor(e,t,i=Yt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class wx{constructor(){this.fe=0,this.ge=bx(),this.pe=Yt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ue(),t=Ue(),i=Ue();return this.ge.forEach(((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:ve()}})),new qf(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=bx()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ee(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class WU{constructor(e){this.Le=e,this.Be=new Map,this.ke=xi(),this.qe=Ex(),this.Qe=new zt(Me)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:ve()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((i,r)=>{this.ze(r)&&t(r)}))}He(e){const t=e.targetId,i=e.me.count,r=this.Je(t);if(r){const o=r.target;if(lg(o))if(i===0){const c=new pe(o.path);this.Ue(t,c,kt.newNoDocument(c,Ie.min()))}else Ee(i===1);else{const c=this.Ye(t);if(c!==i){const h=this.Ze(e),d=h?this.Xe(h,e,c):1;if(d!==0){this.je(t);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,m)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t;let c,h;try{c=Ao(i).toUint8Array()}catch(d){if(d instanceof lN)return vr("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new yE(c,r,o)}catch(d){return vr(d instanceof xd?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Ie===0?null:h}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let r=0;return i.forEach((o=>{const c=this.Le.tt(),h=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.Ue(t,o,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((o,c)=>{const h=this.Je(c);if(h){if(o.current&&lg(h.target)){const d=new pe(h.target.path);this.ke.get(d)!==null||this.it(c,d)||this.Ue(c,d,kt.newNoDocument(d,e))}o.be&&(t.set(c,o.ve()),o.Ce())}}));let i=Ue();this.qe.forEach(((o,c)=>{let h=!0;c.forEachWhile((d=>{const m=this.Je(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(o))})),this.ke.forEach(((o,c)=>c.setReadTime(e)));const r=new zf(e,t,this.Qe,this.ke,i);return this.ke=xi(),this.qe=Ex(),this.Qe=new zt(Me),r}$e(e,t){if(!this.ze(e))return;const i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new wx,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new bt(Me),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||le("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new wx),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Ex(){return new zt(pe.comparator)}function bx(){return new zt(pe.comparator)}const YU={asc:"ASCENDING",desc:"DESCENDING"},XU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JU={and:"AND",or:"OR"};class ZU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function q0(n,e){return n.useProto3Json||Lf(e)?e:{value:e}}function Du(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function UN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function e6(n,e){return Du(n,e.toTimestamp())}function rn(n){return Ee(!!n),Ie.fromTimestamp((function(t){const i=la(t);return new jt(i.seconds,i.nanos)})(n))}function vE(n,e){return G0(n,e).canonicalString()}function G0(n,e){const t=(function(r){return new Ye(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function FN(n){const e=Ye.fromString(n);return Ee(YN(e)),e}function hf(n,e){return vE(n.databaseId,e.path)}function pr(n,e){const t=FN(e);if(t.get(1)!==n.databaseId.projectId)throw new oe(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new oe(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pe(qN(t))}function BN(n,e){return vE(n.databaseId,e)}function zN(n){const e=FN(n);return e.length===4?Ye.emptyPath():qN(e)}function H0(n){return new Ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function qN(n){return Ee(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Tx(n,e,t){return{name:hf(n,e),fields:t.value.mapValue.fields}}function GN(n,e,t){const i=pr(n,e.name),r=rn(e.updateTime),o=e.createTime?rn(e.createTime):Ie.min(),c=new Bn({mapValue:{fields:e.fields}}),h=kt.newFoundDocument(i,r,o,c);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function t6(n,e){return"found"in e?(function(i,r){Ee(!!r.found),r.found.name,r.found.updateTime;const o=pr(i,r.found.name),c=rn(r.found.updateTime),h=r.found.createTime?rn(r.found.createTime):Ie.min(),d=new Bn({mapValue:{fields:r.found.fields}});return kt.newFoundDocument(o,c,h,d)})(n,e):"missing"in e?(function(i,r){Ee(!!r.missing),Ee(!!r.readTime);const o=pr(i,r.missing),c=rn(r.readTime);return kt.newNoDocument(o,c)})(n,e):ve()}function n6(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:ve()})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(m,_){return m.useProto3Json?(Ee(_===void 0||typeof _=="string"),Yt.fromBase64String(_||"")):(Ee(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),Yt.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(m){const _=m.code===void 0?Z.UNKNOWN:MN(m.code);return new oe(_,m.message||"")})(c);t=new jN(i,r,o,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=pr(n,i.document.name),o=rn(i.document.updateTime),c=i.document.createTime?rn(i.document.createTime):Ie.min(),h=new Bn({mapValue:{fields:i.document.fields}}),d=kt.newFoundDocument(r,o,c,h),m=i.targetIds||[],_=i.removedTargetIds||[];t=new Wp(m,_,d.key,d)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=pr(n,i.document),o=i.readTime?rn(i.readTime):Ie.min(),c=kt.newNoDocument(r,o),h=i.removedTargetIds||[];t=new Wp([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=pr(n,i.document),o=i.removedTargetIds||[];t=new Wp([],o,r,null)}else{if(!("filter"in e))return ve();{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:o}=i,c=new $U(r,o),h=i.targetId;t=new LN(h,c)}}return t}function df(n,e){let t;if(e instanceof eh)t={update:Tx(n,e.key,e.value)};else if(e instanceof th)t={delete:hf(n,e.key)};else if(e instanceof pa)t={update:Tx(n,e.key,e.data),updateMask:l6(e.fieldMask)};else{if(!(e instanceof mE))return ve();t={verify:hf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(o,c){const h=c.transform;if(h instanceof Ru)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Hl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Kl)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Nu)return{fieldPath:c.field.canonicalString(),increment:h.Pe};throw ve()})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:e6(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ve()})(n,e.precondition)),t}function K0(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?Vt.updateTime(rn(o.updateTime)):o.exists!==void 0?Vt.exists(o.exists):Vt.none()})(e.currentDocument):Vt.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(c,h){let d=null;if("setToServerValue"in h)Ee(h.setToServerValue==="REQUEST_TIME"),d=new Ru;else if("appendMissingElements"in h){const _=h.appendMissingElements.values||[];d=new Hl(_)}else if("removeAllFromArray"in h){const _=h.removeAllFromArray.values||[];d=new Kl(_)}else"increment"in h?d=new Nu(c,h.increment):ve();const m=Mt.fromServerFormat(h.fieldPath);return new Bf(m,d)})(n,r))):[];if(e.update){e.update.name;const r=pr(n,e.update.name),o=new Bn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(d){const m=d.fieldPaths||[];return new Ai(m.map((_=>Mt.fromServerFormat(_))))})(e.updateMask);return new pa(r,o,c,t,i)}return new eh(r,o,t,i)}if(e.delete){const r=pr(n,e.delete);return new th(r,t)}if(e.verify){const r=pr(n,e.verify);return new mE(r,t)}return ve()}function i6(n,e){return n&&n.length>0?(Ee(e!==void 0),n.map((t=>(function(r,o){let c=r.updateTime?rn(r.updateTime):rn(o);return c.isEqual(Ie.min())&&(c=rn(o)),new GU(c,r.transformResults||[])})(t,e)))):[]}function HN(n,e){return{documents:[BN(n,e.path)]}}function KN(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=BN(n,r);const o=(function(m){if(m.length!==0)return WN(_t.create(m,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(m){if(m.length!==0)return m.map((_=>(function(b){return{field:au(b.field),direction:r6(b.dir)}})(_)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const h=q0(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{_t:t,parent:r}}function $N(n){let e=zN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ee(i===1);const _=t.from[0];_.allDescendants?r=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=(function(y){const b=QN(y);return b instanceof _t&&uE(b)?b.getFilters():[b]})(t.where));let c=[];t.orderBy&&(c=(function(y){return y.map((b=>(function(C){return new uf(ou(C.field),(function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(b)))})(t.orderBy));let h=null;t.limit&&(h=(function(y){let b;return b=typeof y=="object"?y.value:y,Lf(b)?null:b})(t.limit));let d=null;t.startAt&&(d=(function(y){const b=!!y.before,I=y.values||[];return new Ro(I,b)})(t.startAt));let m=null;return t.endAt&&(m=(function(y){const b=!y.before,I=y.values||[];return new Ro(I,b)})(t.endAt)),vN(e,r,c,o,h,"F",d,m)}function s6(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve()}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function QN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ou(t.unaryFilter.field);return Xe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=ou(t.unaryFilter.field);return Xe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ou(t.unaryFilter.field);return Xe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=ou(t.unaryFilter.field);return Xe.create(c,"!=",{nullValue:"NULL_VALUE"});default:return ve()}})(n):n.fieldFilter!==void 0?(function(t){return Xe.create(ou(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ve()}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return _t.create(t.compositeFilter.filters.map((i=>QN(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ve()}})(t.compositeFilter.op))})(n):ve()}function r6(n){return YU[n]}function a6(n){return XU[n]}function o6(n){return JU[n]}function au(n){return{fieldPath:n.canonicalString()}}function ou(n){return Mt.fromServerFormat(n.fieldPath)}function WN(n){return n instanceof Xe?(function(t){if(t.op==="=="){if(ax(t.value))return{unaryFilter:{field:au(t.field),op:"IS_NAN"}};if(rx(t.value))return{unaryFilter:{field:au(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ax(t.value))return{unaryFilter:{field:au(t.field),op:"IS_NOT_NAN"}};if(rx(t.value))return{unaryFilter:{field:au(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:au(t.field),op:a6(t.op),value:t.value}}})(n):n instanceof _t?(function(t){const i=t.getFilters().map((r=>WN(r)));return i.length===1?i[0]:{compositeFilter:{op:o6(t.op),filters:i}}})(n):ve()}function l6(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function YN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,t,i,r,o=Ie.min(),c=Ie.min(),h=Yt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new ta(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e){this.ct=e}}function c6(n,e){let t;if(e.document)t=GN(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=pe.fromSegments(e.noDocument.path),r=Ql(e.noDocument.readTime);t=kt.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ve();{const i=pe.fromSegments(e.unknownDocument.path),r=Ql(e.unknownDocument.version);t=kt.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const o=new jt(r[0],r[1]);return Ie.fromTimestamp(o)})(e.readTime)),t}function Ix(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:hg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(o,c){return{name:hf(o,c.key),fields:c.data.value.mapValue.fields,updateTime:Du(o,c.version.toTimestamp()),createTime:Du(o,c.createTime.toTimestamp())}})(n.ct,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:$l(e.version)};else{if(!e.isUnknownDocument())return ve();i.unknownDocument={path:t.path.toArray(),version:$l(e.version)}}return i}function hg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function $l(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ql(n){const e=new jt(n.seconds,n.nanoseconds);return Ie.fromTimestamp(e)}function Al(n,e){const t=(e.baseMutations||[]).map((o=>K0(n.ct,o)));for(let o=0;o<e.mutations.length-1;++o){const c=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const h=e.mutations[o+1];c.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const i=e.mutations.map((o=>K0(n.ct,o))),r=jt.fromMillis(e.localWriteTimeMs);return new pE(e.batchId,r,t,i)}function Cd(n){const e=Ql(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ql(n.lastLimboFreeSnapshotVersion):Ie.min();let i;return i=(function(o){return o.documents!==void 0})(n.query)?(function(o){return Ee(o.documents.length===1),ui(Zu(zN(o.documents[0])))})(n.query):(function(o){return ui($N(o))})(n.query),new ta(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Yt.fromBase64String(n.resumeToken))}function JN(n,e){const t=$l(e.snapshotVersion),i=$l(e.lastLimboFreeSnapshotVersion);let r;r=lg(e.target)?HN(n.ct,e.target):KN(n.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Gl(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function wE(n){const e=$N({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ug(e,e.limit,"L"):e}function i0(n,e){return new _E(e.largestBatchId,K0(n.ct,e.overlayMutation))}function Sx(n,e){const t=e.path.lastSegment();return[n,ci(e.path.popLast()),t]}function Ax(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:$l(i.readTime),documentKey:ci(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{getBundleMetadata(e,t){return xx(e).get(t).next((i=>{if(i)return(function(o){return{id:o.bundleId,createTime:Ql(o.createTime),version:o.version}})(i)}))}saveBundleMetadata(e,t){return xx(e).put((function(r){return{bundleId:r.id,createTime:$l(rn(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return Cx(e).get(t).next((i=>{if(i)return(function(o){return{name:o.name,query:wE(o.bundledQuery),readTime:Ql(o.readTime)}})(i)}))}saveNamedQuery(e,t){return Cx(e).put((function(r){return{name:r.name,readTime:$l(rn(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function xx(n){return En(n,"bundles")}function Cx(n){return En(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const i=t.uid||"";return new s_(e,i)}getOverlay(e,t){return dd(e).get(Sx(this.userId,t)).next((i=>i?i0(this.serializer,i):null))}getOverlays(e,t){const i=fr();return W.forEach(t,(r=>this.getOverlay(e,r).next((o=>{o!==null&&i.set(r,o)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((o,c)=>{const h=new _E(t,c);r.push(this.ht(e,h))})),W.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((c=>r.add(ci(c.getCollectionPath()))));const o=[];return r.forEach((c=>{const h=IDBKeyRange.bound([this.userId,c,i],[this.userId,c,i+1],!1,!0);o.push(dd(e).j("collectionPathOverlayIndex",h))})),W.waitFor(o)}getOverlaysForCollection(e,t,i){const r=fr(),o=ci(t),c=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return dd(e).U("collectionPathOverlayIndex",c).next((h=>{for(const d of h){const m=i0(this.serializer,d);r.set(m.getKey(),m)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const o=fr();let c;const h=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return dd(e).J({index:"collectionGroupOverlayIndex",range:h},((d,m,_)=>{const y=i0(this.serializer,m);o.size()<r||y.largestBatchId===c?(o.set(y.getKey(),y),c=y.largestBatchId):_.done()})).next((()=>o))}ht(e,t){return dd(e).put((function(r,o,c){const[h,d,m]=Sx(o,c.mutation.key);return{userId:o,collectionPath:d,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:df(r.ct,c.mutation)}})(this.serializer,this.userId,t))}}function dd(n){return En(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{Pt(e){return En(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?Yt.fromUint8Array(i):Yt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Pt(e.integerValue));else if("doubleValue"in e){const i=Pt(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),af(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=la(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ao(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?cN(e)?this.dt(t,Number.MAX_SAFE_INTEGER):t_(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):ve()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const i=e.fields||{};this.dt(t,55);for(const r of Object.keys(i))this.Vt(r,t),this.Tt(i[r],t)}wt(e,t){var i,r;const o=e.fields||{};this.dt(t,53);const c="value",h=((r=(i=o[c].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(t,15),t.At(Pt(h)),this.Vt(c,t),this.Tt(o[c],t)}bt(e,t){const i=e.values||[];this.dt(t,50);for(const r of i)this.Tt(r,t)}yt(e,t){this.dt(t,37),pe.fromName(e).path.forEach((i=>{this.dt(t,60),this.Dt(i,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}xl.vt=new xl;function d6(n){if(n===0)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function Rx(n){const e=64-(function(i){let r=0;for(let o=0;o<8;++o){const c=d6(255&i[o]);if(r+=c,c!==8)break}return r})(n);return Math.ceil(e/8)}class f6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ft(i.value),i=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ot(i.value),i=t.next();this.Nt()}Lt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{const r=t.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Bt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ot(i);else if(i<2048)this.Ot(960|i>>>6),this.Ot(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i);else{const r=t.codePointAt(0);this.Ot(240|r>>>18),this.Ot(128|63&r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r)}}this.Nt()}kt(e){const t=this.qt(e),i=Rx(t);this.Qt(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Kt(e){const t=this.qt(e),i=Rx(t);this.Qt(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=(function(o){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,o,!1),new Uint8Array(c.buffer)})(e),i=(128&t[0])!=0;t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class m6{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class p6{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class fd{constructor(){this.jt=new f6,this.Ht=new m6(this.jt),this.Jt=new p6(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new Cl(this.indexId,this.documentKey,this.arrayValue,i)}}function so(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Nx(n.arrayValue,e.arrayValue),t!==0?t:(t=Nx(n.directionalValue,e.directionalValue),t!==0?t:pe.comparator(n.documentKey,e.documentKey)))}function Nx(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e){this.Xt=new bt(((t,i)=>Mt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const i=t;i.isInequality()?this.Xt=this.Xt.add(i):this.tn.push(i)}}get nn(){return this.Xt.size>1}rn(e){if(Ee(e.collectionGroup===this.collectionId),this.nn)return!1;const t=P0(e);if(t!==void 0&&!this.sn(t))return!1;const i=Tl(e);let r=new Set,o=0,c=0;for(;o<i.length&&this.sn(i[o]);++o)r=r.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.Xt.size>0){const h=this.Xt.getIterator().getNext();if(!r.has(h.field.canonicalString())){const d=i[o];if(!this.on(h,d)||!this._n(this.en[c++],d))return!1}++o}for(;o<i.length;++o){const h=i[o];if(c>=this.en.length||!this._n(this.en[c++],h))return!1}return!0}an(){if(this.nn)return null;let e=new bt(Mt.comparator);const t=[];for(const i of this.tn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Gp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Gp(i.field,0))}for(const i of this.en)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Gp(i.field,i.dir==="asc"?0:1)));return new og(og.UNKNOWN_ID,this.collectionId,t,rf.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(n){var e,t;if(Ee(n instanceof Xe||n instanceof _t),n instanceof Xe){if(n instanceof yN){const r=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((o=>Xe.create(n.field,"==",o))))||[];return _t.create(r,"or")}return n}const i=n.filters.map((r=>ZN(r)));return _t.create(i,n.op)}function g6(n){if(n.getFilters().length===0)return[];const e=W0(ZN(n));return Ee(e2(e)),$0(e)||Q0(e)?[e]:e.getFilters()}function $0(n){return n instanceof Xe}function Q0(n){return n instanceof _t&&uE(n)}function e2(n){return $0(n)||Q0(n)||(function(t){if(t instanceof _t&&U0(t)){for(const i of t.getFilters())if(!$0(i)&&!Q0(i))return!1;return!0}return!1})(n)}function W0(n){if(Ee(n instanceof Xe||n instanceof _t),n instanceof Xe)return n;if(n.filters.length===1)return W0(n.filters[0]);const e=n.filters.map((i=>W0(i)));let t=_t.create(e,n.op);return t=dg(t),e2(t)?t:(Ee(t instanceof _t),Ee(Cu(t)),Ee(t.filters.length>1),t.filters.reduce(((i,r)=>EE(i,r))))}function EE(n,e){let t;return Ee(n instanceof Xe||n instanceof _t),Ee(e instanceof Xe||e instanceof _t),t=n instanceof Xe?e instanceof Xe?(function(r,o){return _t.create([r,o],"and")})(n,e):kx(n,e):e instanceof Xe?kx(e,n):(function(r,o){if(Ee(r.filters.length>0&&o.filters.length>0),Cu(r)&&Cu(o))return pN(r,o.getFilters());const c=U0(r)?r:o,h=U0(r)?o:r,d=c.filters.map((m=>EE(m,h)));return _t.create(d,"or")})(n,e),dg(t)}function kx(n,e){if(Cu(e))return pN(e,n.getFilters());{const t=e.filters.map((i=>EE(n,i)));return _t.create(t,"or")}}function dg(n){if(Ee(n instanceof Xe||n instanceof _t),n instanceof Xe)return n;const e=n.getFilters();if(e.length===1)return dg(e[0]);if(fN(n))return n;const t=e.map((r=>dg(r))),i=[];return t.forEach((r=>{r instanceof Xe?i.push(r):r instanceof _t&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:_t.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(){this.un=new bE}addToCollectionParentIndex(e,t){return this.un.add(t),W.resolve()}getCollectionParents(e,t){return W.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return W.resolve()}deleteFieldIndex(e,t){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,t){return W.resolve()}getDocumentsMatchingTarget(e,t){return W.resolve(null)}getIndexType(e,t){return W.resolve(0)}getFieldIndexes(e,t){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,t){return W.resolve(ts.min())}getMinOffsetFromCollectionGroup(e,t){return W.resolve(ts.min())}updateCollectionGroup(e,t,i){return W.resolve()}updateIndexEntries(e,t){return W.resolve()}}class bE{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new bt(Ye.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new bt(Ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp=new Uint8Array(0);class y6{constructor(e,t){this.databaseId=t,this.cn=new bE,this.ln=new qo((i=>Gl(i)),((i,r)=>jf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const o={collectionId:i,parent:ci(r)};return Ox(e).put(o)}return W.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[YR(t),""],!1,!0);return Ox(e).U(r).next((o=>{for(const c of o){if(c.collectionId!==t)break;i.push(dr(c.parent))}return i}))}addFieldIndex(e,t){const i=md(e),r=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((d=>[d.fieldPath.canonicalString(),d.kind]))}})(t);delete r.indexId;const o=i.add(r);if(t.indexState){const c=tu(e);return o.next((h=>{c.put(Ax(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const i=md(e),r=tu(e),o=eu(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=md(e),i=eu(e),r=tu(e);return t.j().next((()=>i.j())).next((()=>r.j()))}createTargetIndexes(e,t){return W.forEach(this.hn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const o=new Dx(i).an();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const i=eu(e);let r=!0;const o=new Map;return W.forEach(this.hn(t),(c=>this.Pn(e,c).next((h=>{r&&(r=!!h),o.set(c,h)})))).next((()=>{if(r){let c=Ue();const h=[];return W.forEach(o,((d,m)=>{le("IndexedDbIndexManager",`Using index ${(function(X){return`id=${X.indexId}|cg=${X.collectionGroup}|f=${X.fields.map((fe=>`${fe.fieldPath}:${fe.kind}`)).join(",")}`})(d)} to execute ${Gl(t)}`);const _=(function(X,fe){const F=P0(fe);if(F===void 0)return null;for(const ae of cg(X,F.fieldPath))switch(ae.op){case"array-contains-any":return ae.value.arrayValue.values||[];case"array-contains":return[ae.value]}return null})(m,d),y=(function(X,fe){const F=new Map;for(const ae of Tl(fe))for(const D of cg(X,ae.fieldPath))switch(D.op){case"==":case"in":F.set(ae.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return F.set(ae.fieldPath.canonicalString(),D.value),Array.from(F.values())}return null})(m,d),b=(function(X,fe){const F=[];let ae=!0;for(const D of Tl(fe)){const x=D.kind===0?hx(X,D.fieldPath,X.startAt):dx(X,D.fieldPath,X.startAt);F.push(x.value),ae&&(ae=x.inclusive)}return new Ro(F,ae)})(m,d),I=(function(X,fe){const F=[];let ae=!0;for(const D of Tl(fe)){const x=D.kind===0?dx(X,D.fieldPath,X.endAt):hx(X,D.fieldPath,X.endAt);F.push(x.value),ae&&(ae=x.inclusive)}return new Ro(F,ae)})(m,d),C=this.In(d,m,b),M=this.In(d,m,I),z=this.Tn(d,m,y),B=this.En(d.indexId,_,C,b.inclusive,M,I.inclusive,z);return W.forEach(B,(j=>i.G(j,t.limit).next((X=>{X.forEach((fe=>{const F=pe.fromSegments(fe.documentKey);c.has(F)||(c=c.add(F),h.push(F))}))}))))})).next((()=>h))}return W.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=g6(_t.create(e.filters,"and")).map((i=>B0(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,i,r,o,c,h){const d=(t!=null?t.length:1)*Math.max(i.length,o.length),m=d/(t!=null?t.length:1),_=[];for(let y=0;y<d;++y){const b=t?this.dn(t[y/m]):kp,I=this.An(e,b,i[y%m],r),C=this.Rn(e,b,o[y%m],c),M=h.map((z=>this.An(e,b,z,!0)));_.push(...this.createRange(I,C,M))}return _}An(e,t,i,r){const o=new Cl(e,pe.empty(),t,i);return r?o:o.Zt()}Rn(e,t,i,r){const o=new Cl(e,pe.empty(),t,i);return r?o.Zt():o}Pn(e,t){const i=new Dx(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((o=>{let c=null;for(const h of o)i.rn(h)&&(!c||h.fields.length>c.fields.length)&&(c=h);return c}))}getIndexType(e,t){let i=2;const r=this.hn(t);return W.forEach(r,(o=>this.Pn(e,o).next((c=>{c?i!==0&&c.fields.length<(function(d){let m=new bt(Mt.comparator),_=!1;for(const y of d.filters)for(const b of y.getFlattenedFilters())b.field.isKeyField()||(b.op==="array-contains"||b.op==="array-contains-any"?_=!0:m=m.add(b.field));for(const y of d.orderBy)y.field.isKeyField()||(m=m.add(y.field));return m.size+(_?1:0)})(o)&&(i=1):i=0})))).next((()=>(function(c){return c.limit!==null})(t)&&r.length>1&&i===2?1:i))}Vn(e,t){const i=new fd;for(const r of Tl(e)){const o=t.data.field(r.fieldPath);if(o==null)return null;const c=i.Yt(r.kind);xl.vt.It(o,c)}return i.zt()}dn(e){const t=new fd;return xl.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const i=new fd;return xl.vt.It(ql(this.databaseId,t),i.Yt((function(o){const c=Tl(o);return c.length===0?0:c[c.length-1].kind})(e))),i.zt()}Tn(e,t,i){if(i===null)return[];let r=[];r.push(new fd);let o=0;for(const c of Tl(e)){const h=i[o++];for(const d of r)if(this.fn(t,c.fieldPath)&&cf(h))r=this.gn(r,c,h);else{const m=d.Yt(c.kind);xl.vt.It(h,m)}}return this.pn(r)}In(e,t,i){return this.Tn(e,t,i.position)}pn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].zt();return t}gn(e,t,i){const r=[...e],o=[];for(const c of i.arrayValue.values||[])for(const h of r){const d=new fd;d.seed(h.zt()),xl.vt.It(c,d.Yt(t.kind)),o.push(d)}return o}fn(e,t){return!!e.filters.find((i=>i instanceof Xe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=md(e),r=tu(e);return(t?i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.U()).next((o=>{const c=[];return W.forEach(o,(h=>r.get([h.indexId,this.uid]).next((d=>{c.push((function(_,y){const b=y?new rf(y.sequenceNumber,new ts(Ql(y.readTime),new pe(dr(y.documentKey)),y.largestBatchId)):rf.empty(),I=_.fields.map((([C,M])=>new Gp(Mt.fromServerFormat(C),M)));return new og(_.indexId,_.collectionGroup,I,b)})(h,d))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const o=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return o!==0?o:Me(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=md(e),o=tu(e);return this.yn(e).next((c=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((h=>W.forEach(h,(d=>o.put(Ax(d.indexId,this.uid,c,i))))))))}updateIndexEntries(e,t){const i=new Map;return W.forEach(t,((r,o)=>{const c=i.get(r.collectionGroup);return(c?W.resolve(c):this.getFieldIndexes(e,r.collectionGroup)).next((h=>(i.set(r.collectionGroup,h),W.forEach(h,(d=>this.wn(e,r,d).next((m=>{const _=this.Sn(o,d);return m.isEqual(_)?W.resolve():this.bn(e,o,d,m,_)})))))))}))}Dn(e,t,i,r){return eu(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(i,t.key),documentKey:t.key.path.toArray()})}vn(e,t,i,r){return eu(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(i,t.key),t.key.path.toArray()])}wn(e,t,i){const r=eu(e);let o=new bt(so);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.mn(i,t)])},((c,h)=>{o=o.add(new Cl(i.indexId,t,h.arrayValue,h.directionalValue))})).next((()=>o))}Sn(e,t){let i=new bt(so);const r=this.Vn(t,e);if(r==null)return i;const o=P0(t);if(o!=null){const c=e.data.field(o.fieldPath);if(cf(c))for(const h of c.arrayValue.values||[])i=i.add(new Cl(t.indexId,e.key,this.dn(h),r))}else i=i.add(new Cl(t.indexId,e.key,kp,r));return i}bn(e,t,i,r,o){le("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const c=[];return(function(d,m,_,y,b){const I=d.getIterator(),C=m.getIterator();let M=Zc(I),z=Zc(C);for(;M||z;){let B=!1,j=!1;if(M&&z){const X=_(M,z);X<0?j=!0:X>0&&(B=!0)}else M!=null?j=!0:B=!0;B?(y(z),z=Zc(C)):j?(b(M),M=Zc(I)):(M=Zc(I),z=Zc(C))}})(r,o,so,(h=>{c.push(this.Dn(e,t,i,h))}),(h=>{c.push(this.vn(e,t,i,h))})),W.waitFor(c)}yn(e){let t=1;return tu(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,o)=>{o.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((c,h)=>so(c,h))).filter(((c,h,d)=>!h||so(c,d[h-1])!==0));const r=[];r.push(e);for(const c of i){const h=so(c,e),d=so(c,t);if(h===0)r[0]=e.Zt();else if(h>0&&d<0)r.push(c),r.push(c.Zt());else if(d>0)break}r.push(t);const o=[];for(let c=0;c<r.length;c+=2){if(this.Cn(r[c],r[c+1]))return[];const h=[r[c].indexId,this.uid,r[c].arrayValue,r[c].directionalValue,kp,[]],d=[r[c+1].indexId,this.uid,r[c+1].arrayValue,r[c+1].directionalValue,kp,[]];o.push(IDBKeyRange.bound(h,d))}return o}Cn(e,t){return so(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Px)}getMinOffset(e,t){return W.mapArray(this.hn(t),(i=>this.Pn(e,i).next((r=>r||ve())))).next(Px)}}function Ox(n){return En(n,"collectionParents")}function eu(n){return En(n,"indexEntries")}function md(n){return En(n,"indexConfiguration")}function tu(n){return En(n,"indexState")}function Px(n){Ee(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;aE(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ts(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ti{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new Ti(e,Ti.DEFAULT_COLLECTION_PERCENTILE,Ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),o=[],c=IDBKeyRange.only(t.batchId);let h=0;const d=i.J({range:c},((_,y,b)=>(h++,b.delete())));o.push(d.next((()=>{Ee(h===1)})));const m=[];for(const _ of t.mutations){const y=iN(e,_.key.path,t.batchId);o.push(r.delete(y)),m.push(_.key)}return W.waitFor(o).next((()=>m))}function fg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ve();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ti.DEFAULT_COLLECTION_PERCENTILE=10,Ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ti.DEFAULT=new Ti(41943040,Ti.DEFAULT_COLLECTION_PERCENTILE,Ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ti.DISABLED=new Ti(-1,0,0);class r_{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Fn={}}static lt(e,t,i,r){Ee(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new r_(o,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ro(e).J({index:"userMutationsIndex",range:i},((r,o,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const o=lu(e),c=ro(e);return c.add({}).next((h=>{Ee(typeof h=="number");const d=new pE(h,t,i,r),m=(function(I,C,M){const z=M.baseMutations.map((j=>df(I.ct,j))),B=M.mutations.map((j=>df(I.ct,j)));return{userId:C,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:z,mutations:B}})(this.serializer,this.userId,d),_=[];let y=new bt(((b,I)=>Me(b.canonicalString(),I.canonicalString())));for(const b of r){const I=iN(this.userId,b.key.path,h);y=y.add(b.key.path.popLast()),_.push(c.put(m)),_.push(o.put(I,sU))}return y.forEach((b=>{_.push(this.indexManager.addToCollectionParentIndex(e,b))})),e.addOnCommittedListener((()=>{this.Fn[h]=d.keys()})),W.waitFor(_).next((()=>d))}))}lookupMutationBatch(e,t){return ro(e).get(t).next((i=>i?(Ee(i.userId===this.userId),Al(this.serializer,i)):null))}Mn(e,t){return this.Fn[t]?W.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Fn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return ro(e).J({index:"userMutationsIndex",range:r},((c,h,d)=>{h.userId===this.userId&&(Ee(h.batchId>=i),o=Al(this.serializer,h)),d.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return ro(e).J({index:"userMutationsIndex",range:t,reverse:!0},((r,o,c)=>{i=o.batchId,c.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ro(e).U("userMutationsIndex",t).next((i=>i.map((r=>Al(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Hp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),o=[];return lu(e).J({range:r},((c,h,d)=>{const[m,_,y]=c,b=dr(_);if(m===this.userId&&t.path.isEqual(b))return ro(e).get(y).next((I=>{if(!I)throw ve();Ee(I.userId===this.userId),o.push(Al(this.serializer,I))}));d.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new bt(Me);const r=[];return t.forEach((o=>{const c=Hp(this.userId,o.path),h=IDBKeyRange.lowerBound(c),d=lu(e).J({range:h},((m,_,y)=>{const[b,I,C]=m,M=dr(I);b===this.userId&&o.path.isEqual(M)?i=i.add(C):y.done()}));r.push(d)})),W.waitFor(r).next((()=>this.xn(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,o=Hp(this.userId,i),c=IDBKeyRange.lowerBound(o);let h=new bt(Me);return lu(e).J({range:c},((d,m,_)=>{const[y,b,I]=d,C=dr(b);y===this.userId&&i.isPrefixOf(C)?C.length===r&&(h=h.add(I)):_.done()})).next((()=>this.xn(e,h)))}xn(e,t){const i=[],r=[];return t.forEach((o=>{r.push(ro(e).get(o).next((c=>{if(c===null)throw ve();Ee(c.userId===this.userId),i.push(Al(this.serializer,c))})))})),W.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return t2(e._e,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),W.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return W.resolve();const i=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),r=[];return lu(e).J({range:i},((o,c,h)=>{if(o[0]===this.userId){const d=dr(o[1]);r.push(d)}else h.done()})).next((()=>{Ee(r.length===0)}))}))}containsKey(e,t){return n2(e,this.userId,t)}Nn(e){return i2(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function n2(n,e,t){const i=Hp(e,t.path),r=i[1],o=IDBKeyRange.lowerBound(i);let c=!1;return lu(n).J({range:o,H:!0},((h,d,m)=>{const[_,y,b]=h;_===e&&y===r&&(c=!0),m.done()})).next((()=>c))}function ro(n){return En(n,"mutations")}function lu(n){return En(n,"documentMutations")}function i2(n){return En(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Wl(0)}static kn(){return new Wl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const i=new Wl(t.highestTargetId);return t.highestTargetId=i.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((t=>Ie.fromTimestamp(new jt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.qn(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Qn(e,r))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((i=>(i.targetCount+=1,this.$n(t,i),this.Qn(e,i))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>nu(e).delete(t.targetId))).next((()=>this.qn(e))).next((i=>(Ee(i.targetCount>0),i.targetCount-=1,this.Qn(e,i))))}removeTargets(e,t,i){let r=0;const o=[];return nu(e).J(((c,h)=>{const d=Cd(h);d.sequenceNumber<=t&&i.get(d.targetId)===null&&(r++,o.push(this.removeTargetData(e,d)))})).next((()=>W.waitFor(o))).next((()=>r))}forEachTarget(e,t){return nu(e).J(((i,r)=>{const o=Cd(r);t(o)}))}qn(e){return Vx(e).get("targetGlobalKey").next((t=>(Ee(t!==null),t)))}Qn(e,t){return Vx(e).put("targetGlobalKey",t)}Kn(e,t){return nu(e).put(JN(this.serializer,t))}$n(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.qn(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Gl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return nu(e).J({range:r,index:"queryTargetsIndex"},((c,h,d)=>{const m=Cd(h);jf(t,m.target)&&(o=m,d.done())})).next((()=>o))}addMatchingKeys(e,t,i){const r=[],o=ao(e);return t.forEach((c=>{const h=ci(c.path);r.push(o.put({targetId:i,path:h})),r.push(this.referenceDelegate.addReference(e,i,c))})),W.waitFor(r)}removeMatchingKeys(e,t,i){const r=ao(e);return W.forEach(t,(o=>{const c=ci(o.path);return W.waitFor([r.delete([i,c]),this.referenceDelegate.removeReference(e,i,o)])}))}removeMatchingKeysForTargetId(e,t){const i=ao(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=ao(e);let o=Ue();return r.J({range:i,H:!0},((c,h,d)=>{const m=dr(c[1]),_=new pe(m);o=o.add(_)})).next((()=>o))}containsKey(e,t){const i=ci(t.path),r=IDBKeyRange.bound([i],[YR(i)],!1,!0);let o=0;return ao(e).J({index:"documentTargetsIndex",H:!0,range:r},(([c,h],d,m)=>{c!==0&&(o++,m.done())})).next((()=>o>0))}ot(e,t){return nu(e).get(t).next((i=>i?Cd(i):null))}}function nu(n){return En(n,"targets")}function Vx(n){return En(n,"targetGlobal")}function ao(n){return En(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx([n,e],[t,i]){const r=Me(n,t);return r===0?Me(e,i):r}class w6{constructor(e){this.Un=e,this.buffer=new bt(Lx),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Lx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class E6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){le("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){zo(t)?le("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Bo(t)}await this.Hn(3e5)}))}}class b6{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return W.resolve(Si.oe);const i=new w6(t);return this.Jn.forEachTarget(e,(r=>i.zn(r.sequenceNumber))).next((()=>this.Jn.Zn(e,(r=>i.zn(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Jn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(le("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(Mx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(le("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mx):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let i,r,o,c,h,d,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),r=this.params.maximumSequenceNumbersToCollect):r=y,c=Date.now(),this.nthSequenceNumber(e,r)))).next((y=>(i=y,h=Date.now(),this.removeTargets(e,i,t)))).next((y=>(o=y,d=Date.now(),this.removeOrphanedDocuments(e,i)))).next((y=>(m=Date.now(),su()<=Ge.DEBUG&&le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${r} in `+(h-c)+`ms
	Removed ${o} targets in `+(d-h)+`ms
	Removed ${y} documents in `+(m-d)+`ms
Total Duration: ${m-_}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:y}))))}}function T6(n,e){return new b6(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e,t){this.db=e,this.garbageCollector=T6(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}er(e){let t=0;return this.Zn(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((i,r)=>t(r)))}addReference(e,t,i){return Op(e,i)}removeReference(e,t,i){return Op(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Op(e,t)}nr(e,t){return(function(r,o){let c=!1;return i2(r).Y((h=>n2(r,h,o).next((d=>(d&&(c=!0),W.resolve(!d)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let o=0;return this.tr(e,((c,h)=>{if(h<=t){const d=this.nr(e,c).next((m=>{if(!m)return o++,i.getEntry(e,c).next((()=>(i.removeEntry(c,Ie.min()),ao(e).delete((function(y){return[0,ci(y.path)]})(c)))))}));r.push(d)}})).next((()=>W.waitFor(r))).next((()=>i.apply(e))).next((()=>o))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Op(e,t)}tr(e,t){const i=ao(e);let r,o=Si.oe;return i.J({index:"documentTargetsIndex"},(([c,h],{path:d,sequenceNumber:m})=>{c===0?(o!==Si.oe&&t(new pe(dr(r)),o),o=m,r=d):o=Si.oe})).next((()=>{o!==Si.oe&&t(new pe(dr(r)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Op(n,e){return ao(n).put((function(i,r){return{targetId:0,path:ci(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(){this.changes=new qo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,kt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?W.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return wl(e).put(i)}removeEntry(e,t,i){return wl(e).delete((function(o,c){const h=o.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],hg(c),h[h.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.rr(e,i))))}getEntry(e,t){let i=kt.newInvalidDocument(t);return wl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(pd(t))},((r,o)=>{i=this.ir(t,o)})).next((()=>i))}sr(e,t){let i={size:0,document:kt.newInvalidDocument(t)};return wl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(pd(t))},((r,o)=>{i={document:this.ir(t,o),size:fg(o)}})).next((()=>i))}getEntries(e,t){let i=xi();return this._r(e,t,((r,o)=>{const c=this.ir(r,o);i=i.insert(r,c)})).next((()=>i))}ar(e,t){let i=xi(),r=new zt(pe.comparator);return this._r(e,t,((o,c)=>{const h=this.ir(o,c);i=i.insert(o,h),r=r.insert(o,fg(c))})).next((()=>({documents:i,ur:r})))}_r(e,t,i){if(t.isEmpty())return W.resolve();let r=new bt(Fx);t.forEach((d=>r=r.add(d)));const o=IDBKeyRange.bound(pd(r.first()),pd(r.last())),c=r.getIterator();let h=c.getNext();return wl(e).J({index:"documentKeyIndex",range:o},((d,m,_)=>{const y=pe.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&Fx(h,y)<0;)i(h,null),h=c.getNext();h&&h.isEqual(y)&&(i(h,m),h=c.hasNext()?c.getNext():null),h?_.$(pd(h)):_.done()})).next((()=>{for(;h;)i(h,null),h=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,o){const c=t.path,h=[c.popLast().toArray(),c.lastSegment(),hg(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],d=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wl(e).U(IDBKeyRange.bound(h,d,!0)).next((m=>{o==null||o.incrementDocumentReadCount(m.length);let _=xi();for(const y of m){const b=this.ir(pe.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);b.isFoundDocument()&&(Ff(t,b)||r.has(b.key))&&(_=_.insert(b.key,b))}return _}))}getAllFromCollectionGroup(e,t,i,r){let o=xi();const c=Ux(t,i),h=Ux(t,ts.max());return wl(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(c,h,!0)},((d,m,_)=>{const y=this.ir(pe.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(y.key,y),o.size===r&&_.done()})).next((()=>o))}newChangeBuffer(e){return new A6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return jx(e).get("remoteDocumentGlobalKey").next((t=>(Ee(!!t),t)))}rr(e,t){return jx(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const i=c6(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ie.min())))return i}return kt.newInvalidDocument(e)}}function r2(n){return new S6(n)}class A6 extends s2{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new qo((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new bt(((o,c)=>Me(o.canonicalString(),c.canonicalString())));return this.changes.forEach(((o,c)=>{const h=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,h.readTime)),c.isValidDocument()){const d=Ix(this.cr.serializer,c);r=r.add(o.path.popLast());const m=fg(d);i+=m-h.size,t.push(this.cr.addEntry(e,o,d))}else if(i-=h.size,this.trackRemovals){const d=Ix(this.cr.serializer,c.convertToNoDocument(Ie.min()));t.push(this.cr.addEntry(e,o,d))}})),r.forEach((o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.cr.updateMetadata(e,i)),W.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((i=>(this.lr.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((({documents:i,ur:r})=>(r.forEach(((o,c)=>{this.lr.set(o,{size:c,readTime:i.get(o).readTime})})),i)))}}function jx(n){return En(n,"remoteDocumentGlobal")}function wl(n){return En(n,"remoteDocumentsV14")}function pd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ux(n,e){const t=e.documentKey.path.toArray();return[n,hg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Fx(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(r=Me(t[o],i[o]),r)return r;return r=Me(t.length,i.length),r||(r=Me(t[t.length-2],i[i.length-2]),r||Me(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Md(i.mutation,r,Ai.empty(),jt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ue()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ue()){const r=fr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((o=>{let c=Ad();return o.forEach(((h,d)=>{c=c.insert(h,d.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=fr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ue())))}populateOverlays(e,t,i){const r=[];return i.forEach((o=>{t.has(o)||r.push(o)})),this.documentOverlayCache.getOverlays(e,r).next((o=>{o.forEach(((c,h)=>{t.set(c,h)}))}))}computeViews(e,t,i,r){let o=xi();const c=Pd(),h=(function(){return Pd()})();return t.forEach(((d,m)=>{const _=i.get(m.key);r.has(m.key)&&(_===void 0||_.mutation instanceof pa)?o=o.insert(m.key,m):_!==void 0?(c.set(m.key,_.mutation.getFieldMask()),Md(_.mutation,m,_.mutation.getFieldMask(),jt.now())):c.set(m.key,Ai.empty())})),this.recalculateAndSaveOverlays(e,o).next((d=>(d.forEach(((m,_)=>c.set(m,_))),t.forEach(((m,_)=>{var y;return h.set(m,new x6(_,(y=c.get(m))!==null&&y!==void 0?y:null))})),h)))}recalculateAndSaveOverlays(e,t){const i=Pd();let r=new zt(((c,h)=>c-h)),o=Ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const h of c)h.keys().forEach((d=>{const m=t.get(d);if(m===null)return;let _=i.get(d)||Ai.empty();_=h.applyToLocalView(m,_),i.set(d,_);const y=(r.get(h.batchId)||Ue()).add(d);r=r.insert(h.batchId,y)}))})).next((()=>{const c=[],h=r.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),m=d.key,_=d.value,y=SN();_.forEach((b=>{if(!o.has(b)){const I=kN(t.get(b),i.get(b));I!==null&&y.set(b,I),o=o.add(b)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,y))}return W.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(c){return pe.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):hE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((o=>{const c=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):W.resolve(fr());let h=-1,d=o;return c.next((m=>W.forEach(m,((_,y)=>(h<y.largestBatchId&&(h=y.largestBatchId),o.get(_)?W.resolve():this.remoteDocumentCache.getEntry(e,_).next((b=>{d=d.insert(_,b)}))))).next((()=>this.populateOverlays(e,m,o))).next((()=>this.computeViews(e,d,m,Ue()))).next((_=>({batchId:h,changes:IN(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next((i=>{let r=Ad();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const o=t.collectionGroup;let c=Ad();return this.indexManager.getCollectionParents(e,o).next((h=>W.forEach(h,(d=>{const m=(function(y,b){return new ma(b,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,i,r).next((_=>{_.forEach(((y,b)=>{c=c.insert(y,b)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r)))).next((c=>{o.forEach(((d,m)=>{const _=m.getKey();c.get(_)===null&&(c=c.insert(_,kt.newInvalidDocument(_)))}));let h=Ad();return c.forEach(((d,m)=>{const _=o.get(d);_!==void 0&&Md(_.mutation,m,Ai.empty(),jt.now()),Ff(t,m)&&(h=h.insert(d,m))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return W.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:rn(r.createTime)}})(t)),W.resolve()}getNamedQuery(e,t){return W.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,(function(r){return{name:r.name,query:wE(r.bundledQuery),readTime:rn(r.readTime)}})(t)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(){this.overlays=new zt(pe.comparator),this.Ir=new Map}getOverlay(e,t){return W.resolve(this.overlays.get(t))}getOverlays(e,t){const i=fr();return W.forEach(t,(r=>this.getOverlay(e,r).next((o=>{o!==null&&i.set(r,o)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,o)=>{this.ht(e,t,o)})),W.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.Ir.get(i);return r!==void 0&&(r.forEach((o=>this.overlays=this.overlays.remove(o))),this.Ir.delete(i)),W.resolve()}getOverlaysForCollection(e,t,i){const r=fr(),o=t.length+1,c=new pe(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const d=h.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&d.largestBatchId>i&&r.set(d.getKey(),d)}return W.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new zt(((m,_)=>m-_));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let _=o.get(m.largestBatchId);_===null&&(_=fr(),o=o.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const h=fr(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((m,_)=>h.set(m,_))),!(h.size()>=r)););return W.resolve(h)}ht(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const c=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new _E(t,i));let o=this.Ir.get(t);o===void 0&&(o=Ue(),this.Ir.set(t,o)),this.Ir.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(){this.sessionToken=Yt.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(){this.Tr=new bt(xn.Er),this.dr=new bt(xn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const i=new xn(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Vr(new xn(e,t))}mr(e,t){e.forEach((i=>this.removeReference(i,t)))}gr(e){const t=new pe(new Ye([])),i=new xn(t,e),r=new xn(t,e+1),o=[];return this.dr.forEachInRange([i,r],(c=>{this.Vr(c),o.push(c.key)})),o}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new pe(new Ye([])),i=new xn(t,e),r=new xn(t,e+1);let o=Ue();return this.dr.forEachInRange([i,r],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new xn(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class xn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return pe.comparator(e.key,t.key)||Me(e.wr,t.wr)}static Ar(e,t){return Me(e.wr,t.wr)||pe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new bt(xn.Er)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new pE(o,t,i,r);this.mutationQueue.push(c);for(const h of r)this.br=this.br.add(new xn(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return W.resolve(c)}lookupMutationBatch(e,t){return W.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.vr(i),o=r<0?0:r;return W.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new xn(t,0),r=new xn(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([i,r],(c=>{const h=this.Dr(c.wr);o.push(h)})),W.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new bt(Me);return t.forEach((r=>{const o=new xn(r,0),c=new xn(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,c],(h=>{i=i.add(h.wr)}))})),W.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let o=i;pe.isDocumentKey(o)||(o=o.child(""));const c=new xn(new pe(o),0);let h=new bt(Me);return this.br.forEachWhile((d=>{const m=d.key.path;return!!i.isPrefixOf(m)&&(m.length===r&&(h=h.add(d.wr)),!0)}),c),W.resolve(this.Cr(h))}Cr(e){const t=[];return e.forEach((i=>{const r=this.Dr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ee(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return W.forEach(t.mutations,(r=>{const o=new xn(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=i}))}On(e){}containsKey(e,t){const i=new xn(t,0),r=this.br.firstAfterOrEqual(i);return W.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.Mr=e,this.docs=(function(){return new zt(pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),o=r?r.size:0,c=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return W.resolve(i?i.document.mutableCopy():kt.newInvalidDocument(t))}getEntries(e,t){let i=xi();return t.forEach((r=>{const o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():kt.newInvalidDocument(r))})),W.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=xi();const c=t.path,h=new pe(c.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:m,value:{document:_}}=d.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||aE(JR(_),i)<=0||(r.has(_.key)||Ff(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return W.resolve(o)}getAllFromCollectionGroup(e,t,i,r){ve()}Or(e,t){return W.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new O6(this)}getSize(e){return W.resolve(this.size)}}class O6 extends s2{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)})),W.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e){this.persistence=e,this.Nr=new qo((t=>Gl(t)),jf),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.Lr=0,this.Br=new TE,this.targetCount=0,this.kr=Wl.Bn()}forEachTarget(e,t){return this.Nr.forEach(((i,r)=>t(r))),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),W.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Wl(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,W.resolve()}updateTargetData(e,t){return this.Kn(t),W.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,t,i){let r=0;const o=[];return this.Nr.forEach(((c,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.Nr.delete(c),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),r++)})),W.waitFor(o).next((()=>r))}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,t){const i=this.Nr.get(t)||null;return W.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),W.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);const r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((c=>{o.push(r.markPotentiallyOrphaned(e,c))})),W.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),W.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Br.yr(t);return W.resolve(i)}containsKey(e,t){return W.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Si(0),this.Kr=!1,this.Kr=!0,this.$r=new N6,this.referenceDelegate=e(this),this.Ur=new P6(this),this.indexManager=new _6,this.remoteDocumentCache=(function(r){return new k6(r)})((i=>this.referenceDelegate.Wr(i))),this.serializer=new XN(t),this.Gr=new C6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new R6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new D6(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){le("MemoryPersistence","Starting transaction:",e);const r=new M6(this.Qr.next());return this.referenceDelegate.zr(),i(r).next((o=>this.referenceDelegate.jr(r).next((()=>o)))).toPromise().then((o=>(r.raiseOnCommittedEvent(),o)))}Hr(e,t){return W.or(Object.values(this.qr).map((i=>()=>i.containsKey(e,t))))}}class M6 extends eN{constructor(e){super(),this.currentSequenceNumber=e}}class a_{constructor(e){this.persistence=e,this.Jr=new TE,this.Yr=null}static Zr(e){return new a_(e)}get Xr(){if(this.Yr)return this.Yr;throw ve()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),W.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),W.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),W.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((r=>this.Xr.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((o=>this.Xr.add(o.toString())))})).next((()=>i.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.Xr,(i=>{const r=pe.fromPath(i);return this.ei(e,r).next((o=>{o||t.removeEntry(r,Ie.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return W.or([()=>W.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e){this.serializer=e}O(e,t,i,r){const o=new Zg("createOrUpgrade",t);i<1&&r>=1&&((function(d){d.createObjectStore("owner")})(e),(function(d){d.createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ex,{unique:!0}),d.createObjectStore("documentMutations")})(e),Bx(e),(function(d){d.createObjectStore("remoteDocuments")})(e));let c=W.resolve();return i<3&&r>=3&&(i!==0&&((function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")})(e),Bx(e)),c=c.next((()=>(function(d){const m=d.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ie.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",_)})(o)))),i<4&&r>=4&&(i!==0&&(c=c.next((()=>(function(d,m){return m.store("mutations").U().next((_=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ex,{unique:!0});const y=m.store("mutations"),b=_.map((I=>y.put(I)));return W.waitFor(b)}))})(e,o)))),c=c.next((()=>{(function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)}))),i<5&&r>=5&&(c=c.next((()=>this.ni(o)))),i<6&&r>=6&&(c=c.next((()=>((function(d){d.createObjectStore("remoteDocumentGlobal")})(e),this.ri(o))))),i<7&&r>=7&&(c=c.next((()=>this.ii(o)))),i<8&&r>=8&&(c=c.next((()=>this.si(e,o)))),i<9&&r>=9&&(c=c.next((()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(c=c.next((()=>this.oi(o)))),i<11&&r>=11&&(c=c.next((()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),(function(d){d.createObjectStore("namedQueries",{keyPath:"name"})})(e)}))),i<12&&r>=12&&(c=c.next((()=>{(function(d){const m=d.createObjectStore("documentOverlays",{keyPath:gU});m.createIndex("collectionPathOverlayIndex",_U,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",yU,{unique:!1})})(e)}))),i<13&&r>=13&&(c=c.next((()=>(function(d){const m=d.createObjectStore("remoteDocumentsV14",{keyPath:rU});m.createIndex("documentKeyIndex",aU),m.createIndex("collectionGroupIndex",oU)})(e))).next((()=>this._i(e,o))).next((()=>e.deleteObjectStore("remoteDocuments")))),i<14&&r>=14&&(c=c.next((()=>this.ai(e,o)))),i<15&&r>=15&&(c=c.next((()=>(function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:dU}).createIndex("sequenceNumberIndex",fU,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:mU}).createIndex("documentKeyIndex",pU,{unique:!1})})(e)))),i<16&&r>=16&&(c=c.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),i<17&&r>=17&&(c=c.next((()=>{(function(d){d.createObjectStore("globals",{keyPath:"name"})})(e)}))),c}ri(e){let t=0;return e.store("remoteDocuments").J(((i,r)=>{t+=fg(r)})).next((()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)}))}ni(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.U().next((r=>W.forEach(r,(o=>{const c=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",c).next((h=>W.forEach(h,(d=>{Ee(d.userId===o.userId);const m=Al(this.serializer,d);return t2(e,o.userId,m).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((r=>{const o=[];return i.J(((c,h)=>{const d=new Ye(c),m=(function(y){return[0,ci(y)]})(d);o.push(t.get(m).next((_=>_?W.resolve():(y=>t.put({targetId:0,path:ci(y),sequenceNumber:r.highestListenSequenceNumber}))(d))))})).next((()=>W.waitFor(o)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:hU});const i=t.store("collectionParents"),r=new bE,o=c=>{if(r.add(c)){const h=c.lastSegment(),d=c.popLast();return i.put({collectionId:h,parent:ci(d)})}};return t.store("remoteDocuments").J({H:!0},((c,h)=>{const d=new Ye(c);return o(d.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([c,h,d],m)=>{const _=dr(h);return o(_.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((i,r)=>{const o=Cd(r),c=JN(this.serializer,o);return t.put(c)}))}_i(e,t){const i=t.store("remoteDocuments"),r=[];return i.J(((o,c)=>{const h=t.store("remoteDocumentsV14"),d=(function(y){return y.document?new pe(Ye.fromString(y.document.name).popFirst(5)):y.noDocument?pe.fromSegments(y.noDocument.path):y.unknownDocument?pe.fromSegments(y.unknownDocument.path):ve()})(c).path.toArray(),m={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};r.push(h.put(m))})).next((()=>W.waitFor(r)))}ai(e,t){const i=t.store("mutations"),r=r2(this.serializer),o=new o2(a_.Zr,this.serializer.ct);return i.U().next((c=>{const h=new Map;return c.forEach((d=>{var m;let _=(m=h.get(d.userId))!==null&&m!==void 0?m:Ue();Al(this.serializer,d).keys().forEach((y=>_=_.add(y))),h.set(d.userId,_)})),W.forEach(h,((d,m)=>{const _=new Rn(m),y=s_.lt(this.serializer,_),b=o.getIndexManager(_),I=r_.lt(_,this.serializer,b,o.referenceDelegate);return new a2(r,I,y,b).recalculateAndSaveOverlaysForDocumentKeys(new M0(t,Si.oe),d).next()}))}))}}function Bx(n){n.createObjectStore("targetDocuments",{keyPath:cU}).createIndex("documentTargetsIndex",uU,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",lU,{unique:!0}),n.createObjectStore("targetGlobal")}const s0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class IE{constructor(e,t,i,r,o,c,h,d,m,_,y=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.ui=o,this.window=c,this.document=h,this.ci=m,this.li=_,this.hi=y,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=b=>Promise.resolve(),!IE.D())throw new oe(Z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new I6(this,r),this.Ai=t+"main",this.serializer=new XN(d),this.Ri=new mr(this.Ai,this.hi,new V6(this.serializer)),this.$r=new h6,this.Ur=new v6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=r2(this.serializer),this.Gr=new u6,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,_===!1&&sn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new oe(Z.FAILED_PRECONDITION,s0);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new Si(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Pp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(zo(e))return le("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return le("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return gd(e).get("owner").next((t=>W.resolve(this.vi(t))))}Ci(e){return Pp(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=En(t,"clientMetadata");return i.U().next((r=>{const o=this.xi(r,18e5),c=r.filter((h=>o.indexOf(h)===-1));return W.forEach(c,(h=>i.delete(h.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?W.resolve(!0):gd(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new oe(Z.FAILED_PRECONDITION,s0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Pp(e).U().next((i=>this.xi(i,5e3).find((r=>{if(this.clientId!==r.clientId){const o=!this.networkEnabled&&r.networkEnabled,c=!this.inForeground&&r.inForeground,h=this.networkEnabled===r.networkEnabled;if(o||c&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&le("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new M0(e,Si.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((i=>this.Mi(i.updateTimeMs,t)&&!this.Ni(i.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>Pp(e).U().next((t=>this.xi(t,18e5).map((i=>i.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return r_.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new y6(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return s_.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,i){le("IndexedDbPersistence","Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",o=(function(d){return d===17?EU:d===16?wU:d===15?lE:d===14?aN:d===13?rN:d===12?vU:d===11?sN:void ve()})(this.hi);let c;return this.Ri.runTransaction(e,r,o,(h=>(c=new M0(h,this.Qr?this.Qr.next():Si.oe),t==="readwrite-primary"?this.wi(c).next((d=>!!d||this.Si(c))).next((d=>{if(!d)throw sn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new oe(Z.FAILED_PRECONDITION,ZR);return i(c)})).next((d=>this.Di(c).next((()=>d)))):this.Ki(c).next((()=>i(c)))))).then((h=>(c.raiseOnCommittedEvent(),h)))}Ki(e){return gd(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new oe(Z.FAILED_PRECONDITION,s0)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gd(e).put("owner",t)}static D(){return mr.D()}bi(e){const t=gd(e);return t.get("owner").next((i=>this.vi(i)?(le("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):W.resolve()))}Mi(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(sn(`Detected an update time that is in the future: ${e} > ${i}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;A1()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const i=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return le("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return sn("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){sn("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function gd(n){return En(n,"owner")}function Pp(n){return En(n,"clientMetadata")}function SE(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=r}static Wi(e,t){let i=Ue(),r=Ue();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new AE(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return A1()?8:tN(Bt())>0?6:4})()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,r){const o={result:null};return this.Yi(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.Zi(e,t,r,i).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new L6;return this.Xi(e,t,c).next((h=>{if(o.result=h,this.zi)return this.es(e,t,c,h.size)}))})).next((()=>o.result))}es(e,t,i,r){return i.documentReadCount<this.ji?(su()<=Ge.DEBUG&&le("QueryEngine","SDK will not create cache indexes for query:",ru(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),W.resolve()):(su()<=Ge.DEBUG&&le("QueryEngine","Query:",ru(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(su()<=Ge.DEBUG&&le("QueryEngine","The SDK decides to create cache indexes for query:",ru(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ui(t))):W.resolve())}Yi(e,t){if(fx(t))return W.resolve(null);let i=ui(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=ug(t,null,"F"),i=ui(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((o=>{const c=Ue(...o);return this.Ji.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((d=>{const m=this.ts(t,h);return this.ns(t,m,c,d.readTime)?this.Yi(e,ug(t,null,"F")):this.rs(e,m,t,d)}))))})))))}Zi(e,t,i,r){return fx(t)||r.isEqual(Ie.min())?W.resolve(null):this.Ji.getDocuments(e,i).next((o=>{const c=this.ts(t,o);return this.ns(t,c,i,r)?W.resolve(null):(su()<=Ge.DEBUG&&le("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ru(t)),this.rs(e,c,t,XR(r,-1)).next((h=>h)))}))}ts(e,t){let i=new bt(bN(e));return t.forEach(((r,o)=>{Ff(e,o)&&(i=i.add(o))})),i}ns(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Xi(e,t,i){return su()<=Ge.DEBUG&&le("QueryEngine","Using full collection scan to execute query:",ru(t)),this.Ji.getDocumentsMatchingQuery(e,t,ts.min(),i)}rs(e,t,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(e,t,i,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new zt(Me),this._s=new qo((o=>Gl(o)),jf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new a2(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function c2(n,e,t,i){return new j6(n,e,t,i)}async function u2(n,e){const t=ge(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((o=>(r=o,t.ls(e),t.mutationQueue.getAllMutationBatches(i)))).next((o=>{const c=[],h=[];let d=Ue();for(const m of r){c.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}for(const m of o){h.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}return t.localDocuments.getDocuments(i,d).next((m=>({hs:m,removedBatchIds:c,addedBatchIds:h})))}))}))}function U6(n,e){const t=ge(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return(function(h,d,m,_){const y=m.batch,b=y.keys();let I=W.resolve();return b.forEach((C=>{I=I.next((()=>_.getEntry(d,C))).next((M=>{const z=m.docVersions.get(C);Ee(z!==null),M.version.compareTo(z)<0&&(y.applyToRemoteDocument(M,m),M.isValidDocument()&&(M.setReadTime(m.commitVersion),_.addEntry(M)))}))})),I.next((()=>h.mutationQueue.removeMutationBatch(d,y)))})(t,i,e,o).next((()=>o.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let d=Ue();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(d=d.add(h.batch.mutations[m].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function h2(n){const e=ge(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ur.getLastRemoteSnapshotVersion(t)))}function F6(n,e){const t=ge(n),i=e.snapshotVersion;let r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;const h=[];e.targetChanges.forEach(((_,y)=>{const b=r.get(y);if(!b)return;h.push(t.Ur.removeMatchingKeys(o,_.removedDocuments,y).next((()=>t.Ur.addMatchingKeys(o,_.addedDocuments,y))));let I=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?I=I.withResumeToken(Yt.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):_.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(_.resumeToken,i)),r=r.insert(y,I),(function(M,z,B){return M.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0})(b,I,_)&&h.push(t.Ur.updateTargetData(o,I))}));let d=xi(),m=Ue();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,_))})),h.push(d2(o,c,e.documentUpdates).next((_=>{d=_.Ps,m=_.Is}))),!i.isEqual(Ie.min())){const _=t.Ur.getLastRemoteSnapshotVersion(o).next((y=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,i)));h.push(_)}return W.waitFor(h).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,d,m))).next((()=>d))})).then((o=>(t.os=r,o)))}function d2(n,e,t){let i=Ue(),r=Ue();return t.forEach((o=>i=i.add(o))),e.getEntries(n,i).next((o=>{let c=xi();return t.forEach(((h,d)=>{const m=o.get(h);d.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(h)),d.isNoDocument()&&d.version.isEqual(Ie.min())?(e.removeEntry(h,d.readTime),c=c.insert(h,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),c=c.insert(h,d)):le("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",d.version)})),{Ps:c,Is:r}}))}function B6(n,e){const t=ge(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function ku(n,e){const t=ge(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Ur.getTargetData(i,e).next((o=>o?(r=o,W.resolve(r)):t.Ur.allocateTargetId(i).next((c=>(r=new ta(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i}))}async function Ou(n,e,t){const i=ge(n),r=i.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,(c=>i.persistence.referenceDelegate.removeTarget(c,r)))}catch(c){if(!zo(c))throw c;le("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}i.os=i.os.remove(e),i._s.delete(r.target)}function mg(n,e,t){const i=ge(n);let r=Ie.min(),o=Ue();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(d,m,_){const y=ge(d),b=y._s.get(_);return b!==void 0?W.resolve(y.os.get(b)):y.Ur.getTargetData(m,_)})(i,c,ui(e)).next((h=>{if(h)return r=h.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(c,h.targetId).next((d=>{o=d}))})).next((()=>i.ss.getDocumentsMatchingQuery(c,e,t?r:Ie.min(),t?o:Ue()))).next((h=>(p2(i,EN(e),h),{documents:h,Ts:o})))))}function f2(n,e){const t=ge(n),i=ge(t.Ur),r=t.os.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",(o=>i.ot(o,e).next((c=>c?c.target:null))))}function m2(n,e){const t=ge(n),i=t.us.get(e)||Ie.min();return t.persistence.runTransaction("Get new document changes","readonly",(r=>t.cs.getAllFromCollectionGroup(r,e,XR(i,-1),Number.MAX_SAFE_INTEGER))).then((r=>(p2(t,e,r),r)))}function p2(n,e,t){let i=n.us.get(e)||Ie.min();t.forEach(((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)})),n.us.set(e,i)}async function z6(n,e,t,i){const r=ge(n);let o=Ue(),c=xi();for(const m of t){const _=e.Es(m.metadata.name);m.document&&(o=o.add(_));const y=e.ds(m);y.setReadTime(e.As(m.metadata.readTime)),c=c.insert(_,y)}const h=r.cs.newChangeBuffer({trackRemovals:!0}),d=await ku(r,(function(_){return ui(Zu(Ye.fromString(`__bundle__/docs/${_}`)))})(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",(m=>d2(m,h,c).next((_=>(h.apply(m),_))).next((_=>r.Ur.removeMatchingKeysForTargetId(m,d.targetId).next((()=>r.Ur.addMatchingKeys(m,o,d.targetId))).next((()=>r.localDocuments.getLocalViewOfDocuments(m,_.Ps,_.Is))).next((()=>_.Ps))))))}async function q6(n,e,t=Ue()){const i=await ku(n,ui(wE(e.bundledQuery))),r=ge(n);return r.persistence.runTransaction("Save named query","readwrite",(o=>{const c=rn(e.readTime);if(i.snapshotVersion.compareTo(c)>=0)return r.Gr.saveNamedQuery(o,e);const h=i.withResumeToken(Yt.EMPTY_BYTE_STRING,c);return r.os=r.os.insert(h.targetId,h),r.Ur.updateTargetData(o,h).next((()=>r.Ur.removeMatchingKeysForTargetId(o,i.targetId))).next((()=>r.Ur.addMatchingKeys(o,t,i.targetId))).next((()=>r.Gr.saveNamedQuery(o,e)))}))}function zx(n,e){return`firestore_clients_${n}_${e}`}function qx(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function r0(n,e){return`firestore_targets_${n}_${e}`}class pg{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Rs(e,t,i){const r=JSON.parse(i);let o,c=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return c&&r.error&&(c=typeof r.error.message=="string"&&typeof r.error.code=="string",c&&(o=new oe(r.error.code,r.error.message))),c?new pg(e,t,r.state,o):(sn("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Vd{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Rs(e,t){const i=JSON.parse(t);let r,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(r=new oe(i.error.code,i.error.message))),o?new Vd(e,i.state,r):(sn("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const i=JSON.parse(t);let r=typeof i=="object"&&i.activeTargetIds instanceof Array,o=dE();for(let c=0;r&&c<i.activeTargetIds.length;++c)r=nN(i.activeTargetIds[c]),o=o.add(i.activeTargetIds[c]);return r?new gg(e,o):(sn("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class xE{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new xE(t.clientId,t.onlineState):(sn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Y0{constructor(){this.activeTargetIds=dE()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class a0{constructor(e,t,i,r,o){this.window=e,this.ui=t,this.persistenceKey=i,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new zt(Me),this.started=!1,this.bs=[];const c=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=zx(this.persistenceKey,this.ps),this.vs=(function(d){return`firestore_sequence_number_${d}`})(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Y0),this.Cs=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.xs=(function(d){return`firestore_online_state_${d}`})(this.persistenceKey),this.Os=(function(d){return`firestore_bundle_loaded_v2_${d}`})(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const i of e){if(i===this.ps)continue;const r=this.getItem(zx(this.persistenceKey,i));if(r){const o=gg.Rs(i,r);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const i=this.Ls(t);i&&this.Bs(i)}for(const i of this.bs)this.ws(i);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,i){this.qs(e,t,i),this.Qs(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(r0(this.persistenceKey,e));if(r){const o=Vd.Rs(e,r);o&&(i=o.state)}}return t&&this.Ks.fs(e),this.Ns(),i}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(r0(this.persistenceKey,e))}updateQueryState(e,t,i){this.$s(e,t,i)}handleUserChange(e,t,i){t.forEach((r=>{this.Qs(r)})),this.currentUser=e,i.forEach((r=>{this.addPendingMutation(r)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return le("SharedClientState","READ",e,t),t}setItem(e,t){le("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){le("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(le("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void sn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const i=this.Gs(t.key);return this.zs(i,null)}{const i=this.js(t.key,t.newValue);if(i)return this.zs(i.clientId,i)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const i=this.Hs(t.key,t.newValue);if(i)return this.Js(i)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const i=this.Ys(t.key,t.newValue);if(i)return this.Zs(i)}}else if(t.key===this.xs){if(t.newValue!==null){const i=this.Ls(t.newValue);if(i)return this.Bs(i)}}else if(t.key===this.vs){const i=(function(o){let c=Si.oe;if(o!=null)try{const h=JSON.parse(o);Ee(typeof h=="number"),c=h}catch(h){sn("SharedClientState","Failed to read sequence number from WebStorage",h)}return c})(t.newValue);i!==Si.oe&&this.sequenceNumberHandler(i)}else if(t.key===this.Os){const i=this.Xs(t.newValue);await Promise.all(i.map((r=>this.syncEngine.eo(r))))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,i){const r=new pg(this.currentUser,e,t,i),o=qx(this.persistenceKey,this.currentUser,e);this.setItem(o,r.Vs())}Qs(e){const t=qx(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,i){const r=r0(this.persistenceKey,e),o=new Vd(e,t,i);this.setItem(r,o.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const i=this.Gs(e);return gg.Rs(i,t)}Hs(e,t){const i=this.Fs.exec(e),r=Number(i[1]),o=i[2]!==void 0?i[2]:null;return pg.Rs(new Rn(o),r,t)}Ys(e,t){const i=this.Ms.exec(e),r=Number(i[1]);return Vd.Rs(r,t)}Ls(e){return xE.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);le("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const i=t?this.Ss.insert(e,t):this.Ss.remove(e),r=this.ks(this.Ss),o=this.ks(i),c=[],h=[];return o.forEach((d=>{r.has(d)||c.push(d)})),r.forEach((d=>{o.has(d)||h.push(d)})),this.syncEngine.io(c,h).then((()=>{this.Ss=i}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=dE();return e.forEach(((i,r)=>{t=t.unionWith(r.activeTargetIds)})),t}}class g2{constructor(){this.so=new Y0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Y0,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){le("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){le("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mp=null;function o0(){return Mp===null?Mp=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mp++,"0x"+Mp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn="WebChannelConnection";class $6 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${r}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${o}`}get Fo(){return!1}Mo(t,i,r,o,c){const h=o0(),d=this.xo(t,i.toUriEncodedString());le("RestConnection",`Sending RPC '${t}' ${h}:`,d,r);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,o,c),this.No(t,d,m,r).then((_=>(le("RestConnection",`Received RPC '${t}' ${h}: `,_),_)),(_=>{throw vr("RestConnection",`RPC '${t}' ${h} failed with error: `,_,"url: ",d,"request:",r),_}))}Lo(t,i,r,o,c,h){return this.Mo(t,i,r,o,c)}Oo(t,i,r){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ju})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach(((o,c)=>t[c]=o)),r&&r.headers.forEach(((o,c)=>t[c]=o))}xo(t,i){const r=H6[t];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,r){const o=o0();return new Promise(((c,h)=>{const d=new qR;d.setWithCredentials(!0),d.listenOnce(GR.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case qp.NO_ERROR:const _=d.getResponseJson();le(Qn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(_)),c(_);break;case qp.TIMEOUT:le(Qn,`RPC '${e}' ${o} timed out`),h(new oe(Z.DEADLINE_EXCEEDED,"Request time out"));break;case qp.HTTP_ERROR:const y=d.getStatus();if(le(Qn,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const I=b==null?void 0:b.error;if(I&&I.status&&I.message){const C=(function(z){const B=z.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(B)>=0?B:Z.UNKNOWN})(I.status);h(new oe(C,I.message))}else h(new oe(Z.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new oe(Z.UNAVAILABLE,"Connection failed."));break;default:ve()}}finally{le(Qn,`RPC '${e}' ${o} completed.`)}}));const m=JSON.stringify(r);le(Qn,`RPC '${e}' ${o} sending request:`,r),d.send(t,"POST",m,i,15)}))}Bo(e,t,i){const r=o0(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=$R(),h=KR(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const _=o.join("");le(Qn,`Creating RPC '${e}' stream ${r}: ${_}`,d);const y=c.createWebChannel(_,d);let b=!1,I=!1;const C=new K6({Io:z=>{I?le(Qn,`Not sending because RPC '${e}' stream ${r} is closed:`,z):(b||(le(Qn,`Opening RPC '${e}' stream ${r} transport.`),y.open(),b=!0),le(Qn,`RPC '${e}' stream ${r} sending:`,z),y.send(z))},To:()=>y.close()}),M=(z,B,j)=>{z.listen(B,(X=>{try{j(X)}catch(fe){setTimeout((()=>{throw fe}),0)}}))};return M(y,Sd.EventType.OPEN,(()=>{I||(le(Qn,`RPC '${e}' stream ${r} transport opened.`),C.yo())})),M(y,Sd.EventType.CLOSE,(()=>{I||(I=!0,le(Qn,`RPC '${e}' stream ${r} transport closed`),C.So())})),M(y,Sd.EventType.ERROR,(z=>{I||(I=!0,vr(Qn,`RPC '${e}' stream ${r} transport errored:`,z),C.So(new oe(Z.UNAVAILABLE,"The operation could not be completed")))})),M(y,Sd.EventType.MESSAGE,(z=>{var B;if(!I){const j=z.data[0];Ee(!!j);const X=j,fe=X.error||((B=X[0])===null||B===void 0?void 0:B.error);if(fe){le(Qn,`RPC '${e}' stream ${r} received error:`,fe);const F=fe.status;let ae=(function(R){const V=mn[R];if(V!==void 0)return MN(V)})(F),D=fe.message;ae===void 0&&(ae=Z.INTERNAL,D="Unknown error status: "+F+" with message "+fe.message),I=!0,C.So(new oe(ae,D)),y.close()}else le(Qn,`RPC '${e}' stream ${r} received:`,j),C.bo(j)}})),M(h,HR.STAT_EVENT,(z=>{z.stat===O0.PROXY?le(Qn,`RPC '${e}' stream ${r} detected buffering proxy`):z.stat===O0.NOPROXY&&le(Qn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{C.wo()}),0),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _2(){return typeof window<"u"?window:null}function Yp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(n){return new ZU(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,t,i=1e3,r=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&le("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,t,i,r,o,c,h,d){this.ui=e,this.Ho=i,this.Jo=r,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new CE(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===Z.RESOURCE_EXHAUSTED?(sn(t.toString()),sn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.Yo===t&&this.P_(i,r)}),(i=>{e((()=>{const r=new oe(Z.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)}))}))}P_(e,t){const i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{i((()=>this.listener.Eo()))})),this.stream.Ro((()=>{i((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((r=>{i((()=>this.I_(r)))})),this.stream.onMessage((r=>{i((()=>++this.e_==1?this.E_(r):this.onNext(r)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return le("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(le("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Q6 extends y2{constructor(e,t,i,r,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,c),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=n6(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Ie.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Ie.min():c.readTime?rn(c.readTime):Ie.min()})(e);return this.listener.d_(t,i)}A_(e){const t={};t.database=H0(this.serializer),t.addTarget=(function(o,c){let h;const d=c.target;if(h=lg(d)?{documents:HN(o,d)}:{query:KN(o,d)._t},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=UN(o,c.resumeToken);const m=q0(o,c.expectedCount);m!==null&&(h.expectedCount=m)}else if(c.snapshotVersion.compareTo(Ie.min())>0){h.readTime=Du(o,c.snapshotVersion.toTimestamp());const m=q0(o,c.expectedCount);m!==null&&(h.expectedCount=m)}return h})(this.serializer,e);const i=s6(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){const t={};t.database=H0(this.serializer),t.removeTarget=e,this.a_(t)}}class W6 extends y2{constructor(e,t,i,r,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,c),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ee(!!e.streamToken),this.lastStreamToken=e.streamToken,Ee(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ee(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=i6(e.writeResults,e.commitTime),i=rn(e.commitTime);return this.listener.g_(i,t)}p_(){const e={};e.database=H0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>df(this.serializer,i)))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6 extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new oe(Z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Mo(e,G0(t,i),r,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new oe(Z.UNKNOWN,o.toString())}))}Lo(e,t,i,r,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Lo(e,G0(t,i),r,c,h,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new oe(Z.UNKNOWN,c.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class X6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(sn(t),this.D_=!1):le("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o((c=>{i.enqueueAndForget((async()=>{Go(this)&&(le("RemoteStore","Restarting streams for network reachability change."),await(async function(d){const m=ge(d);m.L_.add(4),await nh(m),m.q_.set("Unknown"),m.L_.delete(4),await Hf(m)})(this))}))})),this.q_=new X6(i,r)}}async function Hf(n){if(Go(n))for(const e of n.B_)await e(!0)}async function nh(n){for(const e of n.B_)await e(!1)}function o_(n,e){const t=ge(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),DE(t)?NE(t):sh(t).r_()&&RE(t,e))}function Pu(n,e){const t=ge(n),i=sh(t);t.N_.delete(e),i.r_()&&v2(t,e),t.N_.size===0&&(i.r_()?i.o_():Go(t)&&t.q_.set("Unknown"))}function RE(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sh(n).A_(e)}function v2(n,e){n.Q_.xe(e),sh(n).R_(e)}function NE(n){n.Q_=new WU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),sh(n).start(),n.q_.v_()}function DE(n){return Go(n)&&!sh(n).n_()&&n.N_.size>0}function Go(n){return ge(n).L_.size===0}function w2(n){n.Q_=void 0}async function Z6(n){n.q_.set("Online")}async function eF(n){n.N_.forEach(((e,t)=>{RE(n,e)}))}async function tF(n,e){w2(n),DE(n)?(n.q_.M_(e),NE(n)):n.q_.set("Unknown")}async function nF(n,e,t){if(n.q_.set("Online"),e instanceof jN&&e.state===2&&e.cause)try{await(async function(r,o){const c=o.cause;for(const h of o.targetIds)r.N_.has(h)&&(await r.remoteSyncer.rejectListen(h,c),r.N_.delete(h),r.Q_.removeTarget(h))})(n,e)}catch(i){le("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await _g(n,i)}else if(e instanceof Wp?n.Q_.Ke(e):e instanceof LN?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Ie.min()))try{const i=await h2(n.localStore);t.compareTo(i)>=0&&await(function(o,c){const h=o.Q_.rt(c);return h.targetChanges.forEach(((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const _=o.N_.get(m);_&&o.N_.set(m,_.withResumeToken(d.resumeToken,c))}})),h.targetMismatches.forEach(((d,m)=>{const _=o.N_.get(d);if(!_)return;o.N_.set(d,_.withResumeToken(Yt.EMPTY_BYTE_STRING,_.snapshotVersion)),v2(o,d);const y=new ta(_.target,d,m,_.sequenceNumber);RE(o,y)})),o.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(i){le("RemoteStore","Failed to raise snapshot:",i),await _g(n,i)}}async function _g(n,e,t){if(!zo(e))throw e;n.L_.add(1),await nh(n),n.q_.set("Offline"),t||(t=()=>h2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{le("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Hf(n)}))}function E2(n,e){return e().catch((t=>_g(n,t,e)))}async function ih(n){const e=ge(n),t=No(e);let i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;iF(e);)try{const r=await B6(e.localStore,i);if(r===null){e.O_.length===0&&t.o_();break}i=r.batchId,sF(e,r)}catch(r){await _g(e,r)}b2(e)&&T2(e)}function iF(n){return Go(n)&&n.O_.length<10}function sF(n,e){n.O_.push(e);const t=No(n);t.r_()&&t.V_&&t.m_(e.mutations)}function b2(n){return Go(n)&&!No(n).n_()&&n.O_.length>0}function T2(n){No(n).start()}async function rF(n){No(n).p_()}async function aF(n){const e=No(n);for(const t of n.O_)e.m_(t.mutations)}async function oF(n,e,t){const i=n.O_.shift(),r=gE.from(i,e,t);await E2(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await ih(n)}async function lF(n,e){e&&No(n).V_&&await(async function(i,r){if((function(c){return PN(c)&&c!==Z.ABORTED})(r.code)){const o=i.O_.shift();No(i).s_(),await E2(i,(()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r))),await ih(i)}})(n,e),b2(n)&&T2(n)}async function Hx(n,e){const t=ge(n);t.asyncQueue.verifyOperationInProgress(),le("RemoteStore","RemoteStore received new credentials");const i=Go(t);t.L_.add(3),await nh(t),i&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Hf(t)}async function X0(n,e){const t=ge(n);e?(t.L_.delete(2),await Hf(t)):e||(t.L_.add(2),await nh(t),t.q_.set("Unknown"))}function sh(n){return n.K_||(n.K_=(function(t,i,r){const o=ge(t);return o.w_(),new Q6(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Eo:Z6.bind(null,n),Ro:eF.bind(null,n),mo:tF.bind(null,n),d_:nF.bind(null,n)}),n.B_.push((async e=>{e?(n.K_.s_(),DE(n)?NE(n):n.q_.set("Unknown")):(await n.K_.stop(),w2(n))}))),n.K_}function No(n){return n.U_||(n.U_=(function(t,i,r){const o=ge(t);return o.w_(),new W6(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:rF.bind(null,n),mo:lF.bind(null,n),f_:aF.bind(null,n),g_:oF.bind(null,n)}),n.B_.push((async e=>{e?(n.U_.s_(),await ih(n)):(await n.U_.stop(),n.O_.length>0&&(le("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){const c=Date.now()+i,h=new kE(e,t,c,r,o);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(Z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rh(n,e){if(sn("AsyncQueue",`${e}: ${n}`),zo(n))return new oe(Z.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e){this.comparator=e?(t,i)=>e(t,i)||pe.comparator(t.key,i.key):(t,i)=>pe.comparator(t.key,i.key),this.keyedMap=Ad(),this.sortedSet=new zt(this.comparator)}static emptySet(e){return new gu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new gu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(){this.W_=new zt(pe.comparator)}track(e){const t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ve():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Mu{constructor(e,t,i,r,o,c,h,d,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,r,o){const c=[];return t.forEach((h=>{c.push({type:0,doc:h})})),new Mu(e,t,gu.emptySet(t),c,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class uF{constructor(){this.queries=$x(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){const r=ge(t),o=r.queries;r.queries=$x(),o.forEach(((c,h)=>{for(const d of h.j_)d.onError(i)}))})(this,new oe(Z.ABORTED,"Firestore shutting down"))}}function $x(){return new qo((n=>wN(n)),Uf)}async function OE(n,e){const t=ge(n);let i=3;const r=e.query;let o=t.queries.get(r);o?!o.H_()&&e.J_()&&(i=2):(o=new cF,i=e.J_()?0:1);try{switch(i){case 0:o.z_=await t.onListen(r,!0);break;case 1:o.z_=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(c){const h=rh(c,`Initialization of query '${ru(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&ME(t)}async function PE(n,e){const t=ge(n),i=e.query;let r=3;const o=t.queries.get(i);if(o){const c=o.j_.indexOf(e);c>=0&&(o.j_.splice(c,1),o.j_.length===0?r=e.J_()?0:1:!o.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function hF(n,e){const t=ge(n);let i=!1;for(const r of e){const o=r.query,c=t.queries.get(o);if(c){for(const h of c.j_)h.X_(r)&&(i=!0);c.z_=r}}i&&ME(t)}function dF(n,e,t){const i=ge(n),r=i.queries.get(e);if(r)for(const o of r.j_)o.onError(t);i.queries.delete(e)}function ME(n){n.Y_.forEach((e=>{e.next()}))}var J0,Qx;(Qx=J0||(J0={})).ea="default",Qx.Cache="cache";class VE{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Mu(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Mu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==J0.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fF{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e){this.serializer=e}Es(e){return pr(this.serializer,e)}ds(e){return e.metadata.exists?GN(this.serializer,e.document,!1):kt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return rn(e)}}class mF{constructor(e,t,i){this.ca=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=I2(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const i=Ye.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,i=new Wx(this.serializer);for(const r of e)if(r.metadata.queries){const o=i.Es(r.metadata.name);for(const c of r.metadata.queries){const h=(t.get(c)||Ue()).add(o);t.set(c,h)}}return t}async complete(){const e=await z6(this.localStore,new Wx(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const i of this.queries)await q6(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function I2(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e){this.key=e}}class A2{constructor(e){this.key=e}}class x2{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ue(),this.mutatedKeys=Ue(),this.Aa=bN(e),this.Ra=new gu(this.Aa)}get Va(){return this.Ta}ma(e,t){const i=t?t.fa:new Kx,r=t?t.Ra:this.Ra;let o=t?t.mutatedKeys:this.mutatedKeys,c=r,h=!1;const d=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,m=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((_,y)=>{const b=r.get(_),I=Ff(this.query,y)?y:null,C=!!b&&this.mutatedKeys.has(b.key),M=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let z=!1;b&&I?b.data.isEqual(I.data)?C!==M&&(i.track({type:3,doc:I}),z=!0):this.ga(b,I)||(i.track({type:2,doc:I}),z=!0,(d&&this.Aa(I,d)>0||m&&this.Aa(I,m)<0)&&(h=!0)):!b&&I?(i.track({type:0,doc:I}),z=!0):b&&!I&&(i.track({type:1,doc:b}),z=!0,(d||m)&&(h=!0)),z&&(I?(c=c.add(I),o=M?o.add(_):o.delete(_)):(c=c.delete(_),o=o.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),o=o.delete(_.key),i.track({type:1,doc:_})}return{Ra:c,fa:i,ns:h,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const c=e.fa.G_();c.sort(((_,y)=>(function(I,C){const M=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve()}};return M(I)-M(C)})(_.type,y.type)||this.Aa(_.doc,y.doc))),this.pa(i),r=r!=null&&r;const h=t&&!r?this.ya():[],d=this.da.size===0&&this.current&&!r?1:0,m=d!==this.Ea;return this.Ea=d,c.length!==0||m?{snapshot:new Mu(this.query,e.Ra,o,c,e.mutatedKeys,d===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Kx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((t=>this.Ta=this.Ta.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ta=this.Ta.delete(t))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ue(),this.Ra.forEach((i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))}));const t=[];return e.forEach((i=>{this.da.has(i)||t.push(new A2(i))})),this.da.forEach((i=>{e.has(i)||t.push(new S2(i))})),t}ba(e){this.Ta=e.Ts,this.da=Ue();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Mu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class pF{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class gF{constructor(e){this.key=e,this.va=!1}}class _F{constructor(e,t,i,r,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Ca={},this.Fa=new qo((h=>wN(h)),Uf),this.Ma=new Map,this.xa=new Set,this.Oa=new zt(pe.comparator),this.Na=new Map,this.La=new TE,this.Ba={},this.ka=new Map,this.qa=Wl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function yF(n,e,t=!0){const i=l_(n);let r;const o=i.Fa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.Da()):r=await C2(i,e,t,!0),r}async function vF(n,e){const t=l_(n);await C2(t,e,!0,!1)}async function C2(n,e,t,i){const r=await ku(n.localStore,ui(e)),o=r.targetId,c=n.sharedClientState.addLocalQueryTarget(o,t);let h;return i&&(h=await LE(n,e,o,c==="current",r.resumeToken)),n.isPrimaryClient&&t&&o_(n.remoteStore,r),h}async function LE(n,e,t,i,r){n.Ka=(y,b,I)=>(async function(M,z,B,j){let X=z.view.ma(B);X.ns&&(X=await mg(M.localStore,z.query,!1).then((({documents:D})=>z.view.ma(D,X))));const fe=j&&j.targetChanges.get(z.targetId),F=j&&j.targetMismatches.get(z.targetId)!=null,ae=z.view.applyChanges(X,M.isPrimaryClient,fe,F);return Z0(M,z.targetId,ae.wa),ae.snapshot})(n,y,b,I);const o=await mg(n.localStore,e,!0),c=new x2(e,o.Ts),h=c.ma(o.documents),d=qf.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),m=c.applyChanges(h,n.isPrimaryClient,d);Z0(n,t,m.wa);const _=new pF(e,t,c);return n.Fa.set(e,_),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),m.snapshot}async function wF(n,e,t){const i=ge(n),r=i.Fa.get(e),o=i.Ma.get(r.targetId);if(o.length>1)return i.Ma.set(r.targetId,o.filter((c=>!Uf(c,e)))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Ou(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Pu(i.remoteStore,r.targetId),Vu(i,r.targetId)})).catch(Bo)):(Vu(i,r.targetId),await Ou(i.localStore,r.targetId,!0))}async function EF(n,e){const t=ge(n),i=t.Fa.get(e),r=t.Ma.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Pu(t.remoteStore,i.targetId))}async function bF(n,e,t){const i=BE(n);try{const r=await(function(c,h){const d=ge(c),m=jt.now(),_=h.reduce(((I,C)=>I.add(C.key)),Ue());let y,b;return d.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let C=xi(),M=Ue();return d.cs.getEntries(I,_).next((z=>{C=z,C.forEach(((B,j)=>{j.isValidDocument()||(M=M.add(B))}))})).next((()=>d.localDocuments.getOverlayedDocuments(I,C))).next((z=>{y=z;const B=[];for(const j of h){const X=KU(j,y.get(j.key).overlayedDocument);X!=null&&B.push(new pa(j.key,X,hN(X.value.mapValue),Vt.exists(!0)))}return d.mutationQueue.addMutationBatch(I,m,B,h)})).next((z=>{b=z;const B=z.applyToLocalDocumentSet(y,M);return d.documentOverlayCache.saveOverlays(I,z.batchId,B)}))})).then((()=>({batchId:b.batchId,changes:IN(y)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(c,h,d){let m=c.Ba[c.currentUser.toKey()];m||(m=new zt(Me)),m=m.insert(h,d),c.Ba[c.currentUser.toKey()]=m})(i,r.batchId,t),await ga(i,r.changes),await ih(i.remoteStore)}catch(r){const o=rh(r,"Failed to persist write");t.reject(o)}}async function R2(n,e){const t=ge(n);try{const i=await F6(t.localStore,e);e.targetChanges.forEach(((r,o)=>{const c=t.Na.get(o);c&&(Ee(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?c.va=!0:r.modifiedDocuments.size>0?Ee(c.va):r.removedDocuments.size>0&&(Ee(c.va),c.va=!1))})),await ga(t,i,e)}catch(i){await Bo(i)}}function Yx(n,e,t){const i=ge(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Fa.forEach(((o,c)=>{const h=c.view.Z_(e);h.snapshot&&r.push(h.snapshot)})),(function(c,h){const d=ge(c);d.onlineState=h;let m=!1;d.queries.forEach(((_,y)=>{for(const b of y.j_)b.Z_(h)&&(m=!0)})),m&&ME(d)})(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function TF(n,e,t){const i=ge(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Na.get(e),o=r&&r.key;if(o){let c=new zt(pe.comparator);c=c.insert(o,kt.newNoDocument(o,Ie.min()));const h=Ue().add(o),d=new zf(Ie.min(),new Map,new zt(Me),c,h);await R2(i,d),i.Oa=i.Oa.remove(o),i.Na.delete(e),FE(i)}else await Ou(i.localStore,e,!1).then((()=>Vu(i,e,t))).catch(Bo)}async function IF(n,e){const t=ge(n),i=e.batch.batchId;try{const r=await U6(t.localStore,e);UE(t,i,null),jE(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ga(t,r)}catch(r){await Bo(r)}}async function SF(n,e,t){const i=ge(n);try{const r=await(function(c,h){const d=ge(c);return d.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return d.mutationQueue.lookupMutationBatch(m,h).next((y=>(Ee(y!==null),_=y.keys(),d.mutationQueue.removeMutationBatch(m,y)))).next((()=>d.mutationQueue.performConsistencyCheck(m))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(m,_,h))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>d.localDocuments.getDocuments(m,_)))}))})(i.localStore,e);UE(i,e,t),jE(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ga(i,r)}catch(r){await Bo(r)}}async function AF(n,e){const t=ge(n);Go(t.remoteStore)||le("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await(function(c){const h=ge(c);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(d=>h.mutationQueue.getHighestUnacknowledgedBatchId(d)))})(t.localStore);if(i===-1)return void e.resolve();const r=t.ka.get(i)||[];r.push(e),t.ka.set(i,r)}catch(i){const r=rh(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function jE(n,e){(n.ka.get(e)||[]).forEach((t=>{t.resolve()})),n.ka.delete(e)}function UE(n,e,t){const i=ge(n);let r=i.Ba[i.currentUser.toKey()];if(r){const o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function Vu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach((i=>{n.La.containsKey(i)||N2(n,i)}))}function N2(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Pu(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),FE(n))}function Z0(n,e,t){for(const i of t)i instanceof S2?(n.La.addReference(i.key,e),xF(n,i)):i instanceof A2?(le("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||N2(n,i.key)):ve()}function xF(n,e){const t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(le("SyncEngine","New document in limbo: "+t),n.xa.add(i),FE(n))}function FE(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new pe(Ye.fromString(e)),i=n.qa.next();n.Na.set(i,new gF(t)),n.Oa=n.Oa.insert(t,i),o_(n.remoteStore,new ta(ui(Zu(t.path)),i,"TargetPurposeLimboResolution",Si.oe))}}async function ga(n,e,t){const i=ge(n),r=[],o=[],c=[];i.Fa.isEmpty()||(i.Fa.forEach(((h,d)=>{c.push(i.Ka(d,e,t).then((m=>{var _;if((m||t)&&i.isPrimaryClient){const y=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(d.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(m){r.push(m);const y=AE.Wi(d.targetId,m);o.push(y)}})))})),await Promise.all(c),i.Ca.d_(r),await(async function(d,m){const _=ge(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>W.forEach(m,(b=>W.forEach(b.$i,(I=>_.persistence.referenceDelegate.addReference(y,b.targetId,I))).next((()=>W.forEach(b.Ui,(I=>_.persistence.referenceDelegate.removeReference(y,b.targetId,I)))))))))}catch(y){if(!zo(y))throw y;le("LocalStore","Failed to update sequence numbers: "+y)}for(const y of m){const b=y.targetId;if(!y.fromCache){const I=_.os.get(b),C=I.snapshotVersion,M=I.withLastLimboFreeSnapshotVersion(C);_.os=_.os.insert(b,M)}}})(i.localStore,o))}async function CF(n,e){const t=ge(n);if(!t.currentUser.isEqual(e)){le("SyncEngine","User change. New user:",e.toKey());const i=await u2(t.localStore,e);t.currentUser=e,(function(o,c){o.ka.forEach((h=>{h.forEach((d=>{d.reject(new oe(Z.CANCELLED,c))}))})),o.ka.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ga(t,i.hs)}}function RF(n,e){const t=ge(n),i=t.Na.get(e);if(i&&i.va)return Ue().add(i.key);{let r=Ue();const o=t.Ma.get(e);if(!o)return r;for(const c of o){const h=t.Fa.get(c);r=r.unionWith(h.view.Va)}return r}}async function NF(n,e){const t=ge(n),i=await mg(t.localStore,e.query,!0),r=e.view.ba(i);return t.isPrimaryClient&&Z0(t,e.targetId,r.wa),r}async function DF(n,e){const t=ge(n);return m2(t.localStore,e).then((i=>ga(t,i)))}async function kF(n,e,t,i){const r=ge(n),o=await(function(h,d){const m=ge(h),_=ge(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(y=>_.Mn(y,d).next((b=>b?m.localDocuments.getDocuments(y,b):W.resolve(null)))))})(r.localStore,e);o!==null?(t==="pending"?await ih(r.remoteStore):t==="acknowledged"||t==="rejected"?(UE(r,e,i||null),jE(r,e),(function(h,d){ge(ge(h).mutationQueue).On(d)})(r.localStore,e)):ve(),await ga(r,o)):le("SyncEngine","Cannot apply mutation batch with id: "+e)}async function OF(n,e){const t=ge(n);if(l_(t),BE(t),e===!0&&t.Qa!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),r=await Xx(t,i.toArray());t.Qa=!0,await X0(t.remoteStore,!0);for(const o of r)o_(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){const i=[];let r=Promise.resolve();t.Ma.forEach(((o,c)=>{t.sharedClientState.isLocalQueryTarget(c)?i.push(c):r=r.then((()=>(Vu(t,c),Ou(t.localStore,c,!0)))),Pu(t.remoteStore,c)})),await r,await Xx(t,i),(function(c){const h=ge(c);h.Na.forEach(((d,m)=>{Pu(h.remoteStore,m)})),h.La.pr(),h.Na=new Map,h.Oa=new zt(pe.comparator)})(t),t.Qa=!1,await X0(t.remoteStore,!1)}}async function Xx(n,e,t){const i=ge(n),r=[],o=[];for(const c of e){let h;const d=i.Ma.get(c);if(d&&d.length!==0){h=await ku(i.localStore,ui(d[0]));for(const m of d){const _=i.Fa.get(m),y=await NF(i,_);y.snapshot&&o.push(y.snapshot)}}else{const m=await f2(i.localStore,c);h=await ku(i.localStore,m),await LE(i,D2(m),c,!1,h.resumeToken)}r.push(h)}return i.Ca.d_(o),r}function D2(n){return vN(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function PF(n){return(function(t){return ge(ge(t).persistence).Qi()})(ge(n).localStore)}async function MF(n,e,t,i){const r=ge(n);if(r.Qa)return void le("SyncEngine","Ignoring unexpected query state notification.");const o=r.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const c=await m2(r.localStore,EN(o[0])),h=zf.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Yt.EMPTY_BYTE_STRING);await ga(r,c,h);break}case"rejected":await Ou(r.localStore,e,!0),Vu(r,e,i);break;default:ve()}}async function VF(n,e,t){const i=l_(n);if(i.Qa){for(const r of e){if(i.Ma.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){le("SyncEngine","Adding an already active target "+r);continue}const o=await f2(i.localStore,r),c=await ku(i.localStore,o);await LE(i,D2(o),c.targetId,!1,c.resumeToken),o_(i.remoteStore,c)}for(const r of t)i.Ma.has(r)&&await Ou(i.localStore,r,!1).then((()=>{Pu(i.remoteStore,r),Vu(i,r)})).catch(Bo)}}function l_(n){const e=ge(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=R2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TF.bind(null,e),e.Ca.d_=hF.bind(null,e.eventManager),e.Ca.$a=dF.bind(null,e.eventManager),e}function BE(n){const e=ge(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SF.bind(null,e),e}function LF(n,e,t){const i=ge(n);(async function(o,c,h){try{const d=await c.getMetadata();if(await(function(I,C){const M=ge(I),z=rn(C.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",(B=>M.Gr.getBundleMetadata(B,C.id))).then((B=>!!B&&B.createTime.compareTo(z)>=0))})(o.localStore,d))return await c.close(),h._completeWith((function(I){return{taskState:"Success",documentsLoaded:I.totalDocuments,bytesLoaded:I.totalBytes,totalDocuments:I.totalDocuments,totalBytes:I.totalBytes}})(d)),Promise.resolve(new Set);h._updateProgress(I2(d));const m=new mF(d,o.localStore,c.serializer);let _=await c.Ua();for(;_;){const b=await m.la(_);b&&h._updateProgress(b),_=await c.Ua()}const y=await m.complete();return await ga(o,y.Ia,void 0),await(function(I,C){const M=ge(I);return M.persistence.runTransaction("Save bundle","readwrite",(z=>M.Gr.saveBundleMetadata(z,C)))})(o.localStore,d),h._completeWith(y.progress),Promise.resolve(y.Pa)}catch(d){return vr("SyncEngine",`Loading bundle failed with ${d}`),h._failWith(d),Promise.resolve(new Set)}})(i,e,t).then((r=>{i.sharedClientState.notifyBundleLoaded(r)}))}class ff{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return c2(this.persistence,new l2,e.initialUser,this.serializer)}Ga(e){return new o2(a_.Zr,this.serializer)}Wa(e){return new g2}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ff.provider={build:()=>new ff};class k2 extends ff{constructor(e,t,i){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await BE(this.Ja.syncEngine),await ih(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return c2(this.persistence,new l2,e.initialUser,this.serializer)}ja(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new E6(i,e.asyncQueue,t)}Ha(e,t){const i=new nU(t,this.persistence);return new tU(e.asyncQueue,i)}Ga(e){const t=SE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Ti.withCacheSize(this.cacheSizeBytes):Ti.DEFAULT;return new IE(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,_2(),Yp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new g2}}class jF extends k2{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof a0&&(this.sharedClientState.syncEngine={no:kF.bind(null,t),ro:MF.bind(null,t),io:VF.bind(null,t),Qi:PF.bind(null,t),eo:DF.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async i=>{await OF(this.Ja.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=_2();if(!a0.D(t))throw new oe(Z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=SE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new a0(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class mf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Yx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=CF.bind(null,this.syncEngine),await X0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new uF})()}createDatastore(e){const t=Gf(e.databaseInfo.databaseId),i=(function(o){return new $6(o)})(e.databaseInfo);return(function(o,c,h,d){return new Y6(o,c,h,d)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,o,c,h){return new J6(i,r,o,c,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>Yx(this.syncEngine,t,0)),(function(){return Gx.D()?new Gx:new G6})())}createSyncEngine(e,t){return(function(r,o,c,h,d,m,_){const y=new _F(r,o,c,h,d,m);return _&&(y.Qa=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const o=ge(r);le("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await nh(o),o.k_.shutdown(),o.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}mf.provider={build:()=>new mf};function Jx(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):sn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new zn,this.buffer=new Uint8Array,this.eu=(function(){return new TextDecoder("utf-8")})(),this.tu().then((i=>{i&&i.ua()?this.metadata.resolve(i.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.aa)}`))}),(i=>this.metadata.reject(i)))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),i=Number(t);isNaN(i)&&this.ru(`length string (${t}) is not valid number`);const r=await this.iu(i);return new fF(JSON.parse(r),e.length+i)}su(){return this.buffer.findIndex((e=>e===123))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new oe(Z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(r,o){const c=ge(r),h={documents:o.map((y=>hf(c.serializer,y)))},d=await c.Lo("BatchGetDocuments",c.serializer.databaseId,Ye.emptyPath(),h,o.length),m=new Map;d.forEach((y=>{const b=t6(c.serializer,y);m.set(b.key.toString(),b)}));const _=[];return o.forEach((y=>{const b=m.get(y.toString());Ee(!!b),_.push(b)})),_})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new th(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const r=pe.fromPath(i);this.mutations.push(new mE(r,this.precondition(r)))})),await(async function(i,r){const o=ge(i),c={writes:r.map((h=>df(o.serializer,h)))};await o.Mo("Commit",o.serializer.databaseId,Ye.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ve();t=Ie.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new oe(Z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ie.min())?Vt.exists(!1):Vt.updateTime(t):Vt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ie.min()))throw new oe(Z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Vt.updateTime(t)}return Vt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(e,t,i,r,o){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=o,this._u=i.maxAttempts,this.t_=new CE(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new FF(this.datastore),t=this.cu(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((r=>{this.lu(r)}))))})).catch((i=>{this.lu(i)}))}))}cu(e){try{const t=this.updateFunction(e);return!Lf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!PN(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Rn.UNAUTHENTICATED,this.clientId=WR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,(async c=>{le("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(le("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=rh(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function l0(n,e){n.asyncQueue.verifyOperationInProgress(),le("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await u2(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Zx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await zE(n);le("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Hx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>Hx(e.remoteStore,r))),n._onlineComponents=e}async function zE(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){le("FirestoreClient","Using user provided OfflineComponentProvider");try{await l0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Z.FAILED_PRECONDITION||r.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;vr("Error using user provided cache. Falling back to memory cache: "+t),await l0(n,new ff)}}else le("FirestoreClient","Using default OfflineComponentProvider"),await l0(n,new ff);return n._offlineComponents}async function u_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(le("FirestoreClient","Using user provided OnlineComponentProvider"),await Zx(n,n._uninitializedComponentsProvider._online)):(le("FirestoreClient","Using default OnlineComponentProvider"),await Zx(n,new mf))),n._onlineComponents}function O2(n){return zE(n).then((e=>e.persistence))}function qE(n){return zE(n).then((e=>e.localStore))}function P2(n){return u_(n).then((e=>e.remoteStore))}function GE(n){return u_(n).then((e=>e.syncEngine))}function qF(n){return u_(n).then((e=>e.datastore))}async function Lu(n){const e=await u_(n),t=e.eventManager;return t.onListen=yF.bind(null,e.syncEngine),t.onUnlisten=wF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=EF.bind(null,e.syncEngine),t}function GF(n){return n.asyncQueue.enqueue((async()=>{const e=await O2(n),t=await P2(n);return e.setNetworkEnabled(!0),(function(r){const o=ge(r);return o.L_.delete(0),Hf(o)})(t)}))}function HF(n){return n.asyncQueue.enqueue((async()=>{const e=await O2(n),t=await P2(n);return e.setNetworkEnabled(!1),(async function(r){const o=ge(r);o.L_.add(0),await nh(o),o.q_.set("Offline")})(t)}))}function KF(n,e){const t=new zn;return n.asyncQueue.enqueueAndForget((async()=>(async function(r,o,c){try{const h=await(function(m,_){const y=ge(m);return y.persistence.runTransaction("read document","readonly",(b=>y.localDocuments.getDocument(b,_)))})(r,o);h.isFoundDocument()?c.resolve(h):h.isNoDocument()?c.resolve(null):c.reject(new oe(Z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const d=rh(h,`Failed to get document '${o} from cache`);c.reject(d)}})(await qE(n),e,t))),t.promise}function M2(n,e,t={}){const i=new zn;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,m){const _=new c_({next:b=>{_.Za(),c.enqueueAndForget((()=>PE(o,y)));const I=b.docs.has(h);!I&&b.fromCache?m.reject(new oe(Z.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&b.fromCache&&d&&d.source==="server"?m.reject(new oe(Z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(b)},error:b=>m.reject(b)}),y=new VE(Zu(h.path),_,{includeMetadataChanges:!0,_a:!0});return OE(o,y)})(await Lu(n),n.asyncQueue,e,t,i))),i.promise}function $F(n,e){const t=new zn;return n.asyncQueue.enqueueAndForget((async()=>(async function(r,o,c){try{const h=await mg(r,o,!0),d=new x2(o,h.Ts),m=d.ma(h.documents),_=d.applyChanges(m,!1);c.resolve(_.snapshot)}catch(h){const d=rh(h,`Failed to execute query '${o} against cache`);c.reject(d)}})(await qE(n),e,t))),t.promise}function V2(n,e,t={}){const i=new zn;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,m){const _=new c_({next:b=>{_.Za(),c.enqueueAndForget((()=>PE(o,y))),b.fromCache&&d.source==="server"?m.reject(new oe(Z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(b)},error:b=>m.reject(b)}),y=new VE(h,_,{includeMetadataChanges:!0,_a:!0});return OE(o,y)})(await Lu(n),n.asyncQueue,e,t,i))),i.promise}function QF(n,e){const t=new c_(e);return n.asyncQueue.enqueueAndForget((async()=>(function(r,o){ge(r).Y_.add(o),o.next()})(await Lu(n),t))),()=>{t.Za(),n.asyncQueue.enqueueAndForget((async()=>(function(r,o){ge(r).Y_.delete(o)})(await Lu(n),t)))}}function WF(n,e,t,i){const r=(function(c,h){let d;return d=typeof c=="string"?VN().encode(c):c,(function(_,y){return new UF(_,y)})((function(_,y){if(_ instanceof Uint8Array)return Jx(_,y);if(_ instanceof ArrayBuffer)return Jx(new Uint8Array(_),y);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(d),h)})(t,Gf(e));n.asyncQueue.enqueueAndForget((async()=>{LF(await GE(n),r,i)}))}function YF(n,e){return n.asyncQueue.enqueue((async()=>(function(i,r){const o=ge(i);return o.persistence.runTransaction("Get named query","readonly",(c=>o.Gr.getNamedQuery(c,r)))})(await qE(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(n,e,t){if(!t)throw new oe(Z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function j2(n,e,t,i){if(e===!0&&i===!0)throw new oe(Z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function tC(n){if(!pe.isDocumentKey(n))throw new oe(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function nC(n){if(pe.isDocumentKey(n))throw new oe(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function h_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ve()}function at(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new oe(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=h_(n);throw new oe(Z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function U2(n,e){if(e<=0)throw new oe(Z.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new oe(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new oe(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}j2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=L2((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new oe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new oe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new oe(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kf{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iC({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iC(e),e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new G3;switch(i.type){case"firstParty":return new Q3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new oe(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=eC.get(t);i&&(le("ComponentProvider","Removing Datastore"),eC.delete(t),i.terminate())})(this),Promise.resolve()}}function F2(n,e,t,i={}){var r;const o=(n=at(n,Kf))._getSettings(),c=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==c&&vr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),i.mockUserToken){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Rn.MOCK_USER;else{h=b1(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new oe(Z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Rn(m)}n._authCredentials=new H3(new QR(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hi=class B2{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new B2(this.firestore,e,this._query)}},Ft=class z2{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _o(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new z2(this.firestore,e,this._key)}},_o=class q2 extends hi{constructor(e,t,i){super(e,t,Zu(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new pe(e))}withConverter(e){return new q2(this.firestore,e,this._path)}};function d_(n,e,...t){if(n=ye(n),HE("collection","path",e),n instanceof Kf){const i=Ye.fromString(e,...t);return nC(i),new _o(n,null,i)}{if(!(n instanceof Ft||n instanceof _o))throw new oe(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ye.fromString(e,...t));return nC(i),new _o(n.firestore,null,i)}}function XF(n,e){if(n=at(n,Kf),HE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new oe(Z.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new hi(n,null,(function(i){return new ma(Ye.emptyPath(),i)})(e))}function rt(n,e,...t){if(n=ye(n),arguments.length===1&&(e=WR.newId()),HE("doc","path",e),n instanceof Kf){const i=Ye.fromString(e,...t);return tC(i),new Ft(n,null,new pe(i))}{if(!(n instanceof Ft||n instanceof _o))throw new oe(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ye.fromString(e,...t));return tC(i),new Ft(n.firestore,n instanceof _o?n.converter:null,new pe(i))}}function G2(n,e){return n=ye(n),e=ye(e),(n instanceof Ft||n instanceof _o)&&(e instanceof Ft||e instanceof _o)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function H2(n,e){return n=ye(n),e=ye(e),n instanceof hi&&e instanceof hi&&n.firestore===e.firestore&&Uf(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new CE(this,"async_queue_retry"),this.Vu=()=>{const i=Yp();i&&le("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;const t=Yp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Yp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new zn;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!zo(e))throw e;le("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((i=>{this.Eu=i,this.du=!1;const r=(function(c){let h=c.message||"";return c.stack&&(h=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),h})(i);throw sn("INTERNAL UNHANDLED ERROR: ",r),i})).then((i=>(this.du=!1,i))))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=kE.createAndSchedule(this,e,t,i,(o=>this.yu(o)));return this.Tu.push(r),r}fu(){this.Eu&&ve()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function ew(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const o of i)if(o in r&&typeof r[o]=="function")return!0;return!1})(n,["next","error","complete"])}class JF{constructor(){this._progressObserver={},this._taskCompletionResolver=new zn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=-1;let Xt=class extends Kf{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new sC,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sC(e),this._firestoreClient=void 0,await e}}};function eB(n,e){const t=typeof n=="object"?n:Ug(),i=typeof n=="string"?n:"(default)",r=Qu(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const o=v1("firestore");o&&F2(r,...o)}return r}function qn(n){if(n._terminated)throw new oe(Z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||K2(n),n._firestoreClient}function K2(n){var e,t,i;const r=n._freezeSettings(),o=(function(h,d,m,_){return new IU(h,d,m,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,L2(_.experimentalLongPollingOptions),_.useFetchStreams)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new zF(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(h){const d=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(d),_online:d}})(n._componentsProvider))}function tB(n,e){vr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return $2(n,mf.provider,{build:i=>new k2(i,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function nB(n){vr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();$2(n,mf.provider,{build:t=>new jF(t,e.cacheSizeBytes)})}function $2(n,e,t){if((n=at(n,Xt))._firestoreClient||n._terminated)throw new oe(Z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new oe(Z.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},K2(n)}function iB(n){if(n._initialized&&!n._terminated)throw new oe(Z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new zn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(i){if(!mr.D())return Promise.resolve();const r=i+"main";await mr.delete(r)})(SE(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function sB(n){return(function(t){const i=new zn;return t.asyncQueue.enqueueAndForget((async()=>AF(await GE(t),i))),i.promise})(qn(n=at(n,Xt)))}function rB(n){return GF(qn(n=at(n,Xt)))}function aB(n){return HF(qn(n=at(n,Xt)))}function oB(n,e){const t=qn(n=at(n,Xt)),i=new JF;return WF(t,n._databaseId,e,i),i}function lB(n,e){return YF(qn(n=at(n,Xt)),e).then((t=>t?new hi(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Er(Yt.fromBase64String(e))}catch(t){throw new oe(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Er(Yt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Do=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new oe(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rc=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new oe(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new oe(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0})(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cB=/^__.*__$/;class uB{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new pa(e,this.data,this.fieldMask,t,this.fieldTransforms):new eh(e,this.data,t,this.fieldTransforms)}}class Q2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new pa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function W2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve()}}class m_{constructor(e,t,i,r,o,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new m_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yg(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(W2(this.Cu)&&cB.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class hB{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Gf(e)}Qu(e,t,i,r=!1){return new m_({Cu:e,methodName:t,qu:i,path:Mt.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ac(n){const e=n._freezeSettings(),t=Gf(n._databaseId);return new hB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function p_(n,e,t,i,r,o={}){const c=n.Qu(o.merge||o.mergeFields?2:0,e,t,r);ZE("Data must be an object, but it was:",c,i);const h=J2(i,c);let d,m;if(o.merge)d=new Ai(c.fieldMask),m=c.fieldTransforms;else if(o.mergeFields){const _=[];for(const y of o.mergeFields){const b=tw(e,y,t);if(!c.contains(b))throw new oe(Z.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);eD(_,b)||_.push(b)}d=new Ai(_),m=c.fieldTransforms.filter((y=>d.covers(y.field)))}else d=null,m=c.fieldTransforms;return new uB(new Bn(h),d,m)}class $f extends rc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $f}}function Y2(n,e,t){return new m_({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class $E extends rc{_toFieldTransform(e){return new Bf(e.path,new Ru)}isEqual(e){return e instanceof $E}}class QE extends rc{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Y2(this,e,!0),i=this.Ku.map((o=>oc(o,t))),r=new Hl(i);return new Bf(e.path,r)}isEqual(e){return e instanceof QE&&wu(this.Ku,e.Ku)}}class WE extends rc{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Y2(this,e,!0),i=this.Ku.map((o=>oc(o,t))),r=new Kl(i);return new Bf(e.path,r)}isEqual(e){return e instanceof WE&&wu(this.Ku,e.Ku)}}class YE extends rc{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Nu(e.serializer,xN(e.serializer,this.$u));return new Bf(e.path,t)}isEqual(e){return e instanceof YE&&this.$u===e.$u}}function XE(n,e,t,i){const r=n.Qu(1,e,t);ZE("Data must be an object, but it was:",r,i);const o=[],c=Bn.empty();sc(i,((d,m)=>{const _=eb(e,d,t);m=ye(m);const y=r.Nu(_);if(m instanceof $f)o.push(_);else{const b=oc(m,y);b!=null&&(o.push(_),c.set(_,b))}}));const h=new Ai(o);return new Q2(c,h,r.fieldTransforms)}function JE(n,e,t,i,r,o){const c=n.Qu(1,e,t),h=[tw(e,i,t)],d=[r];if(o.length%2!=0)throw new oe(Z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)h.push(tw(e,o[b])),d.push(o[b+1]);const m=[],_=Bn.empty();for(let b=h.length-1;b>=0;--b)if(!eD(m,h[b])){const I=h[b];let C=d[b];C=ye(C);const M=c.Nu(I);if(C instanceof $f)m.push(I);else{const z=oc(C,M);z!=null&&(m.push(I),_.set(I,z))}}const y=new Ai(m);return new Q2(_,y,c.fieldTransforms)}function X2(n,e,t,i=!1){return oc(t,n.Qu(i?4:3,e))}function oc(n,e){if(Z2(n=ye(n)))return ZE("Unsupported field value:",e,n),J2(n,e);if(n instanceof rc)return(function(i,r){if(!W2(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(i,r){const o=[];let c=0;for(const h of i){let d=oc(h,r.Lu(c));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),c++}return{arrayValue:{values:o}}})(n,e)}return(function(i,r){if((i=ye(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return xN(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=jt.fromDate(i);return{timestampValue:Du(r.serializer,o)}}if(i instanceof jt){const o=new jt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Du(r.serializer,o)}}if(i instanceof f_)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Er)return{bytesValue:UN(r.serializer,i._byteString)};if(i instanceof Ft){const o=r.databaseId,c=i.firestore._databaseId;if(!c.isEqual(o))throw r.Bu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:vE(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof KE)return(function(c,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map((d=>{if(typeof d!="number")throw h.Bu("VectorValues must only contain numeric values.");return fE(h.serializer,d)}))}}}}}})(i,r);throw r.Bu(`Unsupported field value: ${h_(i)}`)})(n,e)}function J2(n,e){const t={};return oN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):sc(n,((i,r)=>{const o=oc(r,e.Mu(i));o!=null&&(t[i]=o)})),{mapValue:{fields:t}}}function Z2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof jt||n instanceof f_||n instanceof Er||n instanceof Ft||n instanceof rc||n instanceof KE)}function ZE(n,e,t){if(!Z2(t)||!(function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)})(t)){const i=h_(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function tw(n,e,t){if((e=ye(e))instanceof Do)return e._internalPath;if(typeof e=="string")return eb(n,e);throw yg("Field path arguments must be of type string or ",n,!1,void 0,t)}const dB=new RegExp("[~\\*/\\[\\]]");function eb(n,e,t){if(e.search(dB)>=0)throw yg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Do(...e.split("."))._internalPath}catch{throw yg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function yg(n,e,t,i,r){const o=i&&!i.isEmpty(),c=r!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(o||c)&&(d+=" (found",o&&(d+=` in field ${i}`),c&&(d+=` in document ${r}`),d+=")"),new oe(Z.INVALID_ARGUMENT,h+n+d)}function eD(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(g_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class fB extends pf{data(){return super.data()}}function g_(n,e){return typeof e=="string"?eb(n,e):e instanceof Do?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new oe(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tb{}let Qf=class extends tb{};function rr(n,e,...t){let i=[];e instanceof tb&&i.push(e),i=i.concat(t),(function(o){const c=o.filter((d=>d instanceof nb)).length,h=o.filter((d=>d instanceof __)).length;if(c>1||c>0&&h>0)throw new oe(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class __ extends Qf{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new __(e,t,i)}_apply(e){const t=this._parse(e);return cD(e._query,t),new hi(e.firestore,e.converter,z0(e._query,t))}_parse(e){const t=ac(e.firestore);return(function(o,c,h,d,m,_,y){let b;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new oe(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){aC(y,_);const I=[];for(const C of y)I.push(rC(d,o,C));b={arrayValue:{values:I}}}else b=rC(d,o,y)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||aC(y,_),b=X2(h,c,y,_==="in"||_==="not-in");return Xe.create(m,_,b)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function nD(n,e,t){const i=e,r=g_("where",n);return __._create(r,i,t)}class nb extends tb{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nb(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:_t.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,o){let c=r;const h=o.getFlattenedFilters();for(const d of h)cD(c,d),c=z0(c,d)})(e._query,t),new hi(e.firestore,e.converter,z0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ib extends Qf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ib(e,t)}_apply(e){const t=(function(r,o,c){if(r.startAt!==null)throw new oe(Z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new oe(Z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new uf(o,c)})(e._query,this._field,this._direction);return new hi(e.firestore,e.converter,(function(r,o){const c=r.explicitOrderBy.concat([o]);return new ma(r.path,r.collectionGroup,c,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)})(e._query,t))}}function mB(n,e="asc"){const t=e,i=g_("orderBy",n);return ib._create(i,t)}class y_ extends Qf{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new y_(e,t,i)}_apply(e){return new hi(e.firestore,e.converter,ug(e._query,this._limit,this._limitType))}}function iD(n){return U2("limit",n),y_._create("limit",n,"F")}function pB(n){return U2("limitToLast",n),y_._create("limitToLast",n,"L")}let sD=class rD extends Qf{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new rD(e,t,i)}_apply(e){const t=lD(e,this.type,this._docOrFields,this._inclusive);return new hi(e.firestore,e.converter,(function(r,o){return new ma(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,o,r.endAt)})(e._query,t))}};function gB(...n){return sD._create("startAt",n,!0)}function _B(...n){return sD._create("startAfter",n,!1)}let aD=class oD extends Qf{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new oD(e,t,i)}_apply(e){const t=lD(e,this.type,this._docOrFields,this._inclusive);return new hi(e.firestore,e.converter,(function(r,o){return new ma(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,o)})(e._query,t))}};function yB(...n){return aD._create("endBefore",n,!1)}function vB(...n){return aD._create("endAt",n,!0)}function lD(n,e,t,i){if(t[0]=ye(t[0]),t[0]instanceof pf)return(function(o,c,h,d,m){if(!d)throw new oe(Z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const _=[];for(const y of pu(o))if(y.field.isKeyField())_.push(ql(c,d.key));else{const b=d.data.field(y.field);if(e_(b))throw new oe(Z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(b===null){const I=y.field.canonicalString();throw new oe(Z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${I}' (used as the orderBy) does not exist.`)}_.push(b)}return new Ro(_,m)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=ac(n.firestore);return(function(c,h,d,m,_,y){const b=c.explicitOrderBy;if(_.length>b.length)throw new oe(Z.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const I=[];for(let C=0;C<_.length;C++){const M=_[C];if(b[C].field.isKeyField()){if(typeof M!="string")throw new oe(Z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof M}`);if(!hE(c)&&M.indexOf("/")!==-1)throw new oe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${M}' contains a slash.`);const z=c.path.child(Ye.fromString(M));if(!pe.isDocumentKey(z))throw new oe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${z}' is not because it contains an odd number of segments.`);const B=new pe(z);I.push(ql(h,B))}else{const z=X2(d,m,M);I.push(z)}}return new Ro(I,y)})(n._query,n.firestore._databaseId,r,e,t,i)}}function rC(n,e,t){if(typeof(t=ye(t))=="string"){if(t==="")throw new oe(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hE(e)&&t.indexOf("/")!==-1)throw new oe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Ye.fromString(t));if(!pe.isDocumentKey(i))throw new oe(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return ql(n,new pe(i))}if(t instanceof Ft)return ql(n,t._key);throw new oe(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${h_(t)}.`)}function aC(n,e){if(!Array.isArray(n)||n.length===0)throw new oe(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cD(n,e){const t=(function(r,o){for(const c of r)for(const h of c.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new oe(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class sb{convertValue(e,t="none"){switch(zl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ao(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ve()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return sc(e,((r,o)=>{i[r]=this.convertValue(o,t)})),i}convertVectorValue(e){var t,i,r;const o=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map((c=>Pt(c.doubleValue)));return new KE(o)}convertGeoPoint(e){return new f_(Pt(e.latitude),Pt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=cE(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(of(e));default:return null}}convertTimestamp(e){const t=la(e);return new jt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ye.fromString(e);Ee(YN(i));const r=new xo(i.get(1),i.get(3)),o=new pe(i.popFirst(5));return r.isEqual(t)||sn(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class wB extends sb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Er(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let ca=class extends pf{constructor(e,t,i,r,o,c){super(e,t,i,r,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ld(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(g_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Ld=class extends ca{data(e={}){return super.data(e)}},ko=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Dl(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ld(this._firestore,this._userDataWriter,i.key,i,new Dl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new oe(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let c=0;return r._snapshot.docChanges.map((h=>{const d=new Ld(r._firestore,r._userDataWriter,h.doc.key,h.doc,new Dl(r._snapshot.mutatedKeys.has(h.doc.key),r._snapshot.fromCache),r.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:c++}}))}{let c=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const d=new Ld(r._firestore,r._userDataWriter,h.doc.key,h.doc,new Dl(r._snapshot.mutatedKeys.has(h.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,_=-1;return h.type!==0&&(m=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),_=c.indexOf(h.doc.key)),{type:EB(h.type),doc:d,oldIndex:m,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function EB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve()}}function uD(n,e){return n instanceof ca&&e instanceof ca?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ko&&e instanceof ko&&n._firestore===e._firestore&&H2(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(n){n=at(n,Ft);const e=at(n.firestore,Xt);return M2(qn(e),n._key).then((t=>rb(e,n,t)))}class lc extends sb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Er(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,t)}}function bB(n){n=at(n,Ft);const e=at(n.firestore,Xt),t=qn(e),i=new lc(e);return KF(t,n._key).then((r=>new ca(e,i,n._key,r,new Dl(r!==null&&r.hasLocalMutations,!0),n.converter)))}function TB(n){n=at(n,Ft);const e=at(n.firestore,Xt);return M2(qn(e),n._key,{source:"server"}).then((t=>rb(e,n,t)))}function hD(n){n=at(n,hi);const e=at(n.firestore,Xt),t=qn(e),i=new lc(e);return tD(n._query),V2(t,n._query).then((r=>new ko(e,i,n,r)))}function IB(n){n=at(n,hi);const e=at(n.firestore,Xt),t=qn(e),i=new lc(e);return $F(t,n._query).then((r=>new ko(e,i,n,r)))}function SB(n){n=at(n,hi);const e=at(n.firestore,Xt),t=qn(e),i=new lc(e);return V2(t,n._query,{source:"server"}).then((r=>new ko(e,i,n,r)))}function Oo(n,e,t){n=at(n,Ft);const i=at(n.firestore,Xt),r=v_(n.converter,e,t);return oh(i,[p_(ac(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Vt.none())])}function Is(n,e,t,...i){n=at(n,Ft);const r=at(n.firestore,Xt),o=ac(r);let c;return c=typeof(e=ye(e))=="string"||e instanceof Do?JE(o,"updateDoc",n._key,e,t,i):XE(o,"updateDoc",n._key,e),oh(r,[c.toMutation(n._key,Vt.exists(!0))])}function w_(n){return oh(at(n.firestore,Xt),[new th(n._key,Vt.none())])}function AB(n,e){const t=at(n.firestore,Xt),i=rt(n),r=v_(n.converter,e);return oh(t,[p_(ac(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Vt.exists(!1))]).then((()=>i))}function ah(n,...e){var t,i,r;n=ye(n);let o={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||ew(e[c])||(o=e[c],c++);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(ew(e[c])){const y=e[c];e[c]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[c+1]=(i=y.error)===null||i===void 0?void 0:i.bind(y),e[c+2]=(r=y.complete)===null||r===void 0?void 0:r.bind(y)}let d,m,_;if(n instanceof Ft)m=at(n.firestore,Xt),_=Zu(n._key.path),d={next:y=>{e[c]&&e[c](rb(m,n,y))},error:e[c+1],complete:e[c+2]};else{const y=at(n,hi);m=at(y.firestore,Xt),_=y._query;const b=new lc(m);d={next:I=>{e[c]&&e[c](new ko(m,b,y,I))},error:e[c+1],complete:e[c+2]},tD(n._query)}return(function(b,I,C,M){const z=new c_(M),B=new VE(I,z,C);return b.asyncQueue.enqueueAndForget((async()=>OE(await Lu(b),B))),()=>{z.Za(),b.asyncQueue.enqueueAndForget((async()=>PE(await Lu(b),B)))}})(qn(m),_,h,d)}function xB(n,e){return QF(qn(n=at(n,Xt)),ew(e)?e:{next:e})}function oh(n,e){return(function(i,r){const o=new zn;return i.asyncQueue.enqueueAndForget((async()=>bF(await GE(i),r,o))),o.promise})(qn(n),e)}function rb(n,e,t){const i=t.docs.get(e._key),r=new lc(n);return new ca(n,r,e._key,i,new Dl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CB={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dD=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ac(e)}set(e,t,i){this._verifyNotCommitted();const r=oo(e,this._firestore),o=v_(r.converter,t,i),c=p_(this._dataReader,"WriteBatch.set",r._key,o,r.converter!==null,i);return this._mutations.push(c.toMutation(r._key,Vt.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const o=oo(e,this._firestore);let c;return c=typeof(t=ye(t))=="string"||t instanceof Do?JE(this._dataReader,"WriteBatch.update",o._key,t,i,r):XE(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(c.toMutation(o._key,Vt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=oo(e,this._firestore);return this._mutations=this._mutations.concat(new th(t._key,Vt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new oe(Z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function oo(n,e){if((n=ye(n)).firestore!==e)throw new oe(Z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RB=class extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=ac(t)}get(t){const i=oo(t,this._firestore),r=new wB(this._firestore);return this._transaction.lookup([i._key]).then((o=>{if(!o||o.length!==1)return ve();const c=o[0];if(c.isFoundDocument())return new pf(this._firestore,r,c.key,c,i.converter);if(c.isNoDocument())return new pf(this._firestore,r,i._key,null,i.converter);throw ve()}))}set(t,i,r){const o=oo(t,this._firestore),c=v_(o.converter,i,r),h=p_(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,r);return this._transaction.set(o._key,h),this}update(t,i,r,...o){const c=oo(t,this._firestore);let h;return h=typeof(i=ye(i))=="string"||i instanceof Do?JE(this._dataReader,"Transaction.update",c._key,i,r,o):XE(this._dataReader,"Transaction.update",c._key,i),this._transaction.update(c._key,h),this}delete(t){const i=oo(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=oo(e,this._firestore),i=new lc(this._firestore);return super.get(e).then((r=>new ca(this._firestore,i,t._key,r._document,new Dl(!1,!1),t.converter)))}};function NB(n,e,t){n=at(n,Xt);const i=Object.assign(Object.assign({},CB),t);return(function(o){if(o.maxAttempts<1)throw new oe(Z.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i),(function(o,c,h){const d=new zn;return o.asyncQueue.enqueueAndForget((async()=>{const m=await qF(o);new BF(o.asyncQueue,m,h,c,d).au()})),d.promise})(qn(n),(r=>e(new RB(n,r))),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DB(){return new $f("deleteField")}function fD(){return new $E("serverTimestamp")}function kB(...n){return new QE("arrayUnion",n)}function OB(...n){return new WE("arrayRemove",n)}function PB(n){return new YE("increment",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(n){return qn(n=at(n,Xt)),new dD(n,(e=>oh(n,e)))}(function(e,t=!0){(function(r){Ju=r})(ha),aa(new Ni("firestore",((i,{instanceIdentifier:r,options:o})=>{const c=i.getProvider("app").getImmediate(),h=new Xt(new K3(i.getProvider("auth-internal")),new Y3(i.getProvider("app-check-internal")),(function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new oe(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xo(m.options.projectId,_)})(c,r),c);return o=Object.assign({useFetchStreams:t},o),h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),Zi(XA,"4.7.3",e),Zi(XA,"4.7.3","esm2017")})();const MB="@firebase/firestore-compat",VB="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new oe("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(){if(typeof Uint8Array>"u")throw new oe("unimplemented","Uint8Arrays are not available in this environment.")}function lC(){if(!bU())throw new oe("unimplemented","Blobs are unavailable in Firestore in this environment.")}class gf{constructor(e){this._delegate=e}static fromBase64String(e){return lC(),new gf(Er.fromBase64String(e))}static fromUint8Array(e){return oC(),new gf(Er.fromUint8Array(e))}toBase64(){return lC(),this._delegate.toBase64()}toUint8Array(){return oC(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(n){return LB(n,["next","error","complete"])}function LB(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jB{enableIndexedDbPersistence(e,t){return tB(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return nB(e._delegate)}clearIndexedDbPersistence(e){return iB(e._delegate)}}class pD{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof xo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&vr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){F2(this._delegate,e,t,i)}enableNetwork(){return rB(this._delegate)}disableNetwork(){return aB(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,j2("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return sB(this._delegate)}onSnapshotsInSync(e){return xB(this._delegate,e)}get app(){if(!this._appCompat)throw new oe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ju(this,d_(this._delegate,e))}catch(t){throw ri(t,"collection()","Firestore.collection()")}}doc(e){try{return new ys(this,rt(this._delegate,e))}catch(t){throw ri(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new vf(this,XF(this._delegate,e))}catch(t){throw ri(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return NB(this._delegate,t=>e(new gD(this,t)))}batch(){return qn(this._delegate),new _D(new dD(this._delegate,e=>oh(this._delegate,e)))}loadBundle(e){return oB(this._delegate,e)}namedQuery(e){return lB(this._delegate,e).then(t=>t?new vf(this,t):null)}}class E_ extends sb{constructor(e){super(),this.firestore=e}convertBytes(e){return new gf(new Er(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return ys.forKey(t,this.firestore,null)}}function UB(n){z3(n)}class gD{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new E_(e)}get(e){const t=kl(e);return this._delegate.get(t).then(i=>new _f(this._firestore,new ca(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=kl(e);return i?(ab("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const o=kl(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...r),this}delete(e){const t=kl(e);return this._delegate.delete(t),this}}class _D{constructor(e){this._delegate=e}set(e,t,i){const r=kl(e);return i?(ab("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const o=kl(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...r),this}delete(e){const t=kl(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Yl{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new Ld(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new yf(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Yl.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let o=r.get(t);return o||(o=new Yl(e,new E_(e),t),r.set(t,o)),o}}Yl.INSTANCES=new WeakMap;class ys{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new E_(e)}static forPath(e,t,i){if(e.length%2!==0)throw new oe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ys(t,new Ft(t._delegate,i,new pe(e)))}static forKey(e,t,i){return new ys(t,new Ft(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new ju(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ju(this.firestore,d_(this._delegate,e))}catch(t){throw ri(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ye(e),e instanceof Ft?G2(this._delegate,e):!1}set(e,t){t=ab("DocumentReference.set",t);try{return t?Oo(this._delegate,e,t):Oo(this._delegate,e)}catch(i){throw ri(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?Is(this._delegate,e):Is(this._delegate,e,t,...i)}catch(r){throw ri(r,"updateDoc()","DocumentReference.update()")}}delete(){return w_(this._delegate)}onSnapshot(...e){const t=yD(e),i=vD(e,r=>new _f(this.firestore,new ca(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return ah(this._delegate,t,i)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=bB(this._delegate):(e==null?void 0:e.source)==="server"?t=TB(this._delegate):t=_a(this._delegate),t.then(i=>new _f(this.firestore,new ca(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new ys(this.firestore,e?this._delegate.withConverter(Yl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ri(n,e,t){return n.message=n.message.replace(e,t),n}function yD(n){for(const e of n)if(typeof e=="object"&&!nw(e))return e;return{}}function vD(n,e){var t,i;let r;return nw(n[0])?r=n[0]:nw(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:o=>{r.next&&r.next(e(o))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}class _f{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ys(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return uD(this._delegate,e._delegate)}}class yf extends _f{data(e){const t=this._delegate.data(e);return this._delegate._converter||q3(t!==void 0),t}}let vf=class sr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new E_(e)}where(e,t,i){try{return new sr(this.firestore,rr(this._delegate,nD(e,t,i)))}catch(r){throw ri(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new sr(this.firestore,rr(this._delegate,mB(e,t)))}catch(i){throw ri(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new sr(this.firestore,rr(this._delegate,iD(e)))}catch(t){throw ri(t,"limit()","Query.limit()")}}limitToLast(e){try{return new sr(this.firestore,rr(this._delegate,pB(e)))}catch(t){throw ri(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new sr(this.firestore,rr(this._delegate,gB(...e)))}catch(t){throw ri(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new sr(this.firestore,rr(this._delegate,_B(...e)))}catch(t){throw ri(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new sr(this.firestore,rr(this._delegate,yB(...e)))}catch(t){throw ri(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new sr(this.firestore,rr(this._delegate,vB(...e)))}catch(t){throw ri(t,"endAt()","Query.endAt()")}}isEqual(e){return H2(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=IB(this._delegate):(e==null?void 0:e.source)==="server"?t=SB(this._delegate):t=hD(this._delegate),t.then(i=>new iw(this.firestore,new ko(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=yD(e),i=vD(e,r=>new iw(this.firestore,new ko(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return ah(this._delegate,t,i)}withConverter(e){return new sr(this.firestore,e?this._delegate.withConverter(Yl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};class FB{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new yf(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class iw{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new vf(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new yf(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new FB(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new yf(this._firestore,i))})}isEqual(e){return uD(this._delegate,e._delegate)}}class ju extends vf{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ys(this.firestore,e):null}doc(e){try{return e===void 0?new ys(this.firestore,rt(this._delegate)):new ys(this.firestore,rt(this._delegate,e))}catch(t){throw ri(t,"doc()","CollectionReference.doc()")}}add(e){return AB(this._delegate,e).then(t=>new ys(this.firestore,t))}isEqual(e){return G2(this._delegate,e._delegate)}withConverter(e){return new ju(this.firestore,e?this._delegate.withConverter(Yl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function kl(n){return at(n,Ft)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(...e){this._delegate=new Do(...e)}static documentId(){return new ob(Mt.keyField().canonicalString())}isEqual(e){return e=ye(e),e instanceof Do?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e){this._delegate=e}static serverTimestamp(){const e=fD();return e._methodName="FieldValue.serverTimestamp",new Rl(e)}static delete(){const e=DB();return e._methodName="FieldValue.delete",new Rl(e)}static arrayUnion(...e){const t=kB(...e);return t._methodName="FieldValue.arrayUnion",new Rl(t)}static arrayRemove(...e){const t=OB(...e);return t._methodName="FieldValue.arrayRemove",new Rl(t)}static increment(e){const t=PB(e);return t._methodName="FieldValue.increment",new Rl(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BB={Firestore:pD,GeoPoint:f_,Timestamp:jt,Blob:gf,Transaction:gD,WriteBatch:_D,DocumentReference:ys,DocumentSnapshot:_f,Query:vf,QueryDocumentSnapshot:yf,QuerySnapshot:iw,CollectionReference:ju,FieldPath:ob,FieldValue:Rl,setLogLevel:UB,CACHE_SIZE_UNLIMITED:ZF};function zB(n,e){n.INTERNAL.registerComponent(new Ni("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},BB)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(n){zB(n,(e,t)=>new pD(e,t,new jB)),n.registerVersion(MB,VB)}qB(nc);var cC={};const uC="@firebase/database",hC="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wD="";function ED(n){wD=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GB{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),vn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Yd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return es(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new GB(e)}}catch{}return new HB},Ol=bD("localStorage"),sw=bD("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _u=new $u("@firebase/database"),TD=(function(){let n=1;return function(){return n++}})(),ID=function(n){const e=yV(n),t=new pV;t.update(e);const i=t.digest();return Dw.encodeByteArray(i)},Wf=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Wf.apply(null,i):typeof i=="object"?e+=vn(i):e+=i,e+=" "}return e};let Ll=null,dC=!0;const SD=function(n,e){he(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(_u.logLevel=Ge.VERBOSE,Ll=_u.log.bind(_u),e&&sw.set("logging_enabled",!0)):typeof n=="function"?Ll=n:(Ll=null,sw.remove("logging_enabled"))},Dn=function(...n){if(dC===!0&&(dC=!1,Ll===null&&sw.get("logging_enabled")===!0&&SD(!0)),Ll){const e=Wf.apply(null,n);Ll(e)}},Yf=function(n){return function(...e){Dn(n,...e)}},rw=function(...n){const e="FIREBASE INTERNAL ERROR: "+Wf(...n);_u.error(e)},br=function(...n){const e=`FIREBASE FATAL ERROR: ${Wf(...n)}`;throw _u.error(e),new Error(e)},Wn=function(...n){const e="FIREBASE WARNING: "+Wf(...n);_u.warn(e)},KB=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Wn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},b_=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},$B=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Po="[MIN_NAME]",ua="[MAX_NAME]",cc=function(n,e){if(n===e)return 0;if(n===Po||e===ua)return-1;if(e===Po||n===ua)return 1;{const t=fC(n),i=fC(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},QB=function(n,e){return n===e?0:n<e?-1:1},_d=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+vn(e))},lb=function(n){if(typeof n!="object"||n===null)return vn(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=vn(e[i]),t+=":",t+=lb(n[e[i]]);return t+="}",t},AD=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function Mn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const xD=function(n){he(!b_(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let r,o,c,h,d;n===0?(o=0,c=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=h+i,c=Math.round(n*Math.pow(2,t-h)-Math.pow(2,t))):(o=0,c=Math.round(n/Math.pow(2,1-i-t))));const m=[];for(d=t;d;d-=1)m.push(c%2?1:0),c=Math.floor(c/2);for(d=e;d;d-=1)m.push(o%2?1:0),o=Math.floor(o/2);m.push(r?1:0),m.reverse();const _=m.join("");let y="";for(d=0;d<64;d+=8){let b=parseInt(_.substr(d,8),2).toString(16);b.length===1&&(b="0"+b),y=y+b}return y.toLowerCase()},WB=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},YB=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function XB(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const JB=new RegExp("^-?(0*)\\d{1,10}$"),ZB=-2147483648,ez=2147483647,fC=function(n){if(JB.test(n)){const e=Number(n);if(e>=ZB&&e<=ez)return e}return null},lh=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Wn("Exception was thrown by user callback.",t),e},Math.floor(0))}},tz=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},jd=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Wn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iz{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Dn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Wn(e)}}class yu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}yu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="5",CD="v",RD="s",ND="r",DD="f",kD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,OD="ls",PD="p",aw="ac",MD="websocket",VD="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,t,i,r,o=!1,c="",h=!1,d=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=o,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ol.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ol.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function sz(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function jD(n,e,t){he(typeof e=="string","typeof type must == string"),he(typeof t=="object","typeof params must == object");let i;if(e===MD)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===VD)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);sz(n)&&(t.ns=n.namespace);const r=[];return Mn(t,(o,c)=>{r.push(o+"="+c)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rz{constructor(){this.counters_={}}incrementCounter(e,t=1){es(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return tV(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0={},u0={};function ub(n){const e=n.toString();return c0[e]||(c0[e]=new rz),c0[e]}function az(n,e){const t=n.toString();return u0[t]||(u0[t]=e()),u0[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oz{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&lh(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mC="start",lz="close",cz="pLPCommand",uz="pRTLPCB",UD="id",FD="pw",BD="ser",hz="cb",dz="seg",fz="ts",mz="d",pz="dframe",zD=1870,qD=30,gz=zD-qD,_z=25e3,yz=3e4;class uo{constructor(e,t,i,r,o,c,h){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=o,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Yf(e),this.stats_=ub(t),this.urlFn=d=>(this.appCheckToken&&(d[aw]=this.appCheckToken),jD(t,VD,d))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new oz(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(yz)),$B(()=>{if(this.isClosed_)return;this.scriptTagHolder=new hb((...o)=>{const[c,h,d,m,_]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===mC)this.id=h,this.password=d;else if(c===lz)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...o)=>{const[c,h]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const i={};i[mC]="t",i[BD]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[hz]=this.scriptTagHolder.uniqueCallbackIdentifier),i[CD]=cb,this.transportSessionId&&(i[RD]=this.transportSessionId),this.lastSessionId&&(i[OD]=this.lastSessionId),this.applicationId&&(i[PD]=this.applicationId),this.appCheckToken&&(i[aw]=this.appCheckToken),typeof location<"u"&&location.hostname&&kD.test(location.hostname)&&(i[ND]=DD);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){uo.forceAllow_=!0}static forceDisallow(){uo.forceDisallow_=!0}static isAvailable(){return uo.forceAllow_?!0:!uo.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!WB()&&!YB()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=vn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=g1(t),r=AD(i,gz);for(let o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[pz]="t",i[UD]=e,i[FD]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=vn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class hb{constructor(e,t,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=TD(),window[cz+this.uniqueCallbackIdentifier]=e,window[uz+this.uniqueCallbackIdentifier]=t,this.myIFrame=hb.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){Dn("frame writing exception"),h.stack&&Dn(h.stack),Dn(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Dn("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[UD]=this.myID,e[FD]=this.myPW,e[BD]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+qD+i.length<=zD;){const c=this.pendingSegs.shift();i=i+"&"+dz+r+"="+c.seg+"&"+fz+r+"="+c.ts+"&"+mz+r+"="+c.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(_z)),o=()=>{clearTimeout(r),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Dn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz=16384,wz=45e3;let vg=null;typeof MozWebSocket<"u"?vg=MozWebSocket:typeof WebSocket<"u"&&(vg=WebSocket);class _s{constructor(e,t,i,r,o,c,h){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Yf(this.connId),this.stats_=ub(t),this.connURL=_s.connectionURL_(t,c,h,r,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,r,o){const c={};return c[CD]=cb,typeof location<"u"&&location.hostname&&kD.test(location.hostname)&&(c[ND]=DD),t&&(c[RD]=t),i&&(c[OD]=i),r&&(c[aw]=r),o&&(c[PD]=o),jD(e,MD,c)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ol.set("previous_websocket_failure",!0);try{let i;lV(),this.mySock=new vg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){_s.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&vg!==null&&!_s.forceDisallow_}static previouslyFailed(){return Ol.isInMemoryStorage||Ol.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ol.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=Yd(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(he(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=vn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=AD(t,vz);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(wz))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}_s.responsesRequiredToBeHealthy=2;_s.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[uo,_s]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=_s&&_s.isAvailable();let i=t&&!_s.previouslyFailed();if(e.webSocketOnly&&(t||Wn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[_s];else{const r=this.transports_=[];for(const o of Uu.ALL_TRANSPORTS)o&&o.isAvailable()&&r.push(o);Uu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Uu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ez=6e4,bz=5e3,Tz=10*1024,Iz=100*1024,h0="t",pC="d",Sz="s",gC="r",Az="e",_C="o",yC="a",vC="n",wC="p",xz="h";class Cz{constructor(e,t,i,r,o,c,h,d,m,_){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=o,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=d,this.onKill_=m,this.lastSessionId=_,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Yf("c:"+this.id+":"),this.transportManager_=new Uu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=jd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Iz?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Tz?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(h0 in e){const t=e[h0];t===yC?this.upgradeIfSecondaryHealthy_():t===gC?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===_C&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=_d("t",e),i=_d("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:wC,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:yC,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:vC,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=_d("t",e),i=_d("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=_d(h0,e);if(pC in e){const i=e[pC];if(t===xz){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===vC){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Sz?this.onConnectionShutdown_(i):t===gC?this.onReset_(i):t===Az?rw("Server Error: "+i):t===_C?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rw("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),cb!==i&&Wn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),jd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Ez))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):jd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(bz))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:wC,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ol.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e){this.allowedEvents_=e,this.listeners_={},he(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let o=0;o<r.length;o++)if(r[o].callback===t&&(!i||i===r[o].context)){r.splice(o,1);return}}validateEventType_(e){he(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg extends HD{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!kw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new wg}getInitialEvent(e){return he(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC=32,bC=768;class mt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function ut(){return new mt("")}function ze(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Mo(n){return n.pieces_.length-n.pieceNum_}function It(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new mt(n.pieces_,e)}function db(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Rz(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function wf(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function KD(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new mt(e,0)}function Lt(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof mt)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new mt(t,0)}function qe(n){return n.pieceNum_>=n.pieces_.length}function ai(n,e){const t=ze(n),i=ze(e);if(t===null)return e;if(t===i)return ai(It(n),It(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Nz(n,e){const t=wf(n,0),i=wf(e,0);for(let r=0;r<t.length&&r<i.length;r++){const o=cc(t[r],i[r]);if(o!==0)return o}return t.length===i.length?0:t.length<i.length?-1:1}function fb(n,e){if(Mo(n)!==Mo(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function vs(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Mo(n)>Mo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class Dz{constructor(e,t){this.errorPrefix_=t,this.parts_=wf(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=jg(this.parts_[i]);$D(this)}}function kz(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=jg(e),$D(n)}function Oz(n){const e=n.parts_.pop();n.byteLength_-=jg(e),n.parts_.length>0&&(n.byteLength_-=1)}function $D(n){if(n.byteLength_>bC)throw new Error(n.errorPrefix_+"has a key path longer than "+bC+" bytes ("+n.byteLength_+").");if(n.parts_.length>EC)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+EC+") or object contains a cycle "+Il(n))}function Il(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb extends HD{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new mb}getInitialEvent(e){return he(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd=1e3,Pz=300*1e3,TC=30*1e3,Mz=1.3,Vz=3e4,Lz="server_kill",IC=3;class sa extends GD{constructor(e,t,i,r,o,c,h,d){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=h,this.authOverride_=d,this.id=sa.nextPersistentConnectionId_++,this.log_=Yf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=yd,this.maxReconnectDelay_=Pz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");mb.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&wg.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const r=++this.requestNumber_,o={r,a:e,b:t};this.log_(vn(o)),he(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[r]=i)}get(e){this.initConnection_();const t=new Ii,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const h=c.d;c.s==="ok"?t.resolve(h):t.reject(h)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,r){this.initConnection_();const o=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),he(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),he(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");const h={onComplete:r,hashFn:t,query:e,tag:i};this.listens.get(c).set(o,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+i+" for "+r);const o={p:i},c="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(c,o,h=>{const d=h.d,m=h.s;sa.warnOnListenWarnings_(d,t),(this.listens.get(i)&&this.listens.get(i).get(r))===e&&(this.log_("listen response",h),m!=="ok"&&this.removeListen_(i,r),e.onComplete&&e.onComplete(m,d))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&es(e,"w")){const i=Ul(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Wn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||mV(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=TC)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=fV(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,r=>{const o=r.s,c=r.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),he(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,e._queryObject,t)}sendUnlisten_(e,t,i,r){this.log_("Unlisten on "+e+" for "+t);const o={p:e},c="n";r&&(o.q=i,o.t=r),this.sendRequest(c,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,r){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,c=>{r&&setTimeout(()=>{r(c.s,c.d)},Math.floor(0))})}put(e,t,i,r){this.putInternal("p",e,t,i,r)}merge(e,t,i,r){this.putInternal("m",e,t,i,r)}putInternal(e,t,i,r,o){this.initConnection_();const c={p:t,d:i};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:e,request:c,onComplete:r}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+vn(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):rw("Unrecognized action received from server: "+vn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){he(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yd,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=yd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Vz&&(this.reconnectDelay_=yd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Mz)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+sa.nextConnectionId_++,o=this.lastSessionId;let c=!1,h=null;const d=function(){h?h.close():(c=!0,i())},m=function(y){he(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(y)};this.realtime_={close:d,sendRequest:m};const _=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[y,b]=await Promise.all([this.authTokenProvider_.getToken(_),this.appCheckTokenProvider_.getToken(_)]);c?Dn("getToken() completed but was canceled"):(Dn("getToken() completed. Creating connection."),this.authToken_=y&&y.accessToken,this.appCheckToken_=b&&b.token,h=new Cz(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,I=>{Wn(I+" ("+this.repoInfo_.toString()+")"),this.interrupt(Lz)},o))}catch(y){this.log_("Failed to get token: "+y),c||(this.repoInfo_.nodeAdmin&&Wn(y),d())}}}interrupt(e){Dn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Dn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Zp(this.interruptReasons_)&&(this.reconnectDelay_=yd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>lb(o)).join("$"):i="default";const r=this.removeListen_(e,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const i=new mt(e).toString();let r;if(this.listens.has(i)){const o=this.listens.get(i);r=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(e,t){Dn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=IC&&(this.reconnectDelay_=TC,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Dn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=IC&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+wD.replace(/\./g,"-")]=1,kw()?e["framework.cordova"]=1:Lg()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=wg.getInstance().currentlyOnline();return Zp(this.interruptReasons_)&&e}}sa.nextPersistentConnectionId_=0;sa.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new He(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new He(Po,e),r=new He(Po,t);return this.compare(i,r)!==0}minPost(){return He.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vp;class QD extends T_{static get __EMPTY_NODE(){return Vp}static set __EMPTY_NODE(e){Vp=e}compare(e,t){return cc(e.name,t.name)}isDefinedOn(e){throw Ku("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return He.MIN}maxPost(){return new He(ua,Vp)}makePost(e,t){return he(typeof e=="string","KeyIndex indexValue must always be a string."),new He(e,Vp)}toString(){return".key"}}const gr=new QD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,t,i,r,o=null){this.isReverse_=r,this.resultGenerator_=o,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?i(e.key,t):1,r&&(c*=-1),c<0)this.isReverse_?e=e.left:e=e.right;else if(c===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Nn{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??Nn.RED,this.left=r??Ci.EMPTY_NODE,this.right=o??Ci.EMPTY_NODE}copy(e,t,i,r,o){return new Nn(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const o=i(e,r.key);return o<0?r=r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r=r.copy(null,t,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ci.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,r;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return Ci.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Nn.RED=!0;Nn.BLACK=!1;class jz{copy(e,t,i,r,o){return this}insert(e,t,i){return new Nn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ci{constructor(e,t=Ci.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Ci(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Nn.BLACK,null,null))}remove(e){return new Ci(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Nn.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Lp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Lp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Lp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Lp(this.root_,null,this.comparator_,!0,e)}}Ci.EMPTY_NODE=new jz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(n,e){return cc(n.name,e.name)}function pb(n,e){return cc(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ow;function Fz(n){ow=n}const WD=function(n){return typeof n=="number"?"number:"+xD(n):"string:"+n},YD=function(n){if(n.isLeafNode()){const e=n.val();he(typeof e=="string"||typeof e=="number"||typeof e=="object"&&es(e,".sv"),"Priority must be a string or number.")}else he(n===ow||n.isEmpty(),"priority of unexpected type.");he(n===ow||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SC;class An{constructor(e,t=An.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,he(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),YD(this.priorityNode_)}static set __childrenNodeConstructor(e){SC=e}static get __childrenNodeConstructor(){return SC}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new An(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:An.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return qe(e)?this:ze(e)===".priority"?this.priorityNode_:An.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:An.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=ze(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(he(i!==".priority"||Mo(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,An.__childrenNodeConstructor.EMPTY_NODE.updateChild(It(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+WD(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=xD(this.value_):e+=this.value_,this.lazyHash_=ID(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===An.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof An.__childrenNodeConstructor?-1:(he(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,r=An.VALUE_TYPE_ORDER.indexOf(t),o=An.VALUE_TYPE_ORDER.indexOf(i);return he(r>=0,"Unknown leaf type: "+t),he(o>=0,"Unknown leaf type: "+i),r===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}An.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let XD,JD;function Bz(n){XD=n}function zz(n){JD=n}class qz extends T_{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),o=i.compareTo(r);return o===0?cc(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return He.MIN}maxPost(){return new He(ua,new An("[PRIORITY-POST]",JD))}makePost(e,t){const i=XD(e);return new He(t,new An("[PRIORITY-POST]",i))}toString(){return".priority"}}const At=new qz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz=Math.log(2);class Hz{constructor(e){const t=o=>parseInt(Math.log(o)/Gz,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Eg=function(n,e,t,i){n.sort(e);const r=function(d,m){const _=m-d;let y,b;if(_===0)return null;if(_===1)return y=n[d],b=t?t(y):y,new Nn(b,y.node,Nn.BLACK,null,null);{const I=parseInt(_/2,10)+d,C=r(d,I),M=r(I+1,m);return y=n[I],b=t?t(y):y,new Nn(b,y.node,Nn.BLACK,C,M)}},o=function(d){let m=null,_=null,y=n.length;const b=function(C,M){const z=y-C,B=y;y-=C;const j=r(z+1,B),X=n[z],fe=t?t(X):X;I(new Nn(fe,X.node,M,null,j))},I=function(C){m?(m.left=C,m=C):(_=C,m=C)};for(let C=0;C<d.count;++C){const M=d.nextBitIsOne(),z=Math.pow(2,d.count-(C+1));M?b(z,Nn.BLACK):(b(z,Nn.BLACK),b(z,Nn.RED))}return _},c=new Hz(n.length),h=o(c);return new Ci(i||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d0;const iu={};class na{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return he(iu&&At,"ChildrenNode.ts has not been loaded"),d0=d0||new na({".priority":iu},{".priority":At}),d0}get(e){const t=Ul(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ci?t:null}hasIndex(e){return es(this.indexSet_,e.toString())}addIndex(e,t){he(e!==gr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const o=t.getIterator(He.Wrap);let c=o.getNext();for(;c;)r=r||e.isDefinedOn(c.node),i.push(c),c=o.getNext();let h;r?h=Eg(i,e.getCompare()):h=iu;const d=e.toString(),m=Object.assign({},this.indexSet_);m[d]=e;const _=Object.assign({},this.indexes_);return _[d]=h,new na(_,m)}addToIndexes(e,t){const i=eg(this.indexes_,(r,o)=>{const c=Ul(this.indexSet_,o);if(he(c,"Missing index implementation for "+o),r===iu)if(c.isDefinedOn(e.node)){const h=[],d=t.getIterator(He.Wrap);let m=d.getNext();for(;m;)m.name!==e.name&&h.push(m),m=d.getNext();return h.push(e),Eg(h,c.getCompare())}else return iu;else{const h=t.get(e.name);let d=r;return h&&(d=d.remove(new He(e.name,h))),d.insert(e,e.node)}});return new na(i,this.indexSet_)}removeFromIndexes(e,t){const i=eg(this.indexes_,r=>{if(r===iu)return r;{const o=t.get(e.name);return o?r.remove(new He(e.name,o)):r}});return new na(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vd;class Ce{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&YD(this.priorityNode_),this.children_.isEmpty()&&he(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return vd||(vd=new Ce(new Ci(pb),null,na.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||vd}updatePriority(e){return this.children_.isEmpty()?this:new Ce(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?vd:t}}getChild(e){const t=ze(e);return t===null?this:this.getImmediateChild(t).getChild(It(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(he(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new He(e,t);let r,o;t.isEmpty()?(r=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const c=r.isEmpty()?vd:this.priorityNode_;return new Ce(r,c,o)}}updateChild(e,t){const i=ze(e);if(i===null)return t;{he(ze(e)!==".priority"||Mo(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(It(e),t);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,r=0,o=!0;if(this.forEachChild(At,(c,h)=>{t[c]=h.val(e),i++,o&&Ce.INTEGER_REGEXP_.test(c)?r=Math.max(r,Number(c)):o=!1}),!e&&o&&r<2*i){const c=[];for(const h in t)c[h]=t[h];return c}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+WD(this.getPriority().val())+":"),this.forEachChild(At,(t,i)=>{const r=i.hash();r!==""&&(e+=":"+t+":"+r)}),this.lazyHash_=e===""?"":ID(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const r=this.resolveIndex_(i);if(r){const o=r.getPredecessorKey(new He(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new He(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new He(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(r=>t(r.name,r.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,He.Wrap);let o=r.peek();for(;o!=null&&t.compare(o,e)<0;)r.getNext(),o=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,He.Wrap);let o=r.peek();for(;o!=null&&t.compare(o,e)>0;)r.getNext(),o=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xf?-1:0}withIndex(e){if(e===gr||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ce(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===gr||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(At),r=t.getIterator(At);let o=i.getNext(),c=r.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=i.getNext(),c=r.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(e){return e===gr?null:this.indexMap_.get(e.toString())}}Ce.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Kz extends Ce{constructor(){super(new Ci(pb),Ce.EMPTY_NODE,na.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ce.EMPTY_NODE}isEmpty(){return!1}}const Xf=new Kz;Object.defineProperties(He,{MIN:{value:new He(Po,Ce.EMPTY_NODE)},MAX:{value:new He(ua,Xf)}});QD.__EMPTY_NODE=Ce.EMPTY_NODE;An.__childrenNodeConstructor=Ce;Fz(Xf);zz(Xf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z=!0;function Ut(n,e=null){if(n===null)return Ce.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),he(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new An(t,Ut(e))}if(!(n instanceof Array)&&$z){const t=[];let i=!1;if(Mn(n,(c,h)=>{if(c.substring(0,1)!=="."){const d=Ut(h);d.isEmpty()||(i=i||!d.getPriority().isEmpty(),t.push(new He(c,d)))}}),t.length===0)return Ce.EMPTY_NODE;const o=Eg(t,Uz,c=>c.name,pb);if(i){const c=Eg(t,At.getCompare());return new Ce(o,Ut(e),new na({".priority":c},{".priority":At}))}else return new Ce(o,Ut(e),na.Default)}else{let t=Ce.EMPTY_NODE;return Mn(n,(i,r)=>{if(es(n,i)&&i.substring(0,1)!=="."){const o=Ut(r);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(Ut(e))}}Bz(Ut);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb extends T_{constructor(e){super(),this.indexPath_=e,he(!qe(e)&&ze(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),o=i.compareTo(r);return o===0?cc(e.name,t.name):o}makePost(e,t){const i=Ut(e),r=Ce.EMPTY_NODE.updateChild(this.indexPath_,i);return new He(t,r)}maxPost(){const e=Ce.EMPTY_NODE.updateChild(this.indexPath_,Xf);return new He(ua,e)}toString(){return wf(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz extends T_{compare(e,t){const i=e.node.compareTo(t.node);return i===0?cc(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return He.MIN}maxPost(){return He.MAX}makePost(e,t){const i=Ut(e);return new He(t,i)}toString(){return".value"}}const _b=new Qz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(n){return{type:"value",snapshotNode:n}}function Fu(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Ef(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function bf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Wz(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e){this.index_=e}updateChild(e,t,i,r,o,c){he(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(r).equals(i.getChild(r))&&h.isEmpty()===i.isEmpty()||(c!=null&&(i.isEmpty()?e.hasChild(t)?c.trackChildChange(Ef(t,h)):he(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(Fu(t,i)):c.trackChildChange(bf(t,i,h))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(At,(r,o)=>{t.hasChild(r)||i.trackChildChange(Ef(r,o))}),t.isLeafNode()||t.forEachChild(At,(r,o)=>{if(e.hasChild(r)){const c=e.getImmediateChild(r);c.equals(o)||i.trackChildChange(bf(r,o,c))}else i.trackChildChange(Fu(r,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ce.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this.indexedFilter_=new yb(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Tf.getStartPost_(e),this.endPost_=Tf.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,o,c){return this.matches(new He(t,i))||(i=Ce.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,o,c)}updateFullNode(e,t,i){t.isLeafNode()&&(t=Ce.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(Ce.EMPTY_NODE);const o=this;return t.forEachChild(At,(c,h)=>{o.matches(new He(c,h))||(r=r.updateImmediateChild(c,Ce.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yz{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Tf(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,o,c){return this.rangedFilter_.matches(new He(t,i))||(i=Ce.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,o,c):this.fullLimitUpdateChild_(e,t,i,o,c)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=Ce.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=Ce.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;o.hasNext()&&c<this.limit_;){const h=o.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))r=r.updateImmediateChild(h.name,h.node),c++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(Ce.EMPTY_NODE);let o;this.reverse_?o=r.getReverseIterator(this.index_):o=r.getIterator(this.index_);let c=0;for(;o.hasNext();){const h=o.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:r=r.updateImmediateChild(h.name,Ce.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,o){let c;if(this.reverse_){const y=this.index_.getCompare();c=(b,I)=>y(I,b)}else c=this.index_.getCompare();const h=e;he(h.numChildren()===this.limit_,"");const d=new He(t,i),m=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),_=this.rangedFilter_.matches(d);if(h.hasChild(t)){const y=h.getImmediateChild(t);let b=r.getChildAfterChild(this.index_,m,this.reverse_);for(;b!=null&&(b.name===t||h.hasChild(b.name));)b=r.getChildAfterChild(this.index_,b,this.reverse_);const I=b==null?1:c(b,d);if(_&&!i.isEmpty()&&I>=0)return o!=null&&o.trackChildChange(bf(t,i,y)),h.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(Ef(t,y));const M=h.updateImmediateChild(t,Ce.EMPTY_NODE);return b!=null&&this.rangedFilter_.matches(b)?(o!=null&&o.trackChildChange(Fu(b.name,b.node)),M.updateImmediateChild(b.name,b.node)):M}}else return i.isEmpty()?e:_&&c(m,d)>=0?(o!=null&&(o.trackChildChange(Ef(m.name,m.node)),o.trackChildChange(Fu(t,i))),h.updateImmediateChild(t,i).updateImmediateChild(m.name,Ce.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=At}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return he(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return he(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Po}hasEnd(){return this.endSet_}getIndexEndValue(){return he(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return he(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ua}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return he(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===At}copy(){const e=new I_;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Xz(n){return n.loadsAllData()?new yb(n.getIndex()):n.hasLimit()?new Yz(n):new Tf(n)}function Jz(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function Zz(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function lw(n,e,t){const i=n.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,t!=null?(i.startNameSet_=!0,i.indexStartName_=t):(i.startNameSet_=!1,i.indexStartName_=""),i}function e9(n,e,t){let i;return n.index_===gr||t?i=lw(n,e,t):i=lw(n,e,ua),i.startAfterSet_=!0,i}function cw(n,e,t){const i=n.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,t!==void 0?(i.endNameSet_=!0,i.indexEndName_=t):(i.endNameSet_=!1,i.indexEndName_=""),i}function t9(n,e,t){let i;return n.index_===gr||t?i=cw(n,e,t):i=cw(n,e,Po),i.endBeforeSet_=!0,i}function S_(n,e){const t=n.copy();return t.index_=e,t}function AC(n){const e={};if(n.isDefault())return e;let t;if(n.index_===At?t="$priority":n.index_===_b?t="$value":n.index_===gr?t="$key":(he(n.index_ instanceof gb,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=vn(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=vn(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+vn(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=vn(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+vn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function xC(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==At&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg extends GD{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Yf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(he(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const c=bg.getListenId_(e,i),h={};this.listens_[c]=h;const d=AC(e._queryParams);this.restRequest_(o+".json",d,(m,_)=>{let y=_;if(m===404&&(y=null,m=null),m===null&&this.onDataUpdate_(o,y,!1,i),Ul(this.listens_,c)===h){let b;m?m===401?b="permission_denied":b="rest_error:"+m:b="ok",r(b,null)}})}unlisten(e,t){const i=bg.getListenId_(e,t);delete this.listens_[i]}get(e){const t=AC(e._queryParams),i=e._path.toString(),r=new Ii;return this.restRequest_(i+".json",t,(o,c)=>{let h=c;o===404&&(h=null,o=null),o===null?(this.onDataUpdate_(i,h,!1,null),r.resolve(h)):r.reject(new Error(h))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,o])=>{r&&r.accessToken&&(t.auth=r.accessToken),o&&o.token&&(t.ac=o.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+tc(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(i&&h.readyState===4){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let d=null;if(h.status>=200&&h.status<300){try{d=Yd(h.responseText)}catch{Wn("Failed to parse JSON response for "+c+": "+h.responseText)}i(null,d)}else h.status!==401&&h.status!==404&&Wn("Got unsuccessful REST response for "+c+" Status: "+h.status),i(h.status);i=null}},h.open("GET",c,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(){this.rootNode_=Ce.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(){return{value:null,children:new Map}}function ch(n,e,t){if(qe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=ze(e);n.children.has(i)||n.children.set(i,Tg());const r=n.children.get(i);e=It(e),ch(r,e,t)}}function uw(n,e){if(qe(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(At,(i,r)=>{ch(n,new mt(i),r)}),uw(n,e)}}else if(n.children.size>0){const t=ze(e);return e=It(e),n.children.has(t)&&uw(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function hw(n,e,t){n.value!==null?t(e,n.value):i9(n,(i,r)=>{const o=new mt(e.toString()+"/"+i);hw(r,o,t)})}function i9(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Mn(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=10*1e3,r9=30*1e3,a9=300*1e3;class o9{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new s9(e);const i=CC+(r9-CC)*Math.random();jd(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;Mn(e,(r,o)=>{o>0&&es(this.statsToReport_,r)&&(t[r]=o,i=!0)}),i&&this.server_.reportStats(t),jd(this.reportStats_.bind(this),Math.floor(Math.random()*2*a9))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var js;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(js||(js={}));function vb(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function wb(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Eb(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=js.ACK_USER_WRITE,this.source=vb()}operationForChild(e){if(qe(this.path)){if(this.affectedTree.value!=null)return he(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new mt(e));return new Ig(ut(),t,this.revert)}}else return he(ze(this.path)===e,"operationForChild called for unrelated child."),new Ig(It(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t){this.source=e,this.path=t,this.type=js.LISTEN_COMPLETE}operationForChild(e){return qe(this.path)?new If(this.source,ut()):new If(this.source,It(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=js.OVERWRITE}operationForChild(e){return qe(this.path)?new Xl(this.source,ut(),this.snap.getImmediateChild(e)):new Xl(this.source,It(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=js.MERGE}operationForChild(e){if(qe(this.path)){const t=this.children.subtree(new mt(e));return t.isEmpty()?null:t.value?new Xl(this.source,ut(),t.value):new Bu(this.source,ut(),t)}else return he(ze(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Bu(this.source,It(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(qe(e))return this.isFullyInitialized()&&!this.filtered_;const t=ze(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function c9(n,e,t,i){const r=[],o=[];return e.forEach(c=>{c.type==="child_changed"&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&o.push(Wz(c.childName,c.snapshotNode))}),wd(n,r,"child_removed",e,i,t),wd(n,r,"child_added",e,i,t),wd(n,r,"child_moved",o,i,t),wd(n,r,"child_changed",e,i,t),wd(n,r,"value",e,i,t),r}function wd(n,e,t,i,r,o){const c=i.filter(h=>h.type===t);c.sort((h,d)=>h9(n,h,d)),c.forEach(h=>{const d=u9(n,h,o);r.forEach(m=>{m.respondsTo(h.type)&&e.push(m.createEvent(d,n.query_))})})}function u9(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function h9(n,e,t){if(e.childName==null||t.childName==null)throw Ku("Should only compare child_ events.");const i=new He(e.childName,e.snapshotNode),r=new He(t.childName,t.snapshotNode);return n.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(n,e){return{eventCache:n,serverCache:e}}function Ud(n,e,t,i){return A_(new Vo(e,t,i),n.serverCache)}function ek(n,e,t,i){return A_(n.eventCache,new Vo(e,t,i))}function Sg(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Jl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let f0;const d9=()=>(f0||(f0=new Ci(QB)),f0);class St{constructor(e,t=d9()){this.value=e,this.children=t}static fromObject(e){let t=new St(null);return Mn(e,(i,r)=>{t=t.set(new mt(i),r)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:ut(),value:this.value};if(qe(e))return null;{const i=ze(e),r=this.children.get(i);if(r!==null){const o=r.findRootMostMatchingPathAndValue(It(e),t);return o!=null?{path:Lt(new mt(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(qe(e))return this;{const t=ze(e),i=this.children.get(t);return i!==null?i.subtree(It(e)):new St(null)}}set(e,t){if(qe(e))return new St(t,this.children);{const i=ze(e),o=(this.children.get(i)||new St(null)).set(It(e),t),c=this.children.insert(i,o);return new St(this.value,c)}}remove(e){if(qe(e))return this.children.isEmpty()?new St(null):new St(null,this.children);{const t=ze(e),i=this.children.get(t);if(i){const r=i.remove(It(e));let o;return r.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,r),this.value===null&&o.isEmpty()?new St(null):new St(this.value,o)}else return this}}get(e){if(qe(e))return this.value;{const t=ze(e),i=this.children.get(t);return i?i.get(It(e)):null}}setTree(e,t){if(qe(e))return t;{const i=ze(e),o=(this.children.get(i)||new St(null)).setTree(It(e),t);let c;return o.isEmpty()?c=this.children.remove(i):c=this.children.insert(i,o),new St(this.value,c)}}fold(e){return this.fold_(ut(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,o)=>{i[r]=o.fold_(Lt(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,ut(),t)}findOnPath_(e,t,i){const r=this.value?i(t,this.value):!1;if(r)return r;if(qe(e))return null;{const o=ze(e),c=this.children.get(o);return c?c.findOnPath_(It(e),Lt(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ut(),t)}foreachOnPath_(e,t,i){if(qe(e))return this;{this.value&&i(t,this.value);const r=ze(e),o=this.children.get(r);return o?o.foreachOnPath_(It(e),Lt(t,r),i):new St(null)}}foreach(e){this.foreach_(ut(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(Lt(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.writeTree_=e}static empty(){return new Us(new St(null))}}function Fd(n,e,t){if(qe(e))return new Us(new St(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const r=i.path;let o=i.value;const c=ai(r,e);return o=o.updateChild(c,t),new Us(n.writeTree_.set(r,o))}else{const r=new St(t),o=n.writeTree_.setTree(e,r);return new Us(o)}}}function dw(n,e,t){let i=n;return Mn(t,(r,o)=>{i=Fd(i,Lt(e,r),o)}),i}function RC(n,e){if(qe(e))return Us.empty();{const t=n.writeTree_.setTree(e,new St(null));return new Us(t)}}function fw(n,e){return uc(n,e)!=null}function uc(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ai(t.path,e)):null}function NC(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(At,(i,r)=>{e.push(new He(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new He(i,r.value))}),e}function yo(n,e){if(qe(e))return n;{const t=uc(n,e);return t!=null?new Us(new St(t)):new Us(n.writeTree_.subtree(e))}}function mw(n){return n.writeTree_.isEmpty()}function zu(n,e){return tk(ut(),n.writeTree_,e)}function tk(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,o)=>{r===".priority"?(he(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=tk(Lt(n,r),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(Lt(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(n,e){return rk(e,n)}function f9(n,e,t,i,r){he(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=Fd(n.visibleWrites,e,t)),n.lastWriteId=i}function m9(n,e,t,i){he(i>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:i,visible:!0}),n.visibleWrites=dw(n.visibleWrites,e,t),n.lastWriteId=i}function p9(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function g9(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);he(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,o=!1,c=n.allWrites.length-1;for(;r&&c>=0;){const h=n.allWrites[c];h.visible&&(c>=t&&_9(h,i.path)?r=!1:vs(i.path,h.path)&&(o=!0)),c--}if(r){if(o)return y9(n),!0;if(i.snap)n.visibleWrites=RC(n.visibleWrites,i.path);else{const h=i.children;Mn(h,d=>{n.visibleWrites=RC(n.visibleWrites,Lt(i.path,d))})}return!0}else return!1}function _9(n,e){if(n.snap)return vs(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&vs(Lt(n.path,t),e))return!0;return!1}function y9(n){n.visibleWrites=nk(n.allWrites,v9,ut()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function v9(n){return n.visible}function nk(n,e,t){let i=Us.empty();for(let r=0;r<n.length;++r){const o=n[r];if(e(o)){const c=o.path;let h;if(o.snap)vs(t,c)?(h=ai(t,c),i=Fd(i,h,o.snap)):vs(c,t)&&(h=ai(c,t),i=Fd(i,ut(),o.snap.getChild(h)));else if(o.children){if(vs(t,c))h=ai(t,c),i=dw(i,h,o.children);else if(vs(c,t))if(h=ai(c,t),qe(h))i=dw(i,ut(),o.children);else{const d=Ul(o.children,ze(h));if(d){const m=d.getChild(It(h));i=Fd(i,ut(),m)}}}else throw Ku("WriteRecord should have .snap or .children")}}return i}function ik(n,e,t,i,r){if(!i&&!r){const o=uc(n.visibleWrites,e);if(o!=null)return o;{const c=yo(n.visibleWrites,e);if(mw(c))return t;if(t==null&&!fw(c,ut()))return null;{const h=t||Ce.EMPTY_NODE;return zu(c,h)}}}else{const o=yo(n.visibleWrites,e);if(!r&&mw(o))return t;if(!r&&t==null&&!fw(o,ut()))return null;{const c=function(m){return(m.visible||r)&&(!i||!~i.indexOf(m.writeId))&&(vs(m.path,e)||vs(e,m.path))},h=nk(n.allWrites,c,e),d=t||Ce.EMPTY_NODE;return zu(h,d)}}}function w9(n,e,t){let i=Ce.EMPTY_NODE;const r=uc(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(At,(o,c)=>{i=i.updateImmediateChild(o,c)}),i;if(t){const o=yo(n.visibleWrites,e);return t.forEachChild(At,(c,h)=>{const d=zu(yo(o,new mt(c)),h);i=i.updateImmediateChild(c,d)}),NC(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}else{const o=yo(n.visibleWrites,e);return NC(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}}function E9(n,e,t,i,r){he(i||r,"Either existingEventSnap or existingServerSnap must exist");const o=Lt(e,t);if(fw(n.visibleWrites,o))return null;{const c=yo(n.visibleWrites,o);return mw(c)?r.getChild(t):zu(c,r.getChild(t))}}function b9(n,e,t,i){const r=Lt(e,t),o=uc(n.visibleWrites,r);if(o!=null)return o;if(i.isCompleteForChild(t)){const c=yo(n.visibleWrites,r);return zu(c,i.getNode().getImmediateChild(t))}else return null}function T9(n,e){return uc(n.visibleWrites,e)}function I9(n,e,t,i,r,o,c){let h;const d=yo(n.visibleWrites,e),m=uc(d,ut());if(m!=null)h=m;else if(t!=null)h=zu(d,t);else return[];if(h=h.withIndex(c),!h.isEmpty()&&!h.isLeafNode()){const _=[],y=c.getCompare(),b=o?h.getReverseIteratorFrom(i,c):h.getIteratorFrom(i,c);let I=b.getNext();for(;I&&_.length<r;)y(I,i)!==0&&_.push(I),I=b.getNext();return _}else return[]}function S9(){return{visibleWrites:Us.empty(),allWrites:[],lastWriteId:-1}}function Ag(n,e,t,i){return ik(n.writeTree,n.treePath,e,t,i)}function bb(n,e){return w9(n.writeTree,n.treePath,e)}function DC(n,e,t,i){return E9(n.writeTree,n.treePath,e,t,i)}function xg(n,e){return T9(n.writeTree,Lt(n.treePath,e))}function A9(n,e,t,i,r,o){return I9(n.writeTree,n.treePath,e,t,i,r,o)}function Tb(n,e,t){return b9(n.writeTree,n.treePath,e,t)}function sk(n,e){return rk(Lt(n.treePath,e),n.writeTree)}function rk(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;he(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),he(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const o=r.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,bf(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,Ef(i,r.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,Fu(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,bf(i,e.snapshotNode,r.oldSnap));else throw Ku("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const ak=new C9;class Ib{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new Vo(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Tb(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Jl(this.viewCache_),o=A9(this.writes_,r,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R9(n){return{filter:n}}function N9(n,e){he(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),he(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function D9(n,e,t,i,r){const o=new x9;let c,h;if(t.type===js.OVERWRITE){const m=t;m.source.fromUser?c=pw(n,e,m.path,m.snap,i,r,o):(he(m.source.fromServer,"Unknown source."),h=m.source.tagged||e.serverCache.isFiltered()&&!qe(m.path),c=Cg(n,e,m.path,m.snap,i,r,h,o))}else if(t.type===js.MERGE){const m=t;m.source.fromUser?c=O9(n,e,m.path,m.children,i,r,o):(he(m.source.fromServer,"Unknown source."),h=m.source.tagged||e.serverCache.isFiltered(),c=gw(n,e,m.path,m.children,i,r,h,o))}else if(t.type===js.ACK_USER_WRITE){const m=t;m.revert?c=V9(n,e,m.path,i,r,o):c=P9(n,e,m.path,m.affectedTree,i,r,o)}else if(t.type===js.LISTEN_COMPLETE)c=M9(n,e,t.path,i,o);else throw Ku("Unknown operation type: "+t.type);const d=o.getChanges();return k9(e,c,d),{viewCache:c,changes:d}}function k9(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Sg(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(ZD(Sg(e)))}}function ok(n,e,t,i,r,o){const c=e.eventCache;if(xg(i,t)!=null)return e;{let h,d;if(qe(t))if(he(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const m=Jl(e),_=m instanceof Ce?m:Ce.EMPTY_NODE,y=bb(i,_);h=n.filter.updateFullNode(e.eventCache.getNode(),y,o)}else{const m=Ag(i,Jl(e));h=n.filter.updateFullNode(e.eventCache.getNode(),m,o)}else{const m=ze(t);if(m===".priority"){he(Mo(t)===1,"Can't have a priority with additional path components");const _=c.getNode();d=e.serverCache.getNode();const y=DC(i,t,_,d);y!=null?h=n.filter.updatePriority(_,y):h=c.getNode()}else{const _=It(t);let y;if(c.isCompleteForChild(m)){d=e.serverCache.getNode();const b=DC(i,t,c.getNode(),d);b!=null?y=c.getNode().getImmediateChild(m).updateChild(_,b):y=c.getNode().getImmediateChild(m)}else y=Tb(i,m,e.serverCache);y!=null?h=n.filter.updateChild(c.getNode(),m,y,_,r,o):h=c.getNode()}}return Ud(e,h,c.isFullyInitialized()||qe(t),n.filter.filtersNodes())}}function Cg(n,e,t,i,r,o,c,h){const d=e.serverCache;let m;const _=c?n.filter:n.filter.getIndexedFilter();if(qe(t))m=_.updateFullNode(d.getNode(),i,null);else if(_.filtersNodes()&&!d.isFiltered()){const I=d.getNode().updateChild(t,i);m=_.updateFullNode(d.getNode(),I,null)}else{const I=ze(t);if(!d.isCompleteForPath(t)&&Mo(t)>1)return e;const C=It(t),z=d.getNode().getImmediateChild(I).updateChild(C,i);I===".priority"?m=_.updatePriority(d.getNode(),z):m=_.updateChild(d.getNode(),I,z,C,ak,null)}const y=ek(e,m,d.isFullyInitialized()||qe(t),_.filtersNodes()),b=new Ib(r,y,o);return ok(n,y,t,r,b,h)}function pw(n,e,t,i,r,o,c){const h=e.eventCache;let d,m;const _=new Ib(r,e,o);if(qe(t))m=n.filter.updateFullNode(e.eventCache.getNode(),i,c),d=Ud(e,m,!0,n.filter.filtersNodes());else{const y=ze(t);if(y===".priority")m=n.filter.updatePriority(e.eventCache.getNode(),i),d=Ud(e,m,h.isFullyInitialized(),h.isFiltered());else{const b=It(t),I=h.getNode().getImmediateChild(y);let C;if(qe(b))C=i;else{const M=_.getCompleteChild(y);M!=null?db(b)===".priority"&&M.getChild(KD(b)).isEmpty()?C=M:C=M.updateChild(b,i):C=Ce.EMPTY_NODE}if(I.equals(C))d=e;else{const M=n.filter.updateChild(h.getNode(),y,C,b,_,c);d=Ud(e,M,h.isFullyInitialized(),n.filter.filtersNodes())}}}return d}function kC(n,e){return n.eventCache.isCompleteForChild(e)}function O9(n,e,t,i,r,o,c){let h=e;return i.foreach((d,m)=>{const _=Lt(t,d);kC(e,ze(_))&&(h=pw(n,h,_,m,r,o,c))}),i.foreach((d,m)=>{const _=Lt(t,d);kC(e,ze(_))||(h=pw(n,h,_,m,r,o,c))}),h}function OC(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function gw(n,e,t,i,r,o,c,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let d=e,m;qe(t)?m=i:m=new St(null).setTree(t,i);const _=e.serverCache.getNode();return m.children.inorderTraversal((y,b)=>{if(_.hasChild(y)){const I=e.serverCache.getNode().getImmediateChild(y),C=OC(n,I,b);d=Cg(n,d,new mt(y),C,r,o,c,h)}}),m.children.inorderTraversal((y,b)=>{const I=!e.serverCache.isCompleteForChild(y)&&b.value===null;if(!_.hasChild(y)&&!I){const C=e.serverCache.getNode().getImmediateChild(y),M=OC(n,C,b);d=Cg(n,d,new mt(y),M,r,o,c,h)}}),d}function P9(n,e,t,i,r,o,c){if(xg(r,t)!=null)return e;const h=e.serverCache.isFiltered(),d=e.serverCache;if(i.value!=null){if(qe(t)&&d.isFullyInitialized()||d.isCompleteForPath(t))return Cg(n,e,t,d.getNode().getChild(t),r,o,h,c);if(qe(t)){let m=new St(null);return d.getNode().forEachChild(gr,(_,y)=>{m=m.set(new mt(_),y)}),gw(n,e,t,m,r,o,h,c)}else return e}else{let m=new St(null);return i.foreach((_,y)=>{const b=Lt(t,_);d.isCompleteForPath(b)&&(m=m.set(_,d.getNode().getChild(b)))}),gw(n,e,t,m,r,o,h,c)}}function M9(n,e,t,i,r){const o=e.serverCache,c=ek(e,o.getNode(),o.isFullyInitialized()||qe(t),o.isFiltered());return ok(n,c,t,i,ak,r)}function V9(n,e,t,i,r,o){let c;if(xg(i,t)!=null)return e;{const h=new Ib(i,e,r),d=e.eventCache.getNode();let m;if(qe(t)||ze(t)===".priority"){let _;if(e.serverCache.isFullyInitialized())_=Ag(i,Jl(e));else{const y=e.serverCache.getNode();he(y instanceof Ce,"serverChildren would be complete if leaf node"),_=bb(i,y)}_=_,m=n.filter.updateFullNode(d,_,o)}else{const _=ze(t);let y=Tb(i,_,e.serverCache);y==null&&e.serverCache.isCompleteForChild(_)&&(y=d.getImmediateChild(_)),y!=null?m=n.filter.updateChild(d,_,y,It(t),h,o):e.eventCache.getNode().hasChild(_)?m=n.filter.updateChild(d,_,Ce.EMPTY_NODE,It(t),h,o):m=d,m.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=Ag(i,Jl(e)),c.isLeafNode()&&(m=n.filter.updateFullNode(m,c,o)))}return c=e.serverCache.isFullyInitialized()||xg(i,ut())!=null,Ud(e,m,c,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new yb(i.getIndex()),o=Xz(i);this.processor_=R9(o);const c=t.serverCache,h=t.eventCache,d=r.updateFullNode(Ce.EMPTY_NODE,c.getNode(),null),m=o.updateFullNode(Ce.EMPTY_NODE,h.getNode(),null),_=new Vo(d,c.isFullyInitialized(),r.filtersNodes()),y=new Vo(m,h.isFullyInitialized(),o.filtersNodes());this.viewCache_=A_(y,_),this.eventGenerator_=new l9(this.query_)}get query(){return this.query_}}function j9(n){return n.viewCache_.serverCache.getNode()}function U9(n){return Sg(n.viewCache_)}function F9(n,e){const t=Jl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!qe(e)&&!t.getImmediateChild(ze(e)).isEmpty())?t.getChild(e):null}function PC(n){return n.eventRegistrations_.length===0}function B9(n,e){n.eventRegistrations_.push(e)}function MC(n,e,t){const i=[];if(t){he(e==null,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(o=>{const c=o.createCancelEvent(t,r);c&&i.push(c)})}if(e){let r=[];for(let o=0;o<n.eventRegistrations_.length;++o){const c=n.eventRegistrations_[o];if(!c.matches(e))r.push(c);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function VC(n,e,t,i){e.type===js.MERGE&&e.source.queryId!==null&&(he(Jl(n.viewCache_),"We should always have a full cache before handling merges"),he(Sg(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,o=D9(n.processor_,r,e,t,i);return N9(n.processor_,o.viewCache),he(o.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,lk(n,o.changes,o.viewCache.eventCache.getNode(),null)}function z9(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(At,(o,c)=>{i.push(Fu(o,c))}),t.isFullyInitialized()&&i.push(ZD(t.getNode())),lk(n,i,t.getNode(),e)}function lk(n,e,t,i){const r=i?[i]:n.eventRegistrations_;return c9(n.eventGenerator_,e,t,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rg;class ck{constructor(){this.views=new Map}}function q9(n){he(!Rg,"__referenceConstructor has already been defined"),Rg=n}function G9(){return he(Rg,"Reference.ts has not been loaded"),Rg}function H9(n){return n.views.size===0}function Sb(n,e,t,i){const r=e.source.queryId;if(r!==null){const o=n.views.get(r);return he(o!=null,"SyncTree gave us an op for an invalid query."),VC(o,e,t,i)}else{let o=[];for(const c of n.views.values())o=o.concat(VC(c,e,t,i));return o}}function uk(n,e,t,i,r){const o=e._queryIdentifier,c=n.views.get(o);if(!c){let h=Ag(t,r?i:null),d=!1;h?d=!0:i instanceof Ce?(h=bb(t,i),d=!1):(h=Ce.EMPTY_NODE,d=!1);const m=A_(new Vo(h,d,!1),new Vo(i,r,!1));return new L9(e,m)}return c}function K9(n,e,t,i,r,o){const c=uk(n,e,i,r,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),B9(c,t),z9(c,t)}function $9(n,e,t,i){const r=e._queryIdentifier,o=[];let c=[];const h=Lo(n);if(r==="default")for(const[d,m]of n.views.entries())c=c.concat(MC(m,t,i)),PC(m)&&(n.views.delete(d),m.query._queryParams.loadsAllData()||o.push(m.query));else{const d=n.views.get(r);d&&(c=c.concat(MC(d,t,i)),PC(d)&&(n.views.delete(r),d.query._queryParams.loadsAllData()||o.push(d.query)))}return h&&!Lo(n)&&o.push(new(G9())(e._repo,e._path)),{removed:o,events:c}}function hk(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function vo(n,e){let t=null;for(const i of n.views.values())t=t||F9(i,e);return t}function dk(n,e){if(e._queryParams.loadsAllData())return C_(n);{const i=e._queryIdentifier;return n.views.get(i)}}function fk(n,e){return dk(n,e)!=null}function Lo(n){return C_(n)!=null}function C_(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ng;function Q9(n){he(!Ng,"__referenceConstructor has already been defined"),Ng=n}function W9(){return he(Ng,"Reference.ts has not been loaded"),Ng}let Y9=1;class LC{constructor(e){this.listenProvider_=e,this.syncPointTree_=new St(null),this.pendingWriteTree_=S9(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ab(n,e,t,i,r){return f9(n.pendingWriteTree_,e,t,i,r),r?uh(n,new Xl(vb(),e,t)):[]}function X9(n,e,t,i){m9(n.pendingWriteTree_,e,t,i);const r=St.fromObject(t);return uh(n,new Bu(vb(),e,r))}function ho(n,e,t=!1){const i=p9(n.pendingWriteTree_,e);if(g9(n.pendingWriteTree_,e)){let o=new St(null);return i.snap!=null?o=o.set(ut(),!0):Mn(i.children,c=>{o=o.set(new mt(c),!0)}),uh(n,new Ig(i.path,o,t))}else return[]}function Jf(n,e,t){return uh(n,new Xl(wb(),e,t))}function J9(n,e,t){const i=St.fromObject(t);return uh(n,new Bu(wb(),e,i))}function Z9(n,e){return uh(n,new If(wb(),e))}function eq(n,e,t){const i=xb(n,t);if(i){const r=Cb(i),o=r.path,c=r.queryId,h=ai(o,e),d=new If(Eb(c),h);return Rb(n,o,d)}else return[]}function Dg(n,e,t,i,r=!1){const o=e._path,c=n.syncPointTree_.get(o);let h=[];if(c&&(e._queryIdentifier==="default"||fk(c,e))){const d=$9(c,e,t,i);H9(c)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const m=d.removed;if(h=d.events,!r){const _=m.findIndex(b=>b._queryParams.loadsAllData())!==-1,y=n.syncPointTree_.findOnPath(o,(b,I)=>Lo(I));if(_&&!y){const b=n.syncPointTree_.subtree(o);if(!b.isEmpty()){const I=iq(b);for(let C=0;C<I.length;++C){const M=I[C],z=M.query,B=_k(n,M);n.listenProvider_.startListening(Bd(z),Sf(n,z),B.hashFn,B.onComplete)}}}!y&&m.length>0&&!i&&(_?n.listenProvider_.stopListening(Bd(e),null):m.forEach(b=>{const I=n.queryToTagMap.get(N_(b));n.listenProvider_.stopListening(Bd(b),I)}))}sq(n,m)}return h}function mk(n,e,t,i){const r=xb(n,i);if(r!=null){const o=Cb(r),c=o.path,h=o.queryId,d=ai(c,e),m=new Xl(Eb(h),d,t);return Rb(n,c,m)}else return[]}function tq(n,e,t,i){const r=xb(n,i);if(r){const o=Cb(r),c=o.path,h=o.queryId,d=ai(c,e),m=St.fromObject(t),_=new Bu(Eb(h),d,m);return Rb(n,c,_)}else return[]}function _w(n,e,t,i=!1){const r=e._path;let o=null,c=!1;n.syncPointTree_.foreachOnPath(r,(b,I)=>{const C=ai(b,r);o=o||vo(I,C),c=c||Lo(I)});let h=n.syncPointTree_.get(r);h?(c=c||Lo(h),o=o||vo(h,ut())):(h=new ck,n.syncPointTree_=n.syncPointTree_.set(r,h));let d;o!=null?d=!0:(d=!1,o=Ce.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((I,C)=>{const M=vo(C,ut());M&&(o=o.updateImmediateChild(I,M))}));const m=fk(h,e);if(!m&&!e._queryParams.loadsAllData()){const b=N_(e);he(!n.queryToTagMap.has(b),"View does not exist, but we have a tag");const I=rq();n.queryToTagMap.set(b,I),n.tagToQueryMap.set(I,b)}const _=x_(n.pendingWriteTree_,r);let y=K9(h,e,t,_,o,d);if(!m&&!c&&!i){const b=dk(h,e);y=y.concat(aq(n,e,b))}return y}function R_(n,e,t){const r=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(c,h)=>{const d=ai(c,e),m=vo(h,d);if(m)return m});return ik(r,e,o,t,!0)}function nq(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(m,_)=>{const y=ai(m,t);i=i||vo(_,y)});let r=n.syncPointTree_.get(t);r?i=i||vo(r,ut()):(r=new ck,n.syncPointTree_=n.syncPointTree_.set(t,r));const o=i!=null,c=o?new Vo(i,!0,!1):null,h=x_(n.pendingWriteTree_,e._path),d=uk(r,e,h,o?c.getNode():Ce.EMPTY_NODE,o);return U9(d)}function uh(n,e){return pk(e,n.syncPointTree_,null,x_(n.pendingWriteTree_,ut()))}function pk(n,e,t,i){if(qe(n.path))return gk(n,e,t,i);{const r=e.get(ut());t==null&&r!=null&&(t=vo(r,ut()));let o=[];const c=ze(n.path),h=n.operationForChild(c),d=e.children.get(c);if(d&&h){const m=t?t.getImmediateChild(c):null,_=sk(i,c);o=o.concat(pk(h,d,m,_))}return r&&(o=o.concat(Sb(r,n,i,t))),o}}function gk(n,e,t,i){const r=e.get(ut());t==null&&r!=null&&(t=vo(r,ut()));let o=[];return e.children.inorderTraversal((c,h)=>{const d=t?t.getImmediateChild(c):null,m=sk(i,c),_=n.operationForChild(c);_&&(o=o.concat(gk(_,h,d,m)))}),r&&(o=o.concat(Sb(r,n,i,t))),o}function _k(n,e){const t=e.query,i=Sf(n,t);return{hashFn:()=>(j9(e)||Ce.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?eq(n,t._path,i):Z9(n,t._path);{const o=XB(r,t);return Dg(n,t,null,o)}}}}function Sf(n,e){const t=N_(e);return n.queryToTagMap.get(t)}function N_(n){return n._path.toString()+"$"+n._queryIdentifier}function xb(n,e){return n.tagToQueryMap.get(e)}function Cb(n){const e=n.indexOf("$");return he(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new mt(n.substr(0,e))}}function Rb(n,e,t){const i=n.syncPointTree_.get(e);he(i,"Missing sync point for query tag that we're tracking");const r=x_(n.pendingWriteTree_,e);return Sb(i,t,r,null)}function iq(n){return n.fold((e,t,i)=>{if(t&&Lo(t))return[C_(t)];{let r=[];return t&&(r=hk(t)),Mn(i,(o,c)=>{r=r.concat(c)}),r}})}function Bd(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(W9())(n._repo,n._path):n}function sq(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const r=N_(i),o=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(o)}}}function rq(){return Y9++}function aq(n,e,t){const i=e._path,r=Sf(n,e),o=_k(n,t),c=n.listenProvider_.startListening(Bd(e),r,o.hashFn,o.onComplete),h=n.syncPointTree_.subtree(i);if(r)he(!Lo(h.value),"If we're adding a query, it shouldn't be shadowed");else{const d=h.fold((m,_,y)=>{if(!qe(m)&&_&&Lo(_))return[C_(_).query];{let b=[];return _&&(b=b.concat(hk(_).map(I=>I.query))),Mn(y,(I,C)=>{b=b.concat(C)}),b}});for(let m=0;m<d.length;++m){const _=d[m];n.listenProvider_.stopListening(Bd(_),Sf(n,_))}}return c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Nb(t)}node(){return this.node_}}class Db{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Lt(this.path_,e);return new Db(this.syncTree_,t)}node(){return R_(this.syncTree_,this.path_)}}const oq=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},jC=function(n,e,t){if(!n||typeof n!="object")return n;if(he(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return lq(n[".sv"],e,t);if(typeof n[".sv"]=="object")return cq(n[".sv"],e);he(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},lq=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:he(!1,"Unexpected server value: "+n)}},cq=function(n,e,t){n.hasOwnProperty("increment")||he(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&he(!1,"Unexpected increment value: "+i);const r=e.node();if(he(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const c=r.getValue();return typeof c!="number"?i:c+i},yk=function(n,e,t,i){return Ob(e,new Db(t,n),i)},kb=function(n,e,t){return Ob(n,new Nb(e),t)};function Ob(n,e,t){const i=n.getPriority().val(),r=jC(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const c=n,h=jC(c.getValue(),e,t);return h!==c.getValue()||r!==c.getPriority().val()?new An(h,Ut(r)):n}else{const c=n;return o=c,r!==c.getPriority().val()&&(o=o.updatePriority(new An(r))),c.forEachChild(At,(h,d)=>{const m=Ob(d,e.getImmediateChild(h),t);m!==d&&(o=o.updateImmediateChild(h,m))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function D_(n,e){let t=e instanceof mt?e:new mt(e),i=n,r=ze(t);for(;r!==null;){const o=Ul(i.node.children,r)||{children:{},childCount:0};i=new Pb(r,i,o),t=It(t),r=ze(t)}return i}function hc(n){return n.node.value}function Mb(n,e){n.node.value=e,yw(n)}function vk(n){return n.node.childCount>0}function uq(n){return hc(n)===void 0&&!vk(n)}function k_(n,e){Mn(n.node.children,(t,i)=>{e(new Pb(t,n,i))})}function wk(n,e,t,i){t&&e(n),k_(n,r=>{wk(r,e,!0)})}function hq(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Zf(n){return new mt(n.parent===null?n.name:Zf(n.parent)+"/"+n.name)}function yw(n){n.parent!==null&&dq(n.parent,n.name,n)}function dq(n,e,t){const i=uq(t),r=es(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,yw(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,yw(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fq=/[\[\].#$\/\u0000-\u001F\u007F]/,mq=/[\[\].#$\u0000-\u001F\u007F]/,m0=10*1024*1024,O_=function(n){return typeof n=="string"&&n.length!==0&&!fq.test(n)},Ek=function(n){return typeof n=="string"&&n.length!==0&&!mq.test(n)},pq=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ek(n)},Af=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!b_(n)||n&&typeof n=="object"&&es(n,".sv")},Tr=function(n,e,t,i){i&&e===void 0||em(Ri(n,"value"),e,t)},em=function(n,e,t){const i=t instanceof mt?new Dz(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Il(i));if(typeof e=="function")throw new Error(n+"contains a function "+Il(i)+" with contents = "+e.toString());if(b_(e))throw new Error(n+"contains "+e.toString()+" "+Il(i));if(typeof e=="string"&&e.length>m0/3&&jg(e)>m0)throw new Error(n+"contains a string greater than "+m0+" utf8 bytes "+Il(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,o=!1;if(Mn(e,(c,h)=>{if(c===".value")r=!0;else if(c!==".priority"&&c!==".sv"&&(o=!0,!O_(c)))throw new Error(n+" contains an invalid key ("+c+") "+Il(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);kz(i,c),em(n,h,i),Oz(i)}),r&&o)throw new Error(n+' contains ".value" child '+Il(i)+" in addition to actual children.")}},gq=function(n,e){let t,i;for(t=0;t<e.length;t++){i=e[t];const o=wf(i);for(let c=0;c<o.length;c++)if(!(o[c]===".priority"&&c===o.length-1)){if(!O_(o[c]))throw new Error(n+"contains an invalid key ("+o[c]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(Nz);let r=null;for(t=0;t<e.length;t++){if(i=e[t],r!==null&&vs(r,i))throw new Error(n+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}},bk=function(n,e,t,i){const r=Ri(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const o=[];Mn(e,(c,h)=>{const d=new mt(c);if(em(r,h,Lt(t,d)),db(d)===".priority"&&!Af(h))throw new Error(r+"contains an invalid value for '"+d.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(d)}),gq(r,o)},Vb=function(n,e,t){if(b_(e))throw new Error(Ri(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Af(e))throw new Error(Ri(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},tm=function(n,e,t,i){if(t!==void 0&&!O_(t))throw new Error(Ri(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},xf=function(n,e,t,i){if(!Ek(t))throw new Error(Ri(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},_q=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),xf(n,e,t)},ws=function(n,e){if(ze(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},Tk=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!O_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!pq(t))throw new Error(Ri(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yq{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function P_(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],o=r.getPath();t!==null&&!fb(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(r)}t&&n.eventLists_.push(t)}function Ik(n,e,t){P_(n,t),Sk(n,i=>fb(i,e))}function ns(n,e,t){P_(n,t),Sk(n,i=>vs(i,e)||vs(e,i))}function Sk(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];if(r){const o=r.path;e(o)?(vq(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function vq(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();Ll&&Dn("event: "+t.toString()),lh(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak="repo_interrupt",wq=25;class Eq{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new yq,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Tg(),this.transactionQueueTree_=new Pb,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function bq(n,e,t){if(n.stats_=ub(n.repoInfo_),n.forceRestClient_||tz())n.server_=new bg(n.repoInfo_,(i,r,o,c)=>{UC(n,i,r,o,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>FC(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{vn(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new sa(n.repoInfo_,e,(i,r,o,c)=>{UC(n,i,r,o,c)},i=>{FC(n,i)},i=>{Tq(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=az(n.repoInfo_,()=>new o9(n.stats_,n.server_)),n.infoData_=new n9,n.infoSyncTree_=new LC({startListening:(i,r,o,c)=>{let h=[];const d=n.infoData_.getNode(i._path);return d.isEmpty()||(h=Jf(n.infoSyncTree_,i._path,d),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),Lb(n,"connected",!1),n.serverSyncTree_=new LC({startListening:(i,r,o,c)=>(n.server_.listen(i,o,r,(h,d)=>{const m=c(h,d);ns(n.eventQueue_,i._path,m)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function xk(n){const t=n.infoData_.getNode(new mt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function nm(n){return oq({timestamp:xk(n)})}function UC(n,e,t,i,r){n.dataUpdateCount++;const o=new mt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(r)if(i){const d=eg(t,m=>Ut(m));c=tq(n.serverSyncTree_,o,d,r)}else{const d=Ut(t);c=mk(n.serverSyncTree_,o,d,r)}else if(i){const d=eg(t,m=>Ut(m));c=J9(n.serverSyncTree_,o,d)}else{const d=Ut(t);c=Jf(n.serverSyncTree_,o,d)}let h=o;c.length>0&&(h=qu(n,o)),ns(n.eventQueue_,h,c)}function FC(n,e){Lb(n,"connected",e),e===!1&&Aq(n)}function Tq(n,e){Mn(e,(t,i)=>{Lb(n,t,i)})}function Lb(n,e,t){const i=new mt("/.info/"+e),r=Ut(t);n.infoData_.updateSnapshot(i,r);const o=Jf(n.infoSyncTree_,i,r);ns(n.eventQueue_,i,o)}function M_(n){return n.nextWriteId_++}function Iq(n,e,t){const i=nq(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(r=>{const o=Ut(r).withIndex(e._queryParams.getIndex());_w(n.serverSyncTree_,e,t,!0);let c;if(e._queryParams.loadsAllData())c=Jf(n.serverSyncTree_,e._path,o);else{const h=Sf(n.serverSyncTree_,e);c=mk(n.serverSyncTree_,e._path,o,h)}return ns(n.eventQueue_,e._path,c),Dg(n.serverSyncTree_,e,t,null,!0),o},r=>(hh(n,"get for query "+vn(e)+" failed: "+r),Promise.reject(new Error(r))))}function jb(n,e,t,i,r){hh(n,"set",{path:e.toString(),value:t,priority:i});const o=nm(n),c=Ut(t,i),h=R_(n.serverSyncTree_,e),d=kb(c,h,o),m=M_(n),_=Ab(n.serverSyncTree_,e,d,m,!0);P_(n.eventQueue_,_),n.server_.put(e.toString(),c.val(!0),(b,I)=>{const C=b==="ok";C||Wn("set at "+e+" failed: "+b);const M=ho(n.serverSyncTree_,m,!C);ns(n.eventQueue_,e,M),jo(n,r,b,I)});const y=Fb(n,e);qu(n,y),ns(n.eventQueue_,y,[])}function Sq(n,e,t,i){hh(n,"update",{path:e.toString(),value:t});let r=!0;const o=nm(n),c={};if(Mn(t,(h,d)=>{r=!1,c[h]=yk(Lt(e,h),Ut(d),n.serverSyncTree_,o)}),r)Dn("update() called with empty data.  Don't do anything."),jo(n,i,"ok",void 0);else{const h=M_(n),d=X9(n.serverSyncTree_,e,c,h);P_(n.eventQueue_,d),n.server_.merge(e.toString(),t,(m,_)=>{const y=m==="ok";y||Wn("update at "+e+" failed: "+m);const b=ho(n.serverSyncTree_,h,!y),I=b.length>0?qu(n,e):e;ns(n.eventQueue_,I,b),jo(n,i,m,_)}),Mn(t,m=>{const _=Fb(n,Lt(e,m));qu(n,_)}),ns(n.eventQueue_,e,[])}}function Aq(n){hh(n,"onDisconnectEvents");const e=nm(n),t=Tg();hw(n.onDisconnect_,ut(),(r,o)=>{const c=yk(r,o,n.serverSyncTree_,e);ch(t,r,c)});let i=[];hw(t,ut(),(r,o)=>{i=i.concat(Jf(n.serverSyncTree_,r,o));const c=Fb(n,r);qu(n,c)}),n.onDisconnect_=Tg(),ns(n.eventQueue_,ut(),i)}function xq(n,e,t){n.server_.onDisconnectCancel(e.toString(),(i,r)=>{i==="ok"&&uw(n.onDisconnect_,e),jo(n,t,i,r)})}function BC(n,e,t,i){const r=Ut(t);n.server_.onDisconnectPut(e.toString(),r.val(!0),(o,c)=>{o==="ok"&&ch(n.onDisconnect_,e,r),jo(n,i,o,c)})}function Cq(n,e,t,i,r){const o=Ut(t,i);n.server_.onDisconnectPut(e.toString(),o.val(!0),(c,h)=>{c==="ok"&&ch(n.onDisconnect_,e,o),jo(n,r,c,h)})}function Rq(n,e,t,i){if(Zp(t)){Dn("onDisconnect().update() called with empty data.  Don't do anything."),jo(n,i,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(r,o)=>{r==="ok"&&Mn(t,(c,h)=>{const d=Ut(h);ch(n.onDisconnect_,Lt(e,c),d)}),jo(n,i,r,o)})}function Nq(n,e,t){let i;ze(e._path)===".info"?i=_w(n.infoSyncTree_,e,t):i=_w(n.serverSyncTree_,e,t),Ik(n.eventQueue_,e._path,i)}function vw(n,e,t){let i;ze(e._path)===".info"?i=Dg(n.infoSyncTree_,e,t):i=Dg(n.serverSyncTree_,e,t),Ik(n.eventQueue_,e._path,i)}function Ck(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Ak)}function Dq(n){n.persistentConnection_&&n.persistentConnection_.resume(Ak)}function hh(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Dn(t,...e)}function jo(n,e,t,i){e&&lh(()=>{if(t==="ok")e(null);else{const r=(t||"error").toUpperCase();let o=r;i&&(o+=": "+i);const c=new Error(o);c.code=r,e(c)}})}function kq(n,e,t,i,r,o){hh(n,"transaction on "+e);const c={path:e,update:t,onComplete:i,status:null,order:TD(),applyLocally:o,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Ub(n,e,void 0);c.currentInputSnapshot=h;const d=c.update(h.val());if(d===void 0)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{em("transaction failed: Data returned ",d,c.path),c.status=0;const m=D_(n.transactionQueueTree_,e),_=hc(m)||[];_.push(c),Mb(m,_);let y;typeof d=="object"&&d!==null&&es(d,".priority")?(y=Ul(d,".priority"),he(Af(y),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):y=(R_(n.serverSyncTree_,e)||Ce.EMPTY_NODE).getPriority().val();const b=nm(n),I=Ut(d,y),C=kb(I,h,b);c.currentOutputSnapshotRaw=I,c.currentOutputSnapshotResolved=C,c.currentWriteId=M_(n);const M=Ab(n.serverSyncTree_,e,C,c.currentWriteId,c.applyLocally);ns(n.eventQueue_,e,M),V_(n,n.transactionQueueTree_)}}function Ub(n,e,t){return R_(n.serverSyncTree_,e,t)||Ce.EMPTY_NODE}function V_(n,e=n.transactionQueueTree_){if(e||L_(n,e),hc(e)){const t=Nk(n,e);he(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&Oq(n,Zf(e),t)}else vk(e)&&k_(e,t=>{V_(n,t)})}function Oq(n,e,t){const i=t.map(m=>m.currentWriteId),r=Ub(n,e,i);let o=r;const c=r.hash();for(let m=0;m<t.length;m++){const _=t[m];he(_.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),_.status=1,_.retryCount++;const y=ai(e,_.path);o=o.updateChild(y,_.currentOutputSnapshotRaw)}const h=o.val(!0),d=e;n.server_.put(d.toString(),h,m=>{hh(n,"transaction put response",{path:d.toString(),status:m});let _=[];if(m==="ok"){const y=[];for(let b=0;b<t.length;b++)t[b].status=2,_=_.concat(ho(n.serverSyncTree_,t[b].currentWriteId)),t[b].onComplete&&y.push(()=>t[b].onComplete(null,!0,t[b].currentOutputSnapshotResolved)),t[b].unwatcher();L_(n,D_(n.transactionQueueTree_,e)),V_(n,n.transactionQueueTree_),ns(n.eventQueue_,e,_);for(let b=0;b<y.length;b++)lh(y[b])}else{if(m==="datastale")for(let y=0;y<t.length;y++)t[y].status===3?t[y].status=4:t[y].status=0;else{Wn("transaction at "+d.toString()+" failed: "+m);for(let y=0;y<t.length;y++)t[y].status=4,t[y].abortReason=m}qu(n,e)}},c)}function qu(n,e){const t=Rk(n,e),i=Zf(t),r=Nk(n,t);return Pq(n,r,i),i}function Pq(n,e,t){if(e.length===0)return;const i=[];let r=[];const c=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const d=e[h],m=ai(t,d.path);let _=!1,y;if(he(m!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),d.status===4)_=!0,y=d.abortReason,r=r.concat(ho(n.serverSyncTree_,d.currentWriteId,!0));else if(d.status===0)if(d.retryCount>=wq)_=!0,y="maxretry",r=r.concat(ho(n.serverSyncTree_,d.currentWriteId,!0));else{const b=Ub(n,d.path,c);d.currentInputSnapshot=b;const I=e[h].update(b.val());if(I!==void 0){em("transaction failed: Data returned ",I,d.path);let C=Ut(I);typeof I=="object"&&I!=null&&es(I,".priority")||(C=C.updatePriority(b.getPriority()));const z=d.currentWriteId,B=nm(n),j=kb(C,b,B);d.currentOutputSnapshotRaw=C,d.currentOutputSnapshotResolved=j,d.currentWriteId=M_(n),c.splice(c.indexOf(z),1),r=r.concat(Ab(n.serverSyncTree_,d.path,j,d.currentWriteId,d.applyLocally)),r=r.concat(ho(n.serverSyncTree_,z,!0))}else _=!0,y="nodata",r=r.concat(ho(n.serverSyncTree_,d.currentWriteId,!0))}ns(n.eventQueue_,t,r),r=[],_&&(e[h].status=2,(function(b){setTimeout(b,Math.floor(0))})(e[h].unwatcher),e[h].onComplete&&(y==="nodata"?i.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):i.push(()=>e[h].onComplete(new Error(y),!1,null))))}L_(n,n.transactionQueueTree_);for(let h=0;h<i.length;h++)lh(i[h]);V_(n,n.transactionQueueTree_)}function Rk(n,e){let t,i=n.transactionQueueTree_;for(t=ze(e);t!==null&&hc(i)===void 0;)i=D_(i,t),e=It(e),t=ze(e);return i}function Nk(n,e){const t=[];return Dk(n,e,t),t.sort((i,r)=>i.order-r.order),t}function Dk(n,e,t){const i=hc(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);k_(e,r=>{Dk(n,r,t)})}function L_(n,e){const t=hc(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,Mb(e,t.length>0?t:void 0)}k_(e,i=>{L_(n,i)})}function Fb(n,e){const t=Zf(Rk(n,e)),i=D_(n.transactionQueueTree_,e);return hq(i,r=>{p0(n,r)}),p0(n,i),wk(i,r=>{p0(n,r)}),t}function p0(n,e){const t=hc(e);if(t){const i=[];let r=[],o=-1;for(let c=0;c<t.length;c++)t[c].status===3||(t[c].status===1?(he(o===c-1,"All SENT items should be at beginning of queue."),o=c,t[c].status=3,t[c].abortReason="set"):(he(t[c].status===0,"Unexpected transaction status in abort"),t[c].unwatcher(),r=r.concat(ho(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&i.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Mb(e,void 0):t.length=o+1,ns(n.eventQueue_,Zf(e),r);for(let c=0;c<i.length;c++)lh(i[c])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mq(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function Vq(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Wn(`Invalid query segment '${t}' in query '${n}'`)}return e}const ww=function(n,e){const t=Lq(n),i=t.namespace;t.domain==="firebase.com"&&br(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&br("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||KB();const r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new LD(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new mt(t.pathString)}},Lq=function(n){let e="",t="",i="",r="",o="",c=!0,h="https",d=443;if(typeof n=="string"){let m=n.indexOf("//");m>=0&&(h=n.substring(0,m-1),n=n.substring(m+2));let _=n.indexOf("/");_===-1&&(_=n.length);let y=n.indexOf("?");y===-1&&(y=n.length),e=n.substring(0,Math.min(_,y)),_<y&&(r=Mq(n.substring(_,y)));const b=Vq(n.substring(Math.min(n.length,y)));m=e.indexOf(":"),m>=0?(c=h==="https"||h==="wss",d=parseInt(e.substring(m+1),10)):m=e.length;const I=e.slice(0,m);if(I.toLowerCase()==="localhost")t="localhost";else if(I.split(".").length<=2)t=I;else{const C=e.indexOf(".");i=e.substring(0,C).toLowerCase(),t=e.substring(C+1),o=i}"ns"in b&&(o=b.ns)}return{host:e,port:d,domain:t,subdomain:i,secure:c,scheme:h,pathString:r,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zC="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",jq=(function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let r;const o=new Array(8);for(r=7;r>=0;r--)o[r]=zC.charAt(t%64),t=Math.floor(t/64);he(t===0,"Cannot push at time == 0");let c=o.join("");if(i){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)c+=zC.charAt(e[r]);return he(c.length===20,"nextPushId: Length should be 20."),c}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+vn(this.snapshot.exportVal())}}class Ok{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return he(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pk=class{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Ii;return xq(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){ws("OnDisconnect.remove",this._path);const e=new Ii;return BC(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){ws("OnDisconnect.set",this._path),Tr("OnDisconnect.set",e,this._path,!1);const t=new Ii;return BC(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){ws("OnDisconnect.setWithPriority",this._path),Tr("OnDisconnect.setWithPriority",e,this._path,!1),Vb("OnDisconnect.setWithPriority",t);const i=new Ii;return Cq(this._repo,this._path,e,t,i.wrapCallback(()=>{})),i.promise}update(e){ws("OnDisconnect.update",this._path),bk("OnDisconnect.update",e,this._path);const t=new Ii;return Rq(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return qe(this._path)?null:db(this._path)}get ref(){return new Ss(this._repo,this._path)}get _queryIdentifier(){const e=xC(this._queryParams),t=lb(e);return t==="{}"?"default":t}get _queryObject(){return xC(this._queryParams)}isEqual(e){if(e=ye(e),!(e instanceof ki))return!1;const t=this._repo===e._repo,i=fb(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+Rz(this._path)}}function j_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ho(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===gr){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Po)throw new Error(i);if(typeof e!="string")throw new Error(r)}if(n.hasEnd()){if(n.getIndexEndName()!==ua)throw new Error(i);if(typeof t!="string")throw new Error(r)}}else if(n.getIndex()===At){if(e!=null&&!Af(e)||t!=null&&!Af(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(he(n.getIndex()instanceof gb||n.getIndex()===_b,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function U_(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ss extends ki{constructor(e,t){super(e,t,new I_,!1)}get parent(){const e=KD(this._path);return e===null?null:new Ss(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let F_=class Ew{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new mt(e),i=Zl(this.ref,e);return new Ew(this._node.getChild(t),i,At)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new Ew(r,Zl(this.ref,i),At)))}hasChild(e){const t=new mt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function jl(n,e){return n=ye(n),n._checkNotDeleted("ref"),e!==void 0?Zl(n._root,e):n._root}function qC(n,e){n=ye(n),n._checkNotDeleted("refFromURL");const t=ww(e,n._repo.repoInfo_.nodeAdmin);Tk("refFromURL",t);const i=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&i.host!==n._repo.repoInfo_.host&&br("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+n._repo.repoInfo_.host+")"),jl(n,t.path.toString())}function Zl(n,e){return n=ye(n),ze(n._path)===null?_q("child","path",e):xf("child","path",e),new Ss(n._repo,Lt(n._path,e))}function GC(n){return n=ye(n),new Pk(n._repo,n._path)}function Uq(n,e){n=ye(n),ws("push",n._path),Tr("push",e,n._path,!0);const t=xk(n._repo),i=jq(t),r=Zl(n,i),o=Zl(n,i);let c;return e!=null?c=Gu(o,e).then(()=>o):c=Promise.resolve(o),r.then=c.then.bind(c),r.catch=c.then.bind(c,void 0),r}function Fq(n){return ws("remove",n._path),Gu(n,null)}function Gu(n,e){n=ye(n),ws("set",n._path),Tr("set",e,n._path,!1);const t=new Ii;return jb(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Bq(n,e){n=ye(n),ws("setPriority",n._path),Vb("setPriority",e);const t=new Ii;return jb(n._repo,Lt(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function zq(n,e,t){if(ws("setWithPriority",n._path),Tr("setWithPriority",e,n._path,!1),Vb("setWithPriority",t),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";const i=new Ii;return jb(n._repo,n._path,e,t,i.wrapCallback(()=>{})),i.promise}function qq(n,e){bk("update",e,n._path);const t=new Ii;return Sq(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function Mk(n){n=ye(n);const e=new Bb(()=>{}),t=new im(e);return Iq(n._repo,n,t).then(i=>new F_(i,new Ss(n._repo,n._path),n._queryParams.getIndex()))}class im{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new kk("value",this,new F_(e.snapshotNode,new Ss(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ok(this,e,t):null}matches(e){return e instanceof im?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class B_{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ok(this,e,t):null}createEvent(e,t){he(e.childName!=null,"Child events should have a childName.");const i=Zl(new Ss(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new kk(e.type,this,new F_(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof B_?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function sm(n,e,t,i,r){let o;if(typeof i=="object"&&(o=void 0,r=i),typeof i=="function"&&(o=i),r&&r.onlyOnce){const d=t,m=(_,y)=>{vw(n._repo,n,h),d(_,y)};m.userCallback=t.userCallback,m.context=t.context,t=m}const c=new Bb(t,o||void 0),h=e==="value"?new im(c):new B_(e,c);return Nq(n._repo,n,h),()=>vw(n._repo,n,h)}function Cf(n,e,t,i){return sm(n,"value",e,t,i)}function HC(n,e,t,i){return sm(n,"child_added",e,t,i)}function KC(n,e,t,i){return sm(n,"child_changed",e,t,i)}function $C(n,e,t,i){return sm(n,"child_moved",e,t,i)}function QC(n,e,t,i){return sm(n,"child_removed",e,t,i)}function WC(n,e,t){let i=null;const r=t?new Bb(t):null;e==="value"?i=new im(r):e&&(i=new B_(e,r)),vw(n._repo,n,i)}class Bs{}class Vk extends Bs{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Tr("endAt",this._value,e._path,!0);const t=cw(e._queryParams,this._value,this._key);if(U_(t),Ho(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ki(e._repo,e._path,t,e._orderByCalled)}}function Gq(n,e){return tm("endAt","key",e),new Vk(n,e)}class Hq extends Bs{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Tr("endBefore",this._value,e._path,!1);const t=t9(e._queryParams,this._value,this._key);if(U_(t),Ho(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ki(e._repo,e._path,t,e._orderByCalled)}}function Kq(n,e){return tm("endBefore","key",e),new Hq(n,e)}class Lk extends Bs{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Tr("startAt",this._value,e._path,!0);const t=lw(e._queryParams,this._value,this._key);if(U_(t),Ho(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ki(e._repo,e._path,t,e._orderByCalled)}}function $q(n=null,e){return tm("startAt","key",e),new Lk(n,e)}class Qq extends Bs{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Tr("startAfter",this._value,e._path,!1);const t=e9(e._queryParams,this._value,this._key);if(U_(t),Ho(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ki(e._repo,e._path,t,e._orderByCalled)}}function Wq(n,e){return tm("startAfter","key",e),new Qq(n,e)}class Yq extends Bs{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ki(e._repo,e._path,Jz(e._queryParams,this._limit),e._orderByCalled)}}function Xq(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Yq(n)}class Jq extends Bs{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ki(e._repo,e._path,Zz(e._queryParams,this._limit),e._orderByCalled)}}function Zq(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Jq(n)}class e8 extends Bs{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){j_(e,"orderByChild");const t=new mt(this._path);if(qe(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const i=new gb(t),r=S_(e._queryParams,i);return Ho(r),new ki(e._repo,e._path,r,!0)}}function t8(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return xf("orderByChild","path",n),new e8(n)}class n8 extends Bs{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){j_(e,"orderByKey");const t=S_(e._queryParams,gr);return Ho(t),new ki(e._repo,e._path,t,!0)}}function i8(){return new n8}class s8 extends Bs{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){j_(e,"orderByPriority");const t=S_(e._queryParams,At);return Ho(t),new ki(e._repo,e._path,t,!0)}}function r8(){return new s8}class a8 extends Bs{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){j_(e,"orderByValue");const t=S_(e._queryParams,_b);return Ho(t),new ki(e._repo,e._path,t,!0)}}function o8(){return new a8}class l8 extends Bs{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Tr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Vk(this._value,this._key)._apply(new Lk(this._value,this._key)._apply(e))}}function c8(n,e){return tm("equalTo","key",e),new l8(n,e)}function Ls(n,...e){let t=ye(n);for(const i of e)t=i._apply(t);return t}q9(Ss);Q9(Ss);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u8="FIREBASE_DATABASE_EMULATOR_HOST",bw={};let h8=!1;function d8(n,e,t,i){n.repoInfo_=new LD(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function jk(n,e,t,i,r){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||br("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Dn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c=ww(o,r),h=c.repoInfo,d,m;typeof process<"u"&&cC&&(m=cC[u8]),m?(d=!0,o=`http://${m}?ns=${h.namespace}`,c=ww(o,r),h=c.repoInfo):d=!c.repoInfo.secure;const _=r&&d?new yu(yu.OWNER):new iz(n.name,n.options,e);Tk("Invalid Firebase Database URL",c),qe(c.path)||br("Database URL must point to the root of a Firebase Database (not including a child path).");const y=m8(h,n,_,new nz(n.name,t));return new p8(y,n)}function f8(n,e){const t=bw[e];(!t||t[n.key]!==n)&&br(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Ck(n),delete t[n.key]}function m8(n,e,t,i){let r=bw[e.name];r||(r={},bw[e.name]=r);let o=r[n.toURLString()];return o&&br("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Eq(n,h8,t,i),r[n.toURLString()]=o,o}let p8=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(bq(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ss(this._repo,ut())),this._rootInternal}_delete(){return this._rootInternal!==null&&(f8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&br("Cannot call "+e+" on a deleted database.")}};function Uk(){Uu.IS_TRANSPORT_INITIALIZED&&Wn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function g8(){Uk(),uo.forceDisallow()}function _8(){Uk(),_s.forceDisallow(),uo.forceAllow()}function y8(n=Ug(),e){const t=Qu(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=v1("database");i&&Fk(t,...i)}return t}function Fk(n,e,t,i={}){n=ye(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&br("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let o;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&br('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new yu(yu.OWNER);else if(i.mockUserToken){const c=typeof i.mockUserToken=="string"?i.mockUserToken:b1(i.mockUserToken,n.app.options.projectId);o=new yu(c)}d8(r,e,t,o)}function v8(n){n=ye(n),n._checkNotDeleted("goOffline"),Ck(n._repo)}function w8(n){n=ye(n),n._checkNotDeleted("goOnline"),Dq(n._repo)}function E8(n,e){SD(n,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b8(n){ED(ha),aa(new Ni("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return jk(i,r,o,t)},"PUBLIC").setMultipleInstances(!0)),Zi(uC,hC,n),Zi(uC,hC,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8={".sv":"timestamp"};function uu(){return T8}function I8(n){return{".sv":{increment:n}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let S8=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function A8(n,e,t){var i;if(n=ye(n),ws("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";const r=(i=t==null?void 0:t.applyLocally)!==null&&i!==void 0?i:!0,o=new Ii,c=(d,m,_)=>{let y=null;d?o.reject(d):(y=new F_(_,new Ss(n._repo,n._path),At),o.resolve(new S8(m,y)))},h=Cf(n,()=>{});return kq(n._repo,n._path,e,c,h,r),o.promise}sa.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};sa.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};b8();const x8="@firebase/database-compat",C8="1.0.8";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R8=new $u("@firebase/database-compat"),Bk=function(n){const e="FIREBASE WARNING: "+n;R8.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N8=function(n,e,t,i){if(t!==void 0&&typeof t!="boolean")throw new Error(Ri(n,e)+"must be a boolean.")},D8=function(n,e,t){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Ri(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k8{constructor(e){this._delegate=e}cancel(e){Ne("OnDisconnect.cancel",0,1,arguments.length),Cn("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),i=>e(i)),t}remove(e){Ne("OnDisconnect.remove",0,1,arguments.length),Cn("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),i=>e(i)),t}set(e,t){Ne("OnDisconnect.set",1,2,arguments.length),Cn("OnDisconnect.set","onComplete",t,!0);const i=this._delegate.set(e);return t&&i.then(()=>t(null),r=>t(r)),i}setWithPriority(e,t,i){Ne("OnDisconnect.setWithPriority",2,3,arguments.length),Cn("OnDisconnect.setWithPriority","onComplete",i,!0);const r=this._delegate.setWithPriority(e,t);return i&&r.then(()=>i(null),o=>i(o)),r}update(e,t){if(Ne("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let o=0;o<e.length;++o)r[""+o]=e[o];e=r,Bk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Cn("OnDisconnect.update","onComplete",t,!0);const i=this._delegate.update(e);return t&&i.then(()=>t(null),r=>t(r)),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O8{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Ne("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,t){this._database=e,this._delegate=t}val(){return Ne("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Ne("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Ne("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Ne("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Ne("DataSnapshot.child",0,1,arguments.length),e=String(e),xf("DataSnapshot.child","path",e),new wo(this._database,this._delegate.child(e))}hasChild(e){return Ne("DataSnapshot.hasChild",1,1,arguments.length),xf("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return Ne("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Ne("DataSnapshot.forEach",1,1,arguments.length),Cn("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new wo(this._database,t)))}hasChildren(){return Ne("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Ne("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Ne("DataSnapshot.ref",0,0,arguments.length),new Qi(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Fn{constructor(e,t){this.database=e,this._delegate=t}on(e,t,i,r){var o;Ne("Query.on",2,4,arguments.length),Cn("Query.on","callback",t,!1);const c=Fn.getCancelAndContextArgs_("Query.on",i,r),h=(m,_)=>{t.call(c.context,new wo(this.database,m),_)};h.userCallback=t,h.context=c.context;const d=(o=c.cancel)===null||o===void 0?void 0:o.bind(c.context);switch(e){case"value":return Cf(this._delegate,h,d),t;case"child_added":return HC(this._delegate,h,d),t;case"child_removed":return QC(this._delegate,h,d),t;case"child_changed":return KC(this._delegate,h,d),t;case"child_moved":return $C(this._delegate,h,d),t;default:throw new Error(Ri("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,i){if(Ne("Query.off",0,3,arguments.length),D8("Query.off",e),Cn("Query.off","callback",t,!0),wA("Query.off","context",i),t){const r=()=>{};r.userCallback=t,r.context=i,WC(this._delegate,e,r)}else WC(this._delegate,e)}get(){return Mk(this._delegate).then(e=>new wo(this.database,e))}once(e,t,i,r){Ne("Query.once",1,4,arguments.length),Cn("Query.once","callback",t,!0);const o=Fn.getCancelAndContextArgs_("Query.once",i,r),c=new Ii,h=(m,_)=>{const y=new wo(this.database,m);t&&t.call(o.context,y,_),c.resolve(y)};h.userCallback=t,h.context=o.context;const d=m=>{o.cancel&&o.cancel.call(o.context,m),c.reject(m)};switch(e){case"value":Cf(this._delegate,h,d,{onlyOnce:!0});break;case"child_added":HC(this._delegate,h,d,{onlyOnce:!0});break;case"child_removed":QC(this._delegate,h,d,{onlyOnce:!0});break;case"child_changed":KC(this._delegate,h,d,{onlyOnce:!0});break;case"child_moved":$C(this._delegate,h,d,{onlyOnce:!0});break;default:throw new Error(Ri("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return Ne("Query.limitToFirst",1,1,arguments.length),new Fn(this.database,Ls(this._delegate,Xq(e)))}limitToLast(e){return Ne("Query.limitToLast",1,1,arguments.length),new Fn(this.database,Ls(this._delegate,Zq(e)))}orderByChild(e){return Ne("Query.orderByChild",1,1,arguments.length),new Fn(this.database,Ls(this._delegate,t8(e)))}orderByKey(){return Ne("Query.orderByKey",0,0,arguments.length),new Fn(this.database,Ls(this._delegate,i8()))}orderByPriority(){return Ne("Query.orderByPriority",0,0,arguments.length),new Fn(this.database,Ls(this._delegate,r8()))}orderByValue(){return Ne("Query.orderByValue",0,0,arguments.length),new Fn(this.database,Ls(this._delegate,o8()))}startAt(e=null,t){return Ne("Query.startAt",0,2,arguments.length),new Fn(this.database,Ls(this._delegate,$q(e,t)))}startAfter(e=null,t){return Ne("Query.startAfter",0,2,arguments.length),new Fn(this.database,Ls(this._delegate,Wq(e,t)))}endAt(e=null,t){return Ne("Query.endAt",0,2,arguments.length),new Fn(this.database,Ls(this._delegate,Gq(e,t)))}endBefore(e=null,t){return Ne("Query.endBefore",0,2,arguments.length),new Fn(this.database,Ls(this._delegate,Kq(e,t)))}equalTo(e,t){return Ne("Query.equalTo",1,2,arguments.length),new Fn(this.database,Ls(this._delegate,c8(e,t)))}toString(){return Ne("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Ne("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Ne("Query.isEqual",1,1,arguments.length),!(e instanceof Fn)){const t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,i){const r={cancel:void 0,context:void 0};if(t&&i)r.cancel=t,Cn(e,"cancel",r.cancel,!0),r.context=i,wA(e,"context",r.context);else if(t)if(typeof t=="object"&&t!==null)r.context=t;else if(typeof t=="function")r.cancel=t;else throw new Error(Ri(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return r}get ref(){return new Qi(this.database,new Ss(this._delegate._repo,this._delegate._path))}}class Qi extends Fn{constructor(e,t){super(e,new ki(t._repo,t._path,new I_,!1)),this.database=e,this._delegate=t}getKey(){return Ne("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Ne("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Qi(this.database,Zl(this._delegate,e))}getParent(){Ne("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Qi(this.database,e):null}getRoot(){return Ne("Reference.root",0,0,arguments.length),new Qi(this.database,this._delegate.root)}set(e,t){Ne("Reference.set",1,2,arguments.length),Cn("Reference.set","onComplete",t,!0);const i=Gu(this._delegate,e);return t&&i.then(()=>t(null),r=>t(r)),i}update(e,t){if(Ne("Reference.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let o=0;o<e.length;++o)r[""+o]=e[o];e=r,Bk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ws("Reference.update",this._delegate._path),Cn("Reference.update","onComplete",t,!0);const i=qq(this._delegate,e);return t&&i.then(()=>t(null),r=>t(r)),i}setWithPriority(e,t,i){Ne("Reference.setWithPriority",2,3,arguments.length),Cn("Reference.setWithPriority","onComplete",i,!0);const r=zq(this._delegate,e,t);return i&&r.then(()=>i(null),o=>i(o)),r}remove(e){Ne("Reference.remove",0,1,arguments.length),Cn("Reference.remove","onComplete",e,!0);const t=Fq(this._delegate);return e&&t.then(()=>e(null),i=>e(i)),t}transaction(e,t,i){Ne("Reference.transaction",1,3,arguments.length),Cn("Reference.transaction","transactionUpdate",e,!1),Cn("Reference.transaction","onComplete",t,!0),N8("Reference.transaction","applyLocally",i);const r=A8(this._delegate,e,{applyLocally:i}).then(o=>new O8(o.committed,new wo(this.database,o.snapshot)));return t&&r.then(o=>t(null,o.committed,o.snapshot),o=>t(o,!1,null)),r}setPriority(e,t){Ne("Reference.setPriority",1,2,arguments.length),Cn("Reference.setPriority","onComplete",t,!0);const i=Bq(this._delegate,e);return t&&i.then(()=>t(null),r=>t(r)),i}push(e,t){Ne("Reference.push",0,2,arguments.length),Cn("Reference.push","onComplete",t,!0);const i=Uq(this._delegate,e),r=i.then(c=>new Qi(this.database,c));t&&r.then(()=>t(null),c=>t(c));const o=new Qi(this.database,i);return o.then=r.then.bind(r),o.catch=r.catch.bind(r,void 0),o}onDisconnect(){return ws("Reference.onDisconnect",this._delegate._path),new k8(new Pk(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:g8,forceLongPolling:_8}}useEmulator(e,t,i={}){Fk(this._delegate,e,t,i)}ref(e){if(Ne("database.ref",0,1,arguments.length),e instanceof Qi){const t=qC(this._delegate,e.toString());return new Qi(this,t)}else{const t=jl(this._delegate,e);return new Qi(this,t)}}refFromURL(e){Ne("database.refFromURL",1,1,arguments.length);const i=qC(this._delegate,e);return new Qi(this,i)}goOffline(){return Ne("database.goOffline",0,0,arguments.length),v8(this._delegate)}goOnline(){return Ne("database.goOnline",0,0,arguments.length),w8(this._delegate)}}Rf.ServerValue={TIMESTAMP:uu(),increment:n=>I8(n)};function P8({app:n,url:e,version:t,customAuthImpl:i,customAppCheckImpl:r,namespace:o,nodeAdmin:c=!1}){ED(t);const h=new Pw("database-standalone"),d=new E0("auth-internal",h);d.setComponent(new Ni("auth-internal",()=>i,"PRIVATE"));let m;return r&&(m=new E0("app-check-internal",h),m.setComponent(new Ni("app-check-internal",()=>r,"PRIVATE"))),{instance:new Rf(jk(n,d,m,e,c),n),namespace:o}}var M8=Object.freeze({__proto__:null,initStandalone:P8});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V8=Rf.ServerValue;function L8(n){n.INTERNAL.registerComponent(new Ni("database-compat",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:t});return new Rf(r,i)},"PUBLIC").setServiceProps({Reference:Qi,Query:Fn,Database:Rf,DataSnapshot:wo,enableLogging:E8,INTERNAL:M8,ServerValue:V8}).setMultipleInstances(!0)),n.registerVersion(x8,C8)}L8(nc);const j8={apiKey:"AIzaSyDCmIQ9Kly6RWPz89D5bsAIyk9wKmWDjZc",authDomain:"caro-ai-arena.firebaseapp.com",databaseURL:"https://caro-ai-arena-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"caro-ai-arena",storageBucket:"caro-ai-arena.firebasestorage.app",messagingSenderId:"316000837643",appId:"1:316000837643:web:805db8f084712d9cabe70e",measurementId:"G-86DC259ZW2"},zb=nc.initializeApp(j8),zd=Jj(zb),st=eB(zb),qd=y8(zb),U8=Eo.filter(n=>n.type==="emoji"&&n.price===0).map(n=>n.id),F8=n=>{const e={};for(let t=0;t<n.length;t++)for(let i=0;i<n[t].length;i++)n[t][i]&&(e[`${t}_${i}`]=n[t][i]);return e},Tw=n=>{const e=Array(it).fill(null).map(()=>Array(it).fill(null));for(const t in n){const[i,r]=t.split("_").map(Number);e[i][r]=n[t]}return e},B8=(n,e)=>{for(let t=0;t<it;t++)for(let i=0;i<it;i++)if(n[t][i]===null&&e[t][i]!==null)return{row:t,col:i};return null},z8=(n,e)=>{const t=[{r:0,c:1},{r:1,c:0},{r:1,c:1},{r:1,c:-1}];for(let i=0;i<it;i++)for(let r=0;r<it;r++)if(n[i][r]===e)for(const o of t){const c=[];for(let h=0;h<si;h++){const d=i+h*o.r,m=r+h*o.c;if(d>=0&&d<it&&m>=0&&m<it&&n[d][m]===e)c.push({row:d,col:m});else break}if(c.length===si)return c}return null},q8=(n,e)=>{const t=new Set(n.filter(i=>i.startsWith("emoji_")));for(const i in e)e[i]>0&&t.add(i);return Pg.filter(i=>t.has(i.id))},G8=()=>{const n=Pg.filter(e=>!["😠","😭","💀","🤡"].includes(e.emoji));return n[Math.floor(Math.random()*n.length)]},zk=async(n,e)=>{const t=rt(st,"users",n.uid),i={uid:n.uid,name:e,email:n.email,isAnonymous:n.isAnonymous,level:1,xp:0,coins:500,cp:0,onlineWins:0,onlineLosses:0,onlineDraws:0,pveWins:0,pveLosses:0,pveDraws:0,ownedCosmeticIds:[Es.id,kn.id,oi.id,Yi.id,Xi.id,Ji.id,...U8],emojiInventory:{},activeThemeId:Es.id,activePieceId:kn.id,activeAvatarId:oi.id,activeEffectId:Yi.id,activeVictoryEffectId:Xi.id,activeBoomEffectId:Ji.id};await Oo(t,i)},Iw=async n=>{const e=rt(st,"users",n),t=await _a(e);return t.exists()?t.data():null},qk=async(n,e)=>{const t=rt(st,"users",n);await Oo(t,e,{merge:!0})},H8=async(n,e)=>{await Kg(n,{displayName:e}),await qk(n.uid,{name:e});const t=rt(st,"onlineUsers",n.uid);try{(await _a(t)).exists()&&await Is(t,{name:e})}catch{console.warn("Could not update online user name, document may not exist yet.")}},YC=async(n,e,t,i)=>{const r=n.uid,o=jl(qd,`/status/${r}`),c=rt(st,"onlineUsers",r),h=await _a(c),d=h.exists()?h.data().status:"idle";if(d==="in_game"||d==="in_queue"){Cf(jl(qd,".info/connected"),y=>{y.val()!==!1&&GC(o).set({state:"offline",last_changed:uu()}).then(()=>{Gu(o,{state:"online",last_changed:uu()})})}),console.log(`Presence system: User is '${d}'. Preserving status.`);return}const m={state:"online",last_changed:uu()},_={state:"offline",last_changed:uu()};Cf(jl(qd,".info/connected"),y=>{y.val()!==!1&&GC(o).set(_).then(async()=>{await Gu(o,m),await Oo(c,{uid:r,name:i,level:e,avatarUrl:t,status:"idle"}),console.log("Presence system: User status set to 'idle'.")})})},K8=async n=>{const e=rt(st,"onlineUsers",n);try{await w_(e)}catch(i){console.error("Error deleting online user doc:",i)}const t=jl(qd,`/status/${n}`);await Gu(t,{state:"offline",last_changed:uu()})},$8=n=>{const e=rr(d_(st,"onlineUsers"));return ah(e,async t=>{const i=t.docs.map(d=>d.data()),r=jl(qd,"status"),o=await Mk(r);if(!o.exists()){console.warn("Could not fetch RTDB user statuses for liveness check. Displaying all users from Firestore. Some may be stale."),n(i);return}const c=o.val()||{},h=i.filter(d=>{const m=c[d.uid];return m&&m.state==="online"});n(h)})},Gk=async n=>{const e=rt(st,"onlineUsers",n),t=await _a(e);return t.exists()?t.data():null},Q8=async n=>{const e=rr(d_(st,"matchmakingQueue"),nD("uid","!=",n.uid),iD(1)),t=await hD(e);if(t.empty)return await Oo(rt(st,"matchmakingQueue",n.uid),{uid:n.uid,joinedAt:fD()}),await Is(rt(st,"onlineUsers",n.uid),{status:"in_queue"}),null;{const r=t.docs[0].id,o=await Hk(n.uid,r),c=mD(st);return c.delete(rt(st,"matchmakingQueue",r)),c.update(rt(st,"onlineUsers",n.uid),{status:"in_game",gameId:o}),c.update(rt(st,"onlineUsers",r),{status:"in_game",gameId:o}),await c.commit(),o}},W8=async n=>{await w_(rt(st,"matchmakingQueue",n)),await Is(rt(st,"onlineUsers",n),{status:"idle"})},Y8=async(n,e)=>{const t=rt(st,"invitations",e);await Oo(t,{from:n.uid,fromName:n.displayName||"Player",timestamp:Date.now()})},X8=(n,e)=>ah(rt(st,"invitations",n),t=>{e(t.exists()?t.data():null)}),J8=async(n,e)=>{const t=await Hk(n.uid,e.from),i=mD(st);return i.update(rt(st,"onlineUsers",n.uid),{status:"in_game",gameId:t}),i.update(rt(st,"onlineUsers",e.from),{status:"in_game",gameId:t}),i.delete(rt(st,"invitations",n.uid)),await i.commit(),t},Z8=async n=>{await w_(rt(st,"invitations",n))},Hk=async(n,e)=>{var h,d;const t=`game_${Date.now()}_${Math.random().toString(36).substring(2,7)}`,i=rt(st,"games",t),[r,o]=await Promise.all([Iw(n),Iw(e)]),c={id:t,players:{X:n,O:e},playerDetails:{[n]:{name:(r==null?void 0:r.name)||"Player 1",avatarUrl:(r!=null&&r.activeAvatarId?(h=Eo.find(m=>m.id===r.activeAvatarId))==null?void 0:h.item:oi).url,level:(r==null?void 0:r.level)||1,pieceId:(r==null?void 0:r.activePieceId)||kn.id,cp:(r==null?void 0:r.cp)||0},[e]:{name:(o==null?void 0:o.name)||"Player 2",avatarUrl:(o!=null&&o.activeAvatarId?(d=Eo.find(m=>m.id===o.activeAvatarId))==null?void 0:d.item:oi).url,level:(o==null?void 0:o.level)||1,pieceId:(o==null?void 0:o.activePieceId)||kn.id,cp:(o==null?void 0:o.cp)||0}},board:{},currentPlayer:"X",status:"in_progress",winner:null,winningLine:null,createdAt:Date.now(),updatedAt:Date.now(),playerTimes:{X:vu,O:vu},turnStartedAt:Date.now()};return await Oo(i,c),t},e7=async(n,e,t)=>{const i=rt(st,"games",n);try{await Is(i,{emotes:{uid:e,emoji:t,timestamp:Date.now()}})}catch(r){console.error("Failed to send emote:",r)}},t7=async n=>{const e=rt(st,"games",n),t=await _a(e);return t.exists()?t.data():null},Kk=(n,e)=>ah(rt(st,"onlineUsers",n),t=>{e(t.exists()?t.data():null)}),n7=(n,e)=>ah(rt(st,"games",n),t=>{e(t.exists()?t.data():null)}),i7=async(n,e,t,i)=>{const r=rt(st,"games",n),o=await _a(r);if(!o.exists())return;const c=o.data();if(c.status!=="in_progress"||c.currentPlayer!==i)return;const h=Tw(c.board);if(h[e][t]!==null)return;h[e][t]=i;const d=Math.round((Date.now()-c.turnStartedAt)/1e3),m={...c.playerTimes};if(m[i]=Math.max(0,m[i]-d),m[i]===0){await Is(r,{playerTimes:m,status:"finished",winner:i==="X"?"O":"X"});return}const _=z8(h,i),y=h.every(I=>I.every(C=>C!==null))&&!_,b={board:F8(h),currentPlayer:i==="X"?"O":"X",updatedAt:Date.now(),status:_||y?"finished":"in_progress",winner:_?i:y?"draw":null,winningLine:_||null,playerTimes:m,turnStartedAt:Date.now()};await Is(r,b)},s7=async(n,e)=>{const t=rt(st,"games",n);try{const i=await _a(t);if(!i.exists())return;const r=i.data();r.status==="in_progress"&&r.currentPlayer!==e&&(Date.now()-r.turnStartedAt)/1e3>fo+2&&(console.log(`Player ${e} is claiming a timeout victory.`),await Is(t,{status:"finished",winner:e}))}catch(i){console.error("Error claiming timeout victory:",i)}},r7=async(n,e,t)=>{const i=rt(st,"games",n);try{await Is(i,{[`playerDetails.${e}.pieceId`]:t})}catch(r){console.log("Could not update piece skin (game may be over):",r)}},a7=async(n,e)=>{const t=rt(st,"games",n);await Is(t,{status:"finished",winner:e==="X"?"O":"X"})},$k=async n=>{const e=rt(st,"onlineUsers",n);try{(await _a(e)).exists()&&await Is(e,{status:"idle",gameId:null})}catch(t){console.error("Failed to return user to lobby:",t)}},Qk=K.createContext(void 0),o7=({children:n})=>{const[e,t]=K.useState(null),[i,r]=K.useState(!0);K.useEffect(()=>{const h=g5(zd,d=>{t(d),r(!1)});return()=>h()},[]);const c={user:e,loading:i,logOut:async()=>{e&&await K8(e.uid),await zd.signOut()}};return v.jsx(Qk.Provider,{value:c,children:!i&&n})},dh=()=>{const n=K.useContext(Qk);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},Wk=Eo.filter(n=>n.type==="emoji"&&n.price===0).map(n=>n.id),Yk="caroGameState_v9_guest",Xk=K.createContext(void 0),El=n=>{if(!n)return null;const{component:e,previewComponent:t,decoratorComponent:i,...r}=n;return r},XC=()=>({coins:500,cp:0,playerName:`Player_${Math.floor(1e3+Math.random()*9e3)}`,pveWins:0,pveLosses:0,pveDraws:0,onlineWins:0,onlineLosses:0,onlineDraws:0,playerLevel:1,playerXp:0,ownedCosmeticIds:[Es.id,kn.id,Hd.id,oi.id,Yi.id,Xi.id,Ji.id,...Wk],emojiInventory:{},botStats:{},activeTheme:Es,activePieceX:kn,activePieceO:Hd,activeAvatar:oi,activeEffect:Yi,activeVictoryEffect:Xi,activeBoomEffect:Ji,isSoundOn:!0,isMusicOn:!0,soundVolume:1,musicVolume:1,activeMusicUrl:f1[0].url,lastProcessedGameId:null}),JC=()=>{try{const n=localStorage.getItem(Yk);if(n){const e=JSON.parse(n),t=[kn,Hd,...mo],i=[oi,...Og],r=[Yi,...Mg],o=[Xi,...Kd],c=[Ji,...$d],h=kg.find(B=>{var j;return B.id===((j=e.activeTheme)==null?void 0:j.id)})||Es,d=t.find(B=>{var j;return B.id===((j=e.activePieceX)==null?void 0:j.id)})||kn,m=t.find(B=>{var j;return B.id===((j=e.activePieceO)==null?void 0:j.id)})||Hd,_=i.find(B=>{var j;return B.id===((j=e.activeAvatar)==null?void 0:j.id)})||oi,y=r.find(B=>{var j;return B.id===((j=e.activeEffect)==null?void 0:j.id)})||Yi,b=o.find(B=>{var j;return B.id===((j=e.activeVictoryEffect)==null?void 0:j.id)})||Xi,I=c.find(B=>{var j;return B.id===((j=e.activeBoomEffect)==null?void 0:j.id)})||Ji,C=e.pveWins??e.wins??0,M=e.pveLosses??e.losses??0,z=e.pveDraws??e.draws??0;return{...XC(),...e,pveWins:C,pveLosses:M,pveDraws:z,onlineWins:e.onlineWins??0,onlineLosses:e.onlineLosses??0,onlineDraws:e.onlineDraws??0,cp:e.cp??0,activeTheme:h,activePieceX:d,activePieceO:m,activeAvatar:_,activeEffect:y,activeVictoryEffect:b,activeBoomEffect:I}}}catch(n){console.error("Failed to parse guest state",n)}return XC()},l7=({children:n})=>{const{user:e}=dh(),[t,i]=K.useState(JC),[r,o]=K.useState(!1);K.useEffect(()=>{(async()=>{if(!e){o(!1),i(JC());return}o(!1);const j=await Iw(e.uid);if(j){const X=kg.find(R=>R.id===j.activeThemeId)||Es,fe=mo.find(R=>R.id===j.activePieceId)||kn,F=Og.find(R=>R.id===j.activeAvatarId)||oi,ae=Mg.find(R=>R.id===j.activeEffectId)||Yi,D=Kd.find(R=>R.id===j.activeVictoryEffectId)||Xi,x=$d.find(R=>R.id===j.activeBoomEffectId)||Ji;i(R=>({...R,playerName:j.name,coins:j.coins,cp:j.cp??0,onlineWins:j.onlineWins,onlineLosses:j.onlineLosses,onlineDraws:j.onlineDraws,pveWins:j.pveWins,pveLosses:j.pveLosses,pveDraws:j.pveDraws,playerLevel:j.level,xp:j.xp,ownedCosmeticIds:j.ownedCosmeticIds,emojiInventory:j.emojiInventory,activeTheme:X,activePieceX:fe,activePieceO:fe,activeAvatar:F,activeEffect:ae,activeVictoryEffect:D,activeBoomEffect:x})),await YC(e,j.level,F.url,j.name)}else{const X=t.playerName;zk(e,X),Kg(e,{displayName:X}),await YC(e,t.playerLevel,t.activeAvatar.url,X)}o(!0)})()},[e]),K.useEffect(()=>{if(e){if(!r)return;const B={name:t.playerName,coins:t.coins,cp:t.cp,onlineWins:t.onlineWins,onlineLosses:t.onlineLosses,onlineDraws:t.onlineDraws,pveWins:t.pveWins,pveLosses:t.pveLosses,pveDraws:t.pveDraws,level:t.playerLevel,xp:t.playerXp,ownedCosmeticIds:t.ownedCosmeticIds,emojiInventory:t.emojiInventory,activeThemeId:t.activeTheme.id,activePieceId:t.activePieceX.id,activeAvatarId:t.activeAvatar.id,activeEffectId:t.activeEffect.id,activeVictoryEffectId:t.activeVictoryEffect.id,activeBoomEffectId:t.activeBoomEffect.id};qk(e.uid,B)}else try{const B={...t,activeTheme:El(t.activeTheme),activePieceX:El(t.activePieceX),activePieceO:El(t.activePieceO),activeAvatar:El(t.activeAvatar),activeEffect:El(t.activeEffect),activeVictoryEffect:El(t.activeVictoryEffect),activeBoomEffect:El(t.activeBoomEffect)};localStorage.setItem(Yk,JSON.stringify(B))}catch(B){console.error("Failed to save guest state",B)}},[t,e,r]);const c=K.useCallback(B=>{e&&H8(e,B),i(j=>({...j,playerName:B}))},[e]),h=K.useCallback(B=>t.coins<B?!1:(i(j=>({...j,coins:j.coins-B})),!0),[t.coins]),d=K.useCallback((B,j,X,fe=0)=>{i(F=>{if(X&&F.lastProcessedGameId===X)return F;const ae=d1[B],D=h1[B];let x=F.playerXp+ae,R=F.playerLevel,V=ar(R);for(;x>=V;)x-=V,R++,V=ar(R);const L=j.startsWith("bot_"),P={...F.botStats};return L&&(P[j]||(P[j]={wins:0,losses:0,draws:0}),B==="win"?P[j].wins++:B==="draw"?P[j].draws++:P[j].losses++),{...F,coins:F.coins+D,playerXp:x,playerLevel:R,pveWins:L&&B==="win"?F.pveWins+1:F.pveWins,pveLosses:L&&B==="loss"?F.pveLosses+1:F.pveLosses,pveDraws:L&&B==="draw"?F.pveDraws+1:F.pveDraws,onlineWins:!L&&B==="win"?F.onlineWins+1:F.onlineWins,onlineLosses:!L&&B==="loss"?F.onlineLosses+1:F.onlineLosses,onlineDraws:!L&&B==="draw"?F.onlineDraws+1:F.onlineDraws,cp:L?F.cp:Math.max(0,F.cp+fe),botStats:P,lastProcessedGameId:X||F.lastProcessedGameId}})},[]),m=K.useCallback(B=>{Wk.includes(B)||i(j=>{const X={...j.emojiInventory};return X[B]>0&&(X[B]-=1,X[B]===0&&delete X[B]),{...j,emojiInventory:X}})},[]),_=K.useCallback((B,j)=>{t.ownedCosmeticIds.includes(j.id)&&i(X=>{switch(B){case"theme":return{...X,activeTheme:j};case"piece":return{...X,activePieceX:j,activePieceO:j};case"avatar":return{...X,activeAvatar:j};case"effect":return{...X,activeEffect:j};case"victory":return{...X,activeVictoryEffect:j};case"boom":return{...X,activeBoomEffect:j};default:return X}})},[t.ownedCosmeticIds]),y=K.useCallback(B=>t.coins<B.price?!1:B.type==="emoji"&&B.price>0?(i(j=>{const X={...j.emojiInventory};return X[B.id]=(X[B.id]||0)+1,{...j,coins:j.coins-B.price,emojiInventory:X}}),!0):t.ownedCosmeticIds.includes(B.id)?!1:(i(j=>({...j,coins:j.coins-B.price,ownedCosmeticIds:[...j.ownedCosmeticIds,B.id]})),_(B.type,B.item),!0),[t.coins,t.ownedCosmeticIds,t.emojiInventory,_]),b=K.useCallback(()=>i(B=>({...B,isSoundOn:!B.isSoundOn})),[]),I=K.useCallback(()=>i(B=>({...B,isMusicOn:!B.isMusicOn})),[]),C=K.useCallback(B=>i(j=>({...j,soundVolume:B})),[]),M=K.useCallback(B=>i(j=>({...j,musicVolume:B})),[]),z=K.useCallback(B=>i(j=>({...j,activeMusicUrl:B})),[]);return v.jsx(Xk.Provider,{value:{gameState:t,setPlayerName:c,applyGameResult:d,spendCoins:h,purchaseCosmetic:y,consumeEmoji:m,equipTheme:B=>_("theme",B),equipPiece:B=>_("piece",B),equipAvatar:B=>_("avatar",B),equipEffect:B=>_("effect",B),equipVictoryEffect:B=>_("victory",B),equipBoomEffect:B=>_("boom",B),toggleSound:b,toggleMusic:I,setSoundVolume:C,setMusicVolume:M,equipMusic:z},children:n})},ya=()=>{const n=K.useContext(Xk);if(!n)throw new Error("useGameState must be used within a GameStateProvider");return n},Hu=({isOpen:n,onClose:e,title:t,children:i,hideCloseButton:r=!1,size:o="sm"})=>{if(!n)return null;const c={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg"};return v.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50 transition-opacity duration-300",onClick:e,children:[v.jsxs("div",{className:`bg-[#1e293b] rounded-2xl shadow-2xl p-6 m-4 w-full ${c[o]} border border-slate-700 transform transition-transform duration-300 scale-95 animate-scale-in`,onClick:h=>h.stopPropagation(),children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-3xl font-bold text-cyan-400",children:t}),!r&&e&&v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors","aria-label":"Close modal",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),v.jsx("div",{children:i})]}),v.jsx("style",{children:`
        @keyframes scale-in {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .animate-scale-in {
            animation: scale-in 0.3s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
        }
      `})]})},ZC={move:"assets/sounds/move.mp3",win:"assets/sounds/win.mp3",lose:"assets/sounds/lose.mp3",click:"assets/sounds/click.mp3",announce_win:"assets/sounds/announce_win.mp3",announce_lose:"assets/sounds/announce_lose.mp3",check:"assets/sounds/check.mp3",first_move_player:"assets/sounds/first_move_player.mp3",first_move_ai:"assets/sounds/first_move_ai.mp3",deciding:"assets/sounds/deciding.mp3",boom:"assets/sounds/boom.mp3",select:"assets/sounds/select.mp3",confirm:"assets/sounds/confirm.mp3",summary:"assets/sounds/summary.mp3"},g0=new Map,e1=(n,e=!1)=>{if(g0.has(n))return g0.get(n);const t=new Audio(n);return t.loop=e,g0.set(n,t),t},t1=(n,e,t)=>{n!==void 0&&n.catch(i=>{i.name==="NotAllowedError"?console.warn("Music playback was prevented because the user hasn't interacted with the page yet. It will start automatically after the first user action."):i.name==="NotSupportedError"?console.warn(`Audio file for "${e}" not found or format not supported. Please add the file to the path: ${t}. See README.md for instructions.`):console.error(`Sound play failed for ${e}:`,i)})},Ir=()=>{const{gameState:n}=ya(),e=K.useRef(null),t=K.useCallback(o=>{if(n.isSoundOn)try{const c=e1(ZC[o]);c.currentTime=0;const h=o==="click"||o==="move"||o==="select"?.7:1;c.volume=n.soundVolume*h;const d=c.play();t1(d,o,ZC[o])}catch(c){console.error(`Could not play sound ${o}:`,c)}},[n.isSoundOn,n.soundVolume]),i=K.useCallback(()=>{if(n.isMusicOn)try{const o=new URL(n.activeMusicUrl,window.location.origin).href;(!e.current||e.current.src!==o)&&(e.current&&e.current.pause(),e.current=e1(n.activeMusicUrl,!0)),e.current.volume=n.musicVolume;const c=e.current.play();t1(c,"music",n.activeMusicUrl)}catch(o){console.error("Could not play music:",o)}},[n.isMusicOn,n.activeMusicUrl,n.musicVolume]),r=K.useCallback(()=>{e.current&&(e.current.pause(),e.current.currentTime=0)},[]);return K.useEffect(()=>{e.current&&(e.current.volume=n.musicVolume)},[n.musicVolume]),K.useEffect(()=>{n.isMusicOn||r()},[n.isMusicOn,r]),K.useEffect(()=>{const o=()=>{document.hidden?e.current&&e.current.pause():n.isMusicOn&&i()};return document.addEventListener("visibilitychange",o),()=>{document.removeEventListener("visibilitychange",o)}},[i,n.isMusicOn]),{playSound:t,playMusic:i,stopMusic:r}},c7=({isOpen:n,onClose:e,onConfirm:t,playSound:i})=>v.jsx(Hu,{isOpen:n,onClose:e,title:"Confirm Undo",children:v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Undoing your last move will cost ",v.jsx("strong",{className:"text-yellow-400",children:"20 💰"}),". Are you sure?"]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>{i("select"),e()},className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:t,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors animate-confirm-glow",children:"Confirm"})]})]})}),qb=({isOpen:n,onClose:e,onOpenShop:t,onOpenInventory:i,onResign:r,onLogOut:o})=>{const{gameState:c,toggleSound:h,toggleMusic:d,setSoundVolume:m,setMusicVolume:_,equipMusic:y}=ya(),{playSound:b}=Ir(),[I,C]=K.useState(!1),M=j=>{b("select"),y(j)},z=()=>{b("select"),C(!0)},B=()=>{o&&o(),C(!1)};return v.jsxs(v.Fragment,{children:[v.jsxs(Hu,{isOpen:n,onClose:e,title:"Settings",children:[v.jsxs("div",{className:"space-y-4 text-white",children:[v.jsxs("div",{className:"rounded-lg overflow-hidden border border-slate-700 divide-y divide-slate-700",children:[v.jsxs("div",{className:"flex justify-between items-center px-4 py-3 hover:bg-slate-700/50 transition-colors",children:[v.jsx("span",{className:"font-semibold",children:"Sound"}),v.jsx("div",{className:"flex-grow flex items-center gap-4 mx-4",children:v.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:c.soundVolume,onChange:j=>m(Number(j.target.value)),disabled:!c.isSoundOn,className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"})}),v.jsx("button",{onClick:()=>{b("select"),h()},className:`font-bold w-12 text-center ${c.isSoundOn?"text-cyan-400":"text-slate-500"}`,children:c.isSoundOn?"ON":"OFF"})]}),v.jsxs("div",{className:"flex justify-between items-center px-4 py-3 hover:bg-slate-700/50 transition-colors",children:[v.jsx("span",{className:"font-semibold",children:"Music"}),v.jsx("div",{className:"flex-grow flex items-center gap-4 mx-4",children:v.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:c.musicVolume,onChange:j=>_(Number(j.target.value)),disabled:!c.isMusicOn,className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"})}),v.jsx("button",{onClick:()=>{b("select"),d()},className:`font-bold w-12 text-center ${c.isMusicOn?"text-cyan-400":"text-slate-500"}`,children:c.isMusicOn?"ON":"OFF"})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-slate-300 mb-2 px-1",children:"Select Music"}),v.jsx("div",{children:v.jsx("select",{value:c.activeMusicUrl,onChange:j=>M(j.target.value),className:"w-full bg-slate-700 border border-slate-600 text-white px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500",children:f1.map(j=>v.jsx("option",{value:j.url,children:j.name},j.id))})})]}),t&&i&&v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsx("button",{onClick:()=>{t(),e()},className:"w-full bg-purple-600 hover:bg-purple-500 font-bold py-3 rounded-lg transition-colors",children:"Shop"}),v.jsx("button",{onClick:()=>{i(),e()},className:"w-full bg-indigo-600 hover:bg-indigo-500 font-bold py-3 rounded-lg transition-colors",children:"Inventory"})]}),r&&v.jsx("button",{onClick:()=>{b("select"),r(),e()},className:"w-full bg-orange-600 hover:bg-orange-500 font-bold py-3 rounded-lg transition-colors",children:"Resign Game"}),o&&v.jsx("button",{onClick:z,className:"w-full bg-red-700 hover:bg-red-600 font-bold py-3 rounded-lg transition-colors",children:"Log Out"}),v.jsx("button",{onClick:()=>{b("select"),e()},className:"w-full bg-slate-600 hover:bg-slate-500 font-bold py-3 rounded-lg transition-colors",children:"Close"})]}),v.jsx("style",{children:`
          input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 16px; height: 16px; background: #22d3ee; cursor: pointer; border-radius: 50%; } 
          input[type="range"]::-moz-range-thumb { width: 16px; height: 16px; background: #22d3ee; cursor: pointer; border-radius: 50%; border: none; } 
          input[type="range"]:disabled::-webkit-slider-thumb { background: #64748b; } 
          input[type="range"]:disabled::-moz-range-thumb { background: #64748b; }
        `})]}),v.jsx(Hu,{isOpen:I,onClose:()=>C(!1),title:"Confirm Log Out",children:v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Are you sure you want to log out?",v.jsx("br",{}),"Any active game will be forfeit."]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>C(!1),className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:B,className:"bg-red-600 hover:bg-red-500 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Log Out"})]})]})})]})},u7=({onGoToShop:n,itemOffset:e=0})=>{const{gameState:t}=ya(),{playSound:i}=Ir(),r=K.useMemo(()=>{const m=Eo.filter(_=>!t.ownedCosmeticIds.includes(_.id)&&_.price>0);return m.length>0?m:[Eo.find(_=>_.id==="boom_rocket")]},[t.ownedCosmeticIds]),[o,c]=K.useState(()=>e%r.length);K.useEffect(()=>{o>=r.length&&c(0)},[r.length,o]),K.useEffect(()=>{if(r.length<=1)return;const m=setInterval(()=>{c(_=>(_+1)%r.length)},5e3+e*250);return()=>clearInterval(m)},[r.length,e]);const h=r[o];if(!h)return null;const d=m=>{switch(m.type){case"piece":{const _=m.item.component;return v.jsx(_,{className:"w-14 h-14 text-cyan-300"})}case"effect":{const _=m.item.previewComponent;return v.jsx("div",{className:"w-14 h-14 flex items-center justify-center text-cyan-300",children:v.jsx(_,{})})}case"theme":{const _=m.item;return v.jsx("div",{className:`w-14 h-14 rounded-md flex items-center justify-center p-2 ${_.boardBg}`,children:v.jsx("div",{className:`w-10 h-10 rounded ${_.cellBg} border-2 ${_.gridColor}`})})}case"avatar":return v.jsx("img",{src:m.item.url,alt:m.name,className:"w-14 h-14 rounded-full object-cover bg-slate-700"});case"emoji":return v.jsx("span",{className:"text-4xl",children:m.item.emoji});default:return null}};return v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-3 w-full h-full flex flex-col items-center justify-center text-center",children:[v.jsx("h3",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-2",children:"Featured Item"}),v.jsx("div",{className:"w-20 h-20 flex items-center justify-center",children:d(h)}),v.jsx("p",{className:"text-white font-semibold mt-1 text-sm h-10 flex items-center",children:h.name}),v.jsx("button",{onClick:()=>{i("select"),n()},className:"mt-2 text-xs bg-yellow-500 text-black font-bold px-3 py-1 rounded-full hover:bg-yellow-400 transition-colors",children:"Go to Shop"})]})},h7=()=>{const{gameState:n,setPlayerName:e,spendCoins:t}=ya(),{playerName:i,playerLevel:r,playerXp:o,pveWins:c,pveLosses:h,pveDraws:d,activeAvatar:m,coins:_}=n,{playSound:y}=Ir(),[b,I]=K.useState(!1),[C,M]=K.useState(i),[z,B]=K.useState(null),[j,X]=K.useState(!1),fe=()=>{if(_<100){B("Not enough coins!"),setTimeout(()=>B(null),2e3);return}I(!0)},F=()=>{const P=C.trim();if(P===i){I(!1);return}P&&P.length>=3&&P.length<=15?X(!0):(B("Name must be 3-15 characters."),setTimeout(()=>B(null),2e3),M(i),I(!1))},ae=()=>{t(100)?(y("confirm"),e(C.trim())):(B("Purchase failed. Not enough coins."),setTimeout(()=>B(null),2e3)),X(!1),I(!1)},D=m.url,x=ar(r),R=o/x*100,V=c+h+d,L=V>0?(c/V*100).toFixed(2):"0.00";return v.jsxs("div",{className:"group relative bg-slate-800/50 border border-slate-700 rounded-xl p-4 w-full h-full transition-all duration-300 hover:border-cyan-400/50 hover:shadow-lg hover:shadow-cyan-500/10 overflow-hidden",children:[v.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 bg-cyan-500/10 rounded-full blur-2xl transition-all duration-500 group-hover:scale-150"}),v.jsxs("div",{className:"relative z-10",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("img",{src:D,alt:"Player Avatar",className:"w-16 h-16 rounded-full flex-shrink-0 border-2 border-slate-600 group-hover:border-cyan-400 transition-colors object-cover bg-slate-700"}),v.jsxs("div",{className:"flex-grow text-left",children:[b?v.jsx("input",{type:"text",value:C,onChange:P=>M(P.target.value),onBlur:F,onKeyPress:P=>P.key==="Enter"&&F(),className:"bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white text-lg font-bold w-full",autoFocus:!0,maxLength:15}):v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("h2",{className:"text-xl font-bold text-white truncate",children:i}),v.jsx("button",{onClick:fe,className:"text-slate-400 hover:text-white transition-colors",title:"Edit name (Costs 100 coins)",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L16.732 3.732z"})})})]}),v.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[v.jsxs("span",{className:"font-semibold text-cyan-400 text-sm",children:["Level ",r]}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("span",{className:"text-yellow-400 font-bold text-sm",children:_}),v.jsx("span",{className:"text-yellow-400",children:"💰"})]})]})]})]}),z&&v.jsx("p",{className:"text-red-500 text-xs text-center absolute -bottom-2 left-1/2 -translate-x-1/2 w-full",children:z}),v.jsxs("div",{className:"mt-3",children:[v.jsxs("div",{className:"flex justify-between items-baseline text-xs text-slate-400 mb-1 px-1",children:[v.jsx("span",{className:"font-semibold",children:"XP"}),v.jsxs("span",{children:[o," / ",x]})]}),v.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:v.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-blue-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${R}%`}})})]}),v.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mt-4",children:[v.jsxs("div",{className:"transition-transform duration-200 hover:scale-110 p-2 rounded-lg",children:[v.jsx("p",{className:"text-green-400 font-bold text-lg",children:c}),v.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Wins"})]}),v.jsxs("div",{className:"transition-transform duration-200 hover:scale-110 p-2 rounded-lg",children:[v.jsx("p",{className:"text-red-400 font-bold text-lg",children:h}),v.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Losses"})]}),v.jsxs("div",{className:"transition-transform duration-200 hover:scale-110 p-2 rounded-lg",children:[v.jsxs("p",{className:"text-cyan-400 font-bold text-lg",children:[L,"%"]}),v.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Win Rate"})]})]})]}),v.jsx(Hu,{isOpen:j,onClose:()=>X(!1),title:"Confirm Name Change",children:v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Are you sure you want to change your name to ",v.jsx("strong",{className:"text-white",children:C.trim()}),"? This will cost ",v.jsx("strong",{className:"text-yellow-400",children:"100 💰"}),"."]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>{y("select"),X(!1),I(!1)},className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:ae,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Confirm"})]})]})})]})},d7=({bot:n,onChallenge:e})=>{const i={easy:"border-green-500",medium:"border-purple-500",hard:"border-orange-500"}[n.skillLevel];return v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 text-center transition-all duration-300 flex flex-col backdrop-blur-sm hover:border-cyan-400",children:[v.jsx("img",{src:n.avatar,alt:n.name,className:`w-16 h-16 rounded-full mx-auto mb-3 border-2 ${i} object-cover bg-slate-700`}),v.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:n.name}),v.jsx("p",{className:"text-slate-400 text-xs mb-3 flex-grow",children:n.description}),v.jsx("button",{onClick:e,className:"mt-auto w-full bg-cyan-500 hover:bg-cyan-400 text-black font-bold py-2 px-3 rounded-lg transition-all text-sm",children:"Challenge"})]})},f7=({onStartGame:n,onGoToShop:e,onGoToInventory:t,onGoToOnline:i})=>{const[r,o]=K.useState(!1),{playSound:c}=Ir(),{user:h,logOut:d}=dh(),m=y=>{c("select"),n(y)},_=()=>{c("select"),o(!0)};return v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 sm:p-6 flex flex-col items-center justify-center overflow-hidden relative",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-5xl text-center z-10 flex flex-col items-center",children:[v.jsxs("h1",{className:"text-5xl md:text-6xl font-black text-white mb-1",children:["Caro ",v.jsx("span",{className:"text-cyan-400",children:"AI Arena"})]}),v.jsx("p",{className:"text-slate-400 text-md mb-8",children:"Five in a row. Infinite possibilities."}),v.jsxs("div",{className:"w-full max-w-4xl grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[v.jsx("div",{className:"md:col-span-1",children:v.jsx(h7,{})}),v.jsx("div",{className:"md:col-span-1",children:v.jsx(u7,{onGoToShop:e,itemOffset:0})}),v.jsxs("div",{className:"md:col-span-1 grid grid-cols-2 gap-4 h-full",children:[v.jsx("button",{onClick:e,className:"w-full h-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center",children:"Shop 🛒"}),v.jsx("button",{onClick:t,className:"w-full h-full bg-gradient-to-r from-teal-500 to-blue-500 hover:from-teal-400 hover:to-blue-400 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center",children:"Inventory 🎒"}),v.jsx("button",{onClick:_,className:"w-full h-full bg-slate-700 hover:bg-slate-600 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center",children:"Settings ⚙️"}),v.jsx("button",{onClick:i,className:"w-full h-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-400 hover:to-red-400 text-white font-bold p-3 rounded-lg text-base transition-all duration-300 shadow-lg flex items-center justify-center transform hover:scale-105",children:"Play Online 🌎"})]})]}),v.jsxs("div",{className:"w-full max-w-4xl",children:[v.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Choose Your Opponent"}),v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:JM.map(y=>v.jsx(d7,{bot:y,onChallenge:()=>m(y)},y.id))})]})]}),v.jsx(qb,{isOpen:r,onClose:()=>o(!1),onLogOut:h?d:void 0})]})},Gd="caroGameState_inProgress",Jk=()=>Array(it).fill(null).map(()=>Array(it).fill(null)),m7=()=>{var n;try{const e=localStorage.getItem(Gd);if(e){const{board:t,currentPlayer:i,totalGameTime:r}=JSON.parse(e);if(t&&Array.isArray(t)&&i&&typeof r=="number"&&t.length===it&&((n=t[0])==null?void 0:n.length)===it)return{board:t,currentPlayer:i,totalGameTime:r,isDecidingFirst:!1}}}catch(e){console.error("Failed to load game state from localStorage",e),localStorage.removeItem(Gd)}return{board:Jk(),currentPlayer:null,totalGameTime:vu,isDecidingFirst:!0}},p7=(n="X",e=!1)=>{const[t]=K.useState(m7),[i,r]=K.useState(t.board),[o,c]=K.useState(t.currentPlayer),[h,d]=K.useState(null),[m,_]=K.useState(!1),[y,b]=K.useState([]),[I,C]=K.useState(t.isDecidingFirst),[M,z]=K.useState(t.totalGameTime),[B,j]=K.useState(fo),[X,fe]=K.useState(null),F=K.useRef([]),ae=K.useRef([]),D=K.useRef(null),x=K.useRef(null);K.useEffect(()=>{if(!m&&!I&&o)try{const ce={board:i,currentPlayer:o,totalGameTime:M};localStorage.setItem(Gd,JSON.stringify(ce))}catch(ce){console.error("Failed to save game state:",ce)}else localStorage.removeItem(Gd)},[i,o,M,m,I]);const R=K.useCallback(()=>{D.current&&(clearInterval(D.current),D.current=null),x.current&&(clearInterval(x.current),x.current=null)},[]);K.useEffect(()=>{if(m||I||!o||e){R();return}return j(fo),D.current=setInterval(()=>{j(ce=>ce<=1?(R(),d("timeout"),_(!0),0):ce-1)},1e3),x.current=setInterval(()=>{z(ce=>ce<=1?(R(),d("draw"),_(!0),0):ce-1)},1e3),()=>R()},[m,I,o,e,R]);const V=K.useCallback((ce,Se)=>{const Re=[{r:0,c:1},{r:1,c:0},{r:1,c:1},{r:1,c:-1}];for(let O=0;O<it;O++)for(let H=0;H<it;H++)if(ce[O][H]===Se)for(const re of Re){const _e=[];let Te=!0;for(let ke=0;ke<si;ke++){const Oe=O+ke*re.r,dt=H+ke*re.c;if(Oe<0||Oe>=it||dt<0||dt>=it||ce[Oe][dt]!==Se){Te=!1;break}_e.push({row:Oe,col:dt})}if(Te)return _e}return null},[]),L=ce=>ce.every(Se=>Se.every(Re=>Re!==null)),P=K.useCallback((ce,Se)=>{if(!o||i[ce][Se]||m||I)return;F.current.push({board:i,currentPlayer:o,totalGameTime:M}),ae.current.push({row:ce,col:Se}),fe({row:ce,col:Se});const Re=i.map(H=>[...H]);Re[ce][Se]=o,r(Re);const O=V(Re,o);O?(d(o),_(!0),b(O)):L(Re)?(d("draw"),_(!0)):c(H=>H==="X"?"O":"X")},[i,o,m,V,I,M]),N=K.useCallback(()=>{R(),r(Jk()),d(null),_(!1),b([]),z(vu),j(fo),c(null),C(!0),F.current=[],ae.current=[],fe(null),localStorage.removeItem(Gd)},[R]),Ve=K.useCallback(ce=>{c(ce),C(!1)},[]),et=o===n&&!m&&F.current.length>0,te=K.useCallback(()=>{if(!et)return;const ce=F.current[F.current.length-2];if(ce)F.current.pop(),F.current.pop(),ae.current.pop(),ae.current.pop(),r(ce.board),c(ce.currentPlayer),z(ce.totalGameTime);else if(F.current.length===1){const Se=F.current.pop();ae.current.pop(),Se&&(r(Se.board),c(Se.currentPlayer),z(Se.totalGameTime))}fe(ae.current[ae.current.length-1]||null),d(null),_(!1),b([]),R()},[et,R]);return{board:i,currentPlayer:o,winner:h,isGameOver:m,makeMove:P,resetGameForRematch:N,beginGame:Ve,winningLine:y,isDecidingFirst:I,totalGameTime:M,turnTimeLeft:B,resign:()=>{!o||m||(d(o===n?"O":"X"),_(!0))},undoMove:te,canUndo:et,moveHistory:ae.current,gameId:null,playerMark:n,lastMove:X}},g7=(n,e)=>{const[t,i]=K.useState(null),[r,o]=K.useState(()=>Tw({})),[c,h]=K.useState(null),[d,m]=K.useState(!0),_=K.useRef(0),[y,b]=K.useState(null),[I,C]=K.useState(fo),[M,z]=K.useState(vu),B=K.useMemo(()=>t&&e?t.players.X===e.uid?"X":"O":"X",[t,e]);return K.useEffect(()=>{if(!n||!e){m(!1),i(null);return}m(!0);const j=n7(n,X=>{if(X){if(i(X),X.emotes&&e){const{uid:fe,emoji:F,timestamp:ae}=X.emotes;fe!==e.uid&&ae>_.current&&(_.current=ae,b({key:ae,emoji:F}))}o(fe=>{const F=Tw(X.board);return JSON.stringify(fe)!==JSON.stringify(F)&&h(B8(fe,F)),F})}else i(null);m(!1)});return()=>j()},[n,e]),K.useEffect(()=>{var X;if(!t||t.status==="finished"){C(fo);const fe=(t==null?void 0:t.currentPlayer)||"X";z(((X=t==null?void 0:t.playerTimes)==null?void 0:X[fe])??vu);return}const j=setInterval(()=>{const fe=(Date.now()-t.turnStartedAt)/1e3,F=fo-fe;C(F);const ae=t.currentPlayer,x=t.playerTimes[ae]-fe;z(Math.max(0,x)),x<-2&&t.currentPlayer!==B&&e&&s7(t.id,B)},500);return()=>clearInterval(j)},[t,B,e]),{board:r,currentPlayer:(t==null?void 0:t.currentPlayer)||null,winner:(t==null?void 0:t.winner)||null,isGameOver:(t==null?void 0:t.status)==="finished",winningLine:(t==null?void 0:t.winningLine)||[],isDecidingFirst:!1,isLoading:d,onlineGameData:t,lastMove:c,opponentEmote:y,playerMark:B,gameId:(t==null?void 0:t.id)||null,activePlayerTime:M,turnTimeLeft:I,makeMove:(j,X)=>{n&&i7(n,j,X,B)},resign:()=>{n&&a7(n,B)},sendEmote:j=>{n&&e&&e7(n,e.uid,j)},beginGame:()=>{},resetGameForRematch:()=>{},undoMove:()=>{},canUndo:!1,moveHistory:[]}},Sw="caroOpeningBook_v1",_7=8,Zk=n=>n.map(e=>e.map(t=>t||"-").join("")).join(""),eO=()=>{try{const n=localStorage.getItem(Sw);if(n)return new Map(JSON.parse(n))}catch(n){console.error("Failed to load or parse opening book from localStorage",n),localStorage.removeItem(Sw)}return new Map},y7=n=>{try{const e=Array.from(n.entries());localStorage.setItem(Sw,JSON.stringify(e))}catch(e){console.error("Failed to save opening book to localStorage",e)}},v7=n=>{if(!n||n.length===0)return;const e=eO(),t=Array(15).fill(null).map(()=>Array(15).fill(null));let i="X";for(let r=0;r<n.length-1&&r<_7;r++){const o=n[r],c=n[r+1],h=Zk(t);t[o.row][o.col]===null&&(t[o.row][o.col]=i),r%2!==0&&e.set(h,c),i=i==="X"?"O":"X"}y7(e),console.log(`Opening book updated. Current size: ${e.size}`)},w7=(n,e)=>{const t=Zk(n),i=e.get(t);return i&&n[i.row][i.col]===null?(console.log("AI Move: Found in opening book.",i),i):null},Uo=(n,e)=>{const t=[{r:0,c:1},{r:1,c:0},{r:1,c:1},{r:1,c:-1}];for(let i=0;i<it;i++)for(let r=0;r<it;r++)if(n[i][r]===e)for(const o of t){let c=1;for(let h=1;h<si;h++){const d=i+h*o.r,m=r+h*o.c;if(d>=0&&d<it&&m>=0&&m<it&&n[d][m]===e)c++;else break}if(c===si)return!0}return!1},rm=n=>{const e=new Set;let t=!1;const i=Math.floor(it/2);for(let r=0;r<it;r++)for(let o=0;o<it;o++)if(n[r][o]!==null){t=!0;for(let c=-2;c<=2;c++)for(let h=-2;h<=2;h++){if(c===0&&h===0)continue;const d=r+c,m=o+h;d>=0&&d<it&&m>=0&&m<it&&n[d][m]===null&&e.add(`${d},${m}`)}}if(!t)return[{row:i,col:i}];if(e.size===0){const r=[];for(let o=0;o<it;o++)for(let c=0;c<it;c++)n[o][c]===null&&r.push({row:o,col:c});return r}return Array.from(e).map(r=>{const[o,c]=r.split(",").map(Number);return{row:o,col:c}})},gs={FIVE:1e7,LIVE_FOUR:5e5,DEAD_FOUR:4e5,LIVE_THREE:5e4,DEAD_THREE:1e4,LIVE_TWO:700,DEAD_TWO:100,LIVE_ONE:10,DEAD_ONE:1},jp=(n,e)=>{const t=e==="X"?"O":"X",i=n.filter(y=>y===e).length,r=n.filter(y=>y===t).length;if(i>0&&r>0)return 0;const o=i||r,c=i>0?e:t,h=n[0],d=n[n.length-1];let m=0;h===null&&m++,d===null&&m++;let _=0;return o===5?_=gs.FIVE:o===4?_=m===2?gs.LIVE_FOUR:m===1?gs.DEAD_FOUR:0:o===3?_=m===2?gs.LIVE_THREE:m===1?gs.DEAD_THREE:0:o===2?_=m===2?gs.LIVE_TWO:m===1?gs.DEAD_TWO:0:o===1&&(_=m===2?gs.LIVE_ONE:m===1?gs.DEAD_ONE:0),c===e?_:-_},_0=(n,e)=>{let t=0;for(let i=0;i<it;i++)for(let r=0;r<it;r++){if(n[i][r]===e?t+=7-(Math.abs(i-7)+Math.abs(r-7))/2:n[i][r]!==null&&(t-=7-(Math.abs(i-7)+Math.abs(r-7))/2),r<=it-si){const o=[];for(let c=0;c<si;c++)o.push(n[i][r+c]);t+=jp(o,e)}if(i<=it-si){const o=[];for(let c=0;c<si;c++)o.push(n[i+c][r]);t+=jp(o,e)}if(i<=it-si&&r<=it-si){const o=[];for(let c=0;c<si;c++)o.push(n[i+c][r+c]);t+=jp(o,e)}if(i>=si-1&&r<=it-si){const o=[];for(let c=0;c<si;c++)o.push(n[i-c][r+c]);t+=jp(o,e)}}return t},Aw=(n,e,t)=>{const i=e==="X"?"O":"X",r=rm(n);let o=null,c=-1/0,h=null,d=-1/0;for(const m of r){const _=n.map(C=>[...C]);_[m.row][m.col]=i;const y=t(_,i);y>c&&(c=y,o={move:m,score:y});const b=n.map(C=>[...C]);b[m.row][m.col]=e;const I=t(b,e);I>d&&(d=I,h={move:m,score:I})}return{bestOpponentMove:o,bestAiMove:h}},xw=(n,e,t,i,r,o,c)=>{if(e===0||Uo(n,"X")||Uo(n,"O"))return{score:c(n,o)};const h=rm(n);if(h.length===0)return{score:c(n,o)};let d=h[0];if(r){let m=-1/0;for(const _ of h){const y=n.map(I=>[...I]);y[_.row][_.col]=o;const b=xw(y,e-1,t,i,!1,o,c);if(b.score>m&&(m=b.score,d=_),t=Math.max(t,b.score),i<=t)break}return{score:m,move:d}}else{let m=1/0;const _=o==="X"?"O":"X";for(const y of h){const b=n.map(C=>[...C]);b[y.row][y.col]=_;const I=xw(b,e-1,t,i,!0,o,c);if(I.score<m&&(m=I.score,d=y),i=Math.min(i,I.score),i<=t)break}return{score:m,move:d}}},n1=(n,e,t,i,r)=>{var d;const o=e==="X"?"O":"X",c=rm(n);for(const m of c){const _=n.map(y=>[...y]);if(_[m.row][m.col]=e,Uo(_,e))return m}for(const m of c){const _=n.map(y=>[...y]);if(_[m.row][m.col]=o,Uo(_,o))return m}if(r==="easy"){const{bestOpponentMove:m,bestAiMove:_}=Aw(n,e,i);return m&&m.score>=gs.DEAD_THREE?_&&_.score>m.score*1.2?(console.log("Easy AI: Found a better offensive move, ignoring block.",_.move),_.move):(console.log("Easy AI: Blocking opponent's 3-in-a-row threat.",m.move),m.move):_?_.move:c[0]}if(r==="medium"||r==="hard"){const{bestOpponentMove:m,bestAiMove:_}=Aw(n,e,i),y=gs.LIVE_THREE;if(m&&m.score>=y&&(!_||m.score>_.score))return console.log(`AI (${r}): Blocking critical player threat.`,m.move),m.move}const{move:h}=xw(n,t,-1/0,1/0,!0,e,i);return h&&((d=n[h.row])==null?void 0:d[h.col])===null?h:(console.error("Minimax failed to return a valid move, picking a random one from available moves."),c[Math.floor(Math.random()*c.length)])},Cw=async(n,e,t,i,r,o,c,h,d)=>{if(e===0||Uo(n,"X")||Uo(n,"O"))return{score:c(n,o)};const m=d||rm(n);if(m.length===0)return{score:c(n,o)};let _=m[0];if(r){let y=-1/0;for(const b of m){h.count++,h.count%25===0&&await new Promise(M=>setTimeout(M,0));const I=n.map(M=>[...M]);I[b.row][b.col]=o;const C=await Cw(I,e-1,t,i,!1,o,c,h);if(C.score>y&&(y=C.score,_=b),t=Math.max(t,C.score),i<=t)break}return{score:y,move:_}}else{let y=1/0;const b=o==="X"?"O":"X";for(const I of m){h.count++,h.count%25===0&&await new Promise(z=>setTimeout(z,0));const C=n.map(z=>[...z]);C[I.row][I.col]=b;const M=await Cw(C,e-1,t,i,!0,o,c,h);if(M.score<y&&(y=M.score,_=I),i=Math.min(i,M.score),i<=t)break}return{score:y,move:_}}},E7=async(n,e,t,i)=>{var b;const r=e==="X"?"O":"X",o=rm(n);for(const I of o){const C=n.map(M=>[...M]);if(C[I.row][I.col]=e,Uo(C,e))return I}for(const I of o){const C=n.map(M=>[...M]);if(C[I.row][I.col]=r,Uo(C,r))return I}const{bestOpponentMove:c,bestAiMove:h}=Aw(n,e,i),d=gs.LIVE_THREE;if(c&&c.score>=d&&(!h||c.score>h.score))return console.log("AI (hard): Blocking critical player threat via tactical analysis.",c.move),c.move;const m=[];for(const I of o){const C=n.map(X=>[...X]);C[I.row][I.col]=e;const M=i(C,e),z=n.map(X=>[...X]);z[I.row][I.col]=r;const B=i(z,e),j=M-B;m.push({move:I,score:j})}m.sort((I,C)=>C.score-I.score);const _=m.slice(0,8).map(I=>I.move),{move:y}=await Cw(n,t,-1/0,1/0,!0,e,i,{count:0},_);return y&&((b=n[y.row])==null?void 0:b[y.col])===null?y:(console.error("Async Minimax failed to return a valid move, picking first available."),o[0])};let y0=null;const b7=async(n,e,t,i)=>{y0===null&&(y0=eO());const r=w7(n,y0);if(r)return i&&i(r),new Promise(h=>setTimeout(()=>h(r),150));let o;switch(t){case"easy":o=1;break;case"medium":o=2;break;case"hard":o=3;break;default:o=1}if(console.log(`Local AI: Minimax (depth ${o}) for ${t} opponent. (Opening book miss)`),i){const h=n1(n,e,1,_0,t);i(h)}if(t==="hard")return E7(n,e,o,_0);const c=t==="easy"?400+Math.random()*300:800+Math.random()*500;return new Promise(h=>{setTimeout(()=>{const d=n1(n,e,o,_0,t);h(d)},c)})},T7=Di.memo(({state:n,onClick:e,isWinningCell:t,pieces:i,showThinkingIndicator:r,theme:o,playPlacementEffect:c,isLastMove:h,effect:d})=>{const m=i.X.component,_=i.O.component,y=`animate-effect_${d.id.split("_")[1]}`;return v.jsxs("div",{className:"w-full h-full flex items-center justify-center cursor-pointer group relative",onClick:e,style:{"--tw-bg-opacity":.1},children:[v.jsx("div",{className:`absolute inset-0 border-r border-b ${o.gridColor}`}),n===null&&v.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:bg-white/10 transition-colors duration-200 rounded-sm"}),v.jsxs("div",{className:`w-full h-full relative transition-all duration-200 ${t?"bg-yellow-500/30 rounded-md scale-110":""}`,children:[n&&v.jsx("div",{className:"w-full h-full p-1.5",children:v.jsx("div",{className:`relative w-full h-full ${n==="X"?"text-cyan-400":"text-pink-500"}`,children:v.jsx("div",{className:c?y:"",children:v.jsx("div",{className:h?"last-move-highlight":"",children:n==="X"?v.jsx(m,{}):v.jsx(_,{})})})})}),r&&v.jsx("div",{className:"w-full h-full flex items-center justify-center",children:v.jsx("div",{className:"w-8 h-8 border-2 border-yellow-400 border-t-transparent rounded-full animate-spin"})})]})]})}),I7=({board:n,onCellClick:e,winningLine:t,pieces:i,aiThinkingCell:r,theme:o,lastMove:c,effect:h})=>{const d=(m,_)=>t.some(y=>y.row===m&&y.col===_);return v.jsx("div",{className:`grid ${o.cellBg} border-t border-l ${o.gridColor}`,style:{gridTemplateColumns:`repeat(${n.length}, minmax(0, 1fr))`},children:n.map((m,_)=>m.map((y,b)=>v.jsx("div",{className:"aspect-square",children:v.jsx(T7,{state:y,onClick:()=>e(_,b),isWinningCell:d(_,b),pieces:i,showThinkingIndicator:(r==null?void 0:r.row)===_&&(r==null?void 0:r.col)===b,theme:o,playPlacementEffect:(c==null?void 0:c.row)===_&&(c==null?void 0:c.col)===b,isLastMove:(c==null?void 0:c.row)===_&&(c==null?void 0:c.col)===b,effect:h})},`${_}-${b}`)))})},i1=Di.forwardRef(({name:n,avatar:e,level:t,player:i,align:r,isCurrent:o,piece:c,skillLevel:h},d)=>{const m=c.component,_=o?"shadow-lg shadow-yellow-500/50":"",y=i==="X"?"text-cyan-400":"text-pink-500",I=h?{easy:"border-green-500",medium:"border-purple-500",hard:"border-orange-500"}[h]:"";return v.jsxs("div",{ref:d,className:`flex items-center gap-3 relative ${r==="right"?"flex-row-reverse":""}`,children:[v.jsx("img",{src:e,alt:`${n}'s avatar`,className:`w-14 h-14 rounded-full transition-all duration-300 ${_} bg-slate-700 object-cover ${h?`border-2 ${I}`:""}`,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.4))"}}),v.jsxs("div",{className:`${r==="right"?"text-right":""} text-shadow`,children:[v.jsx("h3",{className:"font-bold text-white text-lg",children:n}),v.jsxs("div",{className:`flex items-center gap-2 ${r==="right"?"flex-row-reverse":""}`,children:[v.jsxs("p",{className:"text-slate-300 text-sm",children:["Lv. ",t]}),v.jsx("div",{className:`w-5 h-5 ${y}`,children:v.jsx(m,{})})]})]})]})}),v0=(n,e,t=1200)=>{const[i,r]=K.useState(0),o=Di.useRef(null);return K.useEffect(()=>{if(e){let c=null;const h=d=>{c||(c=d);const m=Math.min((d-c)/t,1);r(Math.floor(m*n)),m<1&&(o.current=requestAnimationFrame(h))};o.current=requestAnimationFrame(h)}else r(0);return()=>{o.current&&cancelAnimationFrame(o.current)}},[n,t,e]),i},S7=({show:n,winner:e,timedOutPlayer:t,playerMark:i,onReset:r,onExit:o,playerLevel:c,playerXp:h,gameMode:d,leaveCountdown:m,cpChange:_=0})=>{const[y,b]=K.useState("start"),[I,C]=K.useState(c),M=e===i,z=e==="draw",B=t===i,j=B?"loss":M?"win":z?"draw":"loss",X=n?d1[j]:0,fe=n?h1[j]:0,{didLevelUp:F,initialLevel:ae,initialXp:D,newLevel:x,finalXp:R}=K.useMemo(()=>{if(!n)return{didLevelUp:!1,initialLevel:c,initialXp:h,newLevel:c,finalXp:h};let ce=h;for(let re=1;re<c;re++)ce+=ar(re);const Se=ce-X;let Re=1,O=Se,H=ar(Re);for(;O>=H;)O-=H,Re++,H=ar(Re);return{didLevelUp:Re<c,initialLevel:Re,initialXp:O,newLevel:c,finalXp:h}},[n,c,h,X]),V=D/ar(ae)*100,L=F?100:(D+X)/ar(ae)*100,P=R/ar(x)*100,N=v0(fe,y!=="start"),Ve=v0(X,y!=="start"),et=v0(_,y!=="start"),te=K.useMemo(()=>e==="timeout"?B?"TIME'S UP!":"OPPONENT TIMED OUT":M?"YOU WIN!":z?"IT'S A DRAW!":"YOU LOSE!",[e,B,M,z]),de=j==="win"?"text-green-400":j==="draw"?"text-yellow-400":"text-red-500";return K.useEffect(()=>{let ce=null;if(n)return C(ae),ce=setTimeout(()=>{b("filling"),F?(setTimeout(()=>b("levelUp"),1200),setTimeout(()=>{C(x),b("done")},1700)):setTimeout(()=>b("done"),1200)},500),()=>{ce&&clearTimeout(ce)};b("start"),C(c)},[n,F,x,ae,c]),v.jsx("div",{className:`fixed inset-0 bg-black/80 flex items-center justify-center z-40 transition-opacity duration-500 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:v.jsxs("div",{className:`text-center transition-all duration-500 ${n?"scale-100 opacity-100":"scale-95 opacity-0"}`,children:[v.jsx("h1",{className:`text-7xl font-black ${de} mb-8`,children:te}),v.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 w-80 mx-auto border border-slate-700 relative",children:[y==="levelUp"&&v.jsx("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 text-3xl font-bold text-yellow-300 animate-bounce",children:"LEVEL UP!"}),v.jsxs("div",{className:"text-left mb-4",children:[v.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[v.jsxs("span",{className:"font-semibold text-white",children:["Level ",I]}),v.jsx("span",{className:`text-sm bg-pink-500 text-white font-bold px-2 py-0.5 rounded-full transition-transform duration-300 ${y==="levelUp"?"scale-150":""}`,children:I})]}),v.jsx("div",{className:"bg-slate-700 h-4 rounded-full overflow-hidden relative",children:v.jsx("div",{className:"bg-pink-500 h-full absolute transition-all duration-1000 ease-out",style:{width:y==="start"?`${V}%`:y==="filling"?`${L}%`:y==="levelUp"?"100%":`${P}%`,transitionDuration:y==="done"&&F?"0s":"1s"}})}),v.jsxs("p",{className:"text-right text-sm text-slate-400 mt-1",children:[y==="done"&&F?R:D+Ve,"/",ar(I)," XP"]})]}),v.jsx("h2",{className:"font-bold text-slate-300 mb-2",children:"REWARDS"}),v.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3 flex justify-around",children:[v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsx("span",{className:"text-2xl",children:"💰"}),v.jsxs("span",{className:`font-bold text-yellow-400 text-xl transition-opacity duration-500 ${y!=="start"?"opacity-100":"opacity-0"}`,children:["+",N]})]}),v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsx("span",{className:"text-2xl",children:"✨"}),v.jsxs("span",{className:`font-bold text-purple-400 text-xl transition-opacity duration-500 ${y!=="start"?"opacity-100":"opacity-0"}`,children:["+",Ve," XP"]})]}),d==="online"&&v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsx("span",{className:"text-2xl",children:_>=0?"🏆":"💔"}),v.jsxs("span",{className:`font-bold text-xl transition-opacity duration-500 ${y!=="start"?"opacity-100":"opacity-0"} ${_>=0?"text-green-400":"text-red-400"}`,children:[et>=0?`+${et}`:et," CP"]})]})]})]}),v.jsxs("div",{className:"mt-8 space-y-3",children:[d==="pve"&&v.jsx("button",{onClick:r,className:"w-full max-w-sm bg-green-500 hover:bg-green-400 text-black font-bold py-3 px-6 rounded-lg transition-colors text-lg",children:"Play again!"}),v.jsxs("button",{onClick:o,className:"w-full max-w-sm bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 px-6 rounded-lg transition-colors",children:["Back to ",d==="online"?"Lobby":"Menu",m!==void 0&&` (${m}s)`]})]})]})})},A7=({pieces:n,onAnimationEnd:e,playerMark:t,playSound:i,gameMode:r="pve",forcedWinner:o=null,playerInfo:c,opponentInfo:h})=>{const[d,m]=K.useState(null),[_]=K.useState(()=>o||(Math.random()<.5?"X":"O")),y=n.X.component,b=n.O.component;K.useEffect(()=>{i("deciding");const C=setTimeout(()=>{m(_),i(r==="pve"?_===t?"first_move_player":"first_move_ai":"check"),setTimeout(()=>e(_),1500)},1500);return()=>clearTimeout(C)},[_,e,t,i,r]);const I=()=>d?`${d===t?c==null?void 0:c.name:h==null?void 0:h.name} goes first!`:"Deciding who goes first...";return v.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center rounded-lg z-20",children:[v.jsxs("div",{className:"relative w-48 h-24",children:[v.jsx("div",{className:`absolute top-0 w-24 h-24 p-2 transition-all duration-500 ease-out ${d?d==="X"?"left-1/2 -translate-x-1/2 scale-125":"left-0 opacity-0 -translate-x-full":"left-0 animate-slide-in-left"}`,children:v.jsx(y,{className:"text-cyan-400"})}),v.jsx("div",{className:`absolute top-0 w-24 h-24 p-2 transition-all duration-500 ease-out ${d?d==="O"?"left-1/2 -translate-x-1/2 scale-125":"right-0 opacity-0 translate-x-full":"right-0 animate-slide-in-right"}`,children:v.jsx(b,{className:"text-pink-500"})})]}),v.jsx("p",{className:"text-white font-semibold text-lg mt-4 transition-opacity duration-300",children:I()}),v.jsx("style",{children:`
        @keyframes slide-in-left { 0% { transform: translateX(-100vw); } 80% { transform: translateX(0); } 100% { transform: translateX(0); }}
        @keyframes slide-in-right { 0% { transform: translateX(100vw); } 80% { transform: translateX(0); } 100% { transform: translateX(0); }}
        .animate-slide-in-left { animation: slide-in-left 1s cubic-bezier(0.25, 1, 0.5, 1); }
        .animate-slide-in-right { animation: slide-in-right 1s cubic-bezier(0.25, 1, 0.5, 1); }
      `})]})},x7=Di.memo(({duration:n,isPaused:e,isGameOver:t,isDecidingFirst:i,time:r})=>{if(t||i)return v.jsx("div",{className:"w-full h-1.5 bg-slate-800 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-green-400 rounded-full",style:{width:"100%"}})});const o=Math.max(0,r/n*100),c=o<30?"bg-red-500":o<70?"bg-yellow-400":"bg-green-400";return v.jsx("div",{className:"w-full h-1.5 bg-slate-800 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full ${c} rounded-full transition-colors duration-500`,style:{width:`${o}%`,transition:e?"none":"width 0.5s linear"}})})}),s1=({emoji:n,startRef:e,onEnd:t})=>{const[i,r]=K.useState({top:0,left:0});return K.useEffect(()=>{if(e.current){const o=e.current.getBoundingClientRect();r({top:o.top+o.height/2,left:o.left+o.width/2})}},[e]),i.top===0?null:v.jsxs("div",{className:"fixed text-5xl z-30 pointer-events-none animate-emote-fall",style:{top:i.top,left:i.left},onAnimationEnd:t,children:[n,v.jsx("style",{children:`
                @keyframes emote-fall-anim {
                    0% {
                        transform: translate(-50%, -50%) scale(0.5);
                        opacity: 0;
                    }
                    20% {
                        transform: translate(-50%, -50%) scale(1.2);
                        opacity: 1;
                    }
                    80% {
                        transform: translate(-50%, 200px) scale(1);
                        opacity: 1;
                    }
                    100% {
                        transform: translate(-50%, 300px) scale(0.8);
                        opacity: 0;
                    }
                }
                .animate-emote-fall {
                    animation: emote-fall-anim 3s ease-out forwards;
                }
            `})]})},C7=n=>{const e=Math.floor(n/60),t=Math.round(n%60);return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},r1=({gameMode:n,bot:e,onlineGameId:t,onExit:i,theme:r,pieces:o,playerInfo:c,activeEffect:h,activeVictoryEffect:d,activeBoomEffect:m,isPaused:_,onOpenShop:y,onOpenInventory:b})=>{var Ct,on;const{user:I}=dh(),{gameState:C,consumeEmoji:M,spendCoins:z,applyGameResult:B}=ya(),{playSound:j}=Ir(),X=p7("X",_),fe=g7(n==="online"?t:null,I),F=n==="pve"?X:fe,[ae,D]=K.useState(o.O),[x,R]=K.useState(null),[V,L]=K.useState(!1),[P,N]=K.useState(!1),[Ve,et]=K.useState(!1),[te,de]=K.useState(!1),[ce,Se]=K.useState(15),[Re,O]=K.useState(0),[H,re]=K.useState("none"),[_e,Te]=K.useState(null),[ke,Oe]=K.useState(null),[dt,xt]=K.useState(null),Gn=K.useRef(!1),[Oi,zs]=K.useState(null),[qs,Yn]=K.useState(null),[Sr,Ar]=K.useState(!1),fh=K.useCallback(()=>{Ar(!0)},[]),xr=K.useRef(!1),As=K.useRef(null),is=K.useRef(null),Cr=K.useRef(!1),va=K.useRef(null),Rr=K.useRef(!1),{board:qt,currentPlayer:Pi,winner:tt,isGameOver:yt,winningLine:xs,isDecidingFirst:Cs,gameId:Xn,playerMark:Gt,makeMove:Nr,resign:Gs,lastMove:an}=F,{onlineGameData:De,isLoading:gn,opponentEmote:Ko,activePlayerTime:$o,turnTimeLeft:dc}=fe;De&&(Cr.current=!0),K.useEffect(()=>{Gn.current=!1,re("none"),Te(null),Oe(null),Ar(!1)},[Xn]),K.useEffect(()=>{const Le=()=>{va.current&&(clearInterval(va.current),va.current=null)};return H==="summary"?(Se(15),va.current=setInterval(()=>{Se(Je=>Je<=1?(Le(),i(),0):Je-1)},1e3)):Le(),Le},[H,i]),K.useEffect(()=>{an&&j("move")},[an,j]),K.useEffect(()=>{n==="online"&&Ko&&Yn(Ko)},[Ko,n]),K.useEffect(()=>{var Le;n==="online"&&t&&I&&((Le=C.activePieceX)!=null&&Le.id)&&r7(t,I.uid,C.activePieceX.id)},[(Ct=C.activePieceX)==null?void 0:Ct.id,n,t,I]);const Hs=H!=="none";K.useEffect(()=>{n==="online"&&Cr.current&&!gn&&!De&&!Hs&&i()},[n,gn,De,i,Hs]),K.useEffect(()=>{if(n==="pve"&&Cs){const Le=mo[Math.floor(Math.random()*mo.length)];D(Le)}},[n,Cs]),K.useEffect(()=>{const Le=Gt==="X"?"O":"X";if(Pi!==Le){xr.current=!1;return}n!=="pve"||_||Cs||yt||!e||xr.current||(xr.current=!0,Math.random()<.15&&setTimeout(()=>Yn({key:Date.now(),emoji:G8().emoji}),500),b7(qt,Le,e.skillLevel,Je=>R(Je)).then(({row:Je,col:ln})=>{Je!==-1&&!yt&&!_&&xr.current&&X.makeMove(Je,ln)}).finally(()=>{R(null)}))},[Pi,yt,qt,_,Cs,e,n,X,Gt]),K.useEffect(()=>{var Le,Je;if(console.log(`[GAMEOVER_EFFECT] Fired. isExiting: ${Rr.current}, isGameOver: ${yt}, winner: ${tt}, processed: ${Gn.current}, onlineGameId: ${t}`),Rr.current){console.log("[GAMEOVER_EFFECT] Aborting: Exit in progress.");return}if(yt&&tt&&!Gn.current&&I){Gn.current=!0,console.log(`[GAMEOVER_EFFECT] PROCESSING a win/loss for game ${Xn}`);const ln=tt===Gt?"win":tt==="draw"?"draw":"loss",Ws=n==="pve"?e.id:((De==null?void 0:De.players.X)===(I==null?void 0:I.uid)?De==null?void 0:De.players.O:De==null?void 0:De.players.X)||"unknown";let ks=0;if(n==="online"&&De){const Hn=((Le=De.playerDetails[I.uid])==null?void 0:Le.cp)||0,mi=((Je=De.playerDetails[Ws])==null?void 0:Je.cp)||0;ks=BP(Hn,mi,ln),O(ks)}B(ln,Ws,Xn,ks),ln==="win"?(j("win"),j("announce_win"),Te("You Win!")):ln==="loss"?(j("lose"),j("announce_lose"),Te("You Lose!")):Te(tt==="timeout"?"Time Out!":"Draw!"),n==="pve"&&tt!==Gt&&ln!=="draw"&&v7(X.moveHistory),re("banner");const ss=setTimeout(()=>{var Hn,mi;if(Te(null),tt!=="draw"&&tt!=="timeout"){Oe(tt);const Dr=tt===Gt?As:is,Li=tt===Gt?is:As;xt({winner:(Hn=Dr.current)==null?void 0:Hn.getBoundingClientRect(),loser:(mi=Li.current)==null?void 0:mi.getBoundingClientRect()}),setTimeout(()=>j("boom"),800),re("effects")}},2e3),rs=setTimeout(()=>{re("summary"),j("summary")},5e3);return()=>{clearTimeout(ss),clearTimeout(rs)}}},[yt,tt,Gt,B,e,Xn,n,De,I,X.moveHistory,j,t]);const Jn=K.useMemo(()=>{if(n==="online"&&De&&I){const Le=De.players.X===I.uid?De.players.O:De.players.X,Je=De.playerDetails[Le];return{name:(Je==null?void 0:Je.name)||"Opponent",avatar:(Je==null?void 0:Je.avatarUrl)||"assets/avatars/avatar_1.png",level:(Je==null?void 0:Je.level)||1}}return n==="pve"&&e?{name:e.name,avatar:e.avatar,level:e.level,skillLevel:e.skillLevel}:{name:"Player",avatar:"",level:1}},[n,De,I,e]),Mi=K.useMemo(()=>{var Le;if(n==="pve")return{X:o.X,O:ae};if(n==="online"&&De&&I){const Je=I.uid,ln=De.players.X===Je?De.players.O:De.players.X,Ws=o.X,ks=((Le=De.playerDetails[ln])==null?void 0:Le.pieceId)||kn.id,rs=[kn,Hd,...mo].find(Hn=>Hn.id===ks)||kn;return De.players.X===Je?{X:Ws,O:rs}:{X:rs,O:Ws}}return o},[n,De,I,o,ae]),di=C.botStats[(e==null?void 0:e.id)||""]||{wins:0,losses:0},fi=K.useMemo(()=>q8(C.ownedCosmeticIds,C.emojiInventory),[C.ownedCosmeticIds,C.emojiInventory]),Ks=(Le,Je)=>{yt||Pi!==Gt||qt[Le][Je]!==null||Nr(Le,Je)},wa=()=>{X.canUndo&&C.coins>=20&&et(!0)},Qo=()=>{z(20)&&X.undoMove(),et(!1)},Rs=Le=>{j("select"),zs({key:Date.now(),emoji:Le.emoji}),M(Le.id),N(!1),n==="online"&&fe.sendEmote(Le.emoji)},$s=K.useCallback(()=>{j("select"),re("none"),Te(null),Oe(null),Gn.current=!1,n==="pve"&&X.resetGameForRematch()},[X,n,j]),_n=()=>{Xn&&(navigator.clipboard.writeText(Xn),de(!0),setTimeout(()=>de(!1),2e3))},Wo=K.useCallback(()=>{console.log("[GameScreen] handleExit called. Setting isExitingRef to true and calling onExit prop."),Rr.current=!0,i()},[i]),Ns=r.decoratorComponent,Qs=d.component,Yo=m.component,Ea=n==="pve"&&Cs||n==="online"&&De&&Object.keys(De.board).length===0&&!yt&&!Sr;if(n==="online"&&gn)return v.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center text-white",children:v.jsxs("div",{className:"flex flex-col items-center gap-4",children:[v.jsx("div",{className:"w-12 h-12 border-4 border-cyan-400 border-t-transparent rounded-full animate-spin"}),v.jsx("p",{className:"text-xl",children:"Entering match..."})]})});const Ds=n==="pve"?X.totalGameTime:$o,fc=n==="pve"?X.turnTimeLeft:dc,Vi=n==="online"&&Xn?`Room: ${(on=Xn.split("_").pop())==null?void 0:on.substring(0,6)}`:null;return v.jsxs("div",{style:r.boardBgImage?{backgroundImage:`url(${r.boardBgImage})`}:{},className:`${r.boardBg} min-h-screen p-2 sm:p-4 flex flex-col items-center justify-center font-sans transition-colors duration-500 relative overflow-hidden bg-cover bg-center bg-no-repeat`,children:[Ns&&v.jsx(Ns,{}),v.jsx(RM,{}),v.jsx(XM,{}),Oi&&v.jsx(s1,{emoji:Oi.emoji,startRef:As,onEnd:()=>zs(null)},Oi.key),qs&&v.jsx(s1,{emoji:qs.emoji,startRef:is,onEnd:()=>Yn(null)},qs.key),v.jsxs("div",{className:"w-full max-w-[85vmin] mx-auto relative z-10 flex flex-col justify-center",children:[v.jsxs("header",{className:"flex flex-col justify-center items-center w-full relative mb-4",children:[v.jsx("h1",{className:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-cyan-300 to-blue-400 text-shadow",children:"Caro AI Arena"}),v.jsxs("div",{className:"relative flex items-center justify-center gap-4 mt-2",children:[v.jsx("button",{onClick:()=>{j("select"),L(!0)},className:"bg-slate-800/80 p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Settings",children:v.jsxs("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066 2.573c-.94-1.543.826 3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),n==="pve"&&v.jsx("button",{onClick:wa,disabled:!X.canUndo||C.coins<20,className:"relative bg-slate-800/80 p-2 rounded-full hover:bg-slate-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Undo",children:v.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 15l-3-3m0 0l3-3m-3 3h8a5 5 0 000-10H9"})})}),v.jsx("button",{onClick:()=>{j("select"),N(Le=>!Le)},className:"bg-slate-800/80 p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Emotes",children:v.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),P&&v.jsxs("div",{className:"absolute top-full mt-4 bg-slate-800/90 backdrop-blur-sm p-2 rounded-lg flex flex-wrap justify-center gap-2 animate-fade-in-down z-30",style:{width:"280px"},onMouseLeave:()=>N(!1),children:[" ",fi.map(Le=>v.jsx("button",{onClick:()=>Rs(Le),className:"text-3xl w-12 h-12 flex items-center justify-center rounded-md hover:bg-slate-700/50 hover:scale-110 transition-all",children:Le.emoji},Le.id))," "]})]})]}),v.jsxs("main",{className:"flex-grow flex flex-col justify-center relative",children:[H==="banner"&&_e&&v.jsx("div",{className:"absolute top-28 left-1/2 -translate-x-1/2 w-max px-8 py-4 bg-slate-900/80 border border-slate-700 rounded-2xl shadow-lg z-30 pointer-events-none animate-fade-in-down-then-out",children:v.jsx("h2",{className:`text-5xl font-black ${_e.includes("Win")?"text-green-400":_e.includes("Lose")?"text-red-500":"text-yellow-400"}`,style:{textShadow:"0 0 15px currentColor"},children:_e})}),v.jsxs("div",{className:"flex justify-between items-end px-2 mb-[4px] -mt-px",children:[v.jsx(i1,{ref:As,name:c.name,avatar:c.avatar.url,level:c.level,align:"left",player:Gt,isCurrent:Pi===Gt,piece:Mi[Gt]}),v.jsxs("div",{className:"text-center pb-1 text-shadow",children:[Vi&&v.jsx("div",{className:"text-xs text-slate-400 font-mono mb-1 cursor-pointer",title:"Click to copy full Game ID",onClick:_n,children:te?"Copied!":Vi}),n==="pve"&&e&&v.jsxs("div",{className:"text-white font-mono text-xs tracking-wider whitespace-nowrap",title:`vs ${e.name}`,children:[v.jsxs("span",{className:"text-green-400",children:["Win ",di.wins]})," - ",v.jsxs("span",{className:"text-red-400",children:["Lose ",di.losses]})]}),v.jsx("div",{className:"text-white font-mono text-2xl tracking-wider",children:C7(Ds)})]}),v.jsx(i1,{ref:is,name:Jn.name,avatar:Jn.avatar,level:Jn.level,align:"right",player:Gt==="X"?"O":"X",isCurrent:Pi!==Gt,piece:Mi[Gt==="X"?"O":"X"],skillLevel:n==="pve"?e==null?void 0:e.skillLevel:void 0})]}),v.jsxs("div",{className:"w-full mx-auto",children:[v.jsx(x7,{duration:fo,isPaused:_,isGameOver:yt,isDecidingFirst:Cs||Ea,time:fc},`${Xn}-${Pi}`),v.jsxs("div",{className:"mt-px relative bg-black/40 backdrop-blur-lg rounded-xl p-2 border border-white/10 shadow-lg",children:[v.jsx(I7,{board:qt,onCellClick:Ks,winningLine:xs,pieces:Mi,aiThinkingCell:x,theme:r,lastMove:an,effect:h}),Ea&&v.jsx(A7,{pieces:Mi,onAnimationEnd:n==="pve"?X.beginGame:fh,playerMark:Gt,playSound:j,gameMode:n,forcedWinner:n==="online"?De==null?void 0:De.currentPlayer:null,playerInfo:c,opponentInfo:Jn})]})]})]})]}),H==="effects"&&ke&&dt&&v.jsxs(v.Fragment,{children:[v.jsx(Qs,{})," ",v.jsx(Yo,{winnerCoords:dt==null?void 0:dt.winner,loserCoords:dt==null?void 0:dt.loser})]}),v.jsx(S7,{show:H==="summary",winner:tt,timedOutPlayer:tt==="timeout"?Pi===Gt?Gt==="X"?"O":"X":Pi:null,playerMark:Gt,onReset:$s,onExit:Wo,playerLevel:C.playerLevel,playerXp:C.playerXp,gameMode:n,onlineGame:De,leaveCountdown:ce,cpChange:Re}),v.jsx(c7,{isOpen:Ve,onClose:()=>et(!1),onConfirm:Qo,playSound:j}),v.jsx(qb,{isOpen:V,onClose:()=>L(!1),onOpenShop:y,onOpenInventory:b,onResign:Gs}),v.jsx("style",{children:".animate-confirm-glow { animation: confirm-glow 1.5s ease-in-out infinite; } @keyframes confirm-glow { 50% { box-shadow: 0 0 15px rgba(74, 222, 128, 0.7); } } .last-move-highlight { animation: last-move-glow 2s ease-in-out infinite; } @keyframes last-move-glow { 0% { filter: drop-shadow(0 0 12px rgba(255, 255, 100, 1)) drop-shadow(0 0 6px rgba(255, 255, 100, 1)) brightness(1.5); } 10% { filter: drop-shadow(0 0 10px rgba(255, 255, 100, 0.9)); } 55% { filter: drop-shadow(0 0 4px rgba(255, 255, 100, 0.6)); } 100% { filter: drop-shadow(0 0 10px rgba(255, 255, 100, 0.9)); } } .animate-fade-in-down-then-out { animation: fade-in-down-then-out 2s cubic-bezier(0.25, 1, 0.5, 1) forwards; } @keyframes fade-in-down-then-out { 0% { transform: translateY(-50px) translateX(-50%) scale(0.8); opacity: 0; } 20% { transform: translateY(0) translateX(-50%) scale(1); opacity: 1; } 80% { transform: translateY(0) translateX(-50%) scale(1); opacity: 1; } 100% { transform: translateY(20px) translateX(-50%) scale(0.9); opacity: 0; } }"})]})},a1=({onBack:n})=>{const{gameState:e,purchaseCosmetic:t}=ya(),{playSound:i}=Ir(),[r,o]=K.useState("Skins"),[c,h]=K.useState(null),d={Skins:"piece",Avatars:"avatar",Emojis:"emoji",Themes:"theme",Effects:"effect",Victory:"victory",Booms:"boom"},m=C=>{i("confirm"),t(C),h(null)},_=C=>{i("select"),h(C)},y=Eo.filter(C=>C.type===d[r]),b=C=>{switch(C.type){case"piece":{const M=C.item.component;return v.jsx(M,{className:"w-16 h-16 text-cyan-300"})}case"avatar":return v.jsx("img",{src:C.item.url,alt:C.name,className:"w-16 h-16 rounded-full object-cover bg-slate-700"});case"emoji":return v.jsx("span",{className:"text-4xl",children:C.item.emoji});case"theme":{const M=C.item;return v.jsx("div",{className:`w-16 h-16 rounded-md flex items-center justify-center p-2 bg-cover bg-center ${M.boardBg}`,style:M.boardBgImage?{backgroundImage:`url(${M.boardBgImage})`}:{},children:v.jsx("div",{className:`w-10 h-10 rounded ${M.cellBg} border-2 ${M.gridColor}`})})}case"effect":{const M=C.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(M,{})})}case"victory":{const M=C.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(M,{})})}case"boom":{const M=C.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(M,{})})}default:return null}},I=()=>v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:y.map(C=>{const M=e.ownedCosmeticIds.includes(C.id),z=e.coins>=C.price,B=C.type==="emoji"&&C.price>0,j=e.emojiInventory[C.id]||0;return v.jsxs("div",{className:"relative bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 flex flex-col items-center text-center transition-all duration-300 hover:border-cyan-400 hover:shadow-lg hover:shadow-cyan-500/10",children:[B&&j>0&&v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center border-2 border-slate-800",children:j}),v.jsx("div",{className:"h-24 w-24 mb-3 flex items-center justify-center bg-slate-900/70 rounded-lg p-2",children:b(C)}),v.jsx("h3",{className:"text-md font-semibold text-white mb-2 h-10 flex items-center justify-center",children:C.name}),M&&!B?v.jsx("button",{disabled:!0,className:"w-full mt-auto py-2 px-3 rounded-lg text-sm font-semibold bg-green-600 text-white cursor-not-allowed",children:"Owned"}):v.jsxs("button",{onClick:()=>_(C),disabled:!z,className:`w-full mt-auto py-2 px-3 rounded-lg font-semibold transition-all flex items-center justify-center gap-2 text-sm ${z?"bg-cyan-500 hover:bg-cyan-400 text-black":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:[v.jsx("span",{children:C.price}),v.jsx("span",{className:"text-yellow-800",children:"💰"})]})]},C.id)})});return v.jsxs("div",{className:"p-4 sm:p-8 h-screen bg-slate-900 text-white relative flex flex-col",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"max-w-6xl mx-auto relative z-10 w-full flex flex-col flex-grow overflow-hidden",children:[v.jsx("header",{className:"flex-shrink-0",children:v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400",children:"Shop"}),v.jsxs("div",{className:"flex items-center gap-2 bg-slate-800 px-3 py-1 rounded-full",children:[v.jsx("span",{className:"text-yellow-400 font-bold text-lg",children:e.coins}),v.jsx("span",{className:"text-yellow-400 text-lg",children:"💰"})]})]}),v.jsx("button",{onClick:n,className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Back"})]})}),v.jsx("div",{className:"flex-shrink-0 mb-8 border-b border-slate-700",children:v.jsx("nav",{className:"flex space-x-1 sm:space-x-2 md:space-x-4 overflow-x-auto pb-px scrollbar-hide",children:["Skins","Avatars","Emojis","Themes","Effects","Victory","Booms"].map(C=>v.jsx("button",{onClick:()=>o(C),className:`py-2 px-3 text-base sm:text-lg font-semibold transition-colors whitespace-nowrap ${r===C?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-white"}`,children:C},C))})}),v.jsx("main",{className:"flex-grow overflow-y-auto pr-2 -mr-2 scrollbar-hide",children:I()})]}),v.jsx(Hu,{isOpen:!!c,onClose:()=>h(null),title:"Confirm Purchase",children:c&&v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:["Are you sure you want to buy ",v.jsx("strong",{className:"text-white",children:c.name})," for ",v.jsxs("strong",{className:"text-yellow-400",children:[c.price," 💰"]}),"?"]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:()=>{i("select"),h(null)},className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("button",{onClick:()=>m(c),className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors animate-confirm-glow",children:"Confirm"})]})]})})]})},o1=({onBack:n})=>{const{gameState:e,equipPiece:t,equipAvatar:i,equipTheme:r,equipEffect:o,equipVictoryEffect:c,equipBoomEffect:h}=ya(),{playSound:d}=Ir(),[m,_]=K.useState("Skins"),y={Skins:"piece",Avatars:"avatar",Emojis:"emoji",Themes:"theme",Effects:"effect",Victory:"victory",Booms:"boom"},b=[...mo.map(F=>({id:F.id,name:F.name,type:"piece",price:0,item:F})),...Og.map(F=>({id:F.id,name:F.name,type:"avatar",price:0,item:F})),...Pg.map(F=>({id:F.id,name:F.name,type:"emoji",price:0,item:F})),...kg.map(F=>({id:F.id,name:F.name,type:"theme",price:0,item:F})),...Mg.map(F=>({id:F.id,name:F.name,type:"effect",price:0,item:F})),...Kd.map(F=>({id:F.id,name:F.name,type:"victory",price:0,item:F})),...$d.map(F=>({id:F.id,name:F.name,type:"boom",price:0,item:F})),{id:kn.id,name:kn.name,type:"piece",price:0,item:kn},{id:oi.id,name:oi.name,type:"avatar",price:0,item:oi},{id:Es.id,name:Es.name,type:"theme",price:0,item:Es},{id:Yi.id,name:Yi.name,type:"effect",price:0,item:Yi},{id:Xi.id,name:Xi.name,type:"victory",price:0,item:Xi},{id:Ji.id,name:Ji.name,type:"boom",price:0,item:Ji}],I=new Map;b.forEach(F=>{I.has(F.id)||I.set(F.id,F)});const C=e.ownedCosmeticIds.map(F=>I.get(F)).filter(F=>F!==void 0),M=Object.keys(e.emojiInventory).map(F=>I.get(F)).filter(F=>F!==void 0&&(e.emojiInventory[F.id]||0)>0),z=[...C,...M],j=Array.from(new Map(z.map(F=>[F.id,F])).values()).filter(F=>F.type===y[m]),X=F=>{switch(F.type){case"piece":{const ae=F.item.component;return v.jsx(ae,{className:"w-16 h-16 text-cyan-300"})}case"avatar":return v.jsx("img",{src:F.item.url,alt:F.name,className:"w-16 h-16 rounded-full object-cover bg-slate-700"});case"emoji":return v.jsx("span",{className:"text-4xl",children:F.item.emoji});case"theme":{const ae=F.item;return v.jsx("div",{className:`w-16 h-16 rounded-md flex items-center justify-center p-2 bg-cover bg-center ${ae.boardBg}`,style:ae.boardBgImage?{backgroundImage:`url(${ae.boardBgImage})`}:{},children:v.jsx("div",{className:`w-10 h-10 rounded ${ae.cellBg} border-2 ${ae.gridColor}`})})}case"effect":{const ae=F.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(ae,{})})}case"victory":{const ae=F.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(ae,{})})}case"boom":{const ae=F.item.previewComponent;return v.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-cyan-300",children:v.jsx(ae,{})})}default:return null}},fe=()=>j.length>0?v.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:j.map(F=>{var V;const ae=F.type==="piece"?e.activePieceX.id===F.id:F.type==="avatar"?e.activeAvatar.id===F.id:F.type==="theme"?e.activeTheme.id===F.id:F.type==="effect"?e.activeEffect.id===F.id:F.type==="victory"?e.activeVictoryEffect.id===F.id:F.type==="boom"?e.activeBoomEffect.id===F.id:!1,D=F.type==="emoji"&&(((V=Eo.find(L=>L.id===F.id))==null?void 0:V.price)||0)>0,x=e.emojiInventory[F.id]||0,R=()=>{d("select"),F.type==="piece"?t(F.item):F.type==="avatar"?i(F.item):F.type==="theme"?r(F.item):F.type==="effect"?o(F.item):F.type==="victory"?c(F.item):F.type==="boom"&&h(F.item)};return v.jsxs("div",{className:"relative bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 flex flex-col items-center text-center transition-all duration-300 hover:border-cyan-400 hover:shadow-lg hover:shadow-cyan-500/10",children:[D&&x>0&&v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center border-2 border-slate-800",children:x}),v.jsx("div",{className:"h-24 w-24 mb-3 flex items-center justify-center bg-slate-900/70 rounded-lg p-2",children:X(F)}),v.jsx("h3",{className:"text-md font-semibold text-white mb-2 h-10 flex items-center justify-center",children:F.name}),v.jsx("button",{onClick:R,disabled:ae||F.type==="emoji",className:`w-full mt-auto py-2 px-3 rounded-lg text-sm font-semibold transition-all ${F.type==="emoji"?"bg-slate-600 text-slate-400 cursor-not-allowed":ae?"bg-green-500 text-white cursor-not-allowed":"bg-cyan-500 hover:bg-cyan-400 text-black"}`,children:F.type==="emoji"?"Owned":ae?"Equipped":"Equip"})]},F.id)})}):v.jsxs("div",{className:"text-center py-16",children:[v.jsx("p",{className:"text-slate-400 text-lg",children:"You don't own any items in this category yet."}),v.jsx("p",{className:"text-slate-500",children:"Visit the shop to get some!"})]});return v.jsxs("div",{className:"p-4 sm:p-8 h-screen bg-slate-900 text-white relative flex flex-col",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"max-w-6xl mx-auto relative z-10 w-full flex flex-col flex-grow overflow-hidden",children:[v.jsx("header",{className:"flex-shrink-0",children:v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400",children:"Inventory"}),v.jsx("button",{onClick:n,className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Back"})]})}),v.jsx("div",{className:"flex-shrink-0 mb-8 border-b border-slate-700",children:v.jsx("nav",{className:"flex space-x-1 sm:space-x-2 md:space-x-4 overflow-x-auto pb-px scrollbar-hide",children:["Skins","Avatars","Emojis","Themes","Effects","Victory","Booms"].map(F=>v.jsx("button",{onClick:()=>_(F),className:`py-2 px-3 text-base sm:text-lg font-semibold transition-colors whitespace-nowrap ${m===F?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-white"}`,children:F},F))})}),v.jsx("main",{className:"flex-grow overflow-y-auto pr-2 -mr-2 scrollbar-hide",children:fe()})]})]})},R7=()=>{const[n,e]=K.useState(!0),[t,i]=K.useState(""),[r,o]=K.useState(""),[c,h]=K.useState(""),[d,m]=K.useState(null),[_,y]=K.useState(!1),{playSound:b}=Ir(),I=async M=>{M.preventDefault(),y(!0),m(null),b("select");try{if(n)await gR(zd,t,r);else{if(c.length<3||c.length>15)throw new Error("Username must be between 3 and 15 characters.");const z=await pR(zd,t,r);await Kg(z.user,{displayName:c}),await zk(z.user,c)}}catch(z){m(z.message||"An unknown error occurred.")}finally{y(!1)}},C=async()=>{y(!0),m(null),b("confirm");try{await oR(zd)}catch(M){m(M.message||"Could not sign in as guest.")}finally{y(!1)}};return v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex flex-col items-center justify-center relative",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-md bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-2xl p-8 z-10 animate-fade-in-up",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400 text-center mb-2",children:"Caro AI Arena"}),v.jsx("p",{className:"text-slate-400 text-center mb-8",children:n?"Log in to continue":"Create an account"}),v.jsxs("form",{onSubmit:I,className:"space-y-6",children:[!n&&v.jsx("input",{type:"text",placeholder:"Username",value:c,onChange:M=>h(M.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0}),v.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:M=>i(M.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0}),v.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:M=>o(M.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0}),d&&v.jsx("p",{className:"text-red-500 text-sm",children:d}),v.jsx("button",{type:"submit",disabled:_,className:"w-full bg-cyan-500 hover:bg-cyan-400 text-black font-bold py-3 rounded-lg transition-all disabled:bg-slate-600",children:_?"Processing...":n?"Log In":"Sign Up"})]}),v.jsx("div",{className:"text-center mt-6",children:v.jsx("button",{onClick:()=>{b("select"),e(!n),m(null)},className:"text-cyan-400 hover:underline",children:n?"Need an account? Sign Up":"Already have an account? Log In"})}),v.jsxs("div",{className:"flex items-center my-8",children:[v.jsx("hr",{className:"flex-grow border-slate-600"}),v.jsx("span",{className:"px-4 text-slate-400",children:"OR"}),v.jsx("hr",{className:"flex-grow border-slate-600"})]}),v.jsx("button",{onClick:C,disabled:_,className:"w-full bg-slate-600 hover:bg-slate-500 text-white font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:"Continue as Guest"})]}),v.jsx("style",{children:`
            @keyframes fade-in-up {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in-up { animation: fade-in-up 0.8s ease-out forwards; }
        `})]})},l1=({player:n,align:e})=>{const t=e==="left"?"animate-slide-in-left":"animate-slide-in-right";return v.jsxs("div",{className:`flex flex-col items-center ${t}`,children:[v.jsx("img",{src:n.avatarUrl,alt:n.name,className:"w-32 h-32 rounded-full border-4 border-slate-600 bg-slate-800 object-cover mb-4"}),v.jsx("h3",{className:"text-2xl font-bold text-white",children:n.name}),v.jsxs("p",{className:"text-cyan-400",children:["Level ",n.level]})]})},N7=({game:n,currentUserId:e,onGameStart:t})=>{K.useEffect(()=>{const c=setTimeout(()=>{t()},1500);return()=>clearTimeout(c)},[t]);const i=n.players.X===e?n.players.O:n.players.X,r=n.playerDetails[e],o=n.playerDetails[i];return!r||!o?v.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:v.jsx("p",{children:"Loading player details..."})}):v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex flex-col items-center justify-center relative overflow-hidden",children:[v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%2D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-2xl flex items-center justify-around z-10",children:[v.jsx(l1,{player:r,align:"left"}),v.jsx("div",{className:"animate-zoom-in-out",children:v.jsx("h2",{className:"text-6xl font-black text-red-500",style:{textShadow:"0 0 15px #ef4444"},children:"VS"})}),v.jsx(l1,{player:o,align:"right"})]}),v.jsx("p",{className:"absolute bottom-10 text-slate-400 animate-pulse",children:"Match Starting..."}),v.jsx("style",{children:`
                @keyframes slide-in-left {
                    from { transform: translateX(-100vw); }
                    to { transform: translateX(0); }
                }
                .animate-slide-in-left { animation: slide-in-left 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
                
                @keyframes slide-in-right {
                    from { transform: translateX(100vw); }
                    to { transform: translateX(0); }
                }
                .animate-slide-in-right { animation: slide-in-right 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards; }

                @keyframes zoom-in-out {
                    0% { transform: scale(0.5); opacity: 0; }
                    50% { transform: scale(1.2); opacity: 1; }
                    100% { transform: scale(1); opacity: 1; }
                }
                .animate-zoom-in-out { animation: zoom-in-out 1.2s ease-out forwards; animation-delay: 0.2s; }
            `})]})},D7=({onCancel:n})=>{const[e,t]=K.useState(30),i=K.useRef(null);K.useEffect(()=>{let d;const m=_=>{i.current===null&&(i.current=_);const y=_-i.current,b=Math.max(0,30-y/1e3);t(b),b>0?d=requestAnimationFrame(m):n()};return d=requestAnimationFrame(m),()=>cancelAnimationFrame(d)},[n]);const r=Math.ceil(e),c=2*Math.PI*60,h=c-e/30*c;return v.jsxs("div",{className:"fixed inset-0 bg-slate-900/90 flex flex-col items-center justify-center z-50 backdrop-blur-sm animate-fade-in",children:[v.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[v.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 140 140",children:[v.jsxs("defs",{children:[v.jsxs("linearGradient",{id:"goldGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[v.jsx("stop",{offset:"0%",stopColor:"#FBBF24"}),v.jsx("stop",{offset:"100%",stopColor:"#F59E0B"})]}),v.jsxs("linearGradient",{id:"blueGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[v.jsx("stop",{offset:"0%",stopColor:"#38bdf8"}),v.jsx("stop",{offset:"100%",stopColor:"#0ea5e9"})]}),v.jsxs("filter",{id:"glow",children:[v.jsx("feGaussianBlur",{stdDeviation:"3.5",result:"coloredBlur"}),v.jsxs("feMerge",{children:[v.jsx("feMergeNode",{in:"coloredBlur"}),v.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),v.jsx("circle",{cx:"70",cy:"70",r:"68",stroke:"url(#goldGradient)",strokeWidth:"2",fill:"transparent"}),v.jsx("circle",{cx:"70",cy:"70",r:"60",stroke:"rgba(0,0,0,0.5)",strokeWidth:"8",fill:"transparent"}),v.jsx("circle",{cx:"70",cy:"70",r:60,stroke:"url(#blueGradient)",strokeWidth:"8",fill:"transparent",strokeLinecap:"round",strokeDasharray:c,strokeDashoffset:h,className:"transform -rotate-90 origin-center",style:{filter:"url(#glow)"}})]}),v.jsx("div",{className:"absolute flex flex-col items-center justify-center text-white",children:v.jsx("span",{className:"text-5xl font-bold tracking-tighter",style:{textShadow:"0 0 10px rgba(255,255,255,0.5)"},children:r})})]}),v.jsx("h2",{className:"text-3xl font-bold text-white mt-8",style:{textShadow:"0 0 15px rgba(56, 189, 248, 0.5)"},children:"Finding Opponent"}),v.jsx("button",{onClick:n,className:"mt-8 bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),v.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.3s ease-out; }
      `})]})},k7=({onStartGame:n,onBack:e})=>{const{user:t,logOut:i}=dh(),{gameState:r}=ya(),[o,c]=K.useState([]),[h,d]=K.useState(!1),[m,_]=K.useState(null),[y,b]=K.useState({}),[I,C]=K.useState(!1),{playSound:M}=Ir(),z=async P=>{d(!1);const N=await t7(P);N?(_(N),M("confirm")):t&&$k(t.uid)};K.useEffect(()=>{if(!t)return;Gk(t.uid).then(Ve=>{(Ve==null?void 0:Ve.status)==="in_queue"&&d(!0)});const P=$8(Ve=>{c(Ve.filter(et=>et.uid!==t.uid))}),N=Kk(t.uid,Ve=>{Ve&&Ve.gameId&&(Ve.status==="idle"||Ve.status==="in_queue")&&z(Ve.gameId)});return()=>{P(),N()}},[t]);const B=P=>{t&&(M("select"),Y8(t,P.uid),b(N=>({...N,[P.uid]:"invited"})),setTimeout(()=>{b(N=>{const Ve={...N};return delete Ve[P.uid],Ve})},11e3))},j=async()=>{if(!t)return;d(!0),M("select");const P=await Q8(t);P&&z(P)},X=()=>{t&&(M("select"),W8(t.uid),d(!1))},{onlineWins:fe,onlineLosses:F,onlineDraws:ae,cp:D,coins:x}=r,R=fe+F+ae,V=R>0?(fe/R*100).toFixed(2):"0.00",L=FP(D);return m&&t?v.jsx(N7,{game:m,currentUserId:t.uid,onGameStart:()=>n(m.id)}):v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 sm:p-6 flex flex-col items-center justify-center relative",children:[h&&v.jsx(D7,{onCancel:X}),v.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%2D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),v.jsxs("div",{className:"w-full max-w-4xl text-center z-10",children:[v.jsxs("header",{className:"flex justify-between items-center mb-6",children:[v.jsx("h1",{className:"text-4xl font-bold text-cyan-400",children:"Online Lobby"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:e,className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Menu"}),v.jsx("button",{onClick:()=>{M("select"),C(!0)},className:"bg-slate-700/80 p-2 rounded-full hover:bg-slate-600 transition-colors","aria-label":"Settings",children:v.jsxs("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066 2.573c-.94-1.543.826 3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"md:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-4 h-[60vh] flex flex-col",children:[v.jsxs("h2",{className:"text-xl font-semibold text-white mb-4 text-left",children:["Players Online (",o.length,")"]}),v.jsx("div",{className:"flex-grow overflow-y-auto pr-2 scrollbar-hide",children:o.length>0?o.map(P=>{const N=y[P.uid];return v.jsxs("div",{className:"flex items-center justify-between bg-slate-900/50 p-3 rounded-lg mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:P.avatarUrl,alt:P.name,className:"w-10 h-10 rounded-full object-cover bg-slate-700"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-semibold text-white text-left",children:P.name}),v.jsxs("p",{className:"text-slate-400 text-sm text-left",children:["Level ",P.level]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:`text-sm font-semibold ${P.status==="idle"?"text-green-400":"text-yellow-400"}`,children:P.status.replace("_"," ")}),v.jsx("button",{onClick:()=>B(P),disabled:P.status!=="idle"||!!N,className:`text-xs text-white font-bold px-3 py-1 rounded-full mt-1 transition-colors ${N?"bg-slate-600 cursor-not-allowed":"bg-blue-500 hover:bg-blue-400"}`,children:N?"Invited":"Invite"})]})]},P.uid)}):v.jsx("p",{className:"text-slate-500 text-center pt-16",children:"No other players online right now."})})]}),v.jsxs("div",{className:"md:col-span-1 flex flex-col gap-6",children:[v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:r.activeAvatar.url,alt:"Your Avatar",className:"w-14 h-14 rounded-full flex-shrink-0 border-2 border-slate-600 object-cover bg-slate-700"}),v.jsxs("div",{className:"text-left",children:[v.jsx("h2",{className:"text-lg font-bold text-white truncate",children:r.playerName}),v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("span",{className:"font-semibold text-cyan-400 text-sm",children:["Level ",r.playerLevel]}),v.jsxs("div",{className:"flex items-center gap-1.5",children:[v.jsx("span",{className:"text-yellow-400 font-bold text-sm",children:x}),v.jsx("span",{className:"text-yellow-400",children:"💰"})]})]})]})]}),v.jsxs("div",{className:"mt-2 text-left bg-slate-900/50 rounded-lg p-2 flex items-center justify-between",children:[v.jsxs("p",{className:"text-sm font-semibold",children:[L.icon," ",L.name]}),v.jsxs("p",{className:"text-xs text-slate-300",children:[L.cpInTier," / 100 CP"]})]}),v.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mt-3",children:[v.jsxs("div",{className:"p-1",children:[v.jsx("p",{className:"text-green-400 font-bold text-lg",children:fe}),v.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Wins"})]}),v.jsxs("div",{className:"p-1",children:[v.jsx("p",{className:"text-red-400 font-bold text-lg",children:F}),v.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Losses"})]}),v.jsxs("div",{className:"p-1",children:[v.jsxs("p",{className:"text-cyan-400 font-bold text-lg",children:[V,"%"]}),v.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Win Rate"})]})]})]}),v.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 flex flex-col justify-center items-center flex-grow",children:[v.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Matchmaking"}),v.jsx("p",{className:"text-slate-400 mb-6",children:"Find a random opponent and jump right into a game."}),v.jsx("button",{onClick:j,className:"w-full bg-green-500 hover:bg-green-400 text-black font-bold py-3 px-4 rounded-lg transition-all text-lg mt-auto",children:"Find Match"})]})]})]})]}),v.jsx(qb,{isOpen:I,onClose:()=>C(!1),onLogOut:i})]})},w0="caroActivePveGame_bot",c1="caroGameState_inProgress",O7=1440*60*1e3,Rw=()=>v.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex flex-col items-center justify-center text-center",children:[v.jsxs("h1",{className:"text-6xl md:text-8xl font-black text-white mb-2",children:["Caro ",v.jsx("span",{className:"text-cyan-400",children:"AI Arena"})]}),v.jsx("p",{className:"text-slate-400 text-xl mt-4",children:"Loading..."})]}),P7=()=>{const{user:n,logOut:e}=dh(),[t,i]=K.useState("menu"),[r,o]=K.useState(null),[c,h]=K.useState(null),[d,m]=K.useState(null),[_,y]=K.useState(!0),{gameState:b}=ya(),{playSound:I,playMusic:C,stopMusic:M}=Ir(),[z,B]=K.useState(null),[j,X]=K.useState(10),fe=K.useRef(!1),F=K.useRef(null),ae=K.useCallback(()=>{n&&(console.log("User has been idle for 24 hours. Logging out."),e())},[n,e]),D=K.useCallback(()=>{F.current&&clearTimeout(F.current),F.current=setTimeout(ae,O7)},[ae]);K.useEffect(()=>{if(!n){F.current&&clearTimeout(F.current);return}const O=["mousemove","keydown","click","scroll","touchstart"];return D(),O.forEach(H=>{window.addEventListener(H,D)}),()=>{F.current&&clearTimeout(F.current),O.forEach(H=>{window.removeEventListener(H,D)})}},[D,n]),K.useEffect(()=>{(async()=>{if(n){const H=await Gk(n.uid);if((H==null?void 0:H.status)==="in_game"&&H.gameId){console.log(`Rejoining active online game: ${H.gameId}`),h(H.gameId),i("online_game"),y(!1);return}}try{const H=localStorage.getItem(w0),re=localStorage.getItem(c1);if(H&&re){const _e=JSON.parse(H);o(_e),i("pve_game"),y(!1);return}}catch{localStorage.removeItem(w0),localStorage.removeItem(c1)}i("menu"),y(!1)})()},[n]),K.useEffect(()=>{t==="menu"||t==="pve_game"||t==="lobby"||t==="online_game"?C():M()},[t,C,M]),K.useEffect(()=>{if(!n)return;const O=Kk(n.uid,H=>{const re=(H==null?void 0:H.gameId)||null;if(fe.current){re===null&&(fe.current=!1);return}re&&re!==c&&(console.log(`Detected game change to ${re}. Switching...`),et(re))});return()=>O()},[n,c]),K.useEffect(()=>{if(!n)return;const O=X8(n.uid,H=>{H&&I("select"),B(H)});return()=>O()},[n,I]);const x=K.useCallback(()=>{n&&(I("select"),Z8(n.uid),B(null))},[n,I]);K.useEffect(()=>{if(z){X(10);const O=setInterval(()=>{X(H=>H<=1?(clearInterval(O),x(),0):H-1)},1e3);return()=>clearInterval(O)}},[z,x]);const R=async()=>{!n||!z||(await J8(n,z),B(null))},V=K.useCallback(O=>{try{I("select"),localStorage.setItem(w0,JSON.stringify(O)),o(O),i("pve_game")}catch(H){console.error("Failed to save active bot:",H)}},[I]),L=K.useCallback(()=>{I("select"),i("shop")},[I]),P=K.useCallback(()=>{I("select"),i("inventory")},[I]),N=K.useCallback(()=>{I("select"),i("menu"),o(null),m(null),h(null)},[I]),Ve=()=>{I("select"),i("lobby")},et=O=>{fe.current=!1,h(O),i("online_game")},te=()=>{I("select"),m("shop")},de=()=>{I("select"),m("inventory")},ce=()=>{I("select"),m(null)},Se=K.useCallback(()=>{t==="online_game"?(fe.current=!0,n&&$k(n.uid),i("lobby"),h(null)):N()},[t,N,n]);if(_)return v.jsx(Rw,{});const Re=()=>{switch(t){case"lobby":return v.jsx(k7,{onStartGame:et,onBack:N});case"online_game":return!c||!n?(i("lobby"),v.jsx(Rw,{})):v.jsx(r1,{gameMode:"online",onlineGameId:c,onExit:Se,theme:b.activeTheme,pieces:{X:b.activePieceX,O:b.activePieceO},playerInfo:{name:b.playerName,level:b.playerLevel,avatar:b.activeAvatar,xp:b.playerXp,wins:b.onlineWins,losses:b.onlineLosses},activeEffect:b.activeEffect,activeVictoryEffect:b.activeVictoryEffect,activeBoomEffect:b.activeBoomEffect,isPaused:!!d,onOpenShop:te,onOpenInventory:de},c);case"pve_game":return r?v.jsx(r1,{gameMode:"pve",bot:r,onExit:Se,theme:b.activeTheme,pieces:{X:b.activePieceX,O:b.activePieceO},playerInfo:{name:b.playerName,level:b.playerLevel,avatar:b.activeAvatar,xp:b.playerXp,wins:b.pveWins,losses:b.pveLosses},activeEffect:b.activeEffect,activeVictoryEffect:b.activeVictoryEffect,activeBoomEffect:b.activeBoomEffect,isPaused:!!d,onOpenShop:te,onOpenInventory:de},r.id):(N(),null);case"shop":return v.jsx(a1,{onBack:N});case"inventory":return v.jsx(o1,{onBack:N});case"menu":default:return v.jsx(f7,{onStartGame:V,onGoToShop:L,onGoToInventory:P,onGoToOnline:Ve})}};return v.jsxs("div",{className:"bg-slate-900 relative animate-app-fade-in",children:[Re(),d&&v.jsxs("div",{className:"fixed inset-0 z-50 bg-black/70 p-4 sm:p-8 overflow-y-auto",children:[d==="shop"&&v.jsx(a1,{onBack:ce}),d==="inventory"&&v.jsx(o1,{onBack:ce})]}),v.jsx(Hu,{isOpen:!!z,title:"Incoming Challenge!",children:z&&v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-slate-300 mb-6",children:[v.jsx("strong",{className:"text-white",children:z.fromName})," has challenged you to a match! ",v.jsxs("span",{className:"text-slate-400",children:["(",j,"s)"]})]}),v.jsxs("div",{className:"flex justify-center gap-4",children:[v.jsx("button",{onClick:x,className:"bg-red-600 hover:bg-red-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Decline"}),v.jsx("button",{onClick:R,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Accept"})]})]})}),v.jsx("style",{children:`
                @keyframes app-fade-in {
                    from { opacity: 0; transform: scale(0.97); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-app-fade-in { animation: app-fade-in 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
            `})]})},M7=()=>{const{user:n,loading:e}=dh();return e?v.jsx(Rw,{}):n?v.jsx(P7,{}):v.jsx(R7,{})};function V7(){return v.jsx(o7,{children:v.jsx(l7,{children:v.jsx(M7,{})})})}const tO=document.getElementById("root");if(!tO)throw new Error("Could not find root element to mount to");const L7=UP.createRoot(tO);L7.render(v.jsx(Di.StrictMode,{children:v.jsx(V7,{})}));
